       PROCESS APOST.
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ED201C.
       COPY COPYRIGHT OF QSECCPY.
      ****************************************************************
      *    ED201C - EDI ENROLLMENT UPDATE DETERMINATION              *
      *                                                              *
      *    THIS PROCESS CREATES MEMBERSHIP ENROLLMENT BATCHES FROM   *
      *    THE EEWMAS WORK FILE.                                     *
      ****************************************************************
      *Š                                                            €*
      *Š   NOTICE!!!                                                €*
      *Š                                                            €*
      *ˆ   ANY CHANGES TO PARAPRAPHS THAT PROCESS EEWSUB & EEWDEP   €*
      *ˆ   TABLES WILL NEED TO BE REPLICATED TO THE CORRESPONDING   €*
      *ˆ   EEWBYP PARAGRAPHS IN THE ED201CB COPYBOOK.               €*
      *Š                                                            €*
      *Š   For any code changes, search for similar logic in ED201CB€*
      *Š   that will need the same changes.                         €*
      *Š                                                            €*
      ****************************************************************
      *Š                                                            €*
      *Š   For changes in ED201C to paragraphs Axxx or Bxxx make    €*
      *Š   the same changes to Cxxx or Dxxx paragraphs in ED201CB.  €*
      *Š                                                            €*
      ****************************************************************
      *‚   DISPLAYING DEBUG STATEMENTS                              €*
      *‚                                                            €*
      *‚   Use the IN-DEBUG flag to display messages as needed.     €*
      *‚   This will allow the messages to stay in the program and  €*
      *‚   only be displayed when desired.                          €*
      *‚                                                            €*
      *‚   To cause the messages to be displayed, create a data area€*
      *‚   using the same name as the program in the Library List.  €*
      *‚   (Personal developer library is best, It will not effect  €*
      *‚   others.)                                                 €*
      *‚                                                            €*
      ****************************************************************
      *                       PROGRAM CHANGE LOG                     *
      *                                                              *
      *    Date    Type   Request#  Client  Ver   Programmer         *
      *==============================================================*
      *  03/11/19  Fix    PMHS-406  HFI     7.43  Saket Kala         *
      *  Problem:  Exchange member is enrolled directly into the core*
      *            files by EDI Enrollment (ED201ACL) when there is a*
      *            gap in coverage from previous enrollment and the  *
      *            Premium Total has not been satisfied by the APTC  *
      *            Amount plus Other Payer Amount.                   *
      *  Solution: Program has been modified to determine if a gap in*
      *            coverage for prior enrollment exists for an Excha-*
      *            ange member regardless of other conditions.If a   *
      *            gap in coverage is detected and the Premium Total *
      *            is not satisfied by the ATPC Amount plus Other    *
      *            Payer Amount,the Exchange member will  be placed  *
      *            in pre-enrollment.                                *
      *            Recompile only.                                   *
      *            Copybook: ED201CB1                                *
      *--------------------------------------------------------------*
      *  02/15/19  Fix    PMHS-362  HFI     7.43  Kay Thrasher       *
      *  03/14/19  Fix    PMHS-362  HFI     7.43  Gautam Kumar       *
      *  Problem:  Member is not recognized as Exchange for a Change *
      *            transaction when no M3 data is specified but      *
      *            existing member is Exchange.                      *
      *  Solution: Flag member as Exchange for a Change transaction  *
      *            when existing member is Exchange.                 *
      *  Note:     Additional changes have been made to populate the *
      *            Exchange (EXCHNG) field of MEMMAS to a temp table *
      *            and also the indexing issue has been corrected    *
      *            in A1510-, A1520-, C1510- and C1520- para.        *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  02/14/19  Fix    PMHS-374  HFI     7.43  Kay Thrasher       *
      *  Problem:  MCH0603 occurs when processing a Change           *
      *            transaction for a renewal of both an Exchange     *
      *            subscriber and dependent.                         *
      *  Solution: Make sure member table is cleared and re-filled   *
      *            when processing both a subscriber and dependent.  *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  02/06/19  Fix    PMHS-364  HFI     7.43  Kay Thrasher       *
      *  Problem:  HIM Grace Period Days are not properly recognized.*
      *  Solution: Recompile to capture changes that were made to    *
      *            Grace Period Days linkage under MHS-4250.         *
      *--------------------------------------------------------------*
      *  12/20/18  Fix    PMHS-269  HFI     7.43  Kay Thrasher       *
      *  Problem:  Incorrect Exchange subscriber is termed.          *
      *  Solution: Clear working-storage term effective date after   *
      *            processing a transaction.  Capture proper Reason  *
      *            Category and Term Reason Code to Exchange doc.    *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  12/17/18  Fix    PMHS-270  HFI     7.43  Kay Thrasher       *
      *  Problem:  Dependent is added to pre-enrollment when         *
      *            subscriber exists in the core files.              *
      *            MCH1202 occurs when adding a dependent to a       *
      *            subscriber that exists in pre-enrollment.         *
      *  Solution: Correct comparison of ASSQHP to prevent           *
      *            transaction from being categorized as             *
      *            re-enrollment.  Check for subscriber in           *
      *            pre-enrollment if not found in core.              *
      *  Copybook: ED201CB, ED201CB1                                 *
      *--------------------------------------------------------------*
      *  11/08/18  Fix    PMHS-238  HFI     7.43  Kay Thrasher       *
      *  Problem:  Financial data is not updated when a Change       *
      *            transaction is processed for an Exchange member   *
      *            for which an Add transaction exists in the same   *
      *            batch.                                            *
      *  Solution: Create an Exchange Membership Detail Transaction  *
      *            for a Change to an Exchange member for which an   *
      *            Add transaction exists in the same batch.         *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  05/30/18  Rework CR142605  HFI     7.43  Chaitanya Beesa    *
      *  Problem:  The error "CANNOT CHANGE MEMBER IN PRE-ENROLLMENT'*
      *            is generated when change transaction is processed.*
      *  Solution: Modified the program to bypass the edits when     *
      *            Pre-Enrollment Update option is activated.        *
      *--------------------------------------------------------------*
      *  11/03/17  Fix    CR141350  HFI     7.43  Kay Thrasher       *
      *  Problem:  Reason Code that was previously populated with    *
      *            Enrollment Billing Reason Code is overlaid with   *
      *            PCP Reason Code when only Benefit Package is      *
      *            changed.                                          *
      *  Solution: Prevent Reason Code from being overlaid with PCP  *
      *            Reason Code if it has already been populated.     *
      *--------------------------------------------------------------*
      *  07/28/17  FIX    CR140677    HPP   727   Amy Grimes         *
      *  09/13/17  REP    CR140714    HPP   743   Amy Grimes         *
      *  PROBLEM:  EI08014 error is being received and ED201ACL      *
      *            job goes into MSGW.                               *
      *  SOLUTION: Increase table size and associated fields.        *
      *  Note: Increased from 98 to 115 which was maxmimum allowed   *
      *        without compile errors.                               *
      *--------------------------------------------------------------*
      *  08/17/17  FIX    CR140831   MHW     738Y  Amy Grimes        *
      *  09/12/17  REP    CR140845   MHW     743   Amy Grimes        *
      *  Problem:  Error GROUP CONTRACT NOT FOUND when a valid       *
      *            record exists on ME1033.                          *
      *  Solution: If EXPDAT is sent in on EEIMAS record as zeroes   *
      *            for a change record then move member's current    *
      *            expiration date to MDTMAS.                        *
      *--------------------------------------------------------------*
      *  06/07/17  FIX    CR140394   DST    743   Clifton Winbush    *
      *  Problem:  Subscript issue when no active PCP record exists  *
      *            for a Change when Bypass edits not specified      *
      *  Solution: Modified process to not bypass the first PCPTAB   *
      *            entry even if it's a null entry. All other null   *
      *            entries will continue to be bypassed.             *
      *--------------------------------------------------------------*
      *  06/07/17  FIX    CR140231   HFI     738Y  Richard L Walters *
      *  06/21/17  Rep    CR140242   HFI     743   Clifton Winbush   *
      *  Problem:  Subscript issue when no active PCP record exists  *
      *            for a Change.                                     *
      *  Solution: Restructured PCP Change logic to mimic SEC PCP    *
      *            change logic.                                     *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  05/31/17  Fix    CR140155    HFI   738Y   Amy Grimes        *
      *  06/20/17  Rep    CR140186    HFI   743   Clifton Winbush    *
      *  Problem:  Error 'INVALID GROUP NUMBER FOR SUBSCRIBER' is    *
      *            not showing the subscriber and member affected.   *
      *  Solution: Modify logic to move subscriber and member to the *
      *            detail line of error report.                      *
      *--------------------------------------------------------------*
      *  02/07/17  Fix    CR138302  DST     738Y  David Burrowes     *
      *  03/03/17  Fix    CR139264  DST     742   Chaitanya Beesa    *
      *  Problem:  When attempting to add a dependent to an existing *
      *            SHOP family and the company is set up for auto    *
      *            member number generation, the MEMBER NUMBER       *
      *            ALREADY ON FILE FOR GROUP AND PERIOD error message*
      *            is received.                                      *
      *  Solution: Modify logic to check to see if the generated     *
      *            member number already exists in MEMMAS before     *
      *            writing the new batch.                            *
      *--------------------------------------------------------------*
      *  12/19/16  E-Fix   CR138823  MHW     7.38Y Kay Thrasher      *
      *  02/09/17  Rep     CR138992  MHW     741   Richard L Walters *
      *  02/09/17  Rep     CR138993  MHW     742   Richard L Walters *
      *  Problem:  Duplicate key error occurs on MEMEXDBT.           *
      *  Solution: Process tables when a subscriber transaction is   *
      *            encountered.                                      *
      *  Copybook: ED201CB, ED201CB1                                 *
      *--------------------------------------------------------------*
      *  01/20/17  FIX     CR138310  DST    7.41  Amy Grimes         *
      *  Problem:  Cannot re-enroll previously termed Exchange       *
      *            subscriber to Core.                               *
      *  Solution: Add logic to program so that a previously termed  *
      *            Exchange subscriber with no gap in coverage can   *
      *            be added back to Core instead of pre-enrollment.  *
      *            Note: A previously termed Exchange subscriber with*
      *            a gap in coverage will continue to be added to    *
      *            pre-enrollment.                                   *
      *            Add working storage fields needed for ED201CB1.   *
      *--------------------------------------------------------------*
      *  11/09/16  Fix    CR138494  HFI     738Y  Richard L Walters  *
      *  12/07/16  REP    CR138541  HFI     741   Richard L Walters  *
      *  Problem:  MCH1202 on 32936.                                 *
      *  Solution: Initialize MCDMAS correctly.                      *
      *            Do not re-init if READ fails.                     *
      *  NOTE: Removed old code.                                     *
      *--------------------------------------------------------------*
      *  08/11/16  Fix     CR137785  DST     7.38Y Sreedhar Katragadd*
      *  10/11/16  Rep     CR137832  DST     7.4A  Sreedhar Katragadd*
      *  Problem:  If APLORG is specifed in in any of the M3 record  *
      *            apart from first M3 the APLORG is not populated.
      *  Solution: In any of the record has APLORG it needs to be    *
      *            saved and need to be used.                        *
      *--------------------------------------------------------------*
      *  09/02/16  FIX    CR137935  MHW     7.37  Amy Grimes         *
      *  09/28/16  REP    CR137976  MHW     7.4A  Amy Grimes         *
      *  Problem:  When posting a member via ME1024, error message   *
      *            EFF DATE OCCURS AFTER MEMBER EXPIRES is issued    *
      *            and member is not expired.                        *
      *  Solution: Modify logic to move all '9' to expiration date   *
      *            in MDTMAS if the MEMEFF/MEMEXP is zeroes. This is *
      *            how fields are populated in ME1023.               *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  06/04/16  MOD   CR136142   DST      738Y  Sreedhar Katragadda*
      *  09/07/16  REP   CR136421   DST      740   Sreedhar Katragadda*
      *  09/22/16  DEF   DEF#8120                  RICHARD L WALTERS  *
      * Problem:  OPYSRC not populated in MDTMAS.                     *
      * Solution: Move OPYSRC when other OPYxxx fields are being      *
      *           moved.                                              *
      *---------------------------------------------------------------*
      *  06/04/16  MOD   CR136142   DST      738Y  Sreedhar Katragadda*
      *  09/07/16  REP   CR136421   DST      740   Sreedhar Katragadda*
      *  Process is modified to move ASSQHP from M2 record to M3      *
      *  record.Modified to consider first four charecters of REACAT  *
      *  for TERM and six charecters for CANCEL.                      *
      *---------------------------------------------------------------*
      *  05/18/16  DCR     CR136864  HFI    7.38Y Kay Thrasher       *
      *  08/22/16  Replica CR136909         7.4A  Kay Thrasher       *
      *  Problem:  Invalid Rate Effective and Rate Expiration dates  *
      *            display on the Exchange pop-up window.            *
      *  Solution: Reformat Rate Effective and Rate Expiration dates *
      *            to conform to DST standards.                      *
      *  Copybook: ED201CB, EXCMDTBTR                                *
      *--------------------------------------------------------------*
      *  06/08/16  Fix    CR137129  MHW     7.37  Richard L Walters  *
      *  08/19/16  REP    CR137146  MHW     74A   Richard L Walters  *
      *  Problem:  Processing stops when member for change not found *
      *            in MEMMAS or MDTMAS.                              *
      *  Solution: Changed to non-fatal.                             *
      *            Print error message correctly.                    *
      *--------------------------------------------------------------*
      *  04/08/16  Fix    CR136189  HFI     7.37  Kay Thrasher       *
      *  08/17/16  Rep    CR136292  HFI     74A   Richard L Walters  *
      *  Problem:  MDTMAS is not created but no error is generated   *
      *            when a Change transaction is processed for a      *
      *            member and the member does not exist in the       *
      *            specified group.                                  *
      *  Solution: Include exception logic when a Member Master      *
      *            record cannot be found for the Member within the  *
      *            specified group.                                  *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  07/22/16  Fix    CR137220  HFI     738y  Richard L Walters  *
      *  08/17/16  Rep    CR137329  HFI     74A   Richard L Walters  *
      *  Problem:  Does not error out if Pre-Enrollment record       *
      *            already exists.                                   *
      *  Solution: Produce error if already in Pre-Enrollment.       *
      *--------------------------------------------------------------*
      *  04/13/16  Fix    CR132968  HFI     7.37  David Burrowes     *
      *  07/20/16  REP    CR136519  HFI     7.4A  Amy Grimes         *
      *  Problem:  Financial change records don't contain MEMBNO,    *
      *            BTHDAT or SEXCOD. Member cannot be found.         *
      *  Solution: Move EXCSUB/EXCMEM to M1 record from M2 record to *
      *            locate member. Change all references from M2 to   *
      *            M1 record for subsequent MOVE statements.         *
      *  Problem:  Receiving MCH1202 when posting batches.           *
      *  Solution: Adding in initialization of MDTTAB.               *
      *--------------------------------------------------------------*
      *  04/13/16  Fix    CR135801  MHW     7.37  Clifton Winbush    *
      *  07/20/16  REP    CR136521  MHW     7.4A  Amy Grimes         *
      *  Problem:  Financial change records not being crated in      *
      *            MDTMAS file.                                      *
      *  Solution: Modified code to create a change record (LINE 1)  *
      *            in MDTMAS when the change has been identified as  *
      *            a finacial change only.                           *
      *--------------------------------------------------------------*
      *  05/03/16  Fix    CR136726  DST     7.4A  Kay Thrasher       *
      *  Problem:  MCH0603 occurs when processing Exchange dependent *
      *            without subscriber.                               *
      *  Solution: Use working-storage fields for determining        *
      *            dependent's re-enrollment status.                 *
      *  Copybook: ED201CB1                                          *
      *--------------------------------------------------------------*
      *  02/04/16  Fix     CR135317  HFI     7.37  Kay Thrasher      *
      *  04/29/16  Replica CR135404  HFI     7.4A  Kay Thrasher      *
      *  Problem:  "Cancel" transactions for exchange members are    *
      *            created without enrollment status.                *
      *  Solution: Populate enrollment status in "cancel"            *
      *            transactions for exchange members.                *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  02/08/16  Fix     CR135386  HFI     7.37  Kay Thrasher      *
      *  04/29/16  Replica CR135430  HFI     7.4A  Kay Thrasher      *
      *  Problem:  "EXCSUB/EXCMEM ID CANNOT BE SAME FOR DEP" message *
      *            is generated to ME102A error log when processing  *
      *            a dependant "add" transaction for an exchange     *
      *            subscriber.                                       *
      *  Solution: Capture all relevant exchange data for dependant  *
      *            "add" transaction.                                *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  09/24/14  MOD    CR125573    DST   738   Sreedhar Katragadda*
      *  Modifed to load the members to preenrollment or core based  *
      *  on ENRSTA.                                                  *
      *--------------------------------------------------------------*
      * 06/05/15   FIX  CR121928    DST   737  Amy Grimes            *
      * Problem:  When modifying the dependent's relationship code   *
      *           from 3 to 2, when there is an already existing     *
      *           spouse dependent, the dependent is modifying       *
      *           without any error when processing through EEIMAS.  *
      * Solution: In A682-STEP-3, populate the EFFDAT, EXPDAT,       *
      *           TIERCD and BENPKG of MDTTAB.                       *
      *--------------------------------------------------------------*
      *  06/02/15  FIX    CR130413   DST    737   Amy Grimes         *
      *  Problem: Enrollment Entry records are not being created     *
      *           during poller process.                             *
      * Solution: Modified A642-STEP-3 and B642-STEP-3 to populate   *
      *           LSTCHG OF MDTTAB instead of ENRSTA OF MDTTAB with  *
      *           CHGDAT OF EEWSBS.                                  *
      *--------------------------------------------------------------*
      *  03/10/15  FIX    CR129983   DST    737   Sudheer K Vugile   *
      *  Problem : Spouse and Dependent loaded with same Member      *
      *            number.                                           *
      *  Solution : Modified the logic for generating the Member     *
      *            Number.                                           *
      *--------------------------------------------------------------*
      *  02/09/15 FIX     CR130206   DST    737  Amy Grimes          *
      *  Problem : SUBSCRIBER ENROLLMENT TABLE TOO SMALL(SUBENB)     *
      *            recevied when more than 98 ENBMAS records exist   *
      *            for the subscriber.                               *
      *  Solution : Increased the length of ENSMAX,LSTIDX, ENSLST    *
      *            and SUBENB to 250 to match entries allowed on     *
      *            ME1014.                                           *
      *--------------------------------------------------------------*
      * 11/14/14  Fix    CR129448    HFI    722   Richard L Walters  *
      * 12/29/14  REP    CR129460    HFI    737   Richard L Walters  *
      *  Problem: HOLDCD not updated for Subscriber change           *
      * Solution: Update HOLDCD for Subscriber changes.              *
      * Copybook: ED201CB.                                           *
      *--------------------------------------------------------------*
      * 09/25/14  Fix    CR129305     MHW    736   Richard L Walters  *
      * 12/18/14  Fix    CR129434     MHW    737   Bill Huckbay       *
      * Problem: SPNQLF being is invalid value of EI                  *
      * Solution:SPNQLF field is being populated using the wrong field*
      *  Copybook: ED201CB                                           *
      *---------------------------------------------------------------*
      * 12/19/14  Fix    CR129855     MHW    737   Bill huckbay       *
      * Problem: PAYMENT ID ONLY ALLOWED FOR SUBSCRIBER               *
      * Solution:correct issue for shop members                       *
      *          DCR  2198                                            *
      *---------------------------------------------------------------*
      * 09/25/14  Fix    CR129305     MHW    736   Richard L Walters  *
      * 12/18/14  Fix    CR129434     MHW    737   Bill Huckbay       *
      * Problem: SPNQLF being is invalid value of EI                  *
      * Solution:SPNQLF field is being populated using the wrong field*
      *  Copybook: ED201CB                                           *
      *---------------------------------------------------------------*
      * 09/25/14  Fix    CR128650     MHW    736   Richard L Walters  *
      * 12/05/14  Fix    CR128720     MHW    737   Bill Huckbay       *
      * Problem: EXCSMSBI record was not retriving correctly.         *
      * Solution:Added rest of the PF's key fields to EXCSMSBI.       *
      *          Initialized EXCSMSBI-REC correctly prior to reading. *
      *---------------------------------------------------------------*
      *  10/07/14  FIX    CR128588   MHW    736   David Burrowes     *
      *  11/12/14  REP    CR128668   MHW    737   Bill Huckbay       *
      *  Problem:  Timestamp not being moved to output 834.          *
      *  Solution: Save timestamp and move to output 834.            *
      *  PROBLEM:  Exchange indicator is not being populated on      *
      *            MEEXCINF popup window for subscriber and all      *
      *            dependants.                                       *
      * SOLUTION:  Move SPNQLF of EEWHDR to EXCMDTBT record, instead *
      *            of EXCHNG of EEWSB2 and EEWDP2 records.           *
      *--------------------------------------------------------------*
      * 07/02/14   Fix  CR126672   MHW    732  Bill Huckbay          *
      * 11/04/14   Rep  CR127939   MHW    737  Richard L Walters     *
      * Problem:  Retiree Members on Automatic Term Report           *
      * Solution: OLDGRP and OLD subscriber fields not being init.   *
      *           corectly                                           *
      *--------------------------------------------------------------*
      *  12/06/13  Fix    CR123171  MHW     732   Clifton Winbush   *
      *  10/23/14  Rep    CR128376  MHW     737   Richard L Walters  *
      *  Recompiled for changes to ED201CB.                          *
      *--------------------------------------------------------------*
      *  09/29/14  FIX    CR128686   MHW    736   Richard L Walters  *
      *  09/29/14  FIX    CR128719   MHW    737   Clifton Winbush    *
      *  Problem:  Extra batches created.                            *
      *  Solution: Reset switch. Fixed under Defect 6407 in prev rls.*
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  09/24/14  MOD    CR126190    DST   737   Shailesh Tripathi  *
      *  WS-DT3-RATARA expaned to 7 bytes.                           *
      *--------------------------------------------------------------*
      *  08/29/13  Fix    CR122721    MHW   730   David Burrowes     *
      *  04/11/14  MOD    CR123678    DST   735   Sudheer Kumar V    *
      *  09/02/14  RWK    CR126727    MHW   737   David Burrowes     *
      *            DEFECT #6568                                      *
      *  Problem:  ED201C goes into message wait receiving an MCH1202*
      *            error at line 27934.                              *
      *  Solution: Initialize all WS-DT3 fields.  (Missed 3 fields.) *
      *            Also initialize SAV-OPYAMT, SAV-APTAMT and        *
      *            SAV-PRETOT.                                       *
      *--------------------------------------------------------------*
      *  09/02/14  CR126954           DST   737   David Burrowes     *
      *            Defect #6583                                      *
      *  PROBLEM:  Exchange indicator is not being populated on      *
      *            MEEXCINF popup window for subscriber and all      *
      *            dependants.                                       *
      * SOLUTION:  Move SPNQLF of EEWHDR to EXCMDTBT record, instead *
      *            of EXCHNG of EEWSB2 and EEWDP2 records.           *
      *--------------------------------------------------------------*
      *  06/04/14  FIX    CR126498    IHA   712   Bill Huckbay       *
      *  08/28/14  FIX    CR127009    IHA   737   Bill Huckbay       *
      *  PROBLEM:  EI08007 error is being received                   *
      *  SOLUTION: ENPMAS table is being maxed out.  setting max to  *
      *            200 this is the same as on me1014                 *
      **** CR126498  bh1  fix  change PPSMAX, PPSLST, and OCCURS     *
      *--------------------------------------------------------------*
      * 06/17/14   Fix  CR124534   MHW    732  David Burrowes        *
      * 07/29/14   Rep  CR126608   MHW    735  David Burrowes        *
      * Problem:  Exchange Subscriber/Dependant switching, causing   *
      *           dependent record to be written first.              *
      * Solution: Modify the process to read the PE4SBS file, due to *
      *           adding key fields.  Change from direct READ to     *
      *           STARTGE followed by READNX. Added new paragraph    *
      *           B710-RTVMBR to cycle through PE4SBS records to     *
      *           search for exchange subscriber number.             *
      *--------------------------------------------------------------*
      * 05/27/14 DCR2164  CR125484   DST    732   Chaitanya Beesa    *
      * 07/16/14   FIX    CR126832   DST    735   Neelima Durvasula  *
      * problem: EXCSMSBI record was not retriving correctly.        *
      * Solution:GRPNUM and TRNSEQ added to the EXCSMSBI key. ED201C *
      *          modilfied to use updated key while accesing EXCSMSBI*
      *--------------------------------------------------------------*
      *  08/29/13  Fix    CR122721  MHW     730   David Burrowes     *
      *  06/02/14  Rep    CR126361  MHW     735   David Burrowes     *
      *  Problem:  ED201C goes into message wait receiving an MCH1202*
      *            error at line 27934.                              *
      *  Solution: Initialize all WS-DT3 fields.                     *
      *--------------------------------------------------------------*
      * 06/02/14 Def6606 CR125977      CXB   735   Chaitanya Beesa   *
      * Problem:Area code not populated in MDTMAS.                   *
      * Solution:B680-ME1023-DEPCHG modified to populate areacode in *
      *          MDTMAS                                              *
      *---------------------------------------------------------------*
      * 12/06/13  Fix    CR124104      MHW   732   Clifton Winbush    *
      * 05/23/14  Rep    CR126360      MHW   735   Srisailesh         *
      * DCR2140   Process modified to poulated the expiration date of *
      *           the appropriate amount records with only the effect-*
      *           ive dates are sent in but no expiration date are    *
      *           provided.                                           *
      *---------------------------------------------------------------*
      *  12/05/13  FIX    CR120274   BVT    722   Richard L Walters  *
      *  12/18/13  REP    CR123638   BVT    727   Richard L Walters  *
      *  01/07/14  REP    CR124774   BVT    732   Richard L Walters  *
      *  02/27/14  RWK    CR123639   BVT    734   Richard L Walters  *
      *  05/12/14  RWK    CR125384   BVT    735   Richard L Walters  *
      *                                                              *
      *            DEF    D#6493                                     *
      *  Problem:  TERMED SPOUSE HAS WRONG RELCOD ON REPORT          *
      *  Solution: SAVE RELCOD TO MDTMAS WHEN TERMING MEMBER.        *
      *            SAVE RELTYP TO MDTMAS WHEN TERMING MEMBER.        *
      *            DEF    D#6491                                     *
      *  Problem:  CONTROL ERROR ON MARKET                           *
      *  Solution: ADD TO TOTBAT WHEN MDTMAS IS WRITTEN              *
      *  COPYBOOK: ED201CB                                           *
      *--------------------------------------------------------------*
      *  10/14/13  Fix    CR086062   MHW    722   Clifton Winbush    *
      *  04/16/14  Rep    CR125977   MHW    735   Neelima Durvasula  *
      *  Problem: Receiving AREA CODE MUST BE SPECIFIED IF QUALIFIER *
      *           SPECIFIED warning when batch goes through the Proof*
      *           Post Process                                       *
      *  Solution: Added area code check in the same 'IF' statements *
      *            that the local qualifier are check to make sure   *
      *            the values area are loaded together               *
      *--------------------------------------------------------------*
      *  04/11/14  MOD    CR123678   DST    735   Sudheer Kumar V    *
      *  Modified to Enroll member with Zero Dollar Premium          *
      *--------------------------------------------------------------*
      * 04/04/14   DCR    CR124239   MHW    735   Srisailesh         *
      *            2144                                              *
      * Problem:  Process not allowing a cancel and add transaction  *
      *           to be processed in the same batch.                 *
      * Solution: Per DCR2144 process modified to write a new line 9 *
      *           to MDTMAS when the cancell effective date is pop-  *
      *           ulated and reason category is 'CANCEL'             *
      *--------------------------------------------------------------*
      * 12/31/13  Fix    CR124633      HFI   722   David Burrowes    *
      * 03/14/14  Rep    CR125547      HFI   735   Lisa H. Blake     *
      *  Problem: ALTADR info not appearing when processing EEIMAS   *
      *           files for dependents. Incorrect table being pro-   *
      *           cessed.  Only happening when Bypass Edits = Y      *
      * Solution: Use EEWBY2 table instead of EEWDP2.                *
      * Copybook: ED201CB.                                           *
      *--------------------------------------------------------------*
      *  02/05/14  MOD   CR123676   DST     735   Raghuveer Alampalli*
      *  Included logic for HIM 834 CCN.                             *
      *--------------------------------------------------------------*
      *  09/24/13  Fix    CR123115   mhw    731   Bill Huckbay       *
      *  02/21/14  REP    CR124416   mhw    734   Bill Huckbay       *
      *  Problem:  Exchange errors for non exchange members          *
      *  Solution: do not write EXCMDTBT for non exchange members    *
      *  RECOMPILE                                                   *
      *--------------------------------------------------------------*
      *  02/10/14  Fix    CR125246  MHW     7.32  Kay Thrasher       *
      *  02/20/14  REP    CR125239  MHW     734   Chaitanya Beesa    *
      *  Problem:  MCH0603 or MCH1202 occurs when Medicare Status    *
      *            information is processed.                         *
      *  Solution: Correct PERFORM/THRU statements for C1000.        *
      *  Copybook: ED201CB                                           *
      *--------------------------------------------------------------*
      *  12/05/13  FIX    CR123171   BVT    722   Richard L Walters  *
      *  12/18/13  REP    CR123638   BVT    727   Richard L Walters  *
      *  01/07/14  REP    CR124774   BVT    732   Richard L Walters  *
      *  01/09/14  REP    CR123639   BVT    734   Richard L Walters  *
      *  Problem:  Status 22 on MDTMAS write                         *
      *  Solution: Increase SEQNUM if MEMBNO the name as last one.   *
      *  Problem:  ACTUAL NUMBER OF DOCUMENTS NOT = CONTROL error    *
      *            message in ME102B due to family being split       *
      *            into different batches.                           *
      *  Solution: Increase batch if family will not fit in same     *
      *            batch.                                            *
      *  Additional error found during testing.                      *
      *  Problem:  Error finding MDTMAS record in C110.              *
      *  Solution: Loop thru entire batch until dependent record     *
      *            found.                                            *
      *  Problem:  Duplicate key on MDTMAS when previous record      *
      *            termed a family member.                           *
      *  Solution: Increase SEQNUM if previous record for family     *
      *            was a term record.                                *
      *--------------------------------------------------------------*
      * 10/25/13  Fix    CR123575   MHW     731   Clifton Winbush    *
      * 01/15/14  Rep    CR124137   MHW     734   Raghuveer Alampalli*
      * Problem:  Receiving INVALID SUBSCRIBER NUMBER LENGTH error   *
      *           when attempting to generate member numbers for     *
      *           exchange members.                                  *
      * Solution: Modify the process ignore system size settings when*
      *           generating member numbers for exchange members.    *
      *--------------------------------------------------------------*
      *  11/18/13  Fix    CR124119  MHW     732   Clifton Winbush    *
      *  12/19/13  Rep    CR124158  MHW     734   Sai Kumar Sapa     *
      *  Recompiled for changes to ED201CB.                          *
      *--------------------------------------------------------------*
      *  09/19/12  RWK    CR120274   BVT    722   Richard L Walters  *
      *  11/22/13  RWK    CR122444   BVT    727   Richard L Walters  *
      * Problem:  When the EDI Enrollment (ED2011) process is        *
      *           submitted, a MCH0603 error occurs @ 26869.         *
      * Solution: Only perform RELTYP logic when MEMTMP > 0.         *
      * Problem:  Process is creating change records incorrectly     *
      *           exact same file is run through process again.      *
      * Solution: Modified code to call C560 (new) instead of A560.  *
      *           The new paragraph will compare the EEIBYP table    *
      *           to the MEMTAB to make sure the member the correct  *
      *           members are being compared in C680.                *
      * Problem:  SUB record showing up as Dependent on ME1022 on    *
      *           Add                                                *
      * Solution: Increase SEQNUM - Remove check for CHGTYP = 'C'    *
      * Problem:  Member with Benefit Package changes have the       *
      *           Acct line populated with the previous ENBMAS       *
      *           Eff Date.                                          *
      * Solution: Populate the EEWBYP table after the EEWSUB &       *
      *           EEWDEP table edits. Only perform edits of          *
      *           SUBMEM table if index is not 0.                    *
      * Problem:  Process received MCH0603 in A690-MDTMAS-WRITE      *
      *           when processing with By-Pass Edits set to "Y".     *
      * Solution: Correct table used when bypassing edits.           *
      *           Created two new paragraphs to handle the different *
      *           tables.                                            *
      * Problem:  Status 22 on MDTMAS write                          *
      * Solution: Increase SEQNUM if MEMBNO the same as last one.    *
      *ˆNOTE:‚Added Display statements to show progress if IN-DEBUG €*
      *‚      is TRUE.                                              €*
      * Copybook:  ED201CB                                           *
      *--------------------------------------------------------------*
      *  11/05/13  MOD    CR122646  DST     734   Neelima Durvasula  *
      *  Modified to populate the new fields in EETMAS, EEEMAS       *
      *  EXCMDTBT, DEMDOCBT, DEMEXTBT                                *
      *  Modified the condition that determines the EXCMEM-FLAG      *
      *  Commented the code for the fields removed from EXCMEMBT,    *
      *  EXCMDTBT                                                    *
      *--------------------------------------------------------------*
      *  09/03/13  MOD    CR121312  DST     732   Sudheer K Vugile   *
      *  Added edits when adding Exchange member.                    *
      *--------------------------------------------------------------*
      *  07/12/13  Mod    CR119980  DST     73A   Neelima D          *
      *  Added Exchange member functionality to the program.         *
      *--------------------------------------------------------------*
      *  09/19/12  Fix    CR116408   BVT    722   Richard L Walters  *
      *  06/06/13  Rep    CR120629   BVT    727   Sravan Kumar M     *
      *  Problem:  When Bypass Edits is "Y", records not written to  *
      *            MDTMAS in the order they are loaded (ENTSEQ       *
      *            order).                                           *
      *  Solution: Rewrote EEWSUB & EEWDEP logic to use a single     *
      *            table (EEWBYP). Created new versions of all       *
      *            paragraphs that reference EEWSUB & EEWDEP.        *
      *  Copybook: ED201CB (ByPass Edits logic)                      *
      *  Note: Recompile only.                                       *
      *--------------------------------------------------------------*
      *  04/10/13  FIX    CR120274   BVT    722   Richard L Walters  *
      *  Problem:  Member with Benefit Package changes have the Acct *
      *            line populated with the previous ENBMAS Eff Date. *
      *  Solution: Populate the EEWBYP table after the EEWSUB &      *
      *            EEWDEP table edits.                               *
      *            Only perform edits of SUBMEM table if index is    *
      *            not 0.                                            *
      *--------------------------------------------------------------*
      *  02/25/13  RWK    CR116408   HFI    722   Richard L Walters  *
      *  Problem:  Family split into different SEQNUM if in order    *
      *            and sequential.                                   *
      *  Solution: Do not increase SEQNUM if processing a family     *
      *            and CTLDOC not hit.                               *
      *  Copybook: ED201CB (ByPass Edits logic)                      *
      *--------------------------------------------------------------*
      *  12/31/12  FIX    CR114091    MHW   712   Richard L Walters  *
      *  02/05/13  rep    CR119312    MHW   722   Richard L Walters  *
      *  PROBLEM:  Duplicate key created in EDIDOCBT.                *
      *  SOLUTION: Added logic to skip write if record already       *
1     *            existed.                                          *
      *--------------------------------------------------------------*
      *  05/08/12  FIX    CR115116    MHW   712   Clifton Winbush    *
      *  02/01/13  Rep    CR115840    MHW   722                      *
      *  PROBLEM:  Memmbers on the input file are not being loaded   *
      *            into the system nor appearing on error report.    *
      *  SOLUTION: Edit added to A550 to check the MEMEFF/MEMEXP of  *
      *            input file, if all zeros, flag will not be set    *
      *            allowing process to give correct error.           *
      *--------------------------------------------------------------*
      *  11/02/12  Fix    CR118046   BVT    722   Clifton Winbush    *
      *  Problem:  When records are sent through EEIMAS with only an *
      *            email address change for a dependant, that record *
      *            is bypassed and no MDTMAS record is created.      *
      *  Solution: Added edit in A682-STEP-3 to compare the email    *
      *            test when the email indicator is 'Y' in EEIMAS.   *
      *            Same edit was added to ED201CB.                   *
      *  Copybook: ED201CB (ByPass Edits logic)                      *
      *--------------------------------------------------------------*
      *  09/19/12  Fix    CR116408   BVT    722   Richard L Walters  *
      *  Problem:  When Bypass Edits is "Y", records not written to  *
      *            MDTMAS in the order they are loaded (ENTSEQ       *
      *            order).                                           *
      *  Solution: Rewrote EEWSUB & EEWDEP logic to use a single     *
      *            table (EEWBYP). Created new versions of all       *
      *            paragraphs that reference EEWSUB & EEWDEP.        *
      *  Copybook: ED201CB (ByPass Edits logic)                      *
      *--------------------------------------------------------------*
      *  08/13/12  Fix    CR087509   BNC    722   Richard L Walters  *
      *  Problem:  Other Insurance info not loaded for dependents    *
      *  Solution: Load LIN-002 of Dependents with Other Insurance   *
      *            information.                                      *
      *--------------------------------------------------------------*
      *  04/12/12  Rework CR114867    DST   722   Sravan Kumar Matama*
      *  Problem:  When you attempt to load an individual bill type  *
      *            Medicare member, the member will load via EDI     *
      *            Enrollment Input Data Server (ED201A) and         *
      *            MMCIND still remain as 'N'.                       *
      *  Solution: Modified to populate the correct value for MMCIND *
      *--------------------------------------------------------------*
      *  06/16/11  FIX    CR110256    MYO   712   Clifton Winbush    *
      *  09/13/11  Rep    CR110623    MYO   721   Prathibha Reddy K V*
      *  PROBLEM:  Batch Proof process receiving error message       *
      *            RSP PTY INDICATED BUT NO INFO SPECIFIED-INDICATOR *
      *            IGNORED because RSPDOCBT record is not written.   *
      *  SOLUTION: Removed the check of bypass edit flag before det- *
      *            ermining if the RSPDOCBT record should be written *
      *--------------------------------------------------------------*
      *  08/11/04  Fix    CR050365  BNC     511   Anurag Sinha       *
      *  07/19/11  Rep    CR110495  BNC     72A   Raghuveer Alampalli*
      *  Problem:  The enrollment reason code is being populated even*
      *            when the member is being termed.                  *
      *  Solution: The enrollment billing reason code should be      *
      *            populated only when an account is changed.        *
      *--------------------------------------------------------------*
      *  09/06/05  Fix    CR053722  BNC     541   Richard L Walters  *
      *  06/13/11  Rep    CR110539  BNC     72A   Raghuveer Alampalli*
      *  Problem:  When loading an individually billed Medicare      *
      *            member through batch enrollment, the error        *
      *            message MEDICARE DOCUMENT INFORMATION NOT FOUND   *
      *            is displayed in the Proof/Post Processing Error   *
      *            (ME102A) report.                                  *
      *  Solution: Create MDMMAS record for Individually Billed      *
      *            members when the Account Number is "INDBIL" or    *
      *            SPACES.                                           *
      *--------------------------------------------------------------*
      *  04/08/11  FIX    CR109426    MYO   712   Lisa Palmer        *
      *  07/12/11  REP    CR109565    MYO   72A   Clifton Winbush    *
      *  PROBLEM:  'RSPDOCBT ALREADY EXISTS' error message is being  *
      *            generated on error report incorrectly             *
      *  SOLUTION: Modified program to check Responsible Party switch*
      *            before attempting to write RSPDOCBT again         *
      *--------------------------------------------------------------*
      *  06/14/10  FIX    CR085575    BVT   708   Srisailesh         *
      *  06/28/10  REP    CR088198    BVT   711   Sreedhar Katragadda*
      *  PROBLEM: The Enrollment Update Proof (ME102A) report shows  *
      *           members CHANGED SUCCESSFULLY when there are no     *
      *           changes.                                           *
      *  SOLUTION: The EDI ENROLLMENT UPDATE DETERMINATION (ED201C)  *
      *            process will be modified to check PORG,SECORG and *
      *            MEMSTA values correctly with existing values in   *
      *            the system.MEEMAS was added so that the program   *
      *            can determine if the following fields in EEIMAS   *
      *            are being changed: COBDAT, PAYLOC and PAYNUM.     *
      *--------------------------------------------------------------*
      *  02/02/11  FIX    CR088024    MYO   712   Clifton Winbush    *
      *  07/04/11  REP    CR088069    MYO   72A   Vinay Kumar        *
      *  PROBLEM:  The error message TIER PREMIUM ENTRY NOT FOUND is *
      *            received on the Proof/Post Processing Error ME102A*
      *            report when attempting to make a tier and benefit *
      *            package change for a family.                      *
      *  SOLUTION: Modified code in A682-STEP-11 to move tier code   *
      *            from EEWDEP table into MDTTBL(LIN-0004 1)         *
      *--------------------------------------------------------------*
      *  03/16/11  FIX    CR088281    BVT   712   Clifton Winbush    *
      *  06/09/11  REP    CR088585    BVT   72A   Sravan Kumar       *
      *  PROBLEM:  Program is not creating MDTMAS records when there *
      *            is only a print card change in EEIMAS.            *
      *  SOLUTION: Edit were added to check the PRTCOD from the load *
      *            file against the production file, if the values   *
      *            differ a Demographic change (LIN-0001) will be    *
      *            created with the new value of PRTCOD.             *
      *--------------------------------------------------------------*
      *  04/20/11  FIX    CR087902    MYO   712   Lisa Palmer        *
      *  05/12/11  REP    CR109472    MYO   72A   Lisa Palmer        *
      *  PROBLEM:  When'RSPDOCBT ALREADY EXISTS' error message is    *
      *            generated on error report, the GRPNUM, SUBSNO,    *
      *            RELCOD, MEMBNO,TYPE, FIELD VALUE and MESSAGE ID   *
      *            is not being printed on the report.               *
      *  SOLUTION: Modified program to display fields on report when *
      *            error message is generated.                       *
      *--------------------------------------------------------------*
      *  12/14/10  Mod    CR086864  BNC     72A   Srisailesh         *
      *  Modified to implement the Table Overflow Logic Processing.  *
      *  When the table exceeds TBLPCT mentioned on RF1041 screen    *
      *  then WLOG will be printed on a warning report.              *
      *  It is also modified to call the new MHTBLRPT subroutine.    *
      *  MHTBLRPT produces a report detailing how many entries were  *
      *  loaded in the tables.                                       *
      *--------------------------------------------------------------*
      *  09/18/09  FIX    CR082692    DST   702   Clifton Winbush    *
      *  09/14/10  Rep    CR083831    DST   711   Srisailesh P       *
      *  PROBLEM:  Members ENPMAS records are being updated with     *
      *            dates specified in the change effetive field      *
      *  SOLUTION: Modified code in A400-INIT-MEMTAB to initialize   *
      *            all populated dimemsions on the SUBENB/ENBTAB,    *
      *            SUBPCP, SUBSEC, SUBFEE, & SUBMED tables.          *
      *--------------------------------------------------------------*
      *  09/02/10  RWK    CR085575    BVT   708   Srisailesh         *
      *  09/08/10  RWK    CR085610    BVT   711   Srisailesh         *
      *  PROBLEM:  The Job  throws an MCH error when DEMTMP is Zero  *
      *            and trying to referencing the table entry of zero *
      *  SOLUTION: Comment the logic where the Comparision is done   *
      *            when DEMTMP is Zero and Comapre the field value   *
      *            from DEMMAS                                       *
      *--------------------------------------------------------------*
      *  06/14/10  FIX    CR085575    BVT   708   Srisailesh         *
      *  06/28/10  REP    CR085610    BVT   711   Clifton Winbush    *
      *  PROBLEM: The Enrollment Update Proof (ME102A) report shows  *
      *           members CHANGED SUCCESSFULLY when there are no     *
      *           changes.                                           *
      *  SOLUTION: The EDI ENROLLMENT UPDATE DETERMINATION (ED201C)  *
      *            process will be modified to create Membership     *
      *            Batch Detail Master (MDTMAS) records correctly.   *
      *--------------------------------------------------------------*
      *  04/09/10  MOD     CR076079  DST     71A  Sunny Arora        *
      *  PROBLEM:  School Information not getting updated when trying*
      *            change the existing member.                       *
      *  SOLUTION: Changes made to the code to update DEMDOCBT file  *
      *            when trying to change the existing member.        *
      *  Defect # 1116.                                              *
      *--------------------------------------------------------------*
      *  03/15/10  MOD     CR076079  DST     71A  Sunny Arora        *
      *  PROBLEM:  Job going into message wait due to MCH0603.       *
      *  SOLUTION: Changes made to the code to use the correct index *
      *            i.e ESBACT in place of ETSACT.                    *
      *  Defect # 767.                                               *
      *--------------------------------------------------------------*
      *  09/03/09  FIX    CR082558  DST     702   Clifton Winbush    *
      *  02/24/10  REP    CR084227  DST     71A   Sudheer Kumar V    *
      *  PROBLEM:  Members ENBMAS records are being updated with     *
      *            dates specified in the change effetive field      *
      *  SOLUTION: Modified code in A400-INIT-MEMTAB to initialize   *
      *            all populated dimemsions on the SUBENB/ENBTAB     *
      *            tables.                                           *
      *--------------------------------------------------------------*
      *  11/05/09  MOD     CR076079  DST     71A  Sunny Arora        *
      *  Changes have been made to the code to preform the edits for *
      *  both 5010 & 4010 transaction.                               *
      *--------------------------------------------------------------*
      *  10/28/09  RWK    CR083228  BVT     706   Sudheer Kumar      *
      *  Problem:  "MEDICAL COVERAGE MUST BE SPACE FOR CHANGE" and   *
      *            "DENTAL COVERAGE MUST BE SPACE FOR CHANGE" error  *
      *            messages is received when EI1011 job submitted.   *
      *  Solution: Modified the code to populate MEDCOV and DENCOV   *
      *            fields into MDTMAS.                               *
      *--------------------------------------------------------------*
      *  10/22/09  Fix    CR083228  BVT     706   Geetha Madhavi     *
      *  Problem:  "MEDICAL OR DENTAL COVERAGE MUST BE SPECIFIED"    *
      *            message received incorrectly when EI1011 process  *
      *            is submitted.                                     *
      *  Solution: Modified the code to populate MEDCOV and DENCOV   *
      *            fields into MDTMAS for dependent records so that  *
      *            the error message will display accordingly        *
      *--------------------------------------------------------------*
      *  08/11/09  Fix    CR082187  HFI     54D   Anurag Sinha       *
      *  09/23/09  REP    CR082233  HFI     706   Arun Vaddiraju     *
      *  Problem:  "RSPDOCBT RECORD ALREADY EXISTS" error message    *
      *            incorrectly received even when there are no dupli-*
      *            cate records when MBHMAS batch sequence reaches   *
      *            the maximum limit defined on ED2011.              *
      *  Solution: Paragraph A740-INTMDT would be performed in A660- *
      *            ME1023-DEPADD to capture the correct keys in the  *
      *            MDTMAS-REC from MBHMAS-REC.                       *
      *--------------------------------------------------------------*
      *  10/24/08  FIX   CR071347     DST    70A   TUSHAR            *
      *  PROBLEM:  The EXTDOCBT record is written with  the SEQNUM   *
      *            incremented by one in ED201C.                     *
      *  SOLUTION: Modified code in A660-ME1023-DEPADD to write      *
      *            the correct SEQNUM.                               *
      *--------------------------------------------------------------*
      *  05/23/08  FIX   CR074663     LCA    54D   ROBERT PAGE III   *
      *  06/03/08  REP   CR074926     LCA    551   TUSHAR            *
      *  PROBLEM:  Address line 2 is changed by the system in error. *
      *  SOLUTION: Modified to examine ADRLN1 in conjunction with    *
      *            verifying an ADRLN2 change.                       *
      *--------------------------------------------------------------*
      *  04/22/08  FIX    CR074180  HFI     54D   Richard Walters    *
      *  05/07/08 Replica CR074215  HFI     551   Richard Walters    *
      *  PROBLEM:  Med Cnty change not included when a member also   *
      *            has a benefit package change.                     *
      *  SOLUTION: The SUBMDT and MEMMDT records will be initialized *
      *            when the B100/B110/B200/B210 paragraphs are       *
      *            executed.                                         *
      *            In A830-DEPMED the MEDLST refernece must be       *
      *            removed.  It is no longer populated in the        *
      *            program.  Causing paragraph to end early.         *
      *--------------------------------------------------------------*
      *  04/02/08  FIX    CR073726  HFI   54D    David Armstrong     *
      *  Replica:         CR073839  HFI   551    Bill Huckbay        *
      *  PROBLEM:  Going into message wait with an MCH0603 when      *
      *            MEMTMP is zero.                                   *
      *  SOLUTION: Added check for MEMTMP = ZERO before checking     *
      *            Medicare county and status.  Also corrected       *
      *            B110-CHECK-FOR-MEM to find dependents in MHS.     *
      *--------------------------------------------------------------*
      *  04/18/08  FIX    CR073848  IHA     54D   Amy Grimes         *
      *  Replica:         CR074091  IHS     551   Alvina Singh       *
      *  PROBLEM:  Logic implemented under CR070559 is forcing the   *
      *            BTHSEQ field to be updated without checking to    *
      *            see if there is any change needed. Therefore the  *
      *            DEMCHG flag is being set causing MDTMAS changes   *
      *            to be implemented when they are not necessary.    *
      *  SOLUTION: Corrected the A642-STEP-3 and A682-STEP-3 to cor- *
      *            rectly edit the BTHSEQ field and only set the     *
      *            DEMCHG flag to 'Y' if a change is needed.         *
      *--------------------------------------------------------------*
      *  04/16/08  Fix    CR073770  HFI   54D    Clifton Winbush     *
      *  Replica:         CR073967  HFI   551    Rahul Srivastava    *
      *  Problem:  When a change record is processed for any relation*
      *            other than subscriber and the member expiration   *
      *            date is specified as zeros, MDTMAS is written with*
      *            zeros instead of defaulting to all '9'.           *
      *  Solution: Corrected the B210-CHECK-FOR-MEM to loop back to  *
      *            find dependants in MHS.                           *
      *--------------------------------------------------------------*
      *  05/08/06  EFIX CR060724   BVT  474   ERIC MASON             *
      *  REPLICA        CR071140   BVT  551   Santosh Mohapatra      *
      *  Problem:  Second Address Line not being correctly spaced    *
      *       out when specified in EEIMAS.                          *
      *  Solution: Changed ED201C to correctly space out Second      *
      *       Address Line when specifed in EEIMAS.                  *
      *--------------------------------------------------------------*
      *  11/17/07  FIX     CR069377  MYO     54C   JBL               *
      *  02/11/08  REPLICA CR070663  DST     551   TUSHAR            *
      *  Problem:  Members with no changes were showing up on the    *
      *     ED201C report in error.                                  *
      *  Solution:1)Check correct index when checking the current    *
      *     hire and termination date.                               *
      *           2)Change population of Line 1 to check the current *
      *     value EMLIND.  If it is not changed, do not create a     *
      *     line.                                                    *
      *           3)Change population of Line 1 to check the current *
      *     values of EXTIND, RSPIND, and ALTIND.  If they are not   *
      *     changed, do not create a Line 1 for the member.          *
      *--------------------------------------------------------------*
      *  08/22/07  FIX    CR069286  MYO     54C   Eric Mason         *
      *  02/08/08  REPLICACR069403  MYO     551   RAVINDRA M         *
      *  Problem:  Current existing member name changes are not      *
      *    processing.                                               *
      *  Solution:  Fix the "IF" statement in A640-ME1023-SUBCHG to  *
      *    correctly evaluate the change type of the EEIMAS record.  *
      *--------------------------------------------------------------*
      *  07/13/07  FIX    CR068516  LCA     54C   JBL                *
      *  11/29/07  REP    CR068576  LCA     55X   Eric Mason         *
      *  Problem:  MCH0603 received when changing MCMMAS information *
      *  Solution: Check correct fields when checking EMPSTA for     *
      *            subscribers.  Initialize EXIST-FLAG in A400 para. *
      *--------------------------------------------------------------*
      *  11/18/07  Fix    CR070559  LCA     54C   RCF                *
      *  REPLICA:         CR070836  LCA     55X   Rahul Srivastava   *
      *  Problem:  Birth Sequence field is not being populated when  *
      *            using EEIMAS file.                                *
      *  Solution: Modified A640-ME1023-SUBCHG and A680-ME1023-DEPCHG*
      *            paragraphs to populate Birth Sequence field.      *
      *--------------------------------------------------------------*
      *  04/27/07  FIX     CR067340  LCA     541   JBL               *
      *  11/05/07  REPLICA CR067477  LCA     55X   TUSHAR            *
      *  Problem:  Tier Code not being written to MDTMAS when changin*
      *            USRFL1 - 3 on a dependent.                        *
      *  Solution: Load USRFL1-3 into ENBTAB, if fields do change    *
      *            move to MDTMAS(LIN-0004) when writing MDTMAS-REC  *
      *--------------------------------------------------------------*
      *  10/22/07  MOD    CR065199  DST     55X   Deepak Gera        *
      *  The ED201C program will be modified to include the          *
      *  new FSA Election Amount (FSAAMT) in the membership          *
      *  enrollment batches.                                         *
      *--------------------------------------------------------------*
      *  09/21/07  FIX    CR069629  MYO     54C   Eric Mason         *
      *  10/15/07 Replica CR069919          55X   JBL                *
      *  Problem:  When transations come through that do not produce *
      *    member changes, the MDTMAS sequence number is skipped.    *
      *  Solution: Change the program to only increment the SEQNUM   *
      *    if it is determined that a change is to be made to the    *
      *    member.                                                   *
      *--------------------------------------------------------------*
      *  08/23/07  FIX     CR068634  LCA     54C   Hamender Rana     *
      *  10/19/07  REPLICA CR069987  LCA     55X   Rajesh Nethala    *
      *  Problem: After adding a dependent to an existing subscriber *
      *           using batch enrollment, the alternate member       *
      *           number is not displayed for the dependent on the   *
      *           Enrollment Entry (ME1014).                         *
      *  Solution:In paragraph A660-ME1023-DEPADD. ALTNUM will be    *
      *           loaded from EEWDEP to MDTTAB.                      *
      *--------------------------------------------------------------*
      *  09/22/07  Fix    CR066955  MHW     541   Eric Mason         *
      *  REPLICA:         CR067159  MHW     55X   Rahul Srivastava   *
      *  Problem:  Receiving error message BIRTH SEQ NUMBER MUST BE  *
      *            SPECIFIED when autometic member number creation   *
      *            is used and member number is not specified in     *
      *            EEIMAS.                                           *
      *  Solution: Changed A520-FIND-MEMNUM to correctly populate    *
      *            MEMBNO-HLD when the NUMCNT incremented for the    *
      *            dependent.                                        *
      *--------------------------------------------------------------*
      *  09/19/07  Fix    CR065004  DST     541   Kartik Ramamurthy  *
      *  REPLICA:         CR067487  DST     55X   David Armstrong    *
      *  Problem:  The Membership Detail Transaction Master (MDTMAS) *
      *            file is created with incorrect provider dates     *
      *            when a provider change is submitted.              *
      *  Solution: Program ED201C changed as per DCR#1522.           *
      *--------------------------------------------------------------*
      *  05/09/07  FIX    CR065141  DST     541   Eric Mason         *
      *  Replica:         CR066180          542   Suparna Shokeen    *
      *  Problem:  When the bypass edits indicator is selected and a *
      *   PCP change is submitted for a member that does not exist,  *
      *   the provider number is not populated in MDTMAS.            *
      *  Solution: Change program to process PCP changes when no     *
      *   records exist if the BYPEDT flag is set to 'Y'             *
      *--------------------------------------------------------------*
      *  07/30/07  FIX    CR064247  DST     541   Atul Mogha         *
      *  Replica:         CR066181  DST     542   Abhijeet Mohitkar  *
      *  Problem:  When subscribers and dependents are loaded using  *
      *            the EDI Membership Enrollment (ED2011) process,   *
      *            the error UNABLE TO WRITE MDTMAS FILE, IO-STATUS  *
      *            = 22 is encountered.                              *
      *  Solution: Working storage variables added to hold the SEQNUM*
      *            of the Add record for the subscriber until all Add*
      *            records for the subscriber’s dependents, if any,  *
      *            have been processed.                              *
      *--------------------------------------------------------------*
      *  03/14/07  MOD    CR063418  DST     542   Abhijeet Mohitkar  *
      *  Modified to request the member's product option from Power  *
      *  Choice when the member's products are defined within Product*
      *  Designer                                                    *
      *  Note:- Since the ED201C Member has reached the maximum      *
      *         records limit so the commented code is deleted.      *
      *--------------------------------------------------------------*
      *  02/06/07  MOD    CR062274  DST     542   Hamender Rana      *
      *  Modified the code to process the new external benefit data  *
      *  fields.                                                     *
      *--------------------------------------------------------------*
      *  12/21/06  Defect D00379   DST      540   Amy Grimes         *
      *  Problem:  Different results are received on the ED201C      *
      *            report when using the same data but difference is *
      *            that the BYPEDT flag is set to 'N' on one run and *
      *            'Y' on the other run.                             *
      *  Solution: In A642-STEP-3 modified the logic to only edit    *
      *            the value of DEMTMP index when it is zeroes in-   *
      *            stead of NOT equal to zeroes.                     *
      *--------------------------------------------------------------*
      *  12/14/06  Defect D00374   DST      540   Manoj K Dhamu      *
      *  Problem:  Receiving MCH0603 error when Bypass Edits flag is *
      *            set to 'Y' and invalid member is specified in     *
      *            EEIMAS file.                                      *
      *  Solution: In A642-STEP-3 modified the logic to compare      *
      *            EMPSTA change only when member exists (EXIST-FLAG *
      *            = 'Y')                                            *
      *--------------------------------------------------------------*
      *  11/29/06  RWK    CR059788 DST      54A   Amy Grimes         *
      *            Defect 232 and 234                                *
      * Solution:  Per FD change, removed code that would bypass     *
      *            EI02470 error message.                            *
      *--------------------------------------------------------------*
      *  11/22/06  RWK    CR059788 DST      54A   Amy Grimes         *
      *            Defect 221                                        *
      *  Problem:  Receiving MCH0603 error when Bypass Edits flag is *
      *            set to 'Y' and invalid member is specified in     *
      *            EEIMAS file.                                      *
      *  Solution: Modified A640-ME1023-SUBCHG to go to A642-STEP-2  *
      *            if the CHGTYP OF EEWSUB(ESBACT) is a value other  *
      *            than C or spaces. Also modified additional edits  *
      *            added by CR059788 to no longer check status since *
      *            that is already being done. Removed paragraphs    *
      *            A1430-DEMEXTBT-CHG, A1440-DEMEXTBT-CHG, and       *
      *            A1460-ALTADRBT-CHG since they are not being used. *
      *--------------------------------------------------------------*
      *  10/13/06  Mod    CR054473 DST      54A   Suparna Shokeen.   *
      *  Recompiled due to changes in EETMAS and EEEMAS.             *
      *--------------------------------------------------------------*
      * 10/04/06   MOD    CR059788   HFI    54A   Amy Grimes         *
      * MOD: 1. Added Bypass Edtis flag to banner page.              *
      *      2. Added code to bypass edits if flag = 'Y'.            *
      *--------------------------------------------------------------*
      * 09/08/06  FIX   CR062940    IHA      522   JBL                *
      * Compile Option: ACTGRP(QILE) changed to ACTGRP(*NEW) on PGM   *
      *---------------------------------------------------------------*
      *  07/24/06  EFIX   CR062238  HFI     522   D. Armstrong       *
      *  07/31/06  ReplicaCR062258  HFI     531   Vengala Sreedhar   *
      *  Problem:  Receiving MCH0603 error when there are subscriber *
      *            change records for two different groups.          *
      *            (SUBACT subscript is zero and SUBTAB was not      *
      *             loaded.)                                         *
      *  Solution: Perform the A390-DEMMAS routine if SUBACT is zero.*
      *--------------------------------------------------------------*
      *  07/10/06  Fix    CR061936  IHA     522   JBL                *
      *  07/26/06  ReplicaCR061968          531                      *
      *  Problem:  Receiving MCH1202 error when calling SCRWN.       *
      *  Solution: Initialize WRN-COUNT.                             *
      *--------------------------------------------------------------*
      *  05/25/06  Mod     CR057735  DST     530  Manoj K Dhamu        *
      *  Added COPYRIGHT copybook to include DST copyright.            *
      *----------------------------------------------------------------*
      *  03/03/06  FIX    CR054766  DST     53A   Vipin Kumar Patel  *
      *  PROBLEM:  The Employee Status (EMPSTA) field is spaces on   *
      *            the Enrollment Entry (ME1014) screen when the     *
      *            EMPSTA field is populated in the EEIMAS file on a *
      *            change record.                                    *
      *  SOLUTION: The EMPSTA field is updated on ME1014 as indicated*
      *            in the EEIMAS file.                               *
      *--------------------------------------------------------------*
      *  02/24/06  FIX    CR054360  DST     53A   Sunny Arora        *
      *  PROBLEM:  EI1011 Alternate Address Information is not       *
      *            populating correctly during polling process.      *
      *  SOLUTION: Initialize LINENO OF ALTDOCBT-REC to 1 in         *
      *            A682-STEP-3. When the Alternate Address Indicator *
      *            in EEIMAS file is not equal to alternate address  *
      *            indicator of  DEPTAB table.                       *
      *  Note:     END-IF(s) introduced at the end of A682-STEP-3.   *
      *--------------------------------------------------------------*
      *  12/20/05  DEFECT D00947    DST     521   Vnsp Samala        *
      *  Problem:  Receiving MCH1202 error when there are multiple   *
      *            lines in EEIMAS.                                  *
      *  Solution: Initialize MBH-FLAG at the beginning of the pgm.  *
      *--------------------------------------------------------------*
      * 09/28/05  FIX   CR056588  DST     52A  BILL HUCKBAY          *
      * DCR1358  POPULATE INSCOD CORRECTLY                           *
      *--------------------------------------------------------------*
      *  10/01/05  FIX     CR046803  DST     52A  JBL                *
      *  DCR741: Recompiled for file changes.                        *
      *--------------------------------------------------------------*
      *  05/24/05  FIX    CR052023  CSC     511   Khyati Mehra       *
      *  PROBLEM:  If a dependent is currently enrolled in more than *
      *  one group or is enrolled in the same group more tha one time*
      *  for different enrollment periods, the error message EI02463 *
      *  is received.                                                *
      *  SOLUTION: Add the group to the subscriber and dependent     *
      *  tables and put only one entry per member/group combination  *
      *  in the table.                                               *
      *  Note:     The changes are made as per DCR1311.              *
      *--------------------------------------------------------------*
      *  03/10/05  RWK    CR050845  CHS     510   Eric Mason         *
      *  PROBLEM:  When a Marital Status is specified in MDTMAS, the *
      *     MDTMAS record created does not get updated with the      *
      *     Marital Status.                                          *
      *  SOLUTION: Corrected code to populate MDTMAS with the Marital*
      *     Status when another change is made via EEIMAS.  It was   *
      *     also found that Employee Status code was not properly    *
      *     being populated on MDTMAS, and this was corrected.       *
      *--------------------------------------------------------------*
      *  01/21/05  Fix    CR050845  CHS     51A   Eric Mason         *
      *  Problem:  When a change transaction is created with a HNDIND*
      *   value specified, the program automatically creates a change*
      *   record in error.                                           *
      *  Solution: Changed the program to check the Member Status in *
      *   DEMMAS if a HNDIND value is specified.  As per CR014565, a *
      *   a change record will only be created if the HNDIND = Y and *
      *   the Member Status in DEMMAS is not = "H", or if the HNDIND *
      *   = "N" and the Member Status in DEMMAS = "H"                *
      *--------------------------------------------------------------*
      *  08/05/04  FIX    CR046381  ULI     58A   Eric Mason         *
      *                   DCR 877                                    *
      *    Modified to require the effective and expiration dates    *
      *    when any of the user-defined fields are specified for a   *
      *    change record.  Also changed to place the user-defined    *
      *    field changes on a line 4 record.                         *
      *--------------------------------------------------------------*
      *  07/06/04  RWK    CR050356  HFI     58A   Anish Agarwal      *
      *  Problem:  When loading an EEIMAS file with a DEPENDENT      *
      *            with a responsible party specified, receiving the *
      *            error RSP PTY INDICATED BUT NO INFO SPECIFIED     *
      *            - INDICATOR IGNORED on the ME102A warning report. *
      *  Solution: Modified program to use seqnum of ws-work instead *
      *            of computing Seqnum.                              *
      *--------------------------------------------------------------*
      *  06/28/04  FIX    CR050308  HFI     57B   JBL                *
      *  07/06/04  Repl   CR050358  HFI     58A   Palaniswamy        *
      *  Problem:  INTKCD not loading for added dependents.          *
      *  Solution: Move INTKCD to MDTTAB in A660 Paragraph.          *
      *--------------------------------------------------------------*
      *  06/24/04  FIX    CR050284  HFI     57B   Mukund Vijay       *
      *  07/06/04  Repl   CR050356  HFI     58A   Palaniswamy        *
      *  Problem:  RSPIND not loading for subscriber.                *
      *  Solution: Move RSPIND to MDTMAS in A630 Paragraph.          *
      *--------------------------------------------------------------*
      *  12/15/03  Fix   CR047918    IHA     56B   Kim Crompton       *
      *  01/26/04  Repl  CR048369    IHA     58T   Kim Crompton       *
      *            DCR   CR014565/929
      * Problem:   Cannot remove demographics extension information
      * Solution:  Per DCRs revamp demographics exension indicator
      *            (DEMEXT), responsible party indicator (RSPIND), and
      *            email indicator (EMLIND).
      *---------------------------------------------------------------*
      *  01/12/04  FIX    CR048027  FDX     58T   Kim Crompton       *
      *  Problem:  When changing only work location or employee      *
      *            status fields are not being loaded.               *
      *  Solution: Correct work location table name and correct      *
      *            syntax of IF statement.                           *
      *--------------------------------------------------------------*
      *  12/17/03  MOD    CR043598  CSC     58T   Vnsp Samala Laxmi  *
      *  Recompiled to pick up changes from DEMEXTBTR                *
      *--------------------------------------------------------------*
      *  11/13/03  FIX    CR047710   AFW    56B   ROBERT PAGE III    *
      * Replica:          CR047917   MYO    57A                      *
      * Problem:   Receiving a status code 22 when writing MDTMAS    *
      * Solution:  Modified IF statement to not reference EBSLST when*
      *            processing a dependent. Also corrected index when *
      *            processing responsible party info for a dependent.*
      *--------------------------------------------------------------*
      *  10/17/03  FIX    CR047710   AFW    56B   Kim Crompton       *
      * Problem:   Receiving a status code 22 when writing MDTMAS    *
      * Solution:  Move logic to generate the sequence number from   *
      *            A600 to A610.                                     *
      *--------------------------------------------------------------*
      *  10/17/03  FIX    CR047710   AFW    56B   Kim Crompton       *
      *  10/24/03         CR047741         MHS57A Will Edwards       *
      * Problem:   Receiving a status code 22 when writing MDTMAS    *
      * Solution:  Move logic to generate the sequence number from   *
      *            A600 to A610.                                     *
      *--------------------------------------------------------------*
      *  09/09/03  FIX    CR046816   IHA    56B   Kim Crompton       *
      *  09/24/03  ReplicaCR047165   IHA    57A   Kim Crompton       *
      *  PROBLEM: When using automatic member number generation with *
      *           suffixes on the dependent member numbers the       *
      *           dependent member numer is not being reused if      *
      *           the dependent previous existed for the subscriber  *
      *           in another group.                                  *
      * SOLUTION: Remove the group number check when determining     *
      *           the highest member number used for a subscriber.   *
      *--------------------------------------------------------------*
      *  06/11/03  MOD    CR044267  CSC     507   Kavitha Donepudi   *
      *  MODIFICATION: Added edit to display error message when      *
      *                Birth sequence is not specified or not unique *
      *                when more than one dependent(other than       *
      *                spouse) has the same birth date.              *
      *--------------------------------------------------------------*
      *  04/03/03  RWK    CR042167  CSC     506   ASHLEY ARTHUR      *
      *                   DEFECT #3586                               *
      *  PROBLEM: ALTDOCBT RECORD NOT BEING CREATED WHEN ADDING      *
      *           AN ALTERNATE ADDRESS TO AN EXISTING MEMBER.        *
      * SOLUTION: MODIFIED THE CODE TO CREATE AN ALTDOCBT RECORD IF  *
      *           THE ALTIND OF DEMMAS IS CHANGING TO 'Y'.           *
      *--------------------------------------------------------------*
      *  03/31/03  RWK    CR042167  CSC     506   ASHLEY ARTHUR      *
      *                   DEFECT #3568                               *
      *  MODIFIED THE PROGRAM TO CORRECT SOME CODE TAGS.             *
      *--------------------------------------------------------------*
      *  03/05/03  MOD    CR042167  CSC     506   ASHLEY ARTHUR      *
      *  MOD:  MODIFIED THE PROGRAM TO PROCESS THE NEW ALTERNATE     *
      *        ADDRESS FIELDS (ALTIND, ALTAD1, ALTAD2, ALTCTY,       *
      *        ALTSTT, ALTPST, AND ALTCNR).                          *
      *--------------------------------------------------------------*
      *  01/15/03  FIX    CR039944  CSC     505   Mukund (MLV)       *
      *  PROBLEM:  Country Code is not getting populated in MDTMAS   *
      *            when a non-US country is specified in EEIMAS.     *
      *  SOLUTION: Added a MOVE statement in the A690-MDTMAS-WRITE   *
      *            paragraph to populate the Country Code in MDTMAS. *
      *            This piece of code was missing.                   *
      *            Also modified a MOVE statement in the             *
      *            A630-ME1022-SUB paragraph to move the Country Code*
      *            (CTRYCD) to MDTMAS, instead of the Custodial      *
      *            Parent Country (CCNTRY).                          *
      *--------------------------------------------------------------*
      *  01/15/03  FIX    CR039347  HPS     465   Robert Page        *
      *  REPLICA:         CR039359          505   Mukund (MLV)       *
      *  PROBLEM:  When a change transaction to change the Custodial *
      *            Parent address is processed using EEIMAS, if the  *
      *            Custodial Parent Indicator on EEIMAS has the same *
      *            value as on ME1014, the address change is not     *
      *            being made.                                       *
      *  SOLUTION: The logic to check the individual Custodial Parent*
      *            fields and determine whether they were changed or *
      *            not was being bypassed in the A642-STEP-3         *
      *            paragraph, when the Custodial Parent Indicator    *
      *            did not change. Program was modified to make the  *
      *            process not skip this piece of logic in such a    *
      *            situation.                                        *
      *  NOTE:     This problem was not a part of the original CR    *
      *            but was found while testing. So, it is being fixed*
      *            under the same replica CR number.                 *
      *--------------------------------------------------------------*
      *  10/23/02  FIX    CR041670  ULI   474  L.Palmer
      *                   CR041712 - replica
      *  PROBLEM:  Medicaid information not being written for member
      *  SOLUTION: Modified program to use seqnum of ws-work instead
      *            of computing seqnum of mmdmas
      *--------------------------------------------------------------*
      * 11/05/02   Fix   CR039679    IHA     504   Will Edwards       *
      * This is being done as maintenance, but there are TDs that     *
      * document the change. A total of the members that are in error *
      * and a total of the members that are successfully loaded by    *
      * batch and for the entire job are being added to the report.   *
      *---------------------------------------------------------------*
      *  04/29/02  FIX    CR036779  IBC   I67  ERIC KERSTEN
      *  10/01/02 REPLICA CR037907        504  VICKIE BELL
      *  PROBLEM:  GOING INTO MESSAGE WAIT WITH AN MCH0603 WHEN
      *            MEMTMP IS ZERO.
      *  SOLUTION: ADDED CHECK BEFORE PERFORMING THE MEMBER ADJUSTMENT
      *            ROUTINE IF MEMTMP IS ZERO.
      *--------------------------------------------------------------*
      *  05/15/02  FIX  CR037033   HIP  474  L.Palmer                *
      *                 CR037326 - REPLICA                           *
      *  PROBLEM:  Member not active on termination date message is  *
      *            generated in error                                *
      * SOLUTION:  Modified program to check expiration date against *
      *            termination date                                  *
      *--------------------------------------------------------------*
      *  08/12/02  Fix    CR039324   IHA    503   Will Edwards       *
      *  Problem:  When a PCP change is entered for a member with    *
      *            the PCPCHG flag = ' ' for a full update, the      *
      *            PCP change is not processed. Per the CSC-1142     *
      *            design, the program should determine whether      *
      *            a change should be made when PCPCHG = ' '.        *
      *  Solution: Comment out the code that skips the pcp processing*
      *            with the PCPCHG and SECCHG = ' '.                 *
      *--------------------------------------------------------------*
      *  08/12/02  Fix    CR039393   CSC    503   Will Edwards       *
      *  Problem:  An MDTMAS record for a change is written for the  *
      *            subscriber even when a change is not entered.     *
      *  Solution: Bypass code that enters the change for every      *
      *            subscriber. The code that compares the fields     *
      *            that are changing should be utilized.             *
      *--------------------------------------------------------------*
      *  08/09/02  Fix    CR039392   CSC    503   Will Edwards       *
      *  Problem:  The error 'EFFECTIVE DATE REQUIRED FOR NAME CHANGE*
      *            UPDATE' is received for dependents when no name   *
      *            change is specified.                              *
      *  Solution: The existing edit only checks NAMCHG for NOT = 'N'*
      *            which will cause NAMCHG = ' ' to be treated as a  *
      *            name change. Modified to only process as a name   *
      *            change when NAMCHG = 'Y'.                         *
      *--------------------------------------------------------------*
      *  08/09/02  Fix    CR039221   CSC    503   Will Edwards       *
      *  Problem:  The RELTYP is not populated on MDTMAS when pro-   *
      *            cessing a full update.  I found the same thing    *
      *            for the TITLCD.                                   *
      *  Solution: Modified to process the RELTYP and TITLCD changes.*
      *--------------------------------------------------------------*
      *  07/31/02  FIX  CR039039   PHC  465  LESLIE SMITH            *
      *  REPLICA:       CR039262        503                          *
      *           A DEPENDENT IS ADDED FOR AN EXISTING SUBUSCRIBER.  *
      *SOLUTION:  ADDED LOGIC TO WRITE THE SOC. SEC. NO. TO MDTMAS   *
      *          WHEN DOING A ME1023 DEP. ADD.                       *
      *--------------------------------------------------------------*
      *  05/23/02  Fix    CR037446   IHA    501   Will Edwards       *
      *  Problem:  When FULLUP = 'Y' and effective and expiration    *
      *            dates are not passed in, the chgtyp is set        *
      *            to 'A' even though the dependent already exists.  *
      *  Solution: Modified to default the dependent effective and   *
      *            expiration dates if not specified from the        *
      *            existing MEMMAS record when FULLUP = 'Y'.         *
      *                                                              *
      *  Problem:  The HOMPH2 is not updated for subscribers.        *
      *  Solution: Modified to compare the HOMPH2 to the correct     *
      *            working storage field.                            *
      *--------------------------------------------------------------*
      *  05/07/02  Fix    CR035582   IHA    50C   Will Edwards       *
      *  Found during system acceptance testing. Fields are required *
      *  when processing a full update. Modified to bypass the edits *
      *  requiring the field when FULLUP = 'Y' so that the fields can*
      *  later be defaulted. Only Member number, group number are    *
      *  required. Added edits if the CHGTYP is defaulted to add     *
      *  for the other required fields.                              *
      *--------------------------------------------------------------*
      *  10/03/01  FIX    CR032452   IBC    I67   Don Daniel         *
      *  04/12/02         CR034083          50C   Will Edwards       *
      *  Problem:  "MEMBER NOT ACTIVE ON TERMINATION EXPIRATION"     *
      *            message not appearing.                            *
      *  Solution: Use the current date to determine whether the     *
      *            error message should be displayed.                *
      *--------------------------------------------------------------*
      *  02/27/02  FIX    CR035554    MYO   465   ROBERT PAGE III    *
      *  04/09/02         CR035558          50C   Will Edwards       *
      *  Problem:  Secondary PCP Changes Not Loading when adding a   *
      *            new secondary provider period, but the provider   *
      *            and porg and memcap are the same as the existing  *
      *            period.                                           *
      *  Solution: Modified to check effective period of secondary   *
      *            provider for a change.                            *
      *--------------------------------------------------------------*
      *  04/08/02  Fix    CR036477   CSC    50C   Will Edwards       *
      *  Problem:  The EXTIND and STUSTA fields are not updated when *
      *            adding a dependent only.                          *
      *  Solution: Added moves to MDTMAS for dependent ME1023 type   *
      *            records for these two fields and other new fields.*
      *--------------------------------------------------------------*
      *  02/27/02  FIX    CR035490   HIP    474   CHARLIE LAVETT     *
      *  04/03/02         CRO35668          50C   Will Edwards       *
      *  Problem:  When dependent additions are indicated on the     *
      *            EEIMAS record which includes an area code for the *
      *            subscriber, the AREACD is not being updated to    *
      *            MDTMAS created through the ED201 process.         *
      *  Solution: Added move statement to move AREACD to MDTTAB.    *
      *--------------------------------------------------------------*
      *            RWK    CR033555   BNC                             *
      *  04/03/02         CR033563          50C   Will Edwards       *
      *  Problem:  Dates are written to MDMMAS without the century   *
      *            byte.                                             *
      *  Solution: The dates are converted from CCYYMMDD to CYYMMDD  *
      *            when they are moved to the table. The dates don't *
      *            need to be converted again.                       *
      *--------------------------------------------------------------*
      * 01/31/02   FIX   CR034677    CSC     50B  Kim Crompton       *
      * Problem:   Recieving MCH0603 in 1330                         *
      * Solution:  Use EDPACT subscript rather than ESBACT           *
      *---------------------------------------------------------------*
      * 01/31/02   FIX   CR014565    CSC     50B   Vickie Bell        *
      * Design     Added move statements in A640-ME1023-SUBCHG and    *
      * Change     A680-ME1023-DEPCHG so that it will be allowable    *
      *            for a user to add or change an employment status   *
      *            for any member.                                    *
      *---------------------------------------------------------------*
      *  11/20/01  FIX     CR033555   BNC   474   A KUMAR            *
      *  11/30/01  REPLICA CR033563   BNC   50A   A KUMAR            *
      *  PROBLEM:  MEMBER MEDICARE INFO NOT BEING POPULATED          *
      *  SOLUTION: CHANGED LOGIC TO CORRECTLY HANDLE THIS.           *
      *--------------------------------------------------------------*
      *  11/07/01  FIX     CR026286  AFW    464   ERIC KERSTEN       *
      *            REPLICA CR033204  CSC    5B5   BEJOY VARGHESE     *
      *   PROBLEM: 'HIRE DATE > TERMINATION DATE' ERROR RECEIVED     *
      *  SOLUTION: ADDED 'ELSE' CONDITION FOR WHEN A CHANGE HAS NOT  *
      *            OCCURED FOR THE HIRE DATE OR THE TERMINATION DATE *
      *                                                              *
      *     NOTES: WHILE TRYING TO RECREATE THE AFORE MENTIONED      *
      *            CHANGE REQUEST, RECEIVED A 'SUBSCRIPT OUT OF      *
      *            RANGE' ERROR IN ED201C.                           *
      *            THIS WAS BECAUSE THE CHANGES MADE UNDER CR014565  *
      *            (MHS CSC HIP-834 ENROLLMENT IN/OUT EDI INBOUND    *
      *            CHANGES),THE SUBSCRIPT USED FOR THE ARRAY FOR NEW *
      *            FIELDS FOR HIPAA EDI WAS NOT CORRECT IN PARAGRAPH *
      *            A642-STEP-3 AND A682-STEP-3.SUBSCRIPT VALUE WAS 0.*
      *            CHANGED THE SUBSCRIPT IN A642-STEP-3 AND          *
      *            A682-STEP-3 PARAGRAPHS.                           *
      *--------------------------------------------------------------*
      *  11/01/01 FIX     CR026199  AFW     464   ERIC KERSTEN       *
      *           REPLICA CR033194  CSC     5B5   BEJOY VARGHESE     *
      *  PROBLEM:  NOT PASSING THE BENPKG TO MDTMAS ON A TIER/BENPKG *
      *            CHANGE.                                           *
      *  SOLUTION: FORCED THE BENPKG MOVE ON THE TIER LEVEL SINCE A  *
      *            BENPKG CAN CHANGE ON ITS OWN, BUT A TIER HAS TO   *
      *            HAVE A BENPKG ASSOCIATED WITH IT.                 *
      *---------------------------------------------------------------
      *  10/01/01  Fix    CR014565  CSC     5B4   Vickie Bell        *
      *  New fields were not being moved at all times necessary for  *
      *  a line one record. Were not being moved for dependents.     *
      *--------------------------------------------------------------*
      *  06/15/01  Fix    CR027386  AFW     464   Kim Crompton       *
      *        REPLICA    CR027641          5B3                      *
      *  Problem:  OMEDAT NOT BEING MOVED TO MDTMAS-RECORD.          *
      *  Solution: ADDED CODE TO MOVE OMEDAT TO MDTMAS-RECORD.       *
      *--------------------------------------------------------------*
      *  05/15/01  Mod     CR014565  CSC     5B3   Kim Crompton       *
      *            HIPAA Membership fields expansion                  *
      *            Since the I-O modules had to be added to the       *
      *            program it was necessary to convert to ILE.        *
      *---------------------------------------------------------------*
      *  03/28/01  Mod     CR013641  Cig     5B2   Kim Crompton       *
      *            Add GRPNUM to MEMMAS lookup                        *
      *---------------------------------------------------------------*
      *  03/12/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  REVISED PARA A640 TO CREATE A LIN-0005 WHEN SECPRV OR       *
      *  SECORG OR SECMCP ARE CHANGED.                               *
      *--------------------------------------------------------------*
      *  03/08/01  RWK     CR008697  IBC     49B  ASHLEY ARTHUR      *
      *  MODIFIED CODE TO POPULATE CGAOVR, CGTOVR, DALOVR, SALOVR,   *
      *  CBXOVR, CBEOVR, APCOVR, SSOVR, VRCOVR, AND  RMTOVR IN       *
      *  MDTMAS LINE NUMBERS 2, 3, 5, 6, AND 7 IN PARAGRAPH A640     *
      *--------------------------------------------------------------*
      *  03/07/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  REVISED TO CHECK PCPCHG AND SECCHG FOR BOTH "N" AND SPACE.  *
      *--------------------------------------------------------------*
      *  03/05/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  MODIFIED CODE TO POPULATE SEXCOD IN LINE 5 OF PARA A660.    *
      *--------------------------------------------------------------*
      *  02/21/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  MODIFIED CODE TO POPULATE MEMREA IN LINE 1 OF PARA A660.    *
      *--------------------------------------------------------------*
      *  02/14/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  MODIFIED CODE TO POPULATE DALOVR ON LINE 2 IN PARA A660,    *
      *  AND POPULATE ALL OVERRIDES FOR LINES 5 AND 6 IN PARA A660.  *
      *--------------------------------------------------------------*
      *  02/12/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  MODIFIED CODE TO POPULATE CGAOVR, CGTOVR, DALOVR, SALOVR,   *
      *  CBXOVR, CBEOVR, APCOVR, SSOVR, VRCOVR, AND  RMTOVR IN       *
      *  MDTMAS LINE NUMBERS 1, 4 AND 8 IN PARA A640.                *
      *--------------------------------------------------------------*
      *  02/09/01  RWK     CR008697  IBC     49B  ASHLEY ARTHUR      *
      *  MODIFIED CODE TO POPULATE THE POPULATE CGAOVR, CGTOVR,      *
      *  DALOVR, SALOVR, CBXOVR, CBEOVR, APCOVR, SSOVR, VRCOVR, AND  *
      *  RMTOVR ON MDTMAS LINE NUMBER 2.                             *
      *--------------------------------------------------------------*
      *  01/24/01   MOD    CR021907   IBC   495   James C. Wright    *
      *  Modified to move the COBDAT, PAYLOC, PAYNUM, & DOCNUM       *
      *  fields to MDTMAS, EETMAS, & EEEMAS records, from EEWMAS as  *
      *  appropriate. If a DOCNUM exists on EEWMAS, then a record in *
      *  DODMAS will be created. Also the AREACD field will be       *
      *  expanded from 4 to 6 characters.                            *
      *  03/09/01  MOD     CR021907   IBC   495   Tony Jackson       *
      *  Modified DODMAS for WITH DUPLICATES for record key.         *
      *--------------------------------------------------------------*
      *  01/22/01  RWK     CR008697  IBC     49B  GARY WATKINS       *
      *  SECOVR IS NOT BEING CORRECTLY POPULATED IN ALL TABLES.      *
      *  TYPCOD IS NOT BEING POPULATED IN PARA A660.                 *
      *--------------------------------------------------------------*
      *  12/09/00  FIX     CR022429  IBC     44N  OLIVIA CULBRETH    *
      *  REPLICATE:        CR022688          49A  SARENNA BENJAMIN   *
      *  PROBLEM:  A MDTMAS RECORD IS BEING CREATED WHEN IT SHOULDN'T*
      *  SOLUTION: MODIFIED PROGRAM TO CHECK FOR NULL RECORDS EACH   *
      *            TIME DATES ARE CHECKED                            *
      *--------------------------------------------------------------*
      *  10/24/00   MOD    CR013627   HSI    49A  Gary Watkins       *
      *  Populate the new salary amount (SALAMT), the effective      *
      *  date (EFFDAT), and the expiration date (EXPDAT) in the      *
      *  Membership Batch Detail Master MDTMAS) file.                *
      *--------------------------------------------------------------*
      *  09/28/00   FIX    CR021786   BNC    480  Kim Crompton
      *  Problem:   Program in infinite loop
      * Solution:   Fixed bad PERFORM/THRUs and GO TOs
      *--------------------------------------------------------------*
      *  09/26/00   FIX    CR021156   IBC    44N  E Whatley
      *  REPLICA:          CR021663   IBC    49A  E Whatley
      *  PROBLEM:  Enpmas records are not correctly being nulled and
      *            new record created when PrvOrg or Memcp is spaces.
      *  SOLUTION: Adjust logic to allow blank PrvOrg & Memcp changes.
      *--------------------------------------------------------------*
      *  09/22/00  Fix     CR021397  BNC     4.8  Kim Crompton       *
      *  Problem:  Recieving and error that external member eff/exp  *
      *            dates must be within member eff/exp dates         *
      *  Solution: Add member eff/exp dates to lin-0007              *
      *--------------------------------------------------------------*
      *  09/21/00  Fix     CR021399  BNC     4.8  Kim Crompton       *
      *  Problem:  Receiving an error dependent over age for         *
      *            enrollment date in ME102A.                        *
      *  Solution: Update the member status on lin-0004              *
      *--------------------------------------------------------------*
      *  09/20/00  Fix     CR021418  BNC     4.8  Kim Crompton       *
      *  Problem:  Receiving an error city, state, and zip required  *
      *            out of ME102B when it is present on the input.    *
      *  Solution: Update all parts of address even when only one    *
      *            part is being changes.                            *
      *--------------------------------------------------------------*
      *  08/18/00  MOD    CR008694   IBC    49A   Don Daniel         *
      *       Mod: Program modified to populate TIRFLG in MDTMAS,    *
      *            EETMAS, EEEMAS with the same value from EEWMAS.   *
      *            Also, when TIRFLG in MDTMAS is 'Y', then TIRFLG   *
      *            in MBHMAS must also be set to 'Y'.                *
      *---------------------------------------------------------------
      *  08/15/00  Fix     CR020360  AHA     4.7  BETH GIBSON        *
      *  Problem:  More documents are being created within a batch   *
      *            than the default number specified.                *
      *  Solution: Change logic to check SEQNUM against CTLDOC of    *
      *            MBHMAS before incrementing.                       *
      *            THIS WAS ORIGINALLY FIXED UNDER CR009455.         *
      *--------------------------------------------------------------*
      *  07/26/00  RWK     CR010764  CSC     48B  M.Skiba            *
      *  PROBLEM:  User Fields not being populated for Dependent     *
      *            records on MDTMAS.                                *
      *  SOLUTION: Changed A210 paragraph to move User fields of     *
      *            Dependent records to EEWDEP and EEWDET records.   *
      *--------------------------------------------------------------*
      *  07/26/00  RWK     CR010764  CSC     48B  M.Skiba            *
      *  PROBLEM:  User Fields not being populated for Dependent     *
      *            records on MDTMAS.                                *
      *  SOLUTION: Changed A210 paragraph to move User fields of     *
      *            Dependent records to EEWDEP and EEWDET records.   *
      *--------------------------------------------------------------*
      * 07/21/00   MOD     CR010767   CSC    49A  Mark Skiba         *
      * Modified to change name of SPEXMREF to MEEXMREF and SPEXGREF *
      * to MEEXGREF.                                                 *
      *--------------------------------------------------------------*
      *  07/19/00   FIX    CR019137   BTM    44N  ERIC KERSTEN
      *  PROBLEM:  WHEN CHANGE TYPE = 'T' (TERMINATE) THE PRINT FLAG
      *            IS NOT BEING MOVED TO MDTMAS WHICH IS CAUSING AN
      *            ERROR ON ME102A.
      *  SOLUTION: ADDED A CHECK IN THE A642-STEP-2 ROUTINE TO DEFAULT
      *            THE PRTCOD TO 'N' IF THERE IS NOT ONE SPECIFIED.
      *--------------------------------------------------------------*
      *  07/18/00   Fix    CR018398   BTM    44N  Kenny Shaw         *
      * PROBLEM: No Subscriber or Member info being listed on E-Log  *
      *          when error message is given.                        *
      * SOLUTION: Added code to print Member, Subscriber, and Group  *
      *          when Subscriber or Dependant Table max is reached   *
      *          along with the standard error message.              *
      *--------------------------------------------------------------*
      *  06/14/00  MOD   CR008697   IBC      49A   Gary Watkins       *
      *        Populate the following values to MDTMAS: CGAOVR,       *
      *        CGTOVR, DALOVR, SALOVR, CBXOVR, CBEOVR, APCOVR,        *
      *        SSSOVR, VRCOVR and RMTOVR.                             *
      *----------------------------------------------------------------
      *  06/12/00  MOD   CR008697   IBC      48B   Clifton Winbush    *
      *        Change DOAOVR to DALOVR to correspond to EEIDET file   *
      *        change.                                                *
      *----------------------------------------------------------------
      *  06/12/00  MOD    CR007797    IBC   48B   Clifton Winbush    *
      *  MOD: Added RELTYP field to tables(MDTTAB,EEWDEP,EEWSUB,     *
      *       EETDEP, AND EETSUB).                                   *
      *       The Relationship Type value will be moved from EEWMAS  *
      *       to MDTMAS, EETMAS, & EEEMAS.                           *
      *--------------------------------------------------------------*
      *  05/19/00  MOD  CR008695  IBC   49A  PAUL SNYDER             *
      *            SET VALUE OF SRCIND                               *
      *--------------------------------------------------------------*
      *  04/20/00  MOD    CR010569   IBC    48B   Bonita Brewer      *
      *  Recompiled to capture changes for the new profile codes     *
      *--------------------------------------------------------------*
      *  04/14/00  RWK    CR010764   ITS    48A   B.Holderfield      *
      *  Problem:  CHGTYP is being populated with the CHGTYP         *
      *            directly from EEIMAS                              *
      *  Solution: Only populate MDTMAS LINE 7 with "A" or "C"       *
      *--------------------------------------------------------------*
      *  04/14/00  RWK    CR010110   BNC    48A   M.SKIBA            *
      *  Problem:  Receiving MCH3601 error.                          *
      *  Solution: Commented out move statement of DOAOVR indicator  *
      *--------------------------------------------------------------*
      *  04/13/00  MOD    CR010569   IBC    48B   GARY WATKINS
      *   ENCOUNTERED PROBLEM WHILE DOING RECOMPILES.  CHANGED NAME
      *   OF MBHMAS/EDIBAT TO MBHMAS/SRCIND.
      *--------------------------------------------------------------*
      *  02/29/00  RWK    CR010764   BNC    48A   B.Holderfield
      *   Added code to look up the SUBSNO using EXTSUB if SUBSNO
      *   is not entered.
      *--------------------------------------------------------------*
      *  02/23/00  RWK  CR010110  BNC    47M  D.GOVER
      *  IMPLEMENTED CODE FOR AGE EDITS.
      *--------------------------------------------------------------*
      *  01/24/00  FIX     CR010975  BNC     45N  ERIC KERSTEN
      *  PROBLEM:  MDMMAS WASN'T BEING LOADED PROPERLY.
      *  SOLUTION: CORRECTED NUMEROUS MOVE AND DECLARATION STATEMENTS
      *--------------------------------------------------------------*
      *  12/29/99  MOD  CR010520    IBC     48B   Kim Crompton       *
      *  MOD:  Edit and move ACCTN2 from EEIMAS to EEEMAS and EEWMAS *
      *        Also expanded SAVE-RECORD-AREA to 2048 for standards. *
      *--------------------------------------------------------------*
      *  12/29/99  MOD    CR008923  IBC     48B   B.Holderfield      *
      *  Move PKGOVR from EEWMAS to MDTMAS (LIN-0004) record         *
      *--------------------------------------------------------------*
      *  12/15/99   FIX  CR013241     BNC     45N  ERIC KERSTEN
      *  PROBLEM:  HICFA # IS BEING OVERWRITTEN WHEN A SUBSCRIBER
      *            MCMMAS CHANGE IS SENT THOUGH EDI.
      *  SOLUTION: CORRECTED THE IF STATEMENTS TO ADD THE HICFA # TO
      *            MDTMAS REGARDLESS, BUT ONLY CHANGE DEMMAS IF THE
      *            NUMBER IS DIFFERENT.
      *--------------------------------------------------------------*
      *  12/13/99   FIX  CR013164     BNC     45N  ERIC KERSTEN
      *  PROBLEM:  MCH0603 OCCURS WHEN CHANGING A DEPENDENT DUE TO
      *            INCORRECT CALL TO A SUBSCRIBER WRITE
      *  SOLUTION: CORRECTED THE GO TO STATEMENTS TO CALL THE CORRECT
      *            ROUTINE.
      *--------------------------------------------------------------*
      *  10/29/99  MOD  CR010110  IBC   470  GARY WATKINS            *
      *  POPULATE THE DEPENDENT OVER AGE OVERRIDE INDICATOR          *
      *  (DOAOVR) TO THE MEMBERSHIP DETAIL MASTER (MDTMAS) FILE.     *
      *--------------------------------------------------------------*
      *  10/12/99  MOD    CR010764  IBC     48A  B.Holderfield       *
      *  MOD:      Moved new fields (EXTGRP, EXTMEM, EXTCON, EXTEFF, *
      *            EXTEXP, PROCOD, HISSEQ, CTLPLN, EXTREL, PRVPLN,   *
      *            and PRVNET from EEWMAS to MDTMAS.                 *
      *            SPEXMREF and SPEXGREF are being used to locate    *
      *            the corresponding MEMBNO and GRPNUM.                    *
      *            The DUPMEM will be checked to see if EI02465      *
      *            error message will be bypassed.                   *
      *--------------------------------------------------------------*
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-AS400.
       OBJECT-COMPUTER. IBM-AS400.
      ****--------------------------------------------------------****
      ****  PMHS-364  KCT  Fix                                    ****
      ****  Linkage Grace Period Days subroutine.                 ****
      ****--------------------------------------------------------****
       SPECIAL-NAMES.
           COPY SCLINKAGE OF QLBLSRC.
           LINKAGE TYPE IS PROCEDURE FOR 'DEMDOCBTM'
           LINKAGE TYPE IS PROCEDURE FOR 'DEMEXTBTM'
           LINKAGE TYPE IS PROCEDURE FOR 'EMLPTRBVM'
           LINKAGE TYPE IS PROCEDURE FOR 'GRCPDYS'
           LINKAGE TYPE IS PROCEDURE FOR 'RSPDOCBTM'
           LINKAGE TYPE IS PROCEDURE FOR 'RSPPTYBTM'
           LINKAGE TYPE IS PROCEDURE FOR 'ALTDOCBTM'
           SYSTEM-CONSOLE IS SYS-CONSOLE
           LOCAL-DATA IS LOCAL-AREA.
      *
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           SELECT CMPANY ASSIGN         TO  DATABASE-CMPANYBT
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  CMPANY-STATUS
                         RECORD KEY     IS  CMPANY-KEY.
      *
           SELECT COVMAS ASSIGN         TO DATABASE-COVMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS COVMAS-STATUS
                         RECORD KEY     IS COVMAS-KEY.
           SELECT CPAMAS ASSIGN         TO DATABASE-CPAMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS CPAMAS-STATUS
                         RECORD KEY     IS CPAMAS-KEY.
      *
           SELECT CPDMAS ASSIGN         TO DATABASE-CPDMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS CPDMAS-STATUS
                         RECORD KEY     IS CPDMAS-KEY.
      *
           SELECT DEMMAS ASSIGN         TO DATABASE-DEMMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS DEMMAS-STATUS
                         RECORD KEY     IS DEMMAS-KEY.
      *
           SELECT DODMAS ASSIGN         TO DATABASE-DODMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS DODMAS-STATUS
                         RECORD KEY     IS DODMAS-KEY
                                           WITH DUPLICATES.
      *
           SELECT EDIDOCBT ASSIGN       TO DATABASE-EDIDOCBT
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EDIDOCBT-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY.
      *
           SELECT EEEMAS ASSIGN         TO  DATABASE-EEEMAS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  EEEMAS-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY
                                            WITH DUPLICATES.
      *
           SELECT EEPMAS ASSIGN         TO DATABASE-EEPMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EEPMAS-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY.
      *
           SELECT EETMAS ASSIGN         TO DATABASE-EETMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EETMAS-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY.
      *
           SELECT EEWMAS ASSIGN         TO DATABASE-EEWMAS
                         ORGANIZATION   IS SEQUENTIAL
                         ACCESS MODE    IS SEQUENTIAL
                         FILE STATUS    IS EEWMAS-STATUS.
      *
           SELECT ENBMAS ASSIGN         TO DATABASE-ENBMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS ENBMAS-STATUS
                         RECORD KEY     IS ENBMAS-KEY.
      *
           SELECT ENBMEM ASSIGN         TO DATABASE-ENBMEM
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS ENBMEM-STATUS
                         RECORD KEY     IS ENBMEM-KEY.
      *
           SELECT ENPMAS ASSIGN         TO DATABASE-ENPMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS ENPMAS-STATUS
                         RECORD KEY     IS ENPMAS-KEY.
      *
           SELECT ENPGRP ASSIGN         TO DATABASE-ENPGRP
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS ENPGRP-STATUS
                         RECORD KEY     IS ENPGRP-KEY.
      *
           SELECT EXCMDTBT ASSIGN       TO DATABASE-EXCMDTBT
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EXCMDTBT-STATUS
                         RECORD KEY     IS EXCMDTBT-KEY.
      *
           SELECT EXCMEMBT ASSIGN       TO DATABASE-EXCMEMBT
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EXCMEMBT-STATUS
                         RECORD KEY     IS EXCMEMBT-KEY.
      *
           SELECT EXCSMSBI ASSIGN       TO DATABASE-EXCSMSBI
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EXCSMSBI-STATUS
                         RECORD KEY     IS EXTERNALLY-DESCRIBED-KEY.
      *
           SELECT EXHMAS ASSIGN         TO DATABASE-EXHMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS EXHMAS-STATUS
                         RECORD KEY     IS EXHMAS-KEY.
      *
           SELECT EXTBENBT ASSIGN       TO  DATABASE-EXTBENBT
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  EXTBENBT-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY.
      *
           SELECT EXTDOCBT ASSIGN       TO  DATABASE-EXTDOCBT
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  EXTDOCBT-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY.
           SELECT GPHMAS ASSIGN         TO DATABASE-GPHMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS GPHMAS-STATUS
                         RECORD KEY     IS GPHMAS-KEY.
      *
           SELECT GRPMAS ASSIGN         TO DATABASE-GRPMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS GRPMAS-STATUS
                         RECORD KEY     IS GRPMAS-KEY.
      *
           SELECT MBHMAS ASSIGN         TO DATABASE-MBHMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MBHMAS-STATUS
                         RECORD KEY     IS MBHMAS-KEY.
      *
           SELECT MCDMAS ASSIGN         TO DATABASE-MCDMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MCDMAS-STATUS
                         RECORD KEY     IS MCDMAS-KEY.
      *
           SELECT MDTMAS ASSIGN         TO DATABASE-MDTMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MDTMAS-STATUS
                         RECORD KEY     IS MDTMAS-KEY.
      *
           SELECT MEEMAS ASSIGN         TO  DATABASE-MEEMAS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  MEEMAS-STATUS
                         RECORD KEY     IS  MEEMAS-KEY.
      *
           SELECT MEMEXDBT ASSIGN       TO DATABASE-MEMEXDBT
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MEMEXDBT-STATUS
                         RECORD KEY     IS MEMEXDBT-KEY.
      *
           SELECT MEMMAS ASSIGN         TO  DATABASE-MEMMAS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  MEMMAS-STATUS
                         RECORD KEY     IS  MEMMAS-KEY.
      *
           SELECT MEMSBS ASSIGN         TO  DATABASE-MEMSBS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  MEMSBS-STATUS
                         RECORD KEY     IS  MEMSBS-KEY.
      *
           SELECT MHSMAS ASSIGN         TO  DATABASE-MHSMAS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  MHSMAS-STATUS
                         RECORD KEY     IS  MHSMAS-KEY.
      *
           SELECT MMDMAS ASSIGN         TO DATABASE-MMDMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MMDMAS-STATUS
                         RECORD KEY     IS MMDMAS-KEY.
      *
           SELECT MCMMAS ASSIGN         TO DATABASE-MCMMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MCMMAS-STATUS
                         RECORD KEY     IS MCMMAS-KEY.
      *
           SELECT MDMMAS ASSIGN         TO DATABASE-MDMMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS MDMMAS-STATUS
                         RECORD KEY     IS MDMMAS-KEY.
      *
           SELECT FACMAS ASSIGN         TO DATABASE-FACMAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS FACMAS-STATUS
                         RECORD KEY     IS FACMAS-KEY.
      *
           SELECT PEMMAS ASSIGN         TO  DATABASE-PEMMAS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  PEMMAS-STATUS
                         RECORD KEY     IS  PEMMAS-KEY.
      *
           SELECT PE4SBS ASSIGN         TO  DATABASE-PE4SBS
                         ORGANIZATION   IS  INDEXED
                         ACCESS MODE    IS  DYNAMIC
                         FILE STATUS    IS  PE4SBS-STATUS
                         RECORD KEY     IS  EXTERNALLY-DESCRIBED-KEY
                                            WITH DUPLICATES.
      *
           SELECT RF3MAS ASSIGN         TO DATABASE-RF3MAS
                         ORGANIZATION   IS INDEXED
                         ACCESS MODE    IS DYNAMIC
                         FILE STATUS    IS RF3MAS-STATUS
                         RECORD KEY     IS RF3MAS-KEY.
      *
       I-O-CONTROL.
           SAME RECORD AREA FOR ENBMAS ENBMEM
           SAME RECORD AREA FOR MEMMAS MEMSBS
           SAME RECORD AREA FOR EXCMEMBT EXCSMSBI
           SAME RECORD AREA FOR ENPMAS ENPGRP.
       DATA DIVISION.
      *
       FILE SECTION.
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
       FD  CMPANY.
           COPY CMPANYRF OF QLBLSRC
              REPLACING ==CMPANYBT-REC== BY ==CMPANY-REC==,
                        ==CMPANYBT-KEY== BY ==CMPANY-KEY==.
      *
       FD  COVMAS
                  LABEL RECORDS ARE STANDARD.
           COPY COVMASRF OF QLBLSRC.
       FD  CPAMAS
                  LABEL RECORDS ARE STANDARD.
           COPY CPAMASRF OF QLBLSRC.
      *
       FD  CPDMAS
                  LABEL RECORDS ARE STANDARD.
           COPY CPDMASRF OF QLBLSRC.
      *
       FD  DEMMAS
                  LABEL RECORDS ARE STANDARD.
           COPY DEMMASRF OF QLBLSRC.
      *
       FD  DODMAS
                  LABEL RECORDS ARE STANDARD.
           COPY DODMASRF OF QLBLSRC.
      *
       FD  EDIDOCBT
                  LABEL RECORDS ARE STANDARD.
       01  EDIDOCBT-REC.
           COPY DD-REDIDOCBT OF EDIDOCBT.
      *
       FD  EEEMAS
                  LABEL RECORDS ARE STANDARD.
       01  EEEMAS-REC.
           COPY DD-REEEMAS OF EEEMAS.
      *
       FD  EEPMAS
                  LABEL RECORDS ARE STANDARD.
       01  EEPMAS-REC.
           COPY DD-REEPMAS OF EEPMAS.
      *
       FD  EETMAS
                  LABEL RECORDS ARE STANDARD.
       01  EETMAS-REC.
           COPY DD-REETMAS OF EETMAS.
      *
       FD  EEWMAS
                  LABEL RECORDS ARE STANDARD.
           COPY EEWMASRF OF QLBLSRC.
      *
       FD  ENBMAS
                  LABEL RECORDS ARE STANDARD.
           COPY ENBMASRF OF QLBLSRC.
      *
       FD  ENBMEM
                  LABEL RECORDS ARE STANDARD.
           COPY ENBMEMRF OF QLBLSRC.
      *
       FD  ENPMAS
                  LABEL RECORDS ARE STANDARD.
           COPY ENPMASRF OF QLBLSRC.
      *
       FD  ENPGRP
                  LABEL RECORDS ARE STANDARD.
           COPY ENPGRPRF OF QLBLSRC.
      *
       FD  EXCMDTBT
                  LABEL RECORDS ARE STANDARD.
           COPY EXCMDTBTR OF QLBLSRC.
      *
       FD  EXCMEMBT
                  LABEL RECORDS ARE STANDARD.
           COPY EXCMEMBTR OF QLBLSRC.
      *
       FD  EXCSMSBI
                  LABEL RECORDS ARE STANDARD.
       01  EXCSMSBI-REC.
           COPY DD-REXCMEMBT OF EXCSMSBI.
      *
       FD  EXHMAS
                  LABEL RECORDS ARE STANDARD.
           COPY EXHMASRF OF QLBLSRC.
      *
       FD  EXTBENBT
                  LABEL RECORDS ARE STANDARD.
       01  EXTBENBT-REC.
           COPY DDS-ALL-FORMATS OF EXTBENBT.
      *
       FD  EXTDOCBT
                  LABEL RECORDS ARE STANDARD.
       01  EXTDOCBT-REC.
           COPY DDS-ALL-FORMATS OF EXTDOCBT.
       FD  GPHMAS
                  LABEL RECORDS ARE STANDARD.
           COPY GPHMASRF OF QLBLSRC.
      *
       FD  GRPMAS
                  LABEL RECORDS ARE STANDARD.
           COPY GRPMASRF OF QLBLSRC.
      *
       FD  MBHMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MBHMASRF OF QLBLSRC.
      *
       FD  MCDMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MCDMASRF OF QLBLSRC.
      *
       FD  MCMMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MCMMASRF OF QLBLSRC.
      *
       FD  MDMMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MDMMASRF OF QLBLSRC.
      *
       FD  FACMAS
                  LABEL RECORDS ARE STANDARD.
           COPY FACMASRF OF QLBLSRC.
      *
       FD  MDTMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MDTMASRF OF QLBLSRC.
      *
       FD  MEEMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MEEMASRF OF QLBLSRC.
      *
       FD  MEMEXDBT
                  LABEL RECORDS ARE STANDARD.
           COPY MEMEXDBTR OF QLBLSRC.
      *
       FD  MEMMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MEMMASRF OF QLBLSRC.
      *
       FD  MEMSBS
                  LABEL RECORDS ARE STANDARD.
           COPY MEMSBSRF OF QLBLSRC.
      *
       FD  MHSMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MHSMASRF OF QLBLSRC.
      *
       FD  MMDMAS
                  LABEL RECORDS ARE STANDARD.
           COPY MMDMASRF OF QLBLSRC.
      *
       FD  PEMMAS
                  LABEL RECORDS ARE STANDARD.
           COPY PEMMASRF OF QLBLSRC.
      *
       FD  PE4SBS
                  LABEL RECORDS ARE STANDARD.
       01  PE4SBS-REC.
           COPY DD-RPE4MAS OF PE4SBS.
      *
       FD  RF3MAS
                  LABEL RECORDS ARE STANDARD.
           COPY RF3MASRF OF QLBLSRC.
      *
       WORKING-STORAGE SECTION.
           COPY MSGPARMS OF QSECCPY.
       01  FILLER.
           05  WS-PGMNAM           PIC X(06) VALUE 'ED201C'.
           05  FILLER              PIC X(04) VALUE ' PRD'.
      *
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           05      CMPANY-STATUS       PIC X(02).
           05      COVMAS-STATUS       PIC X(02).
           05      CPAMAS-STATUS       PIC X(02).
           05      CPDMAS-STATUS       PIC X(02).
           05      DEMMAS-STATUS       PIC X(02).
           05      DODMAS-STATUS       PIC X(02).
           05      EDIDOCBT-STATUS     PIC X(02).
           05      EEEMAS-STATUS       PIC X(02).
           05      EEPMAS-STATUS       PIC X(02).
           05      EETMAS-STATUS       PIC X(02).
           05      EEWMAS-STATUS       PIC X(02).
           05      ENBMAS-STATUS       PIC X(02).
           05      ENBMEM-STATUS       PIC X(02).
           05      ENPMAS-STATUS       PIC X(02).
           05      ENPGRP-STATUS       PIC X(02).
           05      EXCMDTBT-STATUS     PIC X(02).
           05      EXCMEMBT-STATUS     PIC X(02).
           05      EXCSMSBI-STATUS     PIC X(02).
           05      EXHMAS-STATUS       PIC X(02).
           05      EXTBENBT-STATUS     PIC X(02).
           05      EXTDOCBT-STATUS     PIC X(02).
           05      GPHMAS-STATUS       PIC X(02).
           05      GRPMAS-STATUS       PIC X(02).
           05      MBHMAS-STATUS       PIC X(02).
           05      MCDMAS-STATUS       PIC X(02).
           05      MCMMAS-STATUS       PIC X(02).
           05      MDMMAS-STATUS       PIC X(02).
           05      FACMAS-STATUS       PIC X(02).
           05      MDTMAS-STATUS       PIC X(02).
           05      MEEMAS-STATUS       PIC X(02).
           05      MEMEXDBT-STATUS     PIC X(02).
           05      MEMMAS-STATUS       PIC X(02).
           05      MEMSBS-STATUS       PIC X(02).
           05      MHSMAS-STATUS       PIC X(02).
           05      MMDMAS-STATUS       PIC X(02).
           05      PEMMAS-STATUS       PIC X(02).
           05      PE4SBS-STATUS       PIC X(02).
           05      RF3MAS-STATUS       PIC X(02).
      *
           05      SAVE-RECORD-AREA    PIC X(5000) VALUE SPACES.
      *
           COPY LCDISP OF QSECCPY.
           05  PGM-WORK REDEFINES LOCAL-WORK.
               10  NOTUSR              PIC  X(10).
               10  STDMSG              PIC  X(07).
               10  FILMEM              PIC  X(10).
               10  SNDRID              PIC  X(20).
               10  PRCERR              PIC  X(01).
               10  FULLUP              PIC  X(01).
               10  AUTOPR              PIC  X(01).
               10  AUTOPS              PIC  X(01).
               10  GRPNUM              PIC  X(06).
               10  TRMEXP              PIC S9(07).
               10  FILLER              PIC  X(286).
      *
       01  WS-WORK.
           05      BTHDAT-HLD.
            10     BTHCC               PIC  99.
            10     BTHYY               PIC  99.
            10     BTHMM               PIC  99.
            10     BTHDD               PIC  99.
           05      BTHDAT-CONV.
            10     BTHCC               PIC  9.
            10     BTHYY               PIC  99.
            10     BTHMM               PIC  99.
            10     BTHDD               PIC  99.
           05      BTHDAT-SRCH REDEFINES BTHDAT-CONV
                                       PIC S9(07).
           05      TARDAT.
            10     DATCC               PIC  99.
            10     DATYY               PIC  99.
            10     DATMM               PIC  99.
            10     DATDD               PIC  99.
           05      TARDAT-CONV.
            10     DATCC               PIC  9.
            10     DATYY               PIC  99.
            10     DATMM               PIC  99.
            10     DATDD               PIC  99.
           05      CNVDAT  REDEFINES TARDAT-CONV
                                       PIC S9(07).
           05      OLDSUB              PIC  X(15).
           05      OLDGRP              PIC  X(06).
           05      MEMBNO-HLD          PIC  X(15).
           05      EEWEFF              PIC S9(07).
           05      EEWEXP              PIC S9(07).
           05      DATECOD             PIC  X(01)         VALUE SPACES.
           05      SEXCOD-SRCH         PIC  X(01).
           05      NUMCNT              PIC  9(05)         VALUE ZEROS.
           05      MEMBNO-INPUT        PIC  X(15).
           05      MEMBNO-HIGH         PIC  X(15).
           05      MEMBNO-SAVE         PIC  X(15).
           05      GENMEM              PIC  X(15).
           05      MEMBNO-MAX          PIC  9(02)         VALUE 15.
           05      MEMBNO-TBL.
            10     FILLER OCCURS 15.
             15    MEMBNO-TAB          PIC  X(01).
           05      MEMSUF-9            PIC  9(02).
           05      FILLER REDEFINES MEMSUF-9.
            10     MEMSUF-X OCCURS 2   PIC  X(01).
           05      MEMEFF              PIC S9(07) COMP-3.
           05      MEMEXP              PIC S9(07) COMP-3.
           05      ENPEFF              PIC S9(07) COMP-3.
           05      ENPEXP              PIC S9(07) COMP-3.
           05      ENBEFF              PIC S9(07) COMP-3.
           05      ENBEXP              PIC S9(07) COMP-3.
           05      ENBGRP              PIC  X(06) VALUE SPACES.
           05      ENBSUB              PIC  X(15) VALUE SPACES.
           05      ENBMEB              PIC  X(15) VALUE SPACES.
           05      ENBBEN              PIC  X(04) VALUE SPACES.
           05      ENBTRN              PIC S9(11) COMP-3.
           05      CHGTYP              PIC  X(01) VALUE SPACES.
           05      EINDX               PIC  9(02) VALUE ZEROES.
           05      RESPID              PIC  X(01) VALUE SPACES.
           05      BENEQU              PIC  X(01) VALUE SPACES.
      *
           05      PRCSEQ              PIC S9(07) COMP-3  VALUE +0.
           05      SEQNUM              PIC S9(03) COMP-3  VALUE +0.
           05      LINENO              PIC S9(03) COMP-3  VALUE +0.
           05      SEQNM2              PIC S9(03) COMP-3  VALUE +0.
      *
           05      MBHKEY.
            10     BRANCD              PIC  X(02)         VALUE SPACES.
            10     BATDAT              PIC S9(07) COMP-3  VALUE +0.
            10     BATSEQ              PIC  9(03)         VALUE  0.
           05      LIN-0001            PIC S9(03) COMP-3  VALUE +1.
           05      LIN-0002            PIC S9(03) COMP-3  VALUE +2.
           05      LIN-0003            PIC S9(03) COMP-3  VALUE +3.
           05      LIN-0004            PIC S9(03) COMP-3  VALUE +4.
           05      LIN-0005            PIC S9(03) COMP-3  VALUE +5.
           05      LIN-0006            PIC S9(03) COMP-3  VALUE +6.
           05      LIN-0007            PIC S9(03) COMP-3  VALUE +7.
           05      LIN-0008            PIC S9(03) COMP-3  VALUE +8.
           05      LIN-0009            PIC S9(03) COMP-3  VALUE +9.
           05      HLDCOD-MEM          PIC  X(15).
           05      HLDCOD-HLD          PIC  X(02).
           05      TIERCD-HLD          PIC  X(04).
           05      ACCTNO-HLD          PIC  X(15).
           05      USRFL1-HLD          PIC  X(05).
           05      USRFL2-HLD          PIC  X(10).
           05      USRFL3-HLD          PIC  X(10).
           05      PPSTMP              PIC S9(05) COMP-3  VALUE +0.
           05      SPSTMP              PIC S9(05) COMP-3  VALUE +0.
           05      SMDTMP              PIC S9(05) COMP-3  VALUE +0.
           05      SFETMP              PIC S9(05) COMP-3  VALUE +0.
           05      ENSTMP              PIC S9(05) COMP-3  VALUE +0.
           05      MEMTMP              PIC S9(05) COMP-3  VALUE +0.
           05      PCPTMP              PIC S9(05) COMP-3  VALUE +0.
           05      SECTMP              PIC S9(05) COMP-3  VALUE +0.
           05      MEDTMP              PIC S9(05) COMP-3  VALUE +0.
           05      FEETMP              PIC S9(05) COMP-3  VALUE +0.
           05      ENBTMP              PIC S9(05) COMP-3  VALUE +0.
           05      TMPACT              PIC S9(05) COMP-3  VALUE +0.
           05      DEPTMP              PIC S9(05) COMP-3  VALUE +0.
           05      DEMTMP              PIC S9(05) COMP-3  VALUE +0.
           05      TBLIND              PIC S9(05) COMP-3  VALUE +0.
           05      NUMWRN              PIC S9(05) COMP-3  VALUE +0.
           05      SAVLIN              PIC X(132).
           05      NUMERR              PIC S9(05) COMP-3  VALUE +0.
           05      TOTADD              PIC S9(05) COMP-3  VALUE +0.
           05      TOTCHG              PIC S9(05) COMP-3  VALUE +0.
           05      TOTMEM              PIC S9(05) COMP-3  VALUE +0.
           05      BATADD              PIC S9(03) COMP-3  VALUE +0.
           05      BATCHG              PIC S9(03) COMP-3  VALUE +0.
           05      BATMEM              PIC S9(03) COMP-3  VALUE +0.
           05      CTLDOC              PIC S9(03) COMP-3  VALUE +0.
           05      CURDAT-SAV          PIC S9(07) COMP-3  VALUE +0.
           05      ERRREC              PIC S9(05) COMP-3  VALUE +0.
           05      ERRMEM              PIC S9(05) COMP-3  VALUE +0.
           05      WRNREC              PIC S9(05) COMP-3  VALUE +0.
           05      MBHCNT              PIC S9(07) COMP-3  VALUE +0.
           05      TOTBAT              PIC S9(03) COMP-3  VALUE +0.
           05      NUMMDT              PIC S9(05) COMP-3  VALUE +0.
           05      TIRHLD              PIC  X(01)  VALUE SPACE.
           05      DOCNUM              PIC  X(15)  VALUE SPACES.
           05      SW-FULLUP-ERROR     PIC  X(01).
             88    FULLUP-ERROR                    VALUE 'Y'.
           05      FSTWRN              PIC  X(01)  VALUE 'Y'.
            88     FIRST-WARNING                   VALUE 'Y'.
           05      WS-MAXPCT           PIC S9(02)  VALUE ZEROES.
           05      WS-FEEACT           PIC S9(05)  VALUE ZEROES.
           05      WS-MEDACT           PIC S9(05)  VALUE ZEROES.
           05      WS-PPSACT           PIC S9(05)  VALUE ZEROES.
           05      WS-SPSACT           PIC S9(05)  VALUE ZEROES.
           05      WS-SFEACT           PIC S9(05)  VALUE ZEROES.
           05      WS-SMDACT           PIC S9(05)  VALUE ZEROES.
           05      WS-EDPACT           PIC S9(05)  VALUE ZEROES.
           05      WS-ESBACT           PIC S9(05)  VALUE ZEROES.
           05      WS-EBYACT           PIC S9(05)  VALUE ZEROES.
           05      WS-DEPACT           PIC S9(05)  VALUE ZEROES.
           05      WS-MEMACT           PIC S9(05)  VALUE ZEROES.
           05      WS-ENBACT           PIC S9(05)  VALUE ZEROES.
           05      WS-MESACT           PIC S9(05)  VALUE ZEROES.
           05      WS-ENSACT           PIC S9(05)  VALUE ZEROES.
           05      WS-SUBACT           PIC S9(05)  VALUE ZEROES.
           05      WS-FLG-EEWBYP       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-FEETAB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-MEDTAB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBPCP       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBSEC       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBFEE       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBMED       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-EEWDEP       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-EEWSUB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-DEPTAB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-MEMTAB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-ENBTAB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBMEM       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBENB       PIC  X(01)  VALUE 'N'.
           05      WS-FLG-SUBTAB       PIC  X(01)  VALUE 'N'.
           05      WS-EMLEID           PIC  X(20)  VALUE SPACES.
           05      MEEMAS-EXISTS       PIC  X(01)  VALUE 'N'.
           05      SW-SEARCH-OK        PIC X(01)   VALUE 'N'.
            88     SEARCH-OK                       VALUE 'Y'.
           05      WS-BTHSEQ           PIC S9(02)  VALUE +0.
           05      WS-BTHSEQ1          PIC S9(02)  VALUE +0.
           05      WS-BTHDAT           PIC  9(08)  VALUE 0.
           05      TINDX               PIC S9(05) COMP-3  VALUE +0.
           05      INDTMP              PIC S9(05) COMP-3  VALUE +0.
           05      INDK                PIC  9(03)  VALUE ZEROS.
           05      SW-SET-ERROR        PIC  X(01)        VALUE 'N'.
               88     SET-ERROR                          VALUE 'Y'.
           05      SW-SEQ-USED         PIC  X(01)        VALUE 'Y'.
            88     SEQ-USED                              VALUE 'Y'.
           05      WS-VERSID           PIC  X(06)  VALUE SPACES.
           05      WS-FULLUP           PIC  X(01)  VALUE SPACES.
           05      WS-CNFCOD-FLG       PIC  X(01)  VALUE SPACES.
           05      SW-FST-REC          PIC  X(01)        VALUE 'Y'.
            88     FST-REC                               VALUE 'Y'.
            88     NOT-FST-REC                           VALUE 'N'.
           05      WS-SAV-SEQNUM       PIC S9(03) COMP-3  VALUE +0.
           05      WS-SAV-MEMSEQ       PIC S9(13) COMP-3  VALUE +0.
           05      WS-SAV-TRNSEQ       PIC S9(03) COMP-3  VALUE +0.
           05      WS-SEQNUM           PIC S9(03) COMP-3  VALUE +0.
           05      WS-TRNSEQ           PIC S9(03) COMP-3  VALUE +0.
           05      WS-ENRSTA           PIC  X(01)        VALUE ' '.
           05      WS-EXCHNG           PIC  X(02)        VALUE ' '.
           05      WS-EXC-BRANCD       PIC  X(02)        VALUE ' '.
           05      WS-EXC-BATDAT       PIC S9(07)        VALUE  +0.
           05      WS-EXC-BATSEQ       PIC S9(03)        VALUE  +0.
           05      WS-EXC-SEQNUM       PIC S9(03)        VALUE  +0.
           05      WS-EXC-LINENO       PIC S9(03)        VALUE  +0.
           05      WS-EXC-MEMSEQ       PIC S9(13) COMP-3  VALUE +0.
           05      WS-EXCSEQ           PIC S9(03) COMP-3  VALUE +0.
           05      FIRST-DT3-REC       PIC  X(01)        VALUE ' '.
           05      WS-EXC-SUB          PIC  X(01)        VALUE 'N'.
            88     EXCHANGE-SUBSCRIBER                   VALUE 'Y'.
           05      EXC-MEMSEQ          PIC S9(13) COMP-3  VALUE +0.
           05      EXC-TRNSEQ          PIC S9(03) COMP-3  VALUE +0.
           05      EXC-MEMBNO          PIC  X(15)        VALUE ' '.
           05      WS-DEP-REC          PIC  X(01)        VALUE 'N'.
            88     DEP-REC-FOUND                         VALUE 'Y'.
           05      WS-DT3-GRPNUM       PIC  X(06) VALUE SPACES.
           05      WS-DT3-SUBSNO       PIC  X(15) VALUE SPACES.
           05      WS-DT3-RELTYP       PIC  X(02) VALUE SPACES.
           05      WS-DT3-RELCOD       PIC  X(01) VALUE SPACES.
           05      WS-DT3-MEMBNO       PIC  X(15) VALUE SPACES.
           05      WS-DT3-BTHDAT       PIC  X(08) VALUE SPACES.
           05      WS-DT3-SEXCOD       PIC  X(01) VALUE SPACES.
           05      WS-DT3-CHGTYP       PIC  X(01) VALUE SPACES.
           05      WS-DT3-EXCMEM       PIC  X(10) VALUE SPACES.
           05      WS-DT3-EXCSUB       PIC  X(10) VALUE SPACES.
           05      WS-DT3-PRVSUB       PIC  X(15) VALUE SPACES.
           05      WS-DT3-SMKCES       PIC  X(01) VALUE SPACES.
           05      WS-DT3-OPYAMT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-OPYEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-OPYEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-OPYSRC       PIC  X(15) VALUE SPACES.
           05      WS-ACCTNO           PIC  X(15) VALUE SPACES.
           05      WS-ACCTN2           PIC  X(15) VALUE SPACES.
           05      WS-TB3CNT           PIC  9(02) VALUE ZEROES.
           05      WS-EEWTB3           OCCURS 15 TIMES.
            10     WS-TB3-OPYAMT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-OPYEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-OPYEXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-OPYSRC       PIC  X(15) VALUE SPACES.
            10     WS-TB3-APTAMT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-APTEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-APTEXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-CSRAMT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-CSREFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-CSREXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-PREAMT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-PREEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-PREEXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-RSPTOT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-RSPEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-RSPEXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-PRETOT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-PTOEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-PTOEXP       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-EMPTOT       PIC S9(08)V99 VALUE ZEROES.
            10     WS-TB3-EMPEFF       PIC  9(08) VALUE ZEROES.
            10     WS-TB3-EMPEXP       PIC  9(08) VALUE ZEROES.
           05      WS-DT3-APTAMT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-APTEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-APTEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-CSRAMT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-CSREFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-CSREXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-PREAMT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-PREEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-PREEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-RSPTOT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-RSPEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-RSPEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-PRETOT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-PTOEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-PTOEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-EMPTOT       PIC S9(08)V99 VALUE ZEROES.
           05      WS-DT3-EMPEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-EMPEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-REACAT       PIC  X(20) VALUE SPACES.
           05      WS-DT3-CANEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-TRMEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT2-HLTCOD       PIC  X(01) VALUE SPACES.
           05      WS-DT1-MEMEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT1-MEMEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT1-MEMTRM       PIC  X(04) VALUE SPACES.
           05      WS-SAV-MEMEXP       PIC S9(07) VALUE ZEROES.
           05      WS-SAV-MEMEFF       PIC S9(07) VALUE ZEROES.
           05      WS-TRMSUB           PIC  X(01) VALUE 'N'.
           05      WS-TRMDEP           PIC  X(01) VALUE 'N'.
           05      WS-PRVSUB           PIC  X(15) VALUE SPACES.
           05      WS-DT1-SUB          PIC  X(15) VALUE SPACES.
           05      WS-DT1-GRP          PIC  X(06) VALUE SPACES.
           05      WS-SUBFND           PIC  X(01) VALUE SPACES.
           05      WS-SUB-EXCSUB       PIC  X(10) VALUE SPACES.
           05      WS-SUB-PRVSUB       PIC  X(15) VALUE SPACES.
           05      WS-DT3-RATARA       PIC  X(07) VALUE SPACES.
           05      WS-DT3-RATEFF       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-RATEXP       PIC S9(07) VALUE ZEROES.
           05      WS-DT3-EXCPOL       PIC  X(15) VALUE SPACES.
           05      WS-DT3-ASSQHP       PIC  X(16) VALUE SPACES.
           05      WS-DT3-SHPGRP       PIC  X(15) VALUE SPACES.
           05      WS-DT3-PYMTID       PIC  X(13) VALUE SPACES.
           05      GENSAV              PIC  9(03) VALUE 0.
           05      MEMEXD-EXIST        PIC  X(01) VALUE SPACES.
           05      MEMEXT-TYP          PIC  X(03) VALUE SPACES.
            88     SUB-CHG                        VALUE 'SUB'.
            88     DEP-CHG                        VALUE 'DEP'.
           05      WS-DT2-EXCHNG       PIC  X(02) VALUE SPACES.
           05      WS-DT2-ENRTYP       PIC  X(02) VALUE SPACES.
           05      WS-DT2-CHGTYP       PIC  X(01) VALUE SPACES.
           05      WS-DT2-ASSQHP       PIC  X(16) VALUE SPACES.
           05      WS-DT2-GRPNUM       PIC  X(06) VALUE SPACES.
           05      WS-DT2-EXCSUB       PIC  X(10) VALUE SPACES.
           05      WS-DT2-EXCMEM       PIC  X(10) VALUE SPACES.
           05      LAST-SUBSCRIBER     PIC  X(15) VALUE SPACES.
           05      LAST-MEMBER         PIC  X(15) VALUE SPACES.
           05      LAST-CHGTYP         PIC  X(01) VALUE SPACES.
           05      SW-CREATE-NEW-MBH   PIC  X(01) VALUE SPACES.
                88 CREATE-NEW-MBHMAS              VALUE 'Y'.
           05      WS-EXCSUB-FOUND     PIC  X(01) VALUE 'N'.
                88 EXCSUB-NOT-FOUND               VALUE 'N'.
                88 EXCSUB-FOUND                   VALUE 'Y'.
           05      WS-EXCSUB-HOLD      PIC  X(10) VALUE SPACES.
           05      TMP-GRPNUM          PIC  X(06).
           05      TMP-MEMBNO          PIC  X(15).
           05      TMP-RELCOD          PIC  X(02).
           05      TMP-SUBSNO          PIC  X(15).
           05      CHK-SUB             PIC  X(01).
           05      CHK-DEP             PIC  X(01).
           05      WS-REACAT1          PIC  X(20).
           05      WS-TRMEFF1          PIC  X(08).
           05      WS-CANEFF1          PIC  X(08).
           05      WS-APLORG1          PIC  X(18).
           05      WS-REACAT2          PIC  X(20).
           05      WS-BATCNT           PIC  9(03)         VALUE ZEROS.
           05      WS-PEMMAS           PIC  X(01).
           05      PDTHRU-HOLD         PIC  9(07).
           05      PDTHRU-TEMP         PIC  9(07).
           05      WS-STATCD           PIC  X(02) VALUE SPACES.
           05      WS-MEMSEQ1          PIC S9(13) VALUE ZEROES.
           05      WS-TRNSEQ1          PIC S9(03) VALUE ZEROES.
           05      WS-RCV-APTAMT       PIC  X(01) VALUE SPACES.
           05      WS-MONTH            PIC  9(02).
           05      WS-PTDATE.
            10     CYY                 PIC S9(03).
            10     FILLER REDEFINES CYY.
               15  CC                  PIC S9(01).
               15  YY                  PIC S9(02).
            10     MM                  PIC S9(02).
            10     DD                  PIC S9(02).
           05      WS-PTDATE-N REDEFINES WS-PTDATE  PIC S9(07).
           05      WS-LEAP-DATE.
            10     CYY                 PIC S9(03).
            10     FILLER REDEFINES CYY.
               15  CC                  PIC S9(01).
               15  YY                  PIC S9(02).
            10     MM                  PIC S9(02).
            10     DD                  PIC S9(02).
           05      WS-DATE             PIC  X(08).
           05      LICENSE-125573       PIC  X(01) VALUE 'N'.
             88    LICENSE-FOR-125573              VALUE 'Y'.
           05      WRKGRP              PIC  X(06)  VALUE SPACES.
           05      WRKACT              PIC  X(15)  VALUE SPACES.
           05      WRKMEM              PIC  X(15)  VALUE SPACES.
           05      WRKPKG              PIC  X(04)  VALUE SPACES.
           05      WRKEFF              PIC S9(07) COMP-3 VALUE +0.
           05      WRKEXP              PIC S9(07) COMP-3 VALUE +0.
      ****----------------------------------------------------------
      ****  CR138310  AHG  FIX
      ****----------------------------------------------------------
           05      WS-CORFND           PIC  X(01) VALUE 'N'.
           05      WS-CORGAP           PIC S9(09) COMP-3 VALUE +0.
           05      WS-CORTRN           PIC S9(11) COMP-3 VALUE +0.
           05      WS-COREXP           PIC S9(07) COMP-3 VALUE +0.

       01  WS-SAV-MDTMAS.
           05      SAV-OPYAMT          PIC  S9(08)V99 VALUE ZEROES.
           05      SAV-APTAMT          PIC  S9(08)V99 VALUE ZEROES.
           05      SAV-PRETOT          PIC  S9(08)V99 VALUE ZEROES.
           05      BKP-MDTMAS          PIC  X(2000) VALUE SPACES.
           05      SAV-MDTMAS.
            10     BRANCD              PIC  X(02) VALUE SPACES.
            10     BATDAT              PIC S9(07) COMP-3 VALUE +0.
            10     BATSEQ              PIC S9(03) COMP-3 VALUE +0.
            10     SEQNUM              PIC S9(03) COMP-3 VALUE +0.
            10     LINENO              PIC S9(03) COMP-3 VALUE +0.
            10     FILLER              PIC  X(2000) VALUE SPACES.
      *
       01  EEW-BYP-LINK.
           05      EBLMAX              PIC S9(05) COMP-3 VALUE +196.
           05      EBLLST              PIC S9(05) COMP-3 VALUE +196.
           05      EBLACT              PIC S9(05) COMP-3 VALUE +0.
           05      EBLLNK OCCURS 196 TIMES INDEXED BY LNKINX.
            10     TBLLNK              PIC  X(01).
+               88 LNK-SUB-ENTRY                   VALUE 'S'.
                88 LNK-DEP-ENTRY                   VALUE 'D'.
            10     TBLSEQ              PIC S9(05).

       01  EEW-BYP-TABLE.
           05      EBYMAX              PIC S9(05) COMP-3 VALUE +196.
           05      EBYLST              PIC S9(05) COMP-3 VALUE +196.
           05      EBYACT              PIC S9(05) COMP-3 VALUE +0.
           COPY EEWMASRF OF QLBLSRC
                REPLACING ==01  EEWMAS-REC==  BY ==05  FILLER==
                          ==01  EEWHDR-REC==  BY ==05  FILLER==
                          ==01  EEWDT3-REC.== BY
                          ==05      EEWBY3                 OCCURS 196.==
                          ==01  EEWDET-REC.== BY
                          ==05      EEWBYP                 OCCURS 196.==
                          ==01  EEWDT2-REC.== BY
                           ==10      ERRMEM              PIC  X(01).
                               05      EEWBY2            OCCURS 196
                                       INDEXED BY EEWBYX.==
                          ==01  EEWTRL-REC==  BY ==05  FILLER==
                          == 05 ==        BY == 10 ==
                          == 10 ==        BY == 15 ==.
      /
           COPY EEWMASRF OF QLBLSRC
                REPLACING ==EEWMAS-REC==  BY ==FILLER==
                          ==EEWHDR-REC==  BY ==FILLER==
                          ==EEWDET-REC==  BY ==EEWDET-WRK==
                          ==EEWDT2-REC==  BY ==EEWDT2-WRK==
                          ==EEWDT3-REC==  BY ==EEWDT3-WRK==
                          ==EEWTRL-REC==  BY ==FILLER==.
      /
       01  EEW-DEP-TABLE.
           05      EDPMAX              PIC S9(05) COMP-3 VALUE +98.
           05      EDPLST              PIC S9(05) COMP-3 VALUE +98.
           05      EDPACT              PIC S9(05) COMP-3 VALUE +0.
           COPY EEWMASRF OF QLBLSRC
                REPLACING ==01  EEWMAS-REC==  BY ==05  EEWMAS-WRK==
                          ==01  EEWHDR-REC==  BY ==05  EEWHDR-WRK==
                          ==01  EEWDET-REC.== BY
                             ==05      EEWDEP                 OCCURS 98
                                       INDEXED BY EEWINX.==
                          ==01  EEWDT2-REC.== BY
                           ==10      ERRMEM              PIC  X(01).
                               05      EEWDP2                 OCCURS 98
                                       INDEXED BY EEWM2X.==
                          ==01  EEWDT3-REC.== BY
                             ==05      EEWDP3                 OCCURS 98
                                       INDEXED BY EEWM3X.==
                          ==01  EEWTRL-REC==  BY ==05  EEWTRL-WRK==
                          == 05 ==        BY == 10 ==
                          == 10 ==        BY == 15 ==.
      /
       01  EEW-SUB-TABLE.
           05      ESBMAX              PIC S9(05) COMP-3 VALUE +98.
           05      ESBLST              PIC S9(05) COMP-3 VALUE +98.
           05      ESBACT              PIC S9(05) COMP-3 VALUE +0.
           COPY EEWMASRF OF QLBLSRC
                REPLACING ==01  EEWMAS-REC==  BY ==05  FILLER==
                          ==01  EEWHDR-REC==  BY ==05  FILLER==
                          ==01  EEWDET-REC.== BY
                          ==05      EEWSUB                 OCCURS 98.==
                          ==01  EEWDT2-REC.== BY
                           ==10      ERRMEM              PIC  X(01).
                               05      EEWSB2                 OCCURS 98
                                       INDEXED BY EEWS2X.==
                          ==01  EEWDT3-REC.== BY
                          ==05      EEWSB3                 OCCURS 98.==
                          ==01  EEWTRL-REC==  BY ==05  FILLER==
                          == 05 ==        BY == 10 ==
                          == 10 ==        BY == 15 ==.
      /
       01  SUB-INFO.
           05      SUBSNO              PIC  X(15).
           05      MEMEFF              PIC S9(07) COMP-3   VALUE +0.
           05      MEMEXP              PIC S9(07) COMP-3   VALUE +0.
           05      GRPNUM              PIC  X(06).
           05      SEQNUM              PIC  9(03)        VALUE ZEROES.

       01  FLAGS.
           05      EEWMAS-ERROR        PIC  X(01)        VALUE 'N'.
              88   EEW-ERROR                             VALUE 'Y'.
           05      SW-EEWMAS-END       PIC  X(01)        VALUE ' '.
              88   EEW-END                               VALUE 'Y'.
           05      FAMILY-FLAG         PIC  X(01)        VALUE 'N'.
              88   FAMILY-ERROR                          VALUE 'Y'.
           05      FIRST-REC-FLAG      PIC  X(01)        VALUE 'Y'.
              88   FIRST-RECORD                          VALUE 'Y'.
           05      EXIST-FLAG          PIC  X(01)        VALUE ' '.
              88   MEM-EXISTS                            VALUE 'Y'.
           05      GEN-FLAG            PIC  X(01)        VALUE ' '.
              88   GENERATED                             VALUE 'Y'.
           05      MBH-FLAG            PIC  X(01)        VALUE 'Y'.
              88   FIRST-MBH                             VALUE 'Y'.
           05      ACCT-FLAG           PIC  X(01)        VALUE ' '.
              88   SUBACCT-CHG                           VALUE 'Y'.
           05      DEMCHG-FLAG         PIC  X(01)        VALUE ' '.
              88   DEMMAS-CHANGE                         VALUE 'Y'.
           05      CPACHG-FLAG         PIC  X(01)        VALUE ' '.
              88   CPAMAS-CHANGE                         VALUE 'Y'.
           05      DEMEXT-FLAG         PIC  X(01)        VALUE ' '.
              88   DEMEXT-CHANGE                         VALUE 'Y'.
           05      RSPPTY-FLAG         PIC  X(01)        VALUE ' '.
              88   RSPPTY-CHANGE                         VALUE 'Y'.
           05      EXTBEN-FLAG         PIC  X(01)        VALUE ' '.
              88   EXTBEN-CHANGE                         VALUE 'Y'.
           05      ALTADR-FLAG         PIC  X(01)        VALUE ' '.
              88   ALTADR-CHANGE                         VALUE 'Y'.
           05      ALTADR-FOUND        PIC  X(01)        VALUE ' '.
           05      MCDCHG-FLAG         PIC  X(01)        VALUE ' '.
              88   MCDMAS-CHANGE                         VALUE 'Y'.
           05      EXCMEM-FLAG         PIC  X(01)        VALUE ' '.
              88   EXCMEM-CHANGE                         VALUE 'Y'.
           05      WS-ADD-EXCMEM       PIC  X(01)        VALUE ' '.
              88   ADD-EXCMEM                            VALUE 'Y'.
           05      MCRCHG-FLAG         PIC  X(01)        VALUE ' '.
           05      HLDCOD-FLAG         PIC  X(01)        VALUE ' '.
              88   HLDCOD-FOUND                          VALUE 'Y'.
           05      TIER-FLAG           PIC  X(01)        VALUE ' '.
              88   SUB-TIRCHG                            VALUE 'Y'.
           05      BEN-FLAG            PIC  X(01)        VALUE ' '.
              88   BEN-FOUND                             VALUE 'Y'.
           05      RECTYP-FLAG         PIC  X(01)        VALUE ' '.
              88   DEP-RECORD                            VALUE 'D'.
              88   SUB-RECORD                            VALUE 'S'.
           05      PCP-FLAG            PIC  X(01)        VALUE ' '.
              88   PCP-FOUND                             VALUE 'Y'.
           05      GROUP-FLAG          PIC  X(01)        VALUE ' '.
              88   GROUP-ERROR                           VALUE 'Y'.
           05      SW-FIRSTERROR       PIC  X(01)        VALUE 'Y'.
               88     FIRSTERROR                         VALUE 'Y'.
           05      SW-FIRSTWRN         PIC  X(01)        VALUE 'Y'.
               88     FIRSTWRN                           VALUE 'Y'.
           05      SW-NEWRECORD        PIC  X(01)        VALUE 'N'.
               88     NEW-RECORD                         VALUE 'Y'.
           05      SW-NEWRECORD-WRN    PIC  X(01)        VALUE 'N'.
               88     NEW-RECORD-WRN                     VALUE 'Y'.
           05      SW-MEMBER-ERROR     PIC  X(01)        VALUE 'Y'.
               88     MEMBER-ERROR                       VALUE 'Y'.
           05      SW-RPT-FLAG         PIC  X(01)        VALUE 'N'.
               88     RPT-END                            VALUE 'Y'.
           05      FIRSTREC-FLAG       PIC  X(01)        VALUE 'Y'.
               88     FIRST-REC                          VALUE 'Y'.
           05      MDT-FLAG            PIC  X(01)        VALUE 'N'.
               88     MDT-ADDED                          VALUE 'Y'.
           05      SEQ-FLAG            PIC  X(01)        VALUE 'N'.
               88     SEQ-ADDED                          VALUE 'Y'.
           05      REC-FLAG            PIC  X(01)        VALUE 'N'.
               88     MDT-EXISTS                         VALUE 'Y'.
           05      PRCSEQ-FLAG         PIC  X(01)        VALUE 'N'.
               88     PRCSEQ-UPDATED                     VALUE 'Y'.
           05      DEP-EXIST-FLAG      PIC  X(01)        VALUE 'N'.
               88     DEP-EXISTS                         VALUE 'Y'.
               88     DEP-NOTEXISTS                      VALUE 'N'.
           05      SUB-FLAG            PIC  X(01)        VALUE 'N'.
               88     SUB-NUMBER                         VALUE 'Y'.
           05      SW-SUBADD-FLAG      PIC  X(01)        VALUE 'N'.
               88     SUB-ADDED                          VALUE 'Y'.
           05      WRITTEN-FLAG        PIC  X(01)        VALUE 'N'.
               88     REC-WRITTEN                        VALUE 'Y'.
           05      PRV-FLAG            PIC  X(01)        VALUE 'N'.
               88     PCP-CHANGE                         VALUE 'Y'.
           05      FEE-FLAG            PIC  X(01)        VALUE 'N'.
               88     FEE-CHANGE                         VALUE 'Y'.
           05      ENB-FLAG            PIC  X(01)        VALUE 'N'.
               88     ENB-CHANGE                         VALUE 'Y'.
           05      FIRST-LINE-FLAG     PIC  X(01)        VALUE 'N'.
               88     FIRST-LINE                         VALUE 'Y'.
           05      PCPTRM-FLAG         PIC  X(01)        VALUE 'N'.
               88     PCPTRM-USED                        VALUE 'Y'.
               88     PCPTRM-NOT-USED                    VALUE 'N'.
           05      FEETRM-FLAG         PIC  X(01)        VALUE 'N'.
               88     FEETRM-USED                        VALUE 'Y'.
               88     FEETRM-NOT-USED                    VALUE 'N'.
           05      CHGSUB-FLAG         PIC  X(01)        VALUE 'N'.
              88   ADD-CHG-SAME                          VALUE 'Y'.
           05      SUB-EXIST-FLAG      PIC  X(01)        VALUE ' '.
              88   SUB-MHS-EXISTS                        VALUE 'H'.
              88   SUBADD-MDT-EXISTS                     VALUE 'M'.
           05      MEM-EXIST-FLAG      PIC  X(01)        VALUE ' '.
              88   MEM-MHS-EXISTS                        VALUE 'E'.
              88   MEMADD-MDT-EXISTS                     VALUE 'D'.
           05      WS-IO-RESULT        PIC  9(04)-       VALUE ZERO.
           05      WS-EFFDAT           PIC S9(07) COMP-3 VALUE ZERO.
           05      WS-EXPDAT           PIC S9(07) COMP-3 VALUE ZERO.
      *
       01  WS-SAVE-REC                 PIC X(2500) VALUE SPACES.
      *
       01  MESSAGE-TABLE.
           05      MSGMAX              PIC S9(03)  VALUE 8.
           05      MSGTX1              PIC X(504).
           05      FILLER REDEFINES MSGTX1.
            10     MSGTXT              OCCURS 8
                                       PIC  X(63).
      *
       01  MEMERR-TABLE.
           05      ERRMAX              PIC S9(03)        VALUE 20.
           05      ERRLST              PIC S9(03)        VALUE +20.
           05      ERRACT              PIC S9(03)        VALUE +0.
           05      ERRTAB OCCURS 20 TIMES INDEXED BY ERRINX.
            10     MEMBNO              PIC  X(15).
      *
      *‚TABLES ALL DEPENDENTS IN THE EEWMAS FILE FOR EACH
      *‚GROUP/SUB COMBINATION
      *
      *‚TABLES SUBSCRIBER EEWMAS RECORDS FOR EACH GROUP/SUB COMBINATION
      *
       01  MDT-TABLE.
           05      MDTMAX              PIC S9(05) COMP-3 VALUE +09.
           05      MDTLST              PIC S9(05) COMP-3 VALUE +0.
           05      MDTACT              PIC S9(05) COMP-3 VALUE +0.
           COPY MDTMASRF OF QLBLSRC
                REPLACING
                    ==01  MDTMAS-REC.== BY
                    ==05      MDTTAB                 OCCURS 09.==
                    ==05      MDTMAS-KEY==  BY ==10      FILLER==
                    ==05      MDTMAS-UNQ==  BY ==10      FILLER==
                    ==05      MDTMAS-SQR==  BY ==10      FILLER==
                    == 05 ==                BY == 10 ==
                    == 10 ==                BY == 15 ==
                    == 15 ==                BY == 20 ==.
      /
       01  EETDEP-TABLE.
           05      ETDMAX              PIC S9(05) COMP-3 VALUE +98.
           05      ETDLST              PIC S9(05) COMP-3 VALUE +98.
           05      ETDACT              PIC S9(05) COMP-3 VALUE +0.
           COPY DDS-ALL-FORMATS OF EETMAS
                REPLACING
                      ==05  EETMAS-RECORD PIC X(3008).== BY == ==
                      ==REETMAS       REDEFINES EETMAS-RECORD.== BY
                             ==EETDEP                 OCCURS 98.==
                          ==EETUNQ==   BY ==FILLER==
                          ==EETSQR==   BY ==FILLER==.
      /
       01  EETSUB-TABLE.
           05      ETSMAX              PIC S9(05) COMP-3 VALUE +98.
           05      ETSLST              PIC S9(05) COMP-3 VALUE +98.
           05      ETSACT              PIC S9(05) COMP-3 VALUE +0.
           COPY DDS-ALL-FORMATS OF EETMAS
                REPLACING
                      ==05  EETMAS-RECORD PIC X(3008).== BY == ==
                      ==REETMAS       REDEFINES EETMAS-RECORD.== BY
                             ==EETSUB                 OCCURS 98.==
                          ==EETUNQ==   BY ==FILLER==
                          ==EETSQR==   BY ==FILLER==.
      /
       01  DEP-TABLE.
           05      DEPMAX              PIC S9(05) COMP-3  VALUE +98.
           05      DEPLST              PIC S9(05) COMP-3  VALUE +98.
           05      DEPACT              PIC S9(05) COMP-3  VALUE +0.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      **** 05      MEMMAX              PIC S9(05) COMP-3  VALUE +98.
      **** 05      MEMLST              PIC S9(05) COMP-3  VALUE +98.
           05      MEMMAX              PIC S9(05) COMP-3  VALUE +115.
           05      MEMLST              PIC S9(05) COMP-3  VALUE +115.
           05      MEMACT              PIC S9(05) COMP-3  VALUE +0.
           05      ENBMAX              PIC S9(05) COMP-3  VALUE +98.
           05      ENBACT              PIC S9(05) COMP-3  VALUE +0.
           05      PCPMAX              PIC S9(05) COMP-3  VALUE +98.
           05      PCPACT              PIC S9(05) COMP-3  VALUE +0.
           05      SECMAX              PIC S9(05) COMP-3  VALUE +98.
           05      SECACT              PIC S9(05) COMP-3  VALUE +0.
           05      FEEMAX              PIC S9(05) COMP-3  VALUE +98.
           05      FEEACT              PIC S9(05) COMP-3  VALUE +0.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      **** 05      MEDMAX              PIC S9(05) COMP-3  VALUE +98.
           05      MEDMAX              PIC S9(05) COMP-3  VALUE +115.
           05      MEDACT              PIC S9(05) COMP-3  VALUE +0.
       01  FILLER.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  FIX
      ****------------------------------------------------------------
      **** 05      LSTIDX              OCCURS 98.
           05      LSTIDX              OCCURS 115.
            10     ENBLST              PIC S9(05) COMP-3  VALUE +60.
            10     PCPLST              PIC S9(05) COMP-3  VALUE +60.
            10     SECLST              PIC S9(05) COMP-3  VALUE +60.
            10     FEELST              PIC S9(05) COMP-3  VALUE +60.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      ****  10     MEDLST              PIC S9(05) COMP-3  VALUE +60.
            10     MEDLST              PIC S9(05) COMP-3  VALUE +115.
      /
           COPY DEMMASRF OF QLBLSRC
                REPLACING
                    ==01  DEMMAS-REC.== BY
                    ==05      DEPTAB                 OCCURS 98.==
                    ==05      DEMMAS-KEY==  BY
                    ==10      MEMBNO              PIC  X(15).
                      10      ELMAIL              PIC  X(80).
                      10      GRPNUM              PIC  X(06).
                       10     FILLER==
                    == 05 ==                BY == 10 ==
                    == 10 ==                BY == 15 ==.
           COPY DEMEXTBTR OF QLBLSRC
                REPLACING
            ==01  DEMEXTBT-LM-PARMS.
                  05  DEMEXTBT-TBL.
                      10  DEMEXTBT-ROW     OCCURS 200 TIMES
                                           INDEXED BY DEMEXTBT-TNDX.==
                  BY ==10  DEPEXT.==
            ==15  MEMSEQ==             BY ==15  EXTSEQ==
            ==05  DEMEXTBT-REC         REDEFINES DEMEXTBT-TBL.==
                  BY ==10  FILLER               REDEFINES DEPEXT.==.
      /
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
       01  FILLER.
           COPY MEMMASRF OF QLBLSRC
                REPLACING
                    ==01  MEMMAS-REC.== BY
      ****          ==05      MEMTAB                 OCCURS 98.==
                    ==05      MEMTAB                 OCCURS 115.==
                    ==05      MEMMAS-KEY==  BY ==10      FILLER==
                    ==05      EFFDAT==      BY ==10      MEMEFF==
                    ==05      EXPDAT==      BY ==10      MEMEXP==
                    == 05 ==                BY == 10 ==
                    == 10 ==                BY == 15 ==.
      /
           COPY ENBMASRF OF QLBLSRC
                REPLACING
                    ==01  ENBMAS-REC.== BY
                    ==10      ENBTAB                 OCCURS 98.==
                    ==05      ENBMAS-KEY==  BY ==15      FILLER==
                    ==05      GRPNUM==      BY ==15      ENBGRP==
                    ==05      MEMBNO==      BY ==15      ENBMEB==
                    ==05      RELCOD==      BY ==15      ENBREL==
                    ==05      SUBSNO==      BY ==15      ENBSUB==
                    ==05      EXPDAT==      BY ==15      ENBEXP==
                    == 10     TRNSEQ==      BY == 20     ENBTRN==
                    ==05      EFFDAT==      BY ==15      ENBEFF==
                    ==05      MEMSEQ==      BY ==15      ENBSEQ==
                    == 05 ==                BY == 15 ==
                    == 10 ==                BY == 20 ==
                    == 15 ==              BY == 25 ==.
            10     PCPTAB              OCCURS 98.
             15    PCPGRP              PIC  X(06).
             15    PCPMEM              PIC  X(15).
             15    PCPEXP              PIC S9(07)          COMP-3.
             15    PCPTRN              PIC S9(11)          COMP-3.
             15    PCPEFF              PIC S9(07)          COMP-3.
             15    PCPSEQ              PIC S9(07)          COMP-3.
             15    PRVORG              PIC  X(04).
             15    PROVNO              PIC  X(15).
             15    PCPOVR              PIC  X(01).
             15    MEMCAP              PIC  X(03).
            10     SECTAB              OCCURS 98.
             15    SECGRP              PIC  X(06).
             15    SECMEM              PIC  X(15).
             15    SECEXP              PIC S9(07)          COMP-3.
             15    SECTRN              PIC S9(11)          COMP-3.
             15    SECEFF              PIC S9(07)          COMP-3.
             15    SECSEQ              PIC S9(07)          COMP-3.
             15    PRVORG              PIC  X(04).
             15    PROVNO              PIC  X(15).
             15    SECOVR              PIC  X(01).
             15    MEMCAP              PIC  X(03).
            10     FEETAB              OCCURS 98.
             15    FEEGRP              PIC  X(06).
             15    FEEMEM              PIC  X(15).
             15    FEEEXP              PIC S9(07)          COMP-3.
             15    FEETRN              PIC S9(11)          COMP-3.
             15    FEEEFF              PIC S9(07)          COMP-3.
             15    FEESEQ              PIC S9(07)          COMP-3.
             15    FEECOD              PIC  X(03).
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      ****  10     MEDTAB              OCCURS 98.
            10     MEDTAB              OCCURS 115.
             15    MEDGRP              PIC  X(06).
             15    MEDMEM              PIC  X(15).
             15    MEDEXP              PIC S9(07)          COMP-3.
             15    MEDTRN              PIC S9(11)          COMP-3.
             15    MEDEFF              PIC S9(07)          COMP-3.
             15    MEDSEQ              PIC S9(07)          COMP-3.
             15    MEDCTY              PIC  X(06).
             15    MEDSTS              PIC  X(02).
      /
       01  SUB-TABLE.
           05      SUBMAX              PIC S9(05) COMP-3  VALUE +5.
           05      SUBLST              PIC S9(05) COMP-3  VALUE +5.
           05      SUBACT              PIC S9(05) COMP-3  VALUE +0.
           05      MESACT              PIC S9(05) COMP-3  VALUE +0.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      **** 05      MESMAX              PIC S9(05) COMP-3  VALUE +200.
      **** 05      MESLST              PIC S9(05) COMP-3  VALUE +200.
           05      MESMAX              PIC S9(05) COMP-3  VALUE +115.
           05      MESLST              PIC S9(05) COMP-3  VALUE +115.
           05      ENSMAX              PIC S9(05) COMP-3  VALUE +250.
           05      ENSACT              PIC S9(05) COMP-3  VALUE +0.
           05      PPSMAX              PIC S9(05) COMP-3  VALUE +200.
           05      PPSACT              PIC S9(05) COMP-3  VALUE +0.
           05      SPSMAX              PIC S9(05) COMP-3  VALUE +98.
           05      SPSACT              PIC S9(05) COMP-3  VALUE +0.
           05      SFEMAX              PIC S9(05) COMP-3  VALUE +98.
           05      SFEACT              PIC S9(05) COMP-3  VALUE +0.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      **** 05      SMDMAX              PIC S9(05) COMP-3  VALUE +98.
           05      SMDMAX              PIC S9(05) COMP-3  VALUE +115.
           05      SMDACT              PIC S9(05) COMP-3  VALUE +0.
           05      LSTIDX     OCCURS 250.
            10     ENSLST              PIC S9(05) COMP-3  VALUE +250.
            10     PPSLST              PIC S9(05) COMP-3  VALUE +200.
            10     SPSLST              PIC S9(05) COMP-3  VALUE +98.
            10     SFELST              PIC S9(05) COMP-3  VALUE +98.
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      ****  10     SMDLST              PIC S9(05) COMP-3  VALUE +98.
            10     SMDLST              PIC S9(05) COMP-3  VALUE +115.
      /
           COPY DEMMASRF OF QLBLSRC
                REPLACING
                    ==01  DEMMAS-REC.== BY
                    ==05      SUBTAB                 OCCURS 98.==
                    ==05      DEMMAS-KEY==  BY
                    ==10      MEMBNO              PIC  X(15).
                      10      GRPNUM              PIC  X(06).
                      10      ELMAIL              PIC  X(80).
                       10     FILLER==
                    == 05 ==                BY == 10 ==
                    == 10 ==                BY == 15 ==.
           COPY DEMEXTBTR OF QLBLSRC
                REPLACING
            ==01  DEMEXTBT-LM-PARMS.
                  05  DEMEXTBT-TBL.
                      10  DEMEXTBT-ROW     OCCURS 200 TIMES
                                           INDEXED BY DEMEXTBT-TNDX.==
                  BY ==10  SUBEXT.==
            ==15  MEMSEQ==             BY ==15  EXTSEQ==
            ==05  DEMEXTBT-REC         REDEFINES DEMEXTBT-TBL.==
                  BY ==10  FILLER               REDEFINES SUBEXT.==.
      /
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
           COPY MEMMASRF OF QLBLSRC
                REPLACING
                    ==01  MEMMAS-REC.== BY
      ****          ==05      SUBMEM                 OCCURS 98.==
                    ==05      SUBMEM                 OCCURS 115.==
                    ==05      MEMMAS-KEY==  BY ==10      FILLER==
                    ==05      EFFDAT==      BY ==10      MEMEFF==
                    ==05      EXPDAT==      BY ==10      MEMEXP==
                    == 05 ==                BY == 10 ==
                    == 10 ==                BY == 15 ==.
      /
           COPY ENBMASRF OF QLBLSRC
                REPLACING
                    ==01  ENBMAS-REC.== BY
                    ==10      SUBENB                 OCCURS 250.==
                    ==05      ENBMAS-KEY==  BY ==15      FILLER==
                    ==05      GRPNUM==      BY ==15      ENBGRP==
                    ==05      MEMBNO==      BY ==15      ENBMEB==
                    ==05      RELCOD==      BY ==15      ENBREL==
                    ==05      SUBSNO==      BY ==15      ENBSUB==
                    ==05      EXPDAT==      BY ==15      ENBEXP==
                    == 10     TRNSEQ==      BY == 20     ENBTRN==
                    ==05      EFFDAT==      BY ==15      ENBEFF==
                    ==05      MEMSEQ==      BY ==15      ENBSEQ==
                    == 05 ==                BY == 15 ==
                    == 10 ==                BY == 20 ==
                    == 15 ==              BY == 25 ==.
      /
            10     SUBPCP              OCCURS 200.
             15    PCPGRP              PIC  X(06).
             15    PCPMEM              PIC  X(15).
             15    PCPEXP              PIC S9(07)          COMP-3.
             15    PCPTRN              PIC S9(11)          COMP-3.
             15    PCPEFF              PIC S9(07)          COMP-3.
             15    PCPSEQ              PIC S9(07)          COMP-3.
             15    PRVORG              PIC  X(04).
             15    PROVNO              PIC  X(15).
             15    PCPOVR              PIC  X(01).
             15    MEMCAP              PIC  X(03).
            10     SUBSEC              OCCURS 98.
             15    SECGRP              PIC  X(06).
             15    SECMEM              PIC  X(15).
             15    SECEXP              PIC S9(07)          COMP-3.
             15    SECTRN              PIC S9(11)          COMP-3.
             15    SECEFF              PIC S9(07)          COMP-3.
             15    SECSEQ              PIC S9(07)          COMP-3.
             15    PRVORG              PIC  X(04).
             15    PROVNO              PIC  X(15).
             15    SECOVR              PIC  X(01).
             15    MEMCAP              PIC  X(03).
            10     SUBFEE              OCCURS 98.
             15    FEEGRP             PIC  X(06).
             15    FEEMEM              PIC  X(15).
             15    FEEEXP              PIC S9(07)          COMP-3.
             15    FEETRN              PIC S9(11)          COMP-3.
             15    FEEEFF              PIC S9(07)          COMP-3.
             15    FEESEQ              PIC S9(07)          COMP-3.
             15    FEECOD              PIC  X(03).
      ****-----------------------------------------------------------
      ****  CR140677  AHG  REP
      ****------------------------------------------------------------
      ****  10     SUBMED              OCCURS 98.
            10     SUBMED              OCCURS 115.
             15    MEDGRP              PIC  X(06).
             15    MEDMEM              PIC  X(15).
             15    MEDEXP              PIC S9(07)          COMP-3.
             15    MEDTRN              PIC S9(11)          COMP-3.
             15    MEDEFF              PIC S9(07)          COMP-3.
             15    MEDSEQ              PIC S9(07)          COMP-3.
             15    MEDCTY              PIC  X(06).
             15    MEDSTS              PIC  X(02).
      /
           COPY MDTMASRF OF QLBLSRC
                REPLACING
                    ==01  MDTMAS-REC. ==    BY  ==01      SUBMDT. ==
                    ==05      MDTMAS-KEY==  BY  ==05      KEYVAL  ==
                    ==05      FILLER==      BY  ==05      UNUSED  ==
                    ==05      MDTMAS-UNQ==  BY  ==05      FILLR1  ==
                    ==05      MDTMAS-SQR==  BY  ==05      FILLR2  ==.
      /
           COPY MDTMASRF OF QLBLSRC
                REPLACING
                    ==01  MDTMAS-REC. ==    BY  ==01      MEMMDT. ==
                    ==05      MDTMAS-KEY==  BY  ==05      KEYVAL  ==
                    ==05      FILLER==      BY  ==05      UNUSED  ==
                    ==05      MDTMAS-UNQ==  BY  ==05      FILLR1  ==
                    ==05      MDTMAS-SQR==  BY  ==05      FILLR2  ==.
      *
       01  PRNTDATA                    EXTERNAL.
           05  PRINT-CODE              PIC  9(02).
           05  PRINT-PROGRAM           PIC  X(08).
           05  PRINT-COUNT             PIC  9(03).
           05  FILLER                  PIC  X(132).
           05  FILLER                  PIC  X(132).
           05  PRNTH3                  PIC  X(132).
           05  FILLER                  PIC  X(132).
           05  FILLER                  PIC  X(132).
           05  PRT-LINE                PIC  X(132).
      *
       01  PRNTERROR                   EXTERNAL.
           05  ERROR-CODE              PIC  9(02).
           05  ERROR-PROGRAM           PIC  X(08).
           05  ERROR-COUNT             PIC  9(03).
           05  FILLER                  PIC  X(660).
           05  ERROR-LINE              PIC  X(132).
      *
       01  PRNTWARN                    EXTERNAL.
           05  WRN-CODE                PIC  9(02).
           05  WRN-PROGRAM             PIC  X(08).
           05  WRN-COUNT               PIC  9(03).
           05  FILLER                  PIC  X(660).
           05  WARNING-LINE            PIC  X(132).
      *
       01  PRINT-DATA.
           05      FILLER              PIC  9(02)      VALUE ZERO.
           05      FILLER              PIC  X(08)      VALUE 'ED201C'.
           05      FILLER              PIC  9(03)      VALUE ZERO.
           05  HEAD1.
             10    FILLER              PIC  X(44)      VALUE
                   '                                     E N R O'.
             10    FILLER              PIC  X(44)      VALUE
                   ' L L M E N T   U P D A T E   D E T E R M I N'.
             10    FILLER              PIC  X(44)      VALUE
                   ' A T I O N                                  '.
           05  HEAD2.
             10    FILLER              PIC  X(44)      VALUE
                   '                                            '.
             10    FILLER              PIC  X(44)      VALUE
                   '          D E T A I L   R E P O R T         '.
             10    FILLER              PIC  X(44)      VALUE
                   '                                            '.
           05  HEAD3.
             10    FILLER              PIC  X(07)      VALUE 'BATCH: '.
             10    BRANCD              PIC  X(02).
             10    FILLER              PIC  X(01)      VALUE SPACES.
             10    BATDAT              PIC  9(06).
             10    FILLER              PIC  X(01)      VALUE SPACES.
             10    BATSEQ              PIC  9(03).
             10    FILLER              PIC  X(112).
           05  HEAD4.
             10    FILLER              PIC  X(44)      VALUE
                   'SEQ  LINE  GROUP#  SUBSCRIBER #    R RT MEMB'.
             10    FILLER              PIC  X(44)      VALUE
                   'ER#         BTHDAT S NAME                   '.
             10    FILLER              PIC  X(44)      VALUE
                   '     TYPE                                   '.
           05  HEAD5                   PIC  X(132)     VALUE ALL '-'.
           05  LINE-P                  PIC  X(132)     VALUE SPACES.

       01  DET-LINE.
           05  SEQNUM                  PIC  9(02).
           05  FILLER                  PIC  X(03)      VALUE SPACES.
           05  LINENO                  PIC  9(03).
           05  FILLER                  PIC  X(03)      VALUE SPACES.
           05  GRPNUM                  PIC  X(06).
           05  FILLER                  PIC  X(02)      VALUE SPACES.
           05  SUBSNO                  PIC  X(15).
           05  FILLER                  PIC  X(01)      VALUE SPACES.
           05  RELCOD                  PIC  X(01).
           05  FILLER                  PIC  X(01).
           05  RELTYP                  PIC  X(02).
           05  FILLER                  PIC  X(01).
           05  MEMBNO                  PIC  X(15).
           05  FILLER                  PIC  X(01).
           05  BTHDAT                  PIC  9(06).
           05  FILLER                  PIC  X(01)      VALUE SPACES.
           05  SEXCOD                  PIC  X(01).
           05  FILLER                  PIC  X(01)      VALUE SPACES.
           05  NAMKEY                  PIC  X(27).
           05  FILLER                  PIC  X(01).
           05  CHGTYP                  PIC  X(06).
      *
       01  BATCH-LINE.
           05  TOTTYP                  PIC  X(15)      VALUE  SPACES.
           05  TYPADD                  PIC  X(06)      VALUE 'ADDS: '.
           05  TOTADD                  PIC  Z,ZZZ,ZZ9.
           05  FILLER                  PIC  X(03)      VALUE SPACES.
           05  TYPCHG                  PIC  X(09)      VALUE
                                             'CHANGES: '.
           05  TOTCHG                  PIC  Z,ZZZ,ZZ9.
           05  FILLER                  PIC  X(03)      VALUE SPACES.
           05  TYPMEM                  PIC  X(09)      VALUE
                                             'MEMBERS: '.
           05  TOTMEM                  PIC  ZZ,ZZZ,ZZ9.
           05  FILLER                  PIC  X(59)      VALUE SPACES.
      *
       01  ERROR-DATA.
           05      FILLER              PIC  9(02)      VALUE ZERO.
           05      FILLER              PIC  X(08)      VALUE 'ED201C'.
           05      FILLER              PIC  9(03)      VALUE ZERO.
           05  EHEAD1.
             10    FILLER              PIC  X(44)      VALUE
                   '                                     E N R O'.
             10    FILLER              PIC  X(44)      VALUE
                   ' L L M E N T   U P D A T E   D E T E R M I N'.
             10    FILLER              PIC  X(44)      VALUE
                   ' A T I O N                                  '.
           05  EHEAD2.
             10    FILLER              PIC  X(44)      VALUE SPACES.
             10    FILLER              PIC  X(44)      VALUE
                   '          E R R O R   R E P O R T           '.
             10    FILLER              PIC  X(44)      VALUE SPACES.
           05  EHEAD3.
             10    FILLER              PIC  X(44)      VALUE SPACES.
             10    FILLER              PIC  X(44)      VALUE SPACES.
             10    FILLER              PIC  X(44)      VALUE SPACES.
           05  EHEAD4.
             10    FILLER              PIC  X(44)      VALUE
                   'GROUP# SUBSCRIBER #    R MEMBER #        T F'.
             10    FILLER              PIC  X(44)      VALUE
                   'IELD VALUE     MESSAGE # MESSAGE            '.
             10    FILLER              PIC  X(44)      VALUE SPACES.
           05  EHEAD5                  PIC X(132)      VALUE ALL '-'.
           05  LINE-E                  PIC X(132)      VALUE SPACES.
      *
       01   ERR-LINE.
            10     GRPNUM              PIC  X(06).
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     SUBSNO              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     RELCOD              PIC  X(01)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     MEMBNO              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     CHGTYP              PIC  X(01)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     FIELDV              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     MSGNUM              PIC  X(07)      VALUE SPACES.
            10     FILLER              PIC  X(03)      VALUE SPACES.
            10     ERRMSG              PIC  X(63)      VALUE SPACES.

       01  ERRTOT-LINE.
           05      FILLER              PIC  X(14)      VALUE
                                            'TOTAL ERRORS: '.
           05      TOTERR              PIC  Z,ZZZ,ZZ9.
           05      FILLER              PIC  X(02)      VALUE SPACES.
           05      FILLER              PIC  X(09)      VALUE
                                            'RECORDS: '.
           05      ERRREC              PIC  Z,ZZZ,ZZ9.
           05      FILLER              PIC  X(02)      VALUE SPACES.
           05      FILLER              PIC  X(09)      VALUE
                                            'MEMBERS: '.
           05      ERRMEM              PIC  Z,ZZZ,ZZ9.
           05      FILLER              PIC  X(67)      VALUE SPACES.
      *
       01  WARN-DATA.
           05      FILLER              PIC  9(02)  VALUE 01.
           05      FILLER              PIC  X(08)  VALUE 'ED201C'.
           05      FILLER              PIC  9(03)  VALUE ZERO.
           05      HEAD1-E.
            10     FILLER              PIC  X(44)  VALUE
                   '                                     E N R O'.
            10     FILLER              PIC  X(44)  VALUE
                   'L L M E N T   U P D A T E   D E T E R M I N '.
            10     FILLER              PIC  X(44)  VALUE
                   ' A T I O N                                  '.
           05      HEAD2-E.
            10     FILLER              PIC  X(44)  VALUE SPACES.
            10     FILLER              PIC  X(44)  VALUE
                   '   W A R N I N G   R E P O R T              '.
            10     FILLER              PIC  X(44)  VALUE SPACES.
      *
           05      HEAD3-E.
            10     FILLER              PIC X(132)  VALUE SPACES.
           05      HEAD4-E.
             10    FILLER              PIC  X(44)  VALUE
                   'GROUP# SUBSCRIBER #    R MEMBER #        T F'.
             10    FILLER              PIC  X(44)  VALUE
                   'IELD VALUE     MESSAGE # MESSAGE            '.
             10    FILLER              PIC  X(44)  VALUE SPACES.
           05      HEAD5-E             PIC X(132)  VALUE ALL '-'.
           05      LINE-W              PIC X(132)      VALUE SPACES.
      *
       01   WRN-LINE.
            10     GRPNUM              PIC  X(06).
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     SUBSNO              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     RELCOD              PIC  X(01)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     MEMBNO              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     CHGTYP              PIC  X(01)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     FIELDV              PIC  X(15)      VALUE SPACES.
            10     FILLER              PIC  X(01)      VALUE SPACES.
            10     MSGNUM              PIC  X(07)      VALUE SPACES.
            10     FILLER              PIC  X(03)      VALUE SPACES.
            10     WRNMSG              PIC  X(63)      VALUE SPACES.
      *
       01  WRNTOT-LINE.
           05      FILLER              PIC  X(16)      VALUE
                                            'TOTAL WARNINGS: '.
           05      TOTWRN              PIC  Z,ZZZ,ZZ9.
           05      FILLER              PIC  X(02)      VALUE SPACES.
           05      FILLER              PIC  X(09)      VALUE
                                            'RECORDS: '.
           05      WRNREC              PIC  Z,ZZZ,ZZ9.
           05      FILLER              PIC  X(87)      VALUE SPACES.
      *
       01  SEL-LINE.
           05      FILLER              PIC  X(40)     VALUE SPACES.
           05      SELDSC              PIC  X(31)     VALUE SPACES.
           05      SELVAL.
            10     BEGRNG              PIC  X(10)     VALUE SPACES.
            10     FILLER              PIC  X(01)     VALUE SPACES.
            10     TO-LIT              PIC  X(02)     VALUE SPACES.
            10     FILLER              PIC  X(01)     VALUE SPACES.
            10     ENDRNG              PIC  X(10)     VALUE SPACES.

           COPY MHTBLRPTLK OF QLBLSRC.
           COPY COMMONWS OF QSECCPY.
           COPY COMMONWSB OF QSECCPY.
           COPY EIMSGWS OF QLBLSRC.
           COPY SCMSGLNK OF QLBLSRC.
           COPY GRCPDYSLK OF QLBLSRC.
      ****--------------------------------------------------------****
      ****  PMHS-364  KCT  Fix                                    ****
      ****  Copybook is not used.                                 ****
      ****--------------------------------------------------------****
      **** COPY SCGRCDATLK OF QLBLSRC.
           COPY LCNCLISTLK.
      *
       01  EXGREF-AREA.
           05      EXTGRP              PIC  X(15).
           05      GRPNUM              PIC  X(06).
           05      ERRIND              PIC  X(01).
           05      ERRMSG              PIC  X(50).
      *
       01  EXMREF-AREA.
           05      EXTMEM              PIC  X(20).
           05      MEMBNO              PIC  X(15).
           05      GRPNUM              PIC  X(06).
           05      EFFDAT              PIC S9(07) COMP-3.
           05      ERRIND              PIC  X(01).
           05      ERRMSG              PIC  X(50).
       01  WS-EMLTXT                   PIC  X(80).
      *
           COPY ALTADRBTR  OF QLBLSRC.
           COPY ALTDOCBTR  OF QLBLSRC.
           COPY IOCOMMUN   OF QLBLSRC.
           COPY DEMDOCBTR  OF QLBLSRC.
           COPY DEMEXTBTR  OF QLBLSRC.
           COPY EMLPTRBVR  OF QLBLSRC.
           COPY PCCOMINTLK  OF QLBLSRC.
           COPY PCGETCHCLK  OF QLBLSRC.
           COPY RSPDOCBTR  OF QLBLSRC.
           COPY RSPPTYBTR  OF QLBLSRC.
           COPY SPGLBALPRM OF QLBLSRC
              REPLACING ==FILGRP== BY ==FILGRP-GLBAL==.
           COPY SPGLBALRTN OF QLBLSRC.
           COPY INDEBUG1   OF QLBLSRC.
      *
       PROCEDURE DIVISION.
           COPY SECTMAIN OF QSECCPY.
           COPY PROCBAT OF QSECCPY
                   REPLACING ==DATCUR== BY ==CURDAT==
                             ==DATCC==  BY ==CURC==
                             ==DATYY==  BY ==CURYY==
                             ==CURYMD== BY ==CURCYMD==.
           COPY LOCGET OF QSECCPY.
      *
       099-OPEN.
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           OPEN INPUT CMPANY.
           PERFORM CMPANY-STATUSR.
           OPEN INPUT  COVMAS.
           PERFORM COVMAS-STATUSR.
           OPEN INPUT  CPAMAS.
           PERFORM CPAMAS-STATUSR.
           OPEN I-O    CPDMAS.
           PERFORM CPDMAS-STATUSR.
           OPEN INPUT  DEMMAS.
           PERFORM DEMMAS-STATUSR.
           OPEN I-O    DODMAS.
           PERFORM DODMAS-STATUSR.
           OPEN I-O    EDIDOCBT.
           OPEN I-O    EEEMAS.
           OPEN I-O    EEPMAS.
           OPEN I-O    EETMAS.
           OPEN INPUT  EEWMAS.
           OPEN INPUT  ENBMAS.
           PERFORM ENBMAS-STATUSR.
           OPEN INPUT  ENBMEM.
           PERFORM ENBMEM-STATUSR.
           OPEN INPUT  EXHMAS.
           PERFORM EXHMAS-STATUSR.
           OPEN INPUT  ENPMAS.
           PERFORM ENPMAS-STATUSR.
           OPEN INPUT  ENPGRP.
           PERFORM ENPGRP-STATUSR.
           OPEN I-O    EXCMDTBT.
           PERFORM EXCMDTBT-STATUSW.
           OPEN I-O   EXCMEMBT.
           PERFORM EXCMEMBT-STATUSR.
           OPEN INPUT EXCSMSBI.
           PERFORM EXCSMSBI-STATUSR.
           OPEN INPUT  EXTBENBT.
           PERFORM EXTBENBT-STATUSR.
           OPEN I-O    EXTDOCBT.
           PERFORM EXTDOCBT-STATUSW.
           OPEN INPUT  GPHMAS.
           PERFORM GPHMAS-STATUSR.
           OPEN INPUT  GRPMAS.
           PERFORM GRPMAS-STATUSR.
           OPEN I-O    MBHMAS.
           PERFORM MBHMAS-STATUSW.
           OPEN INPUT  MCDMAS.
           PERFORM MCDMAS-STATUSR.
           OPEN I-O    MCMMAS.
           PERFORM MCMMAS-STATUSW.
           OPEN I-O    MDMMAS.
           PERFORM MDMMAS-STATUSW.
           OPEN INPUT  FACMAS.
           PERFORM FACMAS-STATUSR.
           OPEN I-O    MDTMAS.
           PERFORM MDTMAS-STATUSW.
           OPEN INPUT  MEEMAS.
           PERFORM MEEMAS-STATUSR.
           OPEN I-O    MEMEXDBT.
           PERFORM MEMEXDBT-STATUSR.
           OPEN INPUT  MEMMAS.
           PERFORM MEMMAS-STATUSR.
           OPEN INPUT  MEMSBS.
           PERFORM MEMSBS-STATUSR.
           OPEN INPUT  MHSMAS.
           PERFORM MHSMAS-STATUSR.
           OPEN I-O    MMDMAS.
           PERFORM MMDMAS-STATUSR.
           OPEN INPUT  PEMMAS.
           PERFORM PEMMAS-STATUSR.
           OPEN INPUT  PE4SBS.
           PERFORM PE4SBS-STATUSR.
           OPEN INPUT  RF3MAS.
           PERFORM RF3MAS-STATUSR.
       099-OPEN-EXIT.
               EXIT.
      *
       099-CLOSE.
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           CLOSE CMPANY.
           CLOSE COVMAS.
           CLOSE CPAMAS.
           CLOSE CPDMAS.
           CLOSE DEMMAS.
           CLOSE DODMAS.
           CLOSE EDIDOCBT.
           CLOSE EEEMAS.
           CLOSE EEPMAS.
           CLOSE EETMAS.
           CLOSE EEWMAS.
           CLOSE ENBMAS.
           CLOSE ENBMEM.
           CLOSE ENPMAS.
           CLOSE ENPGRP.
           CLOSE EXCMDTBT.
           CLOSE EXCMEMBT.
           CLOSE EXCSMSBI.
           CLOSE EXHMAS.
           CLOSE EXTBENBT.
           CLOSE EXTDOCBT.
           CLOSE GPHMAS.
           CLOSE GRPMAS.
           CLOSE MBHMAS.
           CLOSE MCDMAS.
           CLOSE MCMMAS.
           CLOSE MDMMAS.
           CLOSE FACMAS.
           CLOSE MDTMAS.
           CLOSE MEEMAS.
           CLOSE MEMEXDBT.
           CLOSE MEMMAS.
           CLOSE MEMSBS.
           CLOSE MHSMAS.
           CLOSE MMDMAS.
           CLOSE PEMMAS.
           CLOSE PE4SBS.
           CLOSE RF3MAS.

           COPY SCJOBMSG OF QLBLSRC.
           MOVE 50                               TO PRINT-CODE.
           PERFORM 099-PRT.
       099-CLOSE-EXIT.
           EXIT.
      *
       099-SCDAYS.
           CALL 'SCDAYS'.

       099-NAMFMT.
           CALL 'SCNAME'.
      *
       099-PRT.
           MOVE LINE-P                           TO PRT-LINE.
           CALL 'SCPRT'.
      *
       099-ERRMSG.
           COPY SCRTNMSGE OF QLBLSRC.
           PERFORM 099-PRTERR.
           IF MSGPRC = 'T'
              MOVE 'Y'                   TO PRCERR OF PGM-WORK.
      *
       099-PRTERR.
           IF FIRSTERROR
              MOVE 'N'                           TO SW-FIRSTERROR
              MOVE SPACES                        TO ERROR-LINE
              CALL 'SCERR'
              MOVE 41                            TO ERROR-CODE.

           MOVE LINE-E                           TO ERROR-LINE.
           CALL 'SCERR'.
      *
       099-PRTWRN.
           IF FIRSTWRN
              MOVE 'N'                           TO SW-FIRSTWRN
              MOVE SPACES                        TO WARNING-LINE
              CALL 'SCWRN'
              MOVE 41                            TO WRN-CODE.

           MOVE LINE-W                           TO WARNING-LINE.
           CALL 'SCWRN'.
      *
       099-INT.
           MOVE 'I'                              TO DECTYP.
           CALL 'SCDEC'.
      *
           COPY INDEBUG2 OF QLBLSRC.
      *
      ****------------------------------------------------------------
      ****  CR138494  RLW  FIX
      ****------------------------------------------------------------
       099-INIT-MCDMAS.
           MOVE SPACES                           TO MCDMAS-REC.
           MOVE ZEROS                  TO MMAEFF OF MCDMAS-REC
                                          MCTEFF OF MCDMAS-REC
                                          MCDMAS-UNQ OF MCDMAS-REC
                                          MCDMAS-SQR OF MCDMAS-REC.
      *
       099-INIT-MDTMAS.
      *
           MOVE SPACES                           TO MDTMAS-REC.
           MOVE ZEROES                 TO BATDAT OF MDTMAS-REC
                                          BATSEQ OF MDTMAS-REC
                                          SEQNUM OF MDTMAS-REC
                                          LINENO OF MDTMAS-REC.
           MOVE ZERO                   TO HIRDAT OF MDTMAS-REC
                                          TRMDAT OF MDTMAS-REC
                                          BTHDAT OF MDTMAS-REC
                                          EFFDAT OF MDTMAS-REC
                                          EXPDAT OF MDTMAS-REC
                                          INTDAT OF MDTMAS-REC
                                          PRICOD OF MDTMAS-REC
                                          PRIVDT OF MDTMAS-REC
                                          PRCDAT OF MDTMAS-REC
                                          PRCTIM OF MDTMAS-REC
                                          PRCSEQ OF MDTMAS-REC
                                          SSNXRF OF MDTMAS-REC
                                          MEMHLD OF MDTMAS-REC
                                          OVRLTR OF MDTMAS-REC
                                          HLDEFF OF MDTMAS-REC
                                          HLDEXP OF MDTMAS-REC
                                          OMEDAT OF MDTMAS-REC
                                          CRDMTH OF MDTMAS-REC
                                          EXTEFF OF MDTMAS-REC
                                          EXTEXP OF MDTMAS-REC
                                          PRTCNT OF MDTMAS-REC
                                          CRDDAT OF MDTMAS-REC
                                          BEGMTH OF MDTMAS-REC
                                          COBDAT OF MDTMAS-REC
                                          BTHSEQ OF MDTMAS-REC
                                          EDUBEG OF MDTMAS-REC
                                          EDUEND OF MDTMAS-REC
                                          COBRAQ OF MDTMAS-REC
                                          COBRAB OF MDTMAS-REC
                                          COBRAE OF MDTMAS-REC
                                          DETDAT OF MDTMAS-REC
                                          COVEFF OF MDTMAS-REC
                                          COVEXP OF MDTMAS-REC
                                          CANEFF OF MDTMAS-REC
                                          SALAMT OF MDTMAS-REC.
           MOVE '1'                    TO STATCD OF MDTMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF MDTMAS-REC
                                          LSTCHG OF MDTMAS-REC.
           MOVE 'EDI'                  TO TERMID OF MDTMAS-REC.
           MOVE 'ED201C'               TO USERID OF MDTMAS-REC.
      *
       A010-MAIN.
      ****************************************************************
      *     MAIN CONTROL                                             *
      ****************************************************************
           PERFORM A1620-LICENSE-125573          THRU A1629-EXIT.
           PERFORM 099-CHECK-DEBUG.
      *
           IF MHUSER OF SECDAT = SPACES
              MOVE 'ED201A'            TO MHUSER OF SECDAT.
           IF MHTERM OF SECDAT = SPACES
              MOVE 'ED201A'            TO MHTERM OF SECDAT.
      *
           MOVE MHUSER OF SECDAT                 TO IO-USERID.
           MOVE MHTERM OF SECDAT                 TO IO-TERMID.
           MOVE TBLPCT OF LOCAL-DISP             TO WS-MAXPCT.
      *
           MOVE SPACES                           TO EEWDET-WRK.
           MOVE 'Y'                              TO MBH-FLAG.
           MOVE 'Y'                              TO FIRST-DT3-REC.
           INITIALIZE EEWDT2-REC.
           MOVE EEWDT2-REC                       TO EEWDT2-WRK.
           INITIALIZE EEWDT3-REC.
           MOVE EEWDT3-REC                       TO EEWDT3-WRK.
           MOVE PRINT-DATA                       TO PRNTDATA.
           MOVE ERROR-DATA                       TO PRNTERROR.
           MOVE WARN-DATA                        TO PRNTWARN.
           MOVE 'Y'                              TO FIRST-REC-FLAG.
           MOVE ' '                              TO SW-EEWMAS-END.
           MOVE SPACES                           TO OLDGRP.
           MOVE SPACES                           TO OLDSUB.
      *
           PERFORM A150-READ-HEADER              THRU A159-EXIT.
           IF EEW-ERROR
              MOVE 'N'                           TO SW-MEMBER-ERROR
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A090-EXIT.
      *
           MOVE SPACES                           TO RF3MAS-REC.
           MOVE 'AC'                   TO REFTYP OF RF3MAS-REC.
           PERFORM RF3MAS-READ                   IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI02332'                     TO MI-PRIMARY-ID
              MOVE 'N'                           TO SW-MEMBER-ERROR
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y' TO PRCERR OF PGM-WORK     GO TO A098-END.
      *
           MOVE CURDAT                 TO CURDAT-SAV OF WS-WORK.
           MOVE CTLDOC OF EDIENR-REC   TO CTLDOC OF WS-WORK.
           IF CTLDOC OF WS-WORK = ZEROES
              MOVE 99                  TO CTLDOC OF WS-WORK.
           MOVE 'ED201C'               TO PGMNAM OF MHTBLRPTLK.
           MOVE 'FEETAB'               TO TBLNAM OF MHTBLRPTLK(01).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(01).
           MOVE FEEMAX                 TO MAXENT OF MHTBLRPTLK(01).
           MOVE 'MEDTAB'               TO TBLNAM OF MHTBLRPTLK(02).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(02).
           MOVE MEDMAX                 TO MAXENT OF MHTBLRPTLK(02).
           MOVE 'SUBPCP'               TO TBLNAM OF MHTBLRPTLK(03).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(03).
           MOVE PPSMAX                 TO MAXENT OF MHTBLRPTLK(03).
           MOVE 'SUBSEC'               TO TBLNAM OF MHTBLRPTLK(04).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(04).
           MOVE SPSMAX                 TO MAXENT OF MHTBLRPTLK(04).
           MOVE 'SUBFEE'               TO TBLNAM OF MHTBLRPTLK(05).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(05).
           MOVE SFEMAX                 TO MAXENT OF MHTBLRPTLK(05).
           MOVE 'SUBMED'               TO TBLNAM OF MHTBLRPTLK(06).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(06).
           MOVE SMDMAX                 TO MAXENT OF MHTBLRPTLK(06).
           MOVE 'EEWDEP'               TO TBLNAM OF MHTBLRPTLK(07).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(07).
           MOVE EDPMAX                 TO MAXENT OF MHTBLRPTLK(07).
           MOVE 'EEWSUB'               TO TBLNAM OF MHTBLRPTLK(08).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(08).
           MOVE ESBMAX                 TO MAXENT OF MHTBLRPTLK(08).
           MOVE 'DEPTAB'               TO TBLNAM OF MHTBLRPTLK(09).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(09).
           MOVE DEPMAX                 TO MAXENT OF MHTBLRPTLK(09).
           MOVE 'MEMTAB'               TO TBLNAM OF MHTBLRPTLK(10).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(10).
           MOVE MEMMAX                 TO MAXENT OF MHTBLRPTLK(10).
           MOVE 'ENBTAB'               TO TBLNAM OF MHTBLRPTLK(11).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(11).
           MOVE ENBMAX                 TO MAXENT OF MHTBLRPTLK(11).
           MOVE 'SUBMEM'               TO TBLNAM OF MHTBLRPTLK(12).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(12).
           MOVE MESMAX                 TO MAXENT OF MHTBLRPTLK(12).
           MOVE 'SUBENB'               TO TBLNAM OF MHTBLRPTLK(13).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(13).
           MOVE ENSMAX                 TO MAXENT OF MHTBLRPTLK(13).
           MOVE 'SUBTAB'               TO TBLNAM OF MHTBLRPTLK(14).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(14).
           MOVE SUBMAX                 TO MAXENT OF MHTBLRPTLK(14).
           MOVE 'EEWBYP'               TO TBLNAM OF MHTBLRPTLK(15).
           MOVE ZEROES                 TO CURENT OF MHTBLRPTLK(15).
           MOVE EBYMAX                 TO MAXENT OF MHTBLRPTLK(15).

           PERFORM Z900-BANNER                   THRU Z909-EXIT.
           PERFORM A100-PROCESS                  THRU A109-EXIT.
      *
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A098-END.
      *
           MOVE FULLUP OF EEWHDR-WRK   TO FULLUP OF PGM-WORK.
           MOVE GRPNUM OF EEWHDR-WRK   TO GRPNUM OF PGM-WORK.
           MOVE TRMEXP OF EEWHDR-WRK    TO TARDAT.
           PERFORM A930-CONVERT-DATE   THRU A939-EXIT.
           MOVE CNVDAT                 TO TRMEXP OF PGM-WORK.
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF PGM-WORK.
           MOVE AUTOPR OF EDIENR-REC   TO AUTOPR OF PGM-WORK.
           MOVE AUTOPS OF EDIENR-REC   TO AUTOPS OF PGM-WORK.
       A098-END.
           DISPLAY LOCAL-DISP                    UPON LOCAL-AREA.
           CALL 'MHTBLRPT' USING MHTBLRPTLK.
      *
           COMMIT.
      *
       A090-EXIT.
           EXIT.
      *
       A100-PROCESS.
      ****************************************************************
      * MAIN PROCESS LOOP                                            *
      ****************************************************************
           PERFORM C300-INIT                     THRU C309-EXIT.
      *
           READ EEWMAS NEXT RECORD               AT END
              MOVE 'Y'                           TO SW-EEWMAS-END.
      *
           IF RECTYP OF EEWDET-REC NOT = 'M'
              MOVE 'Y'                           TO SW-EEWMAS-END.
      *
           IF EEW-END
              IF FIRST-RECORD
                 MOVE SPACES           TO BRANCD OF HEAD3
                 MOVE ZEROES           TO BATDAT OF HEAD3
                                          BATSEQ OF HEAD3
                 MOVE 'NO RECORDS TO PROCESS'    TO LINE-P
                 MOVE HEAD3 OF PRINT-DATA TO PRNTH3 OF PRNTDATA
                 PERFORM 099-PRT                 GO TO A109-EXIT
              END-IF
              IF EEWDET-WRK = SPACES
                 GO TO A108-END.
      *
           MOVE 'N'                              TO FIRST-REC-FLAG.
      *
           IF  EEW-END
           OR (RECTYP OF EEWMAS-REC = 'M'
           AND DETTYP OF EEWDET-REC = '1')
              IF EEWDET-WRK = SPACES
                 IF EEW-END
                    GO TO A108-END
                 ELSE
                    MOVE SPACES                  TO WS-REACAT2
                    MOVE SPACES                  TO WS-APLORG1
                    MOVE ZEROES                  TO WS-TRMEFF1
                    MOVE ZEROES                  TO WS-CANEFF1
                    MOVE EEWDET-REC              TO EEWDET-WRK
                    INITIALIZE EEWDT2-REC
                    MOVE EEWDT2-REC              TO EEWDT2-WRK
                    INITIALIZE EEWDT3-REC
                    MOVE EEWDT3-REC              TO EEWDT3-WRK
                    COMMIT
                    GO TO A100-PROCESS
                 END-IF
              END-IF
           ELSE
            IF DETTYP OF EEWDET-REC = '2'
              MOVE EEWDT2-REC                    TO EEWDT2-WRK
              COMMIT
              GO TO A100-PROCESS
            ELSE IF DETTYP OF EEWDET-REC = '3'
              PERFORM A450-EEWDT3-WRK            THRU A459-EXIT
              COMMIT
              GO TO A100-PROCESS.
      *
           MOVE 'Y'                              TO FIRST-DT3-REC.
      *
           IF  MEMBNO OF EEWDET-WRK = SPACES
           AND EXTMEM OF EEWDET-WRK NOT = SPACES
              INITIALIZE EXMREF-AREA
              MOVE EXTMEM OF EEWDET-WRK     TO EXTMEM OF EXMREF-AREA
              MOVE GRPNUM OF EEWDET-WRK     TO GRPNUM OF EXMREF-AREA
              MOVE ZEROES                   TO EFFDAT OF EXMREF-AREA
              CALL 'MEEXMREF' USING EXMREF-AREA
              IF ERRIND OF EXMREF-AREA = 'Y'
                 MOVE 'EI02415'                     TO MI-PRIMARY-ID
                 MOVE 'MEMBER# ASSOCIATED'          TO MI-PARM4
                 MOVE 'WITH EXTERNAL'               TO MI-PARM5
                 MOVE 'MEMBER#'                     TO MI-PARM6
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              ELSE
                 MOVE MEMBNO OF EXMREF-AREA TO MEMBNO OF EEWDET-WRK.

           IF  SUBSNO OF EEWDET-WRK = SPACES
           AND EXTSUB OF EEWDET-WRK NOT = SPACES
              INITIALIZE EXMREF-AREA
              MOVE EXTSUB OF EEWDET-WRK     TO EXTMEM OF EXMREF-AREA
              MOVE GRPNUM OF EEWDET-WRK     TO GRPNUM OF EXMREF-AREA
              MOVE ZEROES                   TO EFFDAT OF EXMREF-AREA
              CALL 'MEEXMREF' USING EXMREF-AREA
              IF ERRIND OF EXMREF-AREA = 'Y'
                 MOVE 'EI02415'                  TO MI-PRIMARY-ID
                 MOVE 'SUBSCRIBER#'              TO MI-PARM4
                 MOVE 'ASSOCIATED'               TO MI-PARM5
                 MOVE 'WITH EXTERNAL'            TO MI-PARM6
                 MOVE 'SUBSCRIBER#'              TO MI-PARM7
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
              ELSE
                 MOVE MEMBNO OF EXMREF-AREA TO SUBSNO OF EEWDET-WRK.
      *
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A109-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  E-Fix                                  ****
      ****  Process tables when an additional transaction for the ****
      ****  same subscriber is encountered.                       ****
      ****--------------------------------------------------------****
      ****  PMHS-269  KCT  Fix                                    ****
      ****  Initialize additional fields.                         ****
      ****--------------------------------------------------------****
           IF GRPNUM OF EEWDET-WRK NOT = OLDGRP
           OR SUBSNO OF EEWDET-WRK NOT = OLDSUB
           OR (  SUBSNO OF EEWDET-WRK = OLDSUB
             AND RECTYP OF EEWMAS-REC = 'M'
             AND DETTYP OF EEWDET-REC = '1'
             AND RELCOD OF EEWDET-WRK = '1')
              IF  (OLDSUB NOT = SPACES
              AND OLDGRP NOT = SPACES)
                 PERFORM A300-MHS-INFO           THRU A309-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A109-EXIT
                 END-IF
                 IF NOT FAMILY-ERROR
                    PERFORM A600-LOAD-MDTMAS     THRU A609-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A109-EXIT
                    END-IF
                 ELSE
                    PERFORM A220-ERR-FAMILY      THRU A229-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A109-EXIT
                    END-IF
                 END-IF
                 MOVE ZEROES                     TO WS-TRMEFF1
                                                    WS-CANEFF1
              END-IF
              PERFORM A170-WRITE-EEPMAS-SUB      THRU A179-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT
              END-IF
              PERFORM A140-WRITE-EEPMAS-DEP      THRU A149-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT
              END-IF
              IF NOT FAMILY-ERROR
                 PERFORM A180-WRITE-EETMAS       THRU A189-EXIT
              END-IF
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT
              END-IF
      *
              INITIALIZE EEWDEP(1)
                         EEWDP2(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > EDPMAX OR INDX > EDPLST
                 MOVE EEWDEP(1)                  TO EEWDEP(INDX)
                 MOVE EEWDP2(1)                  TO EEWDP2(INDX)
              END-PERFORM
              MOVE 0                             TO EDPACT EDPLST
              MOVE 'N'                           TO WS-FLG-EEWDEP
      *
              INITIALIZE EEWBYP(1)
                         EEWBY2(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > EBYMAX OR INDX > EBYLST
                 MOVE EEWBYP(1)                  TO EEWBYP(INDX)
                 MOVE EEWBY2(1)                  TO EEWBY2(INDX)
              END-PERFORM
              MOVE ZERO                          TO EBYACT EBYLST
              MOVE 'N'                           TO WS-FLG-EEWBYP
      *
              INITIALIZE EBLLNK(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > EBLMAX OR INDX > EBLLST
                 MOVE EBLLNK(1)                  TO EBLLNK(INDX)
              END-PERFORM
              MOVE ZERO                          TO EBLACT EBLLST
      *
              INITIALIZE EEWSUB(1)
                         EEWSB2(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > ESBMAX OR INDX > ESBLST
                 MOVE EEWSUB(1)                  TO EEWSUB(INDX)
                 MOVE EEWSB2(1)                  TO EEWSB2(INDX)
              END-PERFORM
              MOVE ZERO                          TO ESBACT ESBLST
              MOVE 'N'                           TO WS-FLG-EEWSUB
      *
              INITIALIZE EETSUB(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > ETSMAX OR INDX > ETSLST
                 MOVE EETSUB(1)                  TO EETSUB(INDX)
              END-PERFORM
              MOVE 0                             TO ETSACT ETSLST
      *
              INITIALIZE EETDEP(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > ETDLST OR INDX > ETDMAX
                 MOVE EETDEP(1)                  TO EETDEP(INDX)
              END-PERFORM
              MOVE 0                             TO ETDACT ETDLST
      *
              MOVE SPACES                        TO ERRTAB(1)
              PERFORM VARYING INDX               FROM 2 BY 1
                UNTIL INDX > ERRMAX OR INDX > ERRLST
                 MOVE ERRTAB(1)                  TO ERRTAB(INDX)
              END-PERFORM
              MOVE 0                             TO ERRACT ERRLST
      *
              MOVE 'N'                           TO FAMILY-FLAG
              MOVE SPACES                        TO ACCTNO-HLD
                                                    TIERCD-HLD
              MOVE SPACES                        TO TIER-FLAG
                                                    ACCT-FLAG
                                                    GROUP-FLAG
              MOVE SPACES                        TO SUB-INFO
              MOVE ZEROES              TO MEMEFF OF SUB-INFO
                                          MEMEXP OF SUB-INFO
                                          SEQNUM OF SUB-INFO
              MOVE SPACES                        TO WS-REACAT2
                                                    WS-APLORG1
              MOVE GRPNUM OF EEWDET-WRK          TO OLDGRP
              MOVE SUBSNO OF EEWDET-WRK          TO OLDSUB.
      *
           MOVE EEWMAS-REC                       TO WS-SAVE-REC.
           PERFORM A210-LOAD-EEWTAB              THRU A219-EXIT.
           MOVE WS-SAVE-REC                      TO EEWMAS-REC.
      *
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A109-EXIT.
      *
           MOVE EEWDET-REC                       TO EEWDET-WRK.
           INITIALIZE EEWDT2-REC
           MOVE EEWDT2-REC                       TO EEWDT2-WRK.
           INITIALIZE EEWDT3-REC
           MOVE EEWDT3-REC                       TO EEWDT3-WRK.
      *
           IF NOT EEW-END
              COMMIT
              GO TO A100-PROCESS.
      *
       A108-END.
           PERFORM A300-MHS-INFO                 THRU A309-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A109-EXIT.
      *
           IF NOT FAMILY-ERROR
              PERFORM A600-LOAD-MDTMAS           THRU A609-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT
              END-IF
           ELSE
              PERFORM A220-ERR-FAMILY            THRU A229-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT.
      *
           PERFORM A170-WRITE-EEPMAS-SUB         THRU A179-EXIT
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A109-EXIT.
      *
           PERFORM A140-WRITE-EEPMAS-DEP         THRU A149-EXIT
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A109-EXIT.
      *
           IF NOT FAMILY-ERROR
              PERFORM A180-WRITE-EETMAS          THRU A189-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT.
      *
           IF MBHCNT > ZERO
              MOVE 'Y'                           TO SW-RPT-FLAG
              PERFORM A720-OLDBAT                THRU A729-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A109-EXIT.
      *
           IF NUMMDT OF WS-WORK = 0
              MOVE BRANCD OF MBHKEY    TO BRANCD OF MBHMAS-KEY
              MOVE BATDAT OF MBHKEY    TO BATDAT OF MBHMAS-KEY
              MOVE BATSEQ OF MBHKEY    TO BATSEQ OF MBHMAS-KEY
              PERFORM MBHMAS-READ                IF INVALID-KEY
                 NEXT SENTENCE
              ELSE
                 PERFORM MBHMAS-DELETE           IF INVALID-KEY
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI08000'         TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A109-EXIT.
      *
           IF NUMERR > ZERO
              MOVE NUMERR OF WS-WORK   TO TOTERR OF ERRTOT-LINE
              MOVE ERRREC OF WS-WORK   TO ERRREC OF ERRTOT-LINE
              MOVE ERRMEM OF WS-WORK   TO ERRMEM OF ERRTOT-LINE
              MOVE 02  TO ERROR-CODE
              MOVE ERRTOT-LINE TO LINE-E         PERFORM 099-PRTERR.
      *
           IF NUMWRN > ZERO
              MOVE NUMWRN OF WS-WORK   TO TOTWRN OF WRNTOT-LINE
              MOVE WRNREC OF WS-WORK   TO WRNREC OF WRNTOT-LINE
              MOVE 02 TO WRN-CODE
              MOVE WRNTOT-LINE TO LINE-W         PERFORM 099-PRTWRN.
      *
           IF NOT MDT-EXISTS
           AND NUMERR = 0
              MOVE SPACES              TO BRANCD OF HEAD3
              MOVE ZEROES              TO BATDAT OF HEAD3
                                          BATSEQ OF HEAD3
              MOVE 'NO RECORDS TO PROCESS'       TO LINE-P
              MOVE HEAD3 OF PRINT-DATA TO PRNTH3 OF PRNTDATA
              PERFORM 099-PRT
              MOVE BRANCD OF MBHKEY    TO BRANCD OF MBHMAS-KEY
              MOVE BATDAT OF MBHKEY    TO BATDAT OF MBHMAS-KEY
              MOVE BATSEQ OF MBHKEY    TO BATSEQ OF MBHMAS-KEY
              PERFORM MBHMAS-READ
              IF INVALID-KEY
                 NEXT SENTENCE
              ELSE
                 PERFORM MBHMAS-DELETE           IF INVALID-KEY
                    MOVE 'Y'           TO PRCERR OF PGM-WORK
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI08000'      TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                                                 GO TO A109-EXIT.
      *
           IF GENRPT OF EDIENR-REC NOT = 'Y'
              GO TO A109-EXIT.
      *
           IF MDT-EXISTS
              MOVE SPACES                        TO BATCH-LINE
              MOVE 'REPORT TOTALS:'    TO TOTTYP OF BATCH-LINE
              MOVE 'ADDS:'             TO TYPADD OF BATCH-LINE
              MOVE 'CHANGES:'          TO TYPCHG OF BATCH-LINE
              MOVE 'MEMBERS: '         TO TYPMEM OF BATCH-LINE
              MOVE TOTADD OF WS-WORK   TO TOTADD OF BATCH-LINE
              MOVE TOTCHG OF WS-WORK   TO TOTCHG OF BATCH-LINE
              COMPUTE TOTMEM OF WS-WORK = TOTADD OF WS-WORK
                                        + TOTCHG OF WS-WORK.
              MOVE TOTMEM OF WS-WORK   TO TOTMEM OF BATCH-LINE
              MOVE 02 TO PRINT-CODE
              MOVE BATCH-LINE TO LINE-P          PERFORM 099-PRT.
      *
       A109-EXIT.
           EXIT.
      *
       A140-WRITE-EEPMAS-DEP.
      ****************************************************************
      * WRITE EEPMAS RECORD                                          *
      ****************************************************************
           MOVE ZEROES                           TO EDPACT.
      *
       A141-NEXT.
           IF EDPACT NOT < EDPLST                GO TO A149-EXIT.
      *
           ADD 1                                 TO EDPACT.
      *
           IF EDPACT > EDPLST
              GO TO A149-EXIT.
      *
           IF GRPNUM OF EEWDEP(EDPACT) = SPACES
           OR  MEMBNO OF EEWDEP(EDPACT) = SPACES
              GO TO A141-NEXT.
      *
           MOVE SPACES                           TO EEPMAS-REC.
      *
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF EEPMAS-REC
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF EEPMAS-REC
           START EEPMAS KEY = EXTERNALLY-DESCRIBED-KEY
              INVALID KEY                     GO TO A145-WRITE
              NOT INVALID KEY                 GO TO A141-NEXT.
      *
       A145-WRITE.
           WRITE EEPMAS-REC                   INVALID KEY
              MOVE SPACES            TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI06062'                  TO MI-PRIMARY-ID
              MOVE 'EEPMAS'                   TO MI-PARM4
              MOVE EEPMAS-STATUS              TO MI-PARM5
              MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                   TO LINE-E
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT
              MOVE 'Y'              TO PRCERR OF PGM-WORK
              GO TO A149-EXIT.
      *
           GO TO A141-NEXT.
       A149-EXIT.
           EXIT.
      *
       A150-READ-HEADER.
      *************************************************************
      * READ THE EEWMAS HEADER RECORD                             *
      *************************************************************
           READ EEWMAS NEXT RECORD               AT END
           MOVE 'EI02400'                        TO MI-PRIMARY-ID
           MOVE 'Y'                              TO SW-EEWMAS-END
                                          PRCERR OF PGM-WORK
                                                    EEWMAS-ERROR
                                                 GO TO A159-EXIT.
      *
           IF RECTYP OF EEWHDR-REC NOT = 'H'
              MOVE 'Y'                           TO EEWMAS-ERROR
                                          PRCERR OF PGM-WORK
              MOVE 'EI02301'                     TO MI-PRIMARY-ID
                                                 GO TO A159-EXIT.
      *
           IF VERSID OF EEWHDR-REC = SPACES
              MOVE '005010'            TO VERSID OF EEWHDR-REC.
      *
           MOVE VERSID OF EEWHDR-REC             TO WS-VERSID.
           MOVE FULLUP OF EEWHDR-REC             TO WS-FULLUP.
      *
           MOVE EEWHDR-REC                       TO EEWHDR-WRK.
      *
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF PGM-WORK.
           MOVE FULLUP OF EEWHDR-WRK   TO FULLUP OF PGM-WORK.
       A159-EXIT.
           EXIT.
      *
       A170-WRITE-EEPMAS-SUB.
      ****************************************************************
      * WRITE EEPMAS RECORD                                          *
      ****************************************************************
           MOVE ZEROES                           TO ESBACT.
      *
           IF ESBACT NOT < ESBLST                GO TO A179-EXIT.
      *
       A171-NEXT.
           ADD 1                                 TO ESBACT.
      *
           IF ESBACT > ESBLST
              GO TO A179-EXIT.
      *
           IF GRPNUM OF EEWSUB(ESBACT) = SPACES
           OR  MEMBNO OF EEWSUB(ESBACT) = SPACES
              GO TO A171-NEXT.
      *
           MOVE SPACES                           TO EEPMAS-REC.
      *
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF EEPMAS-REC
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF EEPMAS-REC
           START EEPMAS KEY = EXTERNALLY-DESCRIBED-KEY
              INVALID KEY                     GO TO A175-WRITE
              NOT INVALID KEY                 GO TO A171-NEXT.
      *
       A175-WRITE.
           WRITE EEPMAS-REC                   INVALID KEY
              MOVE SPACES            TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI06062'                  TO MI-PRIMARY-ID
              MOVE 'EEPMAS'                   TO MI-PARM4
              MOVE EEPMAS-STATUS              TO MI-PARM5
              MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
              MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                   TO LINE-E
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT
              MOVE 'Y'              TO PRCERR OF PGM-WORK
              GO TO A179-EXIT.
      *
           GO TO A171-NEXT.
       A179-EXIT.
           EXIT.
      *
       A180-WRITE-EETMAS.
      ****************************************************************
      *  WRITE EETMAS RECORDS                                        *
      ****************************************************************
           MOVE ZEROES                           TO ETSACT.
           MOVE ESBLST                           TO ETSLST.
       A182-NEXT.
           IF ETSACT NOT < ETSLST                GO TO A185-NEXT.
      *
           ADD 1                                 TO ETSACT.
      *
           IF ETSACT > ETSMAX
              GO TO A185-NEXT.
      *
           IF SUBSNO OF EETSUB(ETSACT) = SPACES
              GO TO A185-NEXT.
      *
           INITIALIZE REETMAS.
      *
           PERFORM E100-FILL-SUB-EETMAS       THRU E109-EXIT.
      *
           PERFORM EETMAS-WRITE               IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EETMAS'                      TO MI-PARM4
              MOVE EETMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              MOVE GRPNUM OF EETMAS-REC TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EETMAS-REC TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EETMAS-REC TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EETMAS-REC TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EETMAS-REC TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE             TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO A189-EXIT.
      *
           GO TO A182-NEXT.
       A185-NEXT.
           MOVE ZEROES                           TO ETDACT.
           MOVE EDPLST                           TO ETDLST.
       A187-NEXT.
           IF ETDACT NOT < ETDLST                GO TO A189-EXIT.
      *
           ADD 1                                 TO ETDACT.
      *
           IF ETDACT > ETDMAX
              GO TO A189-EXIT.
      *
           IF SUBSNO OF EETDEP(ETDACT) = SPACES
              GO TO A189-EXIT.
      *
           PERFORM E110-FILL-DEP-EETMAS       THRU E119-EXIT.
      *
           PERFORM EETMAS-WRITE                 IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EETMAS'                      TO MI-PARM4
              MOVE EETMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              MOVE GRPNUM OF EETMAS-REC TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EETMAS-REC TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EETMAS-REC TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EETMAS-REC TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EETMAS-REC TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE             TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO A189-EXIT.
      *
           GO TO A187-NEXT.
       A189-EXIT.
           EXIT.
      *
       A210-LOAD-EEWTAB.
      ***************************************************************
      * LOAD THE EEWDET WORK FILE INTO A TABLE                      *
      ***************************************************************
           ADD 1                                 TO EBYLST.
           ADD 1                                 TO EBYACT.
      *
           IF RELCOD OF EEWDET-WRK NOT = '1'
              GO TO A215-DEPEND.
      *
           ADD 1                                 TO ESBLST.
           ADD 1                                 TO ESBACT.
      *
           IF CURENT(08) < ESBACT
              MOVE ESBACT                        TO CURENT(08).
           IF ESBACT > (ESBMAX * WS-MAXPCT) / 100
           AND WS-FLG-EEWSUB NOT = 'Y'
              MOVE ESBACT                        TO WS-ESBACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'EEWSUB'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE SUBSNO OF EEWDET-WRK          TO MI-PARM7
              MOVE GRPNUM OF EEWDET-WRK          TO MI-PARM8
              MOVE WS-ESBACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-EEWSUB
           END-IF.
      *
           IF ESBACT > ESBMAX
              MOVE 'Y'                  TO PRCERR OF PGM-WORK
              MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
              MOVE SPACES               TO ERR-LINE
              MOVE GRPNUM OF EEWDET-WRK TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDET-WRK TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDET-WRK TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDET-WRK TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDET-WRK TO CHGTYP OF ERR-LINE
              MOVE 'EI08001'            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI08001'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A219-EXIT.

           MOVE EEWDET-WRK                       TO EEWMAS-REC.
           MOVE RECTYP OF EEWDET-REC   TO RECTYP OF EEWSUB(ESBACT)
                                          RECTYP OF EETSUB(ESBACT).
           MOVE DETTYP OF EEWDET-REC   TO DETTYP OF EEWSUB(ESBACT)
                                          DETTYP OF EETSUB(ESBACT).
           MOVE GRPNUM OF EEWDET-REC   TO GRPNUM OF EEWSUB(ESBACT)
                                          WS-DT2-GRPNUM
                                          GRPNUM OF EETSUB(ESBACT).
           MOVE SUBSNO OF EEWDET-REC   TO SUBSNO OF EEWSUB(ESBACT)
                                          SUBSNO OF EETSUB(ESBACT).
           MOVE RELCOD OF EEWDET-REC   TO RELCOD OF EEWSUB(ESBACT)
                                          RELCOD OF EETSUB(ESBACT).
           MOVE RELTYP OF EEWDET-REC   TO RELTYP OF EEWSUB(ESBACT)
                                          RELTYP OF EETSUB(ESBACT).
           MOVE MEMBNO OF EEWDET-REC   TO MEMBNO OF EEWSUB(ESBACT)
                                          MEMBNO OF EETSUB(ESBACT).
           MOVE BTHDAT OF EEWDET-REC   TO TARDAT
                                          BTHDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO BTHDAT OF EEWSUB(ESBACT).
           MOVE BTHSEQ OF EEWDET-REC   TO BTHSEQ OF EEWSUB(ESBACT)
                                          BTHSEQ OF EETSUB(ESBACT).
           MOVE BTHCHG OF EEWDET-REC   TO BTHCHG OF EEWSUB(ESBACT)
                                          BTHCHG OF EETSUB(ESBACT).
           MOVE SEXCOD OF EEWDET-REC   TO SEXCOD OF EEWSUB(ESBACT)
                                          SEXCOD OF EETSUB(ESBACT).
           MOVE SEXCHG OF EEWDET-REC   TO SEXCHG OF EEWSUB(ESBACT)
                                          SEXCHG OF EETSUB(ESBACT).
           MOVE CHGTYP OF EEWDET-REC   TO CHGTYP OF EEWSUB(ESBACT)
                                          CHGTYP OF EETSUB(ESBACT).
           MOVE CHGDAT OF EEWDET-REC   TO TARDAT
                                          CHGDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGDAT OF EEWSUB(ESBACT).
           MOVE CHGTIM OF EEWDET-REC   TO CHGTIM OF EEWSUB(ESBACT)
                                          CHGTIM OF EETSUB(ESBACT).
           MOVE CHGEFF OF EEWDET-REC   TO TARDAT
                                          CHGEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGEFF OF EEWSUB(ESBACT).
           MOVE NAMCHG OF EEWDET-REC   TO NAMCHG OF EEWSUB(ESBACT)
                                          NAMCHG OF EETSUB(ESBACT).
           MOVE LSTNAM OF EEWDET-REC   TO LSTNAM OF EEWSUB(ESBACT)
                                          LSTNAM OF EETSUB(ESBACT).
           MOVE FSTNAM OF EEWDET-REC   TO FSTNAM OF EEWSUB(ESBACT)
                                          FSTNAM OF EETSUB(ESBACT).
           MOVE MIDNAM OF EEWDET-REC   TO MIDNAM OF EEWSUB(ESBACT)
                                          MIDNAM OF EETSUB(ESBACT).
           MOVE TITLCD OF EEWDET-REC   TO TITLCD OF EEWSUB(ESBACT)
                                          TITLCD OF EETSUB(ESBACT).
           MOVE FORNAM OF EEWDET-REC   TO FORNAM OF EEWSUB(ESBACT)
                                          FORNAM OF EETSUB(ESBACT).
           MOVE MEMCHG OF EEWDET-REC   TO MEMCHG OF EEWSUB(ESBACT)
                                          MEMCHG OF EETSUB(ESBACT).
           MOVE EMPSTA OF EEWDET-REC   TO EMPSTA OF EEWSUB(ESBACT)
                                          EMPSTA OF EETSUB(ESBACT).
           MOVE PRTCOD OF EEWDET-REC   TO PRTCOD OF EEWSUB(ESBACT)
                                          PRTCOD OF EETSUB(ESBACT).
           MOVE MEMEFF OF EEWDET-REC   TO TARDAT
                                          MEMEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEMEFF OF EEWSUB(ESBACT).
           MOVE MEMEXP OF EEWDET-REC   TO TARDAT
                                          MEMEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEMEXP OF EEWSUB(ESBACT).
           MOVE MEMREA OF EEWDET-REC   TO MEMREA OF EEWSUB(ESBACT)
                                          MEMREA OF EETSUB(ESBACT).
           MOVE MEMTRM OF EEWDET-REC   TO MEMTRM OF EEWSUB(ESBACT)
                                          MEMTRM OF EETSUB(ESBACT).
           MOVE DEMCHG OF EEWDET-REC   TO DEMCHG OF EEWSUB(ESBACT)
                                          DEMCHG OF EETSUB(ESBACT).
           MOVE ADRLN1 OF EEWDET-REC   TO ADRLN1 OF EEWSUB(ESBACT)
                                          ADRLN1 OF EETSUB(ESBACT).
           MOVE ADRLN2 OF EEWDET-REC   TO ADRLN2 OF EEWSUB(ESBACT)
                                          ADRLN2 OF EETSUB(ESBACT).
           MOVE CITYCD OF EEWDET-REC   TO CITYCD OF EEWSUB(ESBACT)
                                          CITYCD OF EETSUB(ESBACT).
           MOVE STACOD OF EEWDET-REC   TO STACOD OF EEWSUB(ESBACT)
                                          STATCD OF EETSUB(ESBACT).
           MOVE ZIPCOD OF EEWDET-REC   TO ZIPCOD OF EEWSUB(ESBACT)
                                          ZIPCOD OF EETSUB(ESBACT).
           MOVE CTRYCD OF EEWDET-REC   TO CTRYCD OF EEWSUB(ESBACT)
                                          CTRYCD OF EETSUB(ESBACT).
           MOVE LOCQLF OF EEWDET-REC   TO LOCQLF OF EEWSUB(ESBACT)
                                          LOCQLF OF EETSUB(ESBACT).
           MOVE AREACD OF EEWDET-REC   TO AREACD OF EEWSUB(ESBACT)
                                          AREACD OF EETSUB(ESBACT).
           MOVE HOMPH1 OF EEWDET-REC   TO HOMPH1 OF EEWSUB(ESBACT)
                                          HOMPH1 OF EETSUB(ESBACT).
           MOVE HOMPH2 OF EEWDET-REC   TO HOMPH2 OF EEWSUB(ESBACT)
                                          HOMPH2 OF EETSUB(ESBACT).
           MOVE HOMPH3 OF EEWDET-REC   TO HOMPH3 OF EEWSUB(ESBACT)
                                          HOMPH3 OF EETSUB(ESBACT).
           MOVE WRKPH1 OF EEWDET-REC   TO WRKPH1 OF EEWSUB(ESBACT)
                                          WRKPH1 OF EETSUB(ESBACT).
           MOVE WRKPH2 OF EEWDET-REC   TO WRKPH2 OF EEWSUB(ESBACT)
                                          WRKPH2 OF EETSUB(ESBACT).
           MOVE WRKPH3 OF EEWDET-REC   TO WRKPH3 OF EEWSUB(ESBACT)
                                          WRKPH3 OF EETSUB(ESBACT).
           MOVE WRKEXT OF EEWDET-REC   TO WRKEXT OF EEWSUB(ESBACT)
                                          WRKEXT OF EETSUB(ESBACT).
           MOVE FAXNUM OF EEWDET-REC   TO FAXNUM OF EEWSUB(ESBACT)
                                          FAXNUM OF EETSUB(ESBACT).
           MOVE OTHPHN OF EEWDET-REC   TO OTHPHN OF EEWSUB(ESBACT)
                                          OTHPHN OF EETSUB(ESBACT).
           MOVE EMLIND OF EEWDET-REC   TO EMLIND OF EEWSUB(ESBACT)
                                          EMLIND OF EETSUB(ESBACT).
           MOVE ELMAIL OF EEWDET-REC   TO ELMAIL OF EEWSUB(ESBACT)
                                          ELMAIL OF EETSUB(ESBACT).
           MOVE HIRDAT OF EEWDET-REC   TO TARDAT
                                          HIRDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO HIRDAT OF EEWSUB(ESBACT).
           MOVE TRMDAT OF EEWDET-REC   TO TARDAT
                                          TRMDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO TRMDAT OF EEWSUB(ESBACT).
           MOVE SOCSEC OF EEWDET-REC   TO SOCSEC OF EEWSUB(ESBACT)
                                          SOCSEC OF EETSUB(ESBACT).
           MOVE OLDLST OF EEWDET-REC   TO OLDLST OF EEWSUB(ESBACT)
                                          OLDLST OF EETSUB(ESBACT).
           MOVE OLDFST OF EEWDET-REC   TO OLDFST OF EEWSUB(ESBACT)
                                          OLDFST OF EETSUB(ESBACT).
           MOVE OLDMID OF EEWDET-REC   TO OLDMID OF EEWSUB(ESBACT)
                                          OLDMID OF EETSUB(ESBACT).
           MOVE OLDTLC OF EEWDET-REC   TO OLDTLC OF EEWSUB(ESBACT)
                                          OLDTLC OF EETSUB(ESBACT).
           MOVE OLDSSN OF EEWDET-REC   TO OLDSSN OF EEWSUB(ESBACT)
                                          OLDSSN OF EETSUB(ESBACT).
           MOVE OLDBTH OF EEWDET-REC   TO TARDAT
                                          OLDBTH OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OLDBTH OF EEWSUB(ESBACT).
           MOVE OLDSEX OF EEWDET-REC   TO OLDSEX OF EEWSUB(ESBACT)
                                          OLDSEX OF EETSUB(ESBACT).
           MOVE RACECD OF EEWDET-REC   TO RACECD OF EEWSUB(ESBACT)
                                          RACECD OF EETSUB(ESBACT).
           MOVE TYPCOD OF EEWDET-REC   TO TYPCOD OF EEWSUB(ESBACT)
                                          TYPCOD OF EETSUB(ESBACT).
           MOVE HOLDCD OF EEWDET-REC   TO HOLDCD OF EEWSUB(ESBACT)
                                          HOLDCD OF EETSUB(ESBACT).
           MOVE MEMSTA OF EEWDET-REC   TO MEMSTA OF EEWSUB(ESBACT)
                                          MEMSTA OF EETSUB(ESBACT).
           MOVE STUSTA OF EEWDET-REC   TO STUSTA OF EEWSUB(ESBACT)
                                          STUSTA OF EETSUB(ESBACT).
           MOVE EDUBEG OF EEWDET-REC   TO TARDAT
                                          EDUBEG OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EDUBEG OF EEWSUB(ESBACT).
           MOVE EDUEND OF EEWDET-REC   TO TARDAT
                                          EDUEND OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EDUEND OF EEWSUB(ESBACT).
           MOVE HNDIND OF EEWDET-REC   TO HNDIND OF EEWSUB(ESBACT)
                                          HNDIND OF EETSUB(ESBACT).
           MOVE AUTEXP OF EEWDET-REC   TO AUTEXP OF EEWSUB(ESBACT)
                                          AUTEXP OF EETSUB(ESBACT).
           MOVE ALTNUM OF EEWDET-REC   TO ALTNUM OF EEWSUB(ESBACT)
                                          ALTNUM OF EETSUB(ESBACT).
           MOVE INTKCD OF EEWDET-REC   TO INTKCD OF EEWSUB(ESBACT)
                                          INTKCD OF EETSUB(ESBACT).
           MOVE PCPCHG OF EEWDET-REC   TO PCPCHG OF EEWSUB(ESBACT)
                                          PCPCHG OF EETSUB(ESBACT).
           MOVE PCPCOD OF EEWDET-REC   TO PCPCOD OF EEWSUB(ESBACT)
                                          PCPCOD OF EETSUB(ESBACT).
           MOVE PCPORG OF EEWDET-REC   TO PCPORG OF EEWSUB(ESBACT)
                                          PCPORG OF EETSUB(ESBACT).
           MOVE PCPOVR OF EEWDET-REC   TO PCPOVR OF EEWSUB(ESBACT)
                                          PCPOVR OF EETSUB(ESBACT).
           MOVE PCPMCP OF EEWDET-REC   TO PCPMCP OF EEWSUB(ESBACT)
                                          PCPMCP OF EETSUB(ESBACT).
           MOVE PCPEFF OF EEWDET-REC   TO TARDAT
                                          PCPEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PCPEFF OF EEWSUB(ESBACT).
           MOVE PCPEXP OF EEWDET-REC   TO TARDAT
                                          PCPEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PCPEXP OF EEWSUB(ESBACT).
           MOVE PCPREA OF EEWDET-REC   TO PCPREA OF EEWSUB(ESBACT)
                                          PCPREA OF EETSUB(ESBACT).
           MOVE PCPTRM OF EEWDET-REC   TO PCPTRM OF EEWSUB(ESBACT)
                                          PCPTRM OF EETSUB(ESBACT).
           MOVE SECCHG OF EEWDET-REC   TO SECCHG OF EEWSUB(ESBACT)
                                          SECCHG OF EETSUB(ESBACT).
           MOVE SECCOD OF EEWDET-REC   TO SECCOD OF EEWSUB(ESBACT)
                                          SECCOD OF EETSUB(ESBACT).
           MOVE SECORG OF EEWDET-REC   TO SECORG OF EEWSUB(ESBACT)
                                          SECORG OF EETSUB(ESBACT).
           MOVE SECOVR OF EEWDET-REC   TO SECOVR OF EEWSUB(ESBACT)
                                          SECOVR OF EETSUB(ESBACT).
           MOVE SECMCP OF EEWDET-REC   TO SECMCP OF EEWSUB(ESBACT)
                                          SECMCP OF EETSUB(ESBACT).
           MOVE SECEFF OF EEWDET-REC   TO TARDAT
                                          SECEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SECEFF OF EEWSUB(ESBACT).
           MOVE SECEXP OF EEWDET-REC   TO TARDAT
                                          SECEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SECEXP OF EEWSUB(ESBACT).
           MOVE SECREA OF EEWDET-REC   TO SECREA OF EEWSUB(ESBACT)
                                          SECREA OF EETSUB(ESBACT).
           MOVE SECTRM OF EEWDET-REC   TO SECTRM OF EEWSUB(ESBACT)
                                          SECTRM OF EETSUB(ESBACT).
           MOVE MEDCHG OF EEWDET-REC   TO MEDCHG OF EEWSUB(ESBACT)
                                          MEDCHG OF EETSUB(ESBACT).
           MOVE MEDCTY OF EEWDET-REC   TO MEDCTY OF EEWSUB(ESBACT)
                                          MEDCTY OF EETSUB(ESBACT).
           MOVE MEDSTS OF EEWDET-REC   TO MEDSTS OF EEWSUB(ESBACT)
                                          MEDSTS OF EETSUB(ESBACT).
           MOVE MEDEFF OF EEWDET-REC   TO TARDAT
                                          MEDEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEDEFF OF EEWSUB(ESBACT).
           MOVE MEDEXP OF EEWDET-REC   TO TARDAT
                                          MEDEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEDEXP OF EEWSUB(ESBACT).
           MOVE MEDREA OF EEWDET-REC   TO MEDREA OF EEWSUB(ESBACT)
                                          MEDREA OF EETSUB(ESBACT).
           MOVE MEDTRM OF EEWDET-REC   TO MEDTRM OF EEWSUB(ESBACT)
                                          MEDTRM OF EETSUB(ESBACT).
           MOVE FEECHG OF EEWDET-REC   TO FEECHG OF EEWSUB(ESBACT)
                                          FEECHG OF EETSUB(ESBACT).
           MOVE FEECOD OF EEWDET-REC   TO FEECOD OF EEWSUB(ESBACT)
                                          FEECOD OF EETSUB(ESBACT).
           MOVE FEEEFF OF EEWDET-REC   TO TARDAT
                                          FEEEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO FEEEFF OF EEWSUB(ESBACT).
           MOVE FEEEXP OF EEWDET-REC   TO TARDAT
                                          FEEEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO FEEEXP OF EEWSUB(ESBACT).
           MOVE FEEREA OF EEWDET-REC   TO FEEREA OF EEWSUB(ESBACT)
                                          FEEREA OF EETSUB(ESBACT).
           MOVE FEETRM OF EEWDET-REC   TO FEETRM OF EEWSUB(ESBACT)
                                          FEETRM OF EETSUB(ESBACT).
           MOVE ENBCHG OF EEWDET-REC   TO ENBCHG OF EEWSUB(ESBACT)
                                          ENBCHG OF EETSUB(ESBACT).
           MOVE ACCTNO OF EEWDET-REC   TO ACCTNO OF EEWSUB(ESBACT)
                                          ACCTNO OF EETSUB(ESBACT).
           MOVE TIRCAL OF EEWDET-REC   TO TIRCAL OF EEWSUB(ESBACT)
                                          TIRCAL OF EETSUB(ESBACT).
           MOVE TIERCD OF EEWDET-REC   TO TIERCD OF EEWSUB(ESBACT)
                                          TIERCD OF EETSUB(ESBACT).
           MOVE TIRFLG OF EEWDET-REC   TO TIRFLG OF EEWSUB(ESBACT)
                                          TIRFLG OF EETSUB(ESBACT).
           MOVE BENPKG OF EEWDET-REC   TO BENPKG OF EEWSUB(ESBACT)
                                          BENPKG OF EETSUB(ESBACT).
           MOVE BILEXC OF EEWDET-REC   TO BILEXC OF EEWSUB(ESBACT)
                                          BILEXC OF EETSUB(ESBACT).
           MOVE ENBEFF OF EEWDET-REC   TO TARDAT
                                          ENBEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO ENBEFF OF EEWSUB(ESBACT).
           MOVE ENBEXP OF EEWDET-REC   TO TARDAT
                                          ENBEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO ENBEXP OF EEWSUB(ESBACT).
           MOVE ENBREA OF EEWDET-REC   TO ENBREA OF EEWSUB(ESBACT)
                                          ENBREA OF EETSUB(ESBACT).
           MOVE ENBTRM OF EEWDET-REC   TO ENBTRM OF EEWSUB(ESBACT)
                                          ENBTRM OF EETSUB(ESBACT).
           MOVE CPAIND OF EEWDET-REC   TO CPAIND OF EEWSUB(ESBACT)
                                          CPAIND OF EETSUB(ESBACT).
           MOVE CPLNAM OF EEWDET-REC   TO CPLNAM OF EEWSUB(ESBACT)
                                          CPLNAM OF EETSUB(ESBACT).
           MOVE CPFNAM OF EEWDET-REC   TO CPFNAM OF EEWSUB(ESBACT)
                                          CPFNAM OF EETSUB(ESBACT).
           MOVE CPMNAM OF EEWDET-REC   TO CPMNAM OF EEWSUB(ESBACT)
                                          CPMNAM OF EETSUB(ESBACT).
           MOVE CPTITL OF EEWDET-REC   TO CPTITL OF EEWSUB(ESBACT)
                                          CPTITL OF EETSUB(ESBACT).
           MOVE CPFORM OF EEWDET-REC   TO CPFORM OF EEWSUB(ESBACT)
                                          CPFORM OF EETSUB(ESBACT).
           MOVE CPARNT OF EEWDET-REC   TO CPARNT OF EEWSUB(ESBACT)
                                          CPARNT OF EETSUB(ESBACT).
           MOVE CPCONT OF EEWDET-REC   TO CPCONT OF EEWSUB(ESBACT)
                                          CPCONT OF EETSUB(ESBACT).
           MOVE CPHPH1 OF EEWDET-REC   TO CPHPH1 OF EEWSUB(ESBACT)
                                          CPHPH1 OF EETSUB(ESBACT).
           MOVE CPHPH2 OF EEWDET-REC   TO CPHPH2 OF EEWSUB(ESBACT)
                                          CPHPH2 OF EETSUB(ESBACT).
           MOVE CPHPH3 OF EEWDET-REC   TO CPHPH3 OF EEWSUB(ESBACT)
                                          CPHPH3 OF EETSUB(ESBACT).
           MOVE CPWPH1 OF EEWDET-REC   TO CPWPH1 OF EEWSUB(ESBACT)
                                          CPWPH1 OF EETSUB(ESBACT).
           MOVE CPWPH2 OF EEWDET-REC   TO CPWPH2 OF EEWSUB(ESBACT)
                                          CPWPH2 OF EETSUB(ESBACT).
           MOVE CPWPH3 OF EEWDET-REC   TO CPWPH3 OF EEWSUB(ESBACT)
                                          CPWPH3 OF EETSUB(ESBACT).
           MOVE CPWEXT OF EEWDET-REC   TO CPWEXT OF EEWSUB(ESBACT)
                                          CPWEXT OF EETSUB(ESBACT).
           MOVE CFAXNB OF EEWDET-REC   TO CFAXNB OF EEWSUB(ESBACT)
                                          CFAXNB OF EETSUB(ESBACT).
           MOVE COTHPH OF EEWDET-REC   TO COTHPH OF EEWSUB(ESBACT)
                                          COTHPH OF EETSUB(ESBACT).
           MOVE CEMLIN OF EEWDET-REC   TO CEMLIN OF EEWSUB(ESBACT)
                                          CEMLIN OF EETSUB(ESBACT).
           MOVE CEMAIL OF EEWDET-REC   TO CEMAIL OF EEWSUB(ESBACT)
                                          CEMAIL OF EETSUB(ESBACT).
           MOVE CPADR1 OF EEWDET-REC   TO CPADR1 OF EEWSUB(ESBACT)
                                          CPADR1 OF EETSUB(ESBACT).
           MOVE CPADR2 OF EEWDET-REC   TO CPADR2 OF EEWSUB(ESBACT)
                                          CPADR2 OF EETSUB(ESBACT).
           MOVE CPCITY OF EEWDET-REC   TO CPCITY OF EEWSUB(ESBACT)
                                          CPCITY OF EETSUB(ESBACT).
           MOVE CPSTAT OF EEWDET-REC   TO CPSTAT OF EEWSUB(ESBACT)
                                          CPSTAT OF EETSUB(ESBACT).
           MOVE CPZCOD OF EEWDET-REC   TO CPZCOD OF EEWSUB(ESBACT)
                                          CPZCOD OF EETSUB(ESBACT).
           MOVE CCNTRY OF EEWDET-REC   TO CCNTRY OF EEWSUB(ESBACT)
                                          CCNTRY OF EETSUB(ESBACT).
           MOVE WRKLOC OF EEWDET-REC   TO WRKLOC OF EEWSUB(ESBACT)
                                          WRKLOC OF EETSUB(ESBACT).
           MOVE SSNXRF OF EEWDET-REC   TO SSNXRF OF EEWSUB(ESBACT)
                                          SSNXRF OF EETSUB(ESBACT).
           MOVE HICNNO OF EEWDET-REC   TO HICNNO OF EEWSUB(ESBACT)
                                          HICNNO OF EETSUB(ESBACT).
           MOVE PEBTFS OF EEWDET-REC   TO PEBTFS OF EEWSUB(ESBACT)
                                          PEBTFS OF EETSUB(ESBACT).
           MOVE MMDIND OF EEWDET-REC   TO MMDIND OF EEWSUB(ESBACT)
                                          MMDIND OF EETSUB(ESBACT).
           MOVE MMANUM OF EEWDET-REC   TO MMANUM OF EEWSUB(ESBACT)
                                          MMANUM OF EETSUB(ESBACT).
           MOVE MMAEFF OF EEWDET-REC   TO TARDAT
                                          MMAEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MMAEFF OF EEWSUB(ESBACT).
           MOVE MIDNUM OF EEWDET-REC   TO MIDNUM OF EEWSUB(ESBACT)
                                          MIDNUM OF EETSUB(ESBACT).
           MOVE MCTCOD OF EEWDET-REC   TO MCTCOD OF EEWSUB(ESBACT)
                                          MCTCOD OF EETSUB(ESBACT).
           MOVE MCTEFF OF EEWDET-REC   TO TARDAT
                                          MCTEFF OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MCTEFF OF EEWSUB(ESBACT).
           MOVE MPSCOD OF EEWDET-REC   TO MPSCOD OF EEWSUB(ESBACT)
                                          MPSCOD OF EETSUB(ESBACT).
           MOVE MCASNO OF EEWDET-REC   TO MCASNO OF EEWSUB(ESBACT)
                                          MCASNO OF EETSUB(ESBACT).
           MOVE MCAPCD OF EEWDET-REC   TO MCAPCD OF EEWSUB(ESBACT)
                                          MCAPCD OF EETSUB(ESBACT).
           MOVE MMCEXC OF EEWDET-REC   TO MMCEXC OF EEWSUB(ESBACT)
                                          MMCEXC OF EETSUB(ESBACT).
           MOVE MMCIND OF EEWDET-REC   TO MMCIND OF EEWSUB(ESBACT)
                                          MMCIND OF EETSUB(ESBACT).
           MOVE MPLNCD OF EEWDET-REC   TO MPLNCD OF EEWSUB(ESBACT)
                                          MPLNCD OF EETSUB(ESBACT).
           MOVE MSPRCD OF EEWDET-REC   TO MSPRCD OF EEWSUB(ESBACT)
                                          MSPRCD OF EETSUB(ESBACT).
           MOVE MPAEDT OF EEWDET-REC   TO TARDAT
                                          MPAEDT OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAEDT OF EEWSUB(ESBACT).
           MOVE MPAETD OF EEWDET-REC   TO TARDAT
                                          MPAETD OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAETD OF EEWSUB(ESBACT).
           MOVE MPAEFD OF EEWDET-REC   TO TARDAT
                                          MPAEFD OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAEFD OF EEWSUB(ESBACT).
           MOVE MPATDT OF EEWDET-REC   TO TARDAT
                                          MPATDT OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPATDT OF EEWSUB(ESBACT).
           MOVE MPBEDT OF EEWDET-REC   TO TARDAT
                                          MPBEDT OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBEDT OF EEWSUB(ESBACT).
           MOVE MPBETD OF EEWDET-REC   TO TARDAT
                                          MPBETD OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBETD OF EEWSUB(ESBACT).
           MOVE MPBEFD OF EEWDET-REC   TO TARDAT
                                          MPBEFD OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBEFD OF EEWSUB(ESBACT).
           MOVE MPBTDT OF EEWDET-REC   TO TARDAT
                                          MPBTDT OF EETSUB(ESBACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBTDT OF EEWSUB(ESBACT).
           MOVE CRDCNT OF EEWDET-REC   TO CRDCNT OF EEWSUB(ESBACT)
                                          CRDCNT OF EETSUB(ESBACT).
           MOVE MHCIND OF EEWDET-REC   TO MHCIND OF EEWSUB(ESBACT)
                                          MHCIND OF EETSUB(ESBACT).
           MOVE INDUPD OF EEWDET-REC   TO INDUPD OF EEWSUB(ESBACT)
                                          INDUPD OF EETSUB(ESBACT).
           MOVE OMEDAT OF EEWDET-REC   TO TARDAT
                                          OMEDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OMEDAT OF EEWSUB(ESBACT).
           MOVE CRDMTH OF EEWDET-REC   TO CRDMTH OF EEWSUB(ESBACT)
                                          CRDMTH OF EETSUB(ESBACT).
           MOVE USRFL1 OF EEWDET-REC   TO USRFL1 OF EEWSUB(ESBACT)
                                          USRFL1 OF EETSUB(ESBACT).
           MOVE USRFL2 OF EEWDET-REC   TO USRFL2 OF EEWSUB(ESBACT)
                                          USRFL2 OF EETSUB(ESBACT).
           MOVE USRFL3 OF EEWDET-REC   TO USRFL3 OF EEWSUB(ESBACT)
                                          USRFL3 OF EETSUB(ESBACT).
           MOVE ACCTN2 OF EEWDET-REC   TO ACCTN2 OF EEWSUB(ESBACT)
                                          ACCTN2 OF EETSUB(ESBACT).
           MOVE EECOVR OF EEWDET-REC   TO EECOVR OF EEWSUB(ESBACT)
                                          EECOVR OF EETSUB(ESBACT).
           MOVE PKGOVR OF EEWDET-REC   TO PKGOVR OF EEWSUB(ESBACT)
                                          PKGOVR OF EETSUB(ESBACT).
           MOVE CGAOVR OF EEWDET-REC   TO CGAOVR OF EEWSUB(ESBACT)
                                          CGAOVR OF EETSUB(ESBACT).
           MOVE CGTOVR OF EEWDET-REC   TO CGTOVR OF EEWSUB(ESBACT)
                                          CGTOVR OF EETSUB(ESBACT).
           MOVE DALOVR OF EEWDET-REC   TO DALOVR OF EEWSUB(ESBACT)
                                          DALOVR OF EETSUB(ESBACT).
           MOVE SALOVR OF EEWDET-REC   TO SALOVR OF EEWSUB(ESBACT)
                                          SALOVR OF EETSUB(ESBACT).
           MOVE CBXOVR OF EEWDET-REC   TO CBXOVR OF EEWSUB(ESBACT)
                                          CBXOVR OF EETSUB(ESBACT).
           MOVE CBEOVR OF EEWDET-REC   TO CBEOVR OF EEWSUB(ESBACT)
                                          CBEOVR OF EETSUB(ESBACT).
           MOVE APCOVR OF EEWDET-REC   TO APCOVR OF EEWSUB(ESBACT)
                                          APCOVR OF EETSUB(ESBACT).
           MOVE SSSOVR OF EEWDET-REC   TO SSSOVR OF EEWSUB(ESBACT)
                                          SSSOVR OF EETSUB(ESBACT).
           MOVE VRCOVR OF EEWDET-REC   TO VRCOVR OF EEWSUB(ESBACT)
                                          VRCOVR OF EETSUB(ESBACT).
           MOVE RMTOVR OF EEWDET-REC   TO RMTOVR OF EEWSUB(ESBACT)
                                          RMTOVR OF EETSUB(ESBACT).
           MOVE EXTMEM OF EEWDET-REC   TO EXTMEM OF EEWSUB(ESBACT)
                                          EXTMEM OF EETSUB(ESBACT).
           MOVE EXTGRP OF EEWDET-REC   TO EXTGRP OF EEWSUB(ESBACT)
                                          EXTGRP OF EETSUB(ESBACT).
           MOVE EXTCON OF EEWDET-REC   TO EXTCON OF EEWSUB(ESBACT)
                                          EXTCON OF EETSUB(ESBACT).
           MOVE EXTEFF OF EEWDET-REC   TO TARDAT
                                          EXTEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO EXTEFF OF EEWSUB(ESBACT).
           MOVE EXTEXP OF EEWDET-REC   TO TARDAT
                                          EXTEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO EXTEXP OF EEWSUB(ESBACT).
           MOVE EXTSUB OF EEWDET-REC   TO EXTSUB OF EEWSUB(ESBACT)
                                          EXTSUB OF EETSUB(ESBACT).
           MOVE EXTREL OF EEWDET-REC   TO EXTREL OF EEWSUB(ESBACT)
                                          EXTREL OF EETSUB(ESBACT).
           MOVE HISSEQ OF EEWDET-REC   TO HISSEQ OF EEWSUB(ESBACT)
                                          HISSEQ OF EETSUB(ESBACT).
           MOVE CTLPLN OF EEWDET-REC   TO CTLPLN OF EEWSUB(ESBACT)
                                          CTLPLN OF EETSUB(ESBACT).
           MOVE PRVPLN OF EEWDET-REC   TO PRVPLN OF EEWSUB(ESBACT)
                                          PRVPLN OF EETSUB(ESBACT).
           MOVE PRVNET OF EEWDET-REC   TO PRVNET OF EEWSUB(ESBACT)
                                          PRVNET OF EETSUB(ESBACT).
           MOVE PROCOD OF EEWDET-REC   TO PROCOD OF EEWSUB(ESBACT)
                                          PROCOD OF EETSUB(ESBACT).
           MOVE BILMOD OF EEWDET-REC   TO BILMOD OF EEWSUB(ESBACT)
                                          BILMOD OF EETSUB(ESBACT).
           MOVE BEGMTH OF EEWDET-REC   TO BEGMTH OF EEWSUB(ESBACT)
                                          BEGMTH OF EETSUB(ESBACT).
           MOVE IMDBIL OF EEWDET-REC   TO IMDBIL OF EEWSUB(ESBACT)
                                          IMDBIL OF EETSUB(ESBACT).
           MOVE INTBIL OF EEWDET-REC   TO INTBIL OF EEWSUB(ESBACT)
                                          INTBIL OF EETSUB(ESBACT).
           MOVE BILCYC OF EEWDET-REC   TO BILCYC OF EEWSUB(ESBACT)
                                          BILCYC OF EETSUB(ESBACT).
           MOVE SALAMT OF EEWDET-REC   TO SALAMT OF EEWSUB(ESBACT)
                                          SALAMT OF EETSUB(ESBACT).
           MOVE PAYLOC OF EEWDET-REC   TO PAYLOC OF EEWSUB(ESBACT)
                                          PAYLOC OF EETSUB(ESBACT).
           MOVE PAYNUM OF EEWDET-REC   TO PAYNUM OF EEWSUB(ESBACT)
                                          PAYNUM OF EETSUB(ESBACT).
           MOVE DOCNUM OF EEWDET-REC   TO DOCNUM OF EEWSUB(ESBACT)
                                          DOCNUM OF EETSUB(ESBACT).
           MOVE SALEFF OF EEWDET-REC   TO TARDAT
                                          SALEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SALEFF OF EEWSUB(ESBACT).
           MOVE SALEXP OF EEWDET-REC   TO TARDAT
                                          SALEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SALEXP OF EEWSUB(ESBACT).
           MOVE OTHINS OF EEWDET-REC   TO OTHINS OF EEWSUB(ESBACT)
                                          OTHINS OF EETSUB(ESBACT).
           MOVE COBDAT OF EEWDET-REC   TO TARDAT
                                          COBDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO COBDAT OF EEWSUB(ESBACT).
           MOVE PRICOD OF EEWDET-REC   TO PRICOD OF EEWSUB(ESBACT)
                                          PRICOD OF EETSUB(ESBACT).
           MOVE MEMNUM OF EEWDET-REC   TO MEMNUM OF EEWSUB(ESBACT)
                                          MEMNUM OF EETSUB(ESBACT).
           MOVE GRPPOL OF EEWDET-REC   TO GRPPOL OF EEWSUB(ESBACT)
                                          GRPPOL OF EETSUB(ESBACT).
           MOVE OINNAM OF EEWDET-REC   TO OINNAM OF EEWSUB(ESBACT)
                                          OINNAM OF EETSUB(ESBACT).
           MOVE MEDCOV OF EEWDET-REC   TO MEDCOV OF EEWSUB(ESBACT)
                                          MEDCOV OF EETSUB(ESBACT).
           MOVE DENCOV OF EEWDET-REC   TO DENCOV OF EEWSUB(ESBACT)
                                          DENCOV OF EETSUB(ESBACT).

           MOVE OINNUM OF EEWDET-REC   TO OINNUM OF EEWSUB(ESBACT)
                                          OINNUM OF EETSUB(ESBACT).
           MOVE COVEFF OF EEWDET-REC   TO TARDAT
                                          COVEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COVEFF OF EEWSUB(ESBACT).
           MOVE COVEXP OF EEWDET-REC   TO TARDAT
                                          COVEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COVEXP OF EEWSUB(ESBACT).
           MOVE CQLECD OF EEWDET-REC   TO CQLECD OF EEWSUB(ESBACT)
                                          CQLECD OF EETSUB(ESBACT).
           MOVE COBRAQ OF EEWDET-REC   TO TARDAT
                                          COBRAQ OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAQ OF EEWSUB(ESBACT).
           MOVE COBRAB OF EEWDET-REC   TO TARDAT
                                          COBRAB OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAB OF EEWSUB(ESBACT).
           MOVE COBRAE OF EEWDET-REC   TO TARDAT
                                          COBRAE OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAE OF EEWSUB(ESBACT).
           MOVE EMSTCD OF EEWDET-REC   TO EMSTCD OF EEWSUB(ESBACT)
                                          EMSTCD OF EETSUB(ESBACT).
           MOVE DETDAT OF EEWDET-REC   TO TARDAT
                                          DETDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO DETDAT OF EEWSUB(ESBACT).
           MOVE MARSTA OF EEWDET-REC   TO MARSTA OF EEWSUB(ESBACT)
                                          MARSTA OF EETSUB(ESBACT).
           MOVE SPACES                           TO WS-DT1-SUB
                                                    WS-DT1-GRP
                                                    WS-SUB-EXCSUB.
           MOVE SUBSNO OF EEWDET-REC             TO WS-DT1-SUB.
           MOVE GRPNUM OF EEWDET-REC             TO WS-DT1-GRP.
           MOVE PYMTID OF EEWDET-REC   TO PYMTID OF EEWSUB(ESBACT)
                                          PYMTID OF EETSUB(ESBACT).
           MOVE COUNTY OF EEWDET-REC   TO COUNTY OF EEWSUB(ESBACT)
                                          COUNTY OF EETSUB(ESBACT).
           MOVE ETHCD1 OF EEWDET-REC   TO ETHCD1 OF EEWSUB(ESBACT)
                                          ETHCD1 OF EETSUB(ESBACT).
           MOVE ETHCD2 OF EEWDET-REC   TO ETHCD2 OF EEWSUB(ESBACT)
                                          ETHCD2 OF EETSUB(ESBACT).
           MOVE ETHCD3 OF EEWDET-REC   TO ETHCD3 OF EEWSUB(ESBACT)
                                          ETHCD3 OF EETSUB(ESBACT).
           MOVE ETHCD4 OF EEWDET-REC   TO ETHCD4 OF EEWSUB(ESBACT)
                                          ETHCD4 OF EETSUB(ESBACT).
           MOVE ETHCD5 OF EEWDET-REC   TO ETHCD5 OF EEWSUB(ESBACT)
                                          ETHCD5 OF EETSUB(ESBACT).
           MOVE ETHCD6 OF EEWDET-REC   TO ETHCD6 OF EEWSUB(ESBACT)
                                          ETHCD6 OF EETSUB(ESBACT).
           MOVE ETHCD7 OF EEWDET-REC   TO ETHCD7 OF EEWSUB(ESBACT)
                                          ETHCD7 OF EETSUB(ESBACT).
           MOVE ETHCD8 OF EEWDET-REC   TO ETHCD8 OF EEWSUB(ESBACT)
                                          ETHCD8 OF EETSUB(ESBACT).
           MOVE ETHCD9 OF EEWDET-REC   TO ETHCD9 OF EEWSUB(ESBACT)
                                          ETHCD9 OF EETSUB(ESBACT).
           MOVE EXCMEM OF EEWDET-REC   TO EXCMEM OF EEWSUB(ESBACT)
                                          EXCMEM OF EETSUB(ESBACT).
           MOVE EXCSUB OF EEWDET-REC   TO EXCSUB OF EEWSUB(ESBACT)
                                          EXCSUB OF EETSUB(ESBACT)
                                          WS-SUB-EXCSUB.
           MOVE RENREA OF EEWDET-REC   TO RENREA OF EEWSUB(ESBACT)
                                          RENREA OF EETSUB(ESBACT).
      *
           MOVE EEWDT2-WRK                       TO EEWMAS-REC.
           MOVE DETTYP OF EEWDT2-REC   TO DETTYP OF EETSUB(ESBACT).
           MOVE EXTIND OF EEWDT2-REC   TO EXTIND OF EEWSB2(ESBACT)
                                          EXTIND OF EETSUB(ESBACT).
           MOVE CITZEN OF EEWDT2-REC   TO CITZEN OF EEWSB2(ESBACT)
                                          CITZEN OF EETSUB(ESBACT).
           MOVE FRQCOD OF EEWDT2-REC   TO FRQCOD OF EEWSB2(ESBACT)
                                          FRQCOD OF EETSUB(ESBACT).
           MOVE WAGAMT OF EEWDT2-REC   TO WAGAMT OF EEWSB2(ESBACT)
                                          WAGAMT OF EETSUB(ESBACT).
           MOVE WRKHRS OF EEWDT2-REC   TO WRKHRS OF EEWSB2(ESBACT)
                                          WRKHRS OF EETSUB(ESBACT).
           MOVE WORKLC OF EEWDT2-REC   TO WORKLC OF EEWSB2(ESBACT)
                                          WORKLC OF EETSUB(ESBACT).
           MOVE SALGRD OF EEWDT2-REC   TO SALGRD OF EEWSB2(ESBACT)
                                          SALGRD OF EETSUB(ESBACT).
           MOVE HLTCOD OF EEWDT2-REC   TO HLTCOD OF EEWSB2(ESBACT)
                                          HLTCOD OF EETSUB(ESBACT).
           MOVE HEIGHT OF EEWDT2-REC   TO HEIGHT OF EEWSB2(ESBACT)
                                          HEIGHT OF EETSUB(ESBACT).
           MOVE WEIGHT OF EEWDT2-REC   TO WEIGHT OF EEWSB2(ESBACT)
                                          WEIGHT OF EETSUB(ESBACT).
           MOVE LNGCD1 OF EEWDT2-REC   TO LNGCD1 OF EEWSB2(ESBACT)
                                          LNGCD1 OF EETSUB(ESBACT).
           MOVE LNGUS1 OF EEWDT2-REC   TO LNGUS1 OF EEWSB2(ESBACT)
                                          LNGUS1 OF EETSUB(ESBACT).
           MOVE LNGCD2 OF EEWDT2-REC   TO LNGCD2 OF EEWSB2(ESBACT)
                                          LNGCD2 OF EETSUB(ESBACT).
           MOVE LNGUS2 OF EEWDT2-REC   TO LNGUS2 OF EEWSB2(ESBACT)
                                          LNGUS2 OF EETSUB(ESBACT).
           MOVE LNGCD3 OF EEWDT2-REC   TO LNGCD3 OF EEWSB2(ESBACT)
                                          LNGCD3 OF EETSUB(ESBACT).
           MOVE LNGUS3 OF EEWDT2-REC   TO LNGUS3 OF EEWSB2(ESBACT)
                                          LNGUS3 OF EETSUB(ESBACT).
           MOVE LNGCD4 OF EEWDT2-REC   TO LNGCD4 OF EEWSB2(ESBACT)
                                          LNGCD4 OF EETSUB(ESBACT).
           MOVE LNGUS4 OF EEWDT2-REC   TO LNGUS4 OF EEWSB2(ESBACT)
                                          LNGUS4 OF EETSUB(ESBACT).
           MOVE LNGCD5 OF EEWDT2-REC   TO LNGCD5 OF EEWSB2(ESBACT)
                                          LNGCD5 OF EETSUB(ESBACT).
           MOVE LNGUS5 OF EEWDT2-REC   TO LNGUS5 OF EEWSB2(ESBACT)
                                          LNGUS5 OF EETSUB(ESBACT).
           MOVE SCHOOL OF EEWDT2-REC   TO SCHOOL OF EEWSB2(ESBACT)
                                          SCHOOL OF EETSUB(ESBACT).
           MOVE SPHNUM OF EEWDT2-REC   TO SPHNUM OF EEWSB2(ESBACT)
                                          SPHNUM OF EETSUB(ESBACT).
           MOVE SPHEXT OF EEWDT2-REC   TO SPHEXT OF EEWSB2(ESBACT)
                                          SPHEXT OF EETSUB(ESBACT).
           MOVE SFAXNB OF EEWDT2-REC   TO SFAXNB OF EEWSB2(ESBACT)
                                          SFAXNB OF EETSUB(ESBACT).
           MOVE SEMAIL OF EEWDT2-REC   TO SEMAIL OF EEWSB2(ESBACT)
                                          SEMAIL OF EETSUB(ESBACT).
           MOVE SADRL1 OF EEWDT2-REC   TO SADRL1 OF EEWSB2(ESBACT)
                                          SADRL1 OF EETSUB(ESBACT).
           MOVE SADRL2 OF EEWDT2-REC   TO SADRL2 OF EEWSB2(ESBACT)
                                          SADRL2 OF EETSUB(ESBACT).
           MOVE SCTYCD OF EEWDT2-REC   TO SCTYCD OF EEWSB2(ESBACT)
                                          SCTYCD OF EETSUB(ESBACT).
           MOVE SSTACD OF EEWDT2-REC   TO SSTACD OF EEWSB2(ESBACT)
                                          SSTACD OF EETSUB(ESBACT).
           MOVE SZIPCD OF EEWDT2-REC   TO SZIPCD OF EEWSB2(ESBACT)
                                          SZIPCD OF EETSUB(ESBACT).
           MOVE SCNTRY OF EEWDT2-REC   TO SCNTRY OF EEWSB2(ESBACT)
                                          SCNTRY OF EETSUB(ESBACT).
           MOVE RSPIND OF EEWDT2-REC   TO RSPIND OF EEWSB2(ESBACT)
                                          RSPIND OF EETSUB(ESBACT).
           MOVE RSPIDC OF EEWDT2-REC   TO RSPIDC OF EEWSB2(ESBACT)
                                          RSPIDC OF EETSUB(ESBACT).
           MOVE RSPLST OF EEWDT2-REC   TO RSPLST OF EEWSB2(ESBACT)
                                          RSPLST OF EETSUB(ESBACT).
           MOVE RSPFST OF EEWDT2-REC   TO RSPFST OF EEWSB2(ESBACT)
                                          RSPFST OF EETSUB(ESBACT).
           MOVE RSPMID OF EEWDT2-REC   TO RSPMID OF EEWSB2(ESBACT)
                                          RSPMID OF EETSUB(ESBACT).
           MOVE RSPTTL OF EEWDT2-REC   TO RSPTTL OF EEWSB2(ESBACT)
                                          RSPTTL OF EETSUB(ESBACT).
           MOVE RSPFRM OF EEWDT2-REC   TO RSPFRM OF EEWSB2(ESBACT)
                                          RSPFRM OF EETSUB(ESBACT).
           MOVE RESPNB OF EEWDT2-REC   TO RESPNB OF EEWSB2(ESBACT)
                                          RESPNB OF EETSUB(ESBACT).
           MOVE RHOMPH OF EEWDT2-REC   TO RHOMPH OF EEWSB2(ESBACT)
                                          RHOMPH OF EETSUB(ESBACT).
           MOVE RWRKPH OF EEWDT2-REC   TO RWRKPH OF EEWSB2(ESBACT)
                                          RWRKPH OF EETSUB(ESBACT).
           MOVE RWKEXT OF EEWDT2-REC   TO RWKEXT OF EEWSB2(ESBACT)
                                          RSPEXT OF EETSUB(ESBACT).
           MOVE RFAXNB OF EEWDT2-REC   TO RFAXNB OF EEWSB2(ESBACT)
                                          RFAXNB OF EETSUB(ESBACT).
           MOVE ROTHPH OF EEWDT2-REC   TO ROTHPH OF EEWSB2(ESBACT)
                                          ROTHPH OF EETSUB(ESBACT).
           MOVE REMLIN OF EEWDT2-REC   TO REMLIN OF EEWSB2(ESBACT)
                                          REMLIN OF EETSUB(ESBACT).
           MOVE REMAIL OF EEWDT2-REC   TO REMAIL OF EEWSB2(ESBACT)
                                          REMAIL OF EETSUB(ESBACT).
           MOVE RCNTCT OF EEWDT2-REC   TO RCNTCT OF EEWSB2(ESBACT)
                                          RCNTCT OF EETSUB(ESBACT).
           MOVE RADLN1 OF EEWDT2-REC   TO RADLN1 OF EEWSB2(ESBACT)
                                          RADLN1 OF EETSUB(ESBACT).
           MOVE RADLN2 OF EEWDT2-REC   TO RADLN2 OF EEWSB2(ESBACT)
                                          RADLN2 OF EETSUB(ESBACT).
           MOVE RCTYCD OF EEWDT2-REC   TO RCTYCD OF EEWSB2(ESBACT)
                                          RCTYCD OF EETSUB(ESBACT).
           MOVE RSTACD OF EEWDT2-REC   TO RSTACD OF EEWSB2(ESBACT)
                                          RSTACD OF EETSUB(ESBACT).
           MOVE RZIPCD OF EEWDT2-REC   TO RZIPCD OF EEWSB2(ESBACT)
                                          RZIPCD OF EETSUB(ESBACT).
           MOVE RCNTRY OF EEWDT2-REC   TO RCNTRY OF EEWSB2(ESBACT)
                                          RCNTRY OF EETSUB(ESBACT).
           MOVE BENIND OF EEWDT2-REC   TO BENIND OF EEWSB2(ESBACT)
                                          BENIND OF EETSUB(ESBACT).
           MOVE HSAIND OF EEWDT2-REC   TO HSAIND OF EEWSB2(ESBACT)
                                          HSAIND OF EETSUB(ESBACT).
           MOVE HRAIND OF EEWDT2-REC   TO HRAIND OF EEWSB2(ESBACT)
                                          HRAIND OF EETSUB(ESBACT).
           MOVE FSAIND OF EEWDT2-REC   TO FSAIND OF EEWSB2(ESBACT)
                                          FSAIND OF EETSUB(ESBACT).
           MOVE OTHIND OF EEWDT2-REC   TO OTHIND OF EEWSB2(ESBACT)
                                          OTHIND OF EETSUB(ESBACT).
           MOVE MPDIND OF EEWDT2-REC   TO MPDIND OF EEWSB2(ESBACT)
                                          MPDIND OF EETSUB(ESBACT).
           MOVE PHAIND OF EEWDT2-REC   TO PHAIND OF EEWSB2(ESBACT)
                                          PHAIND OF EETSUB(ESBACT).
           MOVE DENIND OF EEWDT2-REC   TO DENIND OF EEWSB2(ESBACT)
                                          DENIND OF EETSUB(ESBACT).
           MOVE VISIND OF EEWDT2-REC   TO VISIND OF EEWSB2(ESBACT)
                                          VISIND OF EETSUB(ESBACT).
           MOVE MHTIND OF EEWDT2-REC   TO MHTIND OF EEWSB2(ESBACT)
                                          MHTIND OF EETSUB(ESBACT).
           MOVE OTHBEN OF EEWDT2-REC   TO OTHBEN OF EEWSB2(ESBACT)
                                          OTHBEN OF EETSUB(ESBACT).
           MOVE FSAAMT OF EEWDT2-REC   TO FSAAMT OF EEWSB2(ESBACT)
                                          FSAAMT OF EETSUB(ESBACT).
           MOVE ALTIND OF EEWDT2-REC   TO ALTIND OF EEWSB2(ESBACT)
                                          ALTIND OF EETSUB(ESBACT).
           MOVE ALTAD1 OF EEWDT2-REC   TO ALTAD1 OF EEWSB2(ESBACT)
                                          ALTAD1 OF EETSUB(ESBACT).
           MOVE ALTAD2 OF EEWDT2-REC   TO ALTAD2 OF EEWSB2(ESBACT)
                                          ALTAD2 OF EETSUB(ESBACT).
           MOVE ALTCTY OF EEWDT2-REC   TO ALTCTY OF EEWSB2(ESBACT)
                                          ALTCTY OF EETSUB(ESBACT).
           MOVE ALTSTT OF EEWDT2-REC   TO ALTSTT OF EEWSB2(ESBACT)
                                          ALTSTT OF EETSUB(ESBACT).
           MOVE ALTPST OF EEWDT2-REC   TO ALTPST OF EEWSB2(ESBACT)
                                          ALTPST OF EETSUB(ESBACT).
           MOVE ALTCNR OF EEWDT2-REC   TO ALTCNR OF EEWSB2(ESBACT)
                                          ALTCNR OF EETSUB(ESBACT).
           MOVE EPCLS1 OF EEWDT2-REC   TO EPCLS1 OF EEWSB2(ESBACT)
                                          EPCLS1 OF EETSUB(ESBACT).
           MOVE EPCLS2 OF EEWDT2-REC   TO EPCLS2 OF EEWSB2(ESBACT)
                                          EPCLS2 OF EETSUB(ESBACT).
           MOVE EPCLS3 OF EEWDT2-REC   TO EPCLS3 OF EEWSB2(ESBACT)
                                          EPCLS3 OF EETSUB(ESBACT).
           MOVE RPCTNM OF EEWDT2-REC   TO RPCTNM OF EEWSB2(ESBACT)
                                          RPCTNM OF EETSUB(ESBACT).
           MOVE RPCTQL OF EEWDT2-REC   TO RPCTQL OF EEWSB2(ESBACT)
                                          RPCTQL OF EETSUB(ESBACT).
           MOVE RPCTID OF EEWDT2-REC   TO RPCTID OF EEWSB2(ESBACT)
                                          RPCTID OF EETSUB(ESBACT).
           MOVE RDTFMT OF EEWDT2-REC   TO RDTFMT OF EEWSB2(ESBACT)
                                          RDTFMT OF EETSUB(ESBACT).
           MOVE RCTDAT OF EEWDT2-REC   TO RCTDAT OF EEWSB2(ESBACT)
                                          RCTDAT OF EETSUB(ESBACT).
           MOVE DOLLST OF EEWDT2-REC   TO DOLLST OF EEWSB2(ESBACT)
                                          DOLLST OF EETSUB(ESBACT).
           MOVE DOLFST OF EEWDT2-REC   TO DOLFST OF EEWSB2(ESBACT)
                                          DOLFST OF EETSUB(ESBACT).
           MOVE DOLMID OF EEWDT2-REC   TO DOLMID OF EEWSB2(ESBACT)
                                          DOLMID OF EETSUB(ESBACT).
           MOVE DOLPRE OF EEWDT2-REC   TO DOLPRE OF EEWSB2(ESBACT)
                                          DOLPRE OF EETSUB(ESBACT).
           MOVE DOLSUF OF EEWDT2-REC   TO DOLSUF OF EEWSB2(ESBACT)
                                          DOLSUF OF EETSUB(ESBACT).
           MOVE DOLAD1 OF EEWDT2-REC   TO DOLAD1 OF EEWSB2(ESBACT)
                                          DOLAD1 OF EETSUB(ESBACT).
           MOVE DOLAD2 OF EEWDT2-REC   TO DOLAD2 OF EEWSB2(ESBACT)
                                          DOLAD2 OF EETSUB(ESBACT).
           MOVE DOLCTY OF EEWDT2-REC   TO DOLCTY OF EEWSB2(ESBACT)
                                          DOLCTY OF EETSUB(ESBACT).
           MOVE DOLSTA OF EEWDT2-REC   TO DOLSTA OF EEWSB2(ESBACT)
                                          DOLSTA OF EETSUB(ESBACT).
           MOVE DOLZIP OF EEWDT2-REC   TO DOLZIP OF EEWSB2(ESBACT)
                                          DOLZIP OF EETSUB(ESBACT).
           MOVE DOLCCD OF EEWDT2-REC   TO DOLCCD OF EEWSB2(ESBACT)
                                          DOLCCD OF EETSUB(ESBACT).
           MOVE DOLSCD OF EEWDT2-REC   TO DOLSCD OF EEWSB2(ESBACT)
                                          DOLSCD OF EETSUB(ESBACT).
           MOVE ICMRCQ OF EEWDT2-REC   TO ICMRCQ OF EEWSB2(ESBACT)
                                          ICMRCQ OF EETSUB(ESBACT).
           MOVE ICMRCC OF EEWDT2-REC   TO ICMRCC OF EEWSB2(ESBACT)
                                          ICMRCC OF EETSUB(ESBACT).
           MOVE MDRCCC OF EEWDT2-REC   TO MDRCCC OF EEWSB2(ESBACT)
                                          MDRCCC OF EETSUB(ESBACT).
           MOVE COBAD1 OF EEWDT2-REC   TO COBAD1 OF EEWSB2(ESBACT)
                                          COBAD1 OF EETSUB(ESBACT).
           MOVE COBAD2 OF EEWDT2-REC   TO COBAD2 OF EEWSB2(ESBACT)
                                          COBAD2 OF EETSUB(ESBACT).
           MOVE COBCTY OF EEWDT2-REC   TO COBCTY OF EEWSB2(ESBACT)
                                          COBCTY OF EETSUB(ESBACT).
           MOVE COBSTA OF EEWDT2-REC   TO COBSTA OF EEWSB2(ESBACT)
                                          COBSTA OF EETSUB(ESBACT).
           MOVE COBZIP OF EEWDT2-REC   TO COBZIP OF EEWSB2(ESBACT)
                                          COBZIP OF EETSUB(ESBACT).
           MOVE COBCCD OF EEWDT2-REC   TO COBCCD OF EEWSB2(ESBACT)
                                          COBCCD OF EETSUB(ESBACT).
           MOVE COBCSB OF EEWDT2-REC   TO COBCSB OF EEWSB2(ESBACT)
                                          COBCSB OF EETSUB(ESBACT).
           MOVE COBPHN OF EEWDT2-REC   TO COBPHN OF EEWSB2(ESBACT)
                                          COBPHN OF EETSUB(ESBACT).
           MOVE CSPCSB OF EEWDT2-REC   TO CSPCSB OF EEWSB2(ESBACT)
                                          CSPCSB OF EETSUB(ESBACT).
           MOVE CNTSCD OF EEWDT2-REC   TO CNTSCD OF EEWSB2(ESBACT)
                                          CNTSCD OF EETSUB(ESBACT).
           MOVE SCHSCD OF EEWDT2-REC   TO SCHSCD OF EEWSB2(ESBACT)
                                          SCHSCD OF EETSUB(ESBACT).
           MOVE RPTCSB OF EEWDT2-REC   TO RPTCSB OF EEWSB2(ESBACT)
                                          RPTCSB OF EETSUB(ESBACT).
           MOVE MBMCSB OF EEWDT2-REC   TO MBMCSB OF EEWSB2(ESBACT)
                                          MBMCSB OF EETSUB(ESBACT).
           MOVE CALTPH OF EEWDT2-REC   TO CALTPH OF EEWSB2(ESBACT)
                                          CALTPH OF EETSUB(ESBACT).
           MOVE CBEPNB OF EEWDT2-REC   TO CBEPNB OF EEWSB2(ESBACT)
                                          CBEPNB OF EETSUB(ESBACT).
           MOVE CCELPH OF EEWDT2-REC   TO CCELPH OF EEWSB2(ESBACT)
                                          CCELPH OF EETSUB(ESBACT).
           MOVE RALTPH OF EEWDT2-REC   TO RALTPH OF EEWSB2(ESBACT)
                                          RALTPH OF EETSUB(ESBACT).
           MOVE RBEPNB OF EEWDT2-REC   TO RBEPNB OF EEWSB2(ESBACT)
                                          RBEPNB OF EETSUB(ESBACT).
           MOVE RCELPH OF EEWDT2-REC   TO RCELPH OF EEWSB2(ESBACT)
                                          RCELPH OF EETSUB(ESBACT).
           MOVE ALTPHN OF EEWDT2-REC   TO ALTPHN OF EEWSB2(ESBACT)
                                          ALTPHN OF EETSUB(ESBACT).
           MOVE BEPNBR OF EEWDT2-REC   TO BEPNBR OF EEWSB2(ESBACT)
                                          BEPNBR OF EETSUB(ESBACT).
           MOVE CELPHN OF EEWDT2-REC   TO CELPHN OF EEWSB2(ESBACT)
                                          CELPHN OF EETSUB(ESBACT).
           MOVE SCHCLK OF EEWDT2-REC   TO SCHCLK OF EEWSB2(ESBACT)
                                          SCHCLK OF EETSUB(ESBACT).
           MOVE CNFCOD OF EEWDT2-REC   TO CNFCOD OF EEWSB2(ESBACT)
                                          CNFCOD OF EETSUB(ESBACT).
      *
           MOVE PRVSUB OF EEWDT2-REC   TO PRVSUB OF EEWSB2(ESBACT)
                                          PRVSUB OF EETSUB(ESBACT).
           MOVE SMKCES OF EEWDT2-REC   TO SMKCES OF EEWSB2(ESBACT)
                                          SMKCES OF EETSUB(ESBACT).
           MOVE EXCPOL OF EEWDT2-REC   TO EXCPOL OF EEWSB2(ESBACT)
                                          EXCPOL OF EETSUB(ESBACT).
           MOVE WS-APLORG1             TO APLORG OF EEWDT3-REC.
           MOVE APLORG OF EEWDT3-REC   TO APLORG OF EEWSB3(ESBACT)
                                          APLORG OF EETSUB(ESBACT).
           MOVE SHPGRP OF EEWDT2-REC   TO SHPGRP OF EEWSB2(ESBACT)
                                          SHPGRP OF EETSUB(ESBACT).
           MOVE EXCHNG OF EEWDT2-REC   TO EXCHNG OF EEWSB2(ESBACT)
                                          EXCHNG OF EETSUB(ESBACT).
      *
           MOVE EEWDT3-WRK                       TO EEWMAS-REC.
           MOVE DETTYP OF EEWDT3-REC   TO DETTYP OF EETSUB(ESBACT).
           MOVE GRPNUM OF EEWDT3-REC   TO GRPNUM OF EEWSB3(ESBACT)
                                          GRPNUM OF EETSUB(ESBACT).
           MOVE SUBSNO OF EEWDT3-REC   TO SUBSNO OF EEWSB3(ESBACT)
                                          SUBSNO OF EETSUB(ESBACT).
           MOVE RELTYP OF EEWDT3-REC   TO RELTYP OF EEWSB3(ESBACT)
                                          RELTYP OF EETSUB(ESBACT).
           MOVE RELCOD OF EEWDT3-REC   TO RELCOD OF EEWSB3(ESBACT)
                                          RELCOD OF EETSUB(ESBACT).
           MOVE MEMBNO OF EEWDT3-REC   TO MEMBNO OF EEWSB3(ESBACT)
                                          MEMBNO OF EETSUB(ESBACT).
           MOVE BTHDAT OF EEWDT3-REC   TO BTHDAT OF EEWSB3(ESBACT)
                                          BTHDAT OF EETSUB(ESBACT).
           MOVE SEXCOD OF EEWDT3-REC   TO SEXCOD OF EEWSB3(ESBACT)
                                          SEXCOD OF EETSUB(ESBACT).
           MOVE CHGTYP OF EEWDT3-REC   TO CHGTYP OF EEWSB3(ESBACT)
                                          CHGTYP OF EETSUB(ESBACT).
           MOVE ASSQHP OF EEWDT3-REC   TO ASSQHP OF EEWSB3(ESBACT)
                                          ASSQHP OF EETSUB(ESBACT)
                                          WS-DT3-ASSQHP.
           MOVE CHGDAT OF EEWDT3-REC   TO TARDAT
                                          CHGDAT OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGDAT OF EEWSB3(ESBACT).
           MOVE CHGTIM OF EEWDT3-REC   TO CHGTIM OF EEWSB3(ESBACT)
                                          CHGTIM OF EETSUB(ESBACT).
           MOVE REPNAM OF EEWDT3-REC   TO REPNAM OF EEWSB3(ESBACT)
                                          REPNAM OF EETSUB(ESBACT).
           MOVE REPRFQ OF EEWDT3-REC   TO REPRFQ OF EEWSB3(ESBACT)
                                          REPRFQ OF EETSUB(ESBACT).
           MOVE REPREF OF EEWDT3-REC   TO REPREF OF EEWSB3(ESBACT)
                                          REPREF OF EETSUB(ESBACT).
           MOVE REPEFQ OF EEWDT3-REC   TO REPEFQ OF EEWSB3(ESBACT)
                                          REPEFQ OF EETSUB(ESBACT).
           MOVE REPEFF OF EEWDT3-REC   TO REPEFF OF EEWSB3(ESBACT)
                                          REPEFF OF EETSUB(ESBACT).
           MOVE ENTSEQ OF EEWDT3-REC   TO ENTSEQ OF EEWSB3(ESBACT)
                                          ENTSEQ OF EETSUB(ESBACT).
           MOVE OPYAMT OF EEWDT3-REC   TO OPYAMT OF EEWSB3(ESBACT)
                                          OPYAMT OF EETSUB(ESBACT).
           MOVE OPYEFF OF EEWDT3-REC   TO TARDAT
                                          OPYEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OPYEFF OF EEWSB3(ESBACT).
           MOVE OPYEXP OF EEWDT3-REC   TO TARDAT
                                          OPYEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OPYEXP OF EEWSB3(ESBACT).
           MOVE OPYSRC OF EEWDT3-REC   TO OPYSRC OF EEWSB3(ESBACT)
                                          OPYSRC OF EETSUB(ESBACT).
           MOVE APTAMT OF EEWDT3-REC   TO APTAMT OF EEWSB3(ESBACT)
                                          APTAMT OF EETSUB(ESBACT).
           MOVE APTEFF OF EEWDT3-REC   TO TARDAT
                                          APTEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO APTEFF OF EEWSB3(ESBACT).
           MOVE APTEXP OF EEWDT3-REC   TO TARDAT
                                          APTEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO APTEXP OF EEWSB3(ESBACT).
           MOVE CSRAMT OF EEWDT3-REC   TO CSRAMT OF EEWSB3(ESBACT)
                                          CSRAMT OF EETSUB(ESBACT).
           MOVE CSREFF OF EEWDT3-REC   TO TARDAT
                                          CSREFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CSREFF OF EEWSB3(ESBACT).
           MOVE CSREXP OF EEWDT3-REC   TO TARDAT
                                          CSREXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CSREXP OF EEWSB3(ESBACT).
           MOVE PREAMT OF EEWDT3-REC   TO PREAMT OF EEWSB3(ESBACT)
                                          PREAMT OF EETSUB(ESBACT).
           MOVE PREEFF OF EEWDT3-REC   TO TARDAT
                                          PREEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PREEFF OF EEWSB3(ESBACT).
           MOVE PREEXP OF EEWDT3-REC   TO TARDAT
                                          PREEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PREEXP OF EEWSB3(ESBACT).
           MOVE RSPTOT OF EEWDT3-REC   TO RSPTOT OF EEWSB3(ESBACT)
                                          RSPTOT OF EETSUB(ESBACT).
           MOVE RSPEFF OF EEWDT3-REC   TO TARDAT
                                          RSPEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RSPEFF OF EEWSB3(ESBACT).
           MOVE RSPEXP OF EEWDT3-REC   TO TARDAT
                                          RSPEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RSPEXP OF EEWSB3(ESBACT).
           MOVE PRETOT OF EEWDT3-REC   TO PRETOT OF EEWSB3(ESBACT)
                                          PRETOT OF EETSUB(ESBACT).
           MOVE PTOEFF OF EEWDT3-REC   TO TARDAT
                                          PTOEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PTOEFF OF EEWSB3(ESBACT).
           MOVE PTOEXP OF EEWDT3-REC   TO TARDAT
                                          PTOEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PTOEXP OF EEWSB3(ESBACT).
           MOVE EMPTOT OF EEWDT3-REC   TO EMPTOT OF EEWSB3(ESBACT)
                                          EMPTOT OF EETSUB(ESBACT).
           MOVE EMPEFF OF EEWDT3-REC   TO TARDAT
                                          EMPEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EMPEFF OF EEWSB3(ESBACT).
           MOVE EMPEXP OF EEWDT3-REC   TO TARDAT
                                          EMPEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EMPEXP OF EEWSB3(ESBACT).
           MOVE WS-REACAT2             TO REACAT OF EEWDT3-REC.
           MOVE REACAT OF EEWDT3-REC   TO REACAT OF EEWSB3(ESBACT)
                                          REACAT OF EETSUB(ESBACT).
           MOVE WS-CANEFF1             TO CANEFF OF EEWDT3-REC.
           MOVE CANEFF OF EEWDT3-REC   TO TARDAT
                                          CANEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CANEFF OF EEWSB3(ESBACT).
           MOVE WS-TRMEFF1             TO TRMEFF OF EEWDT3-REC.
           MOVE TRMEFF OF EEWDT3-REC   TO TARDAT
                                          TRMEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO TRMEFF OF EEWSB3(ESBACT).
           MOVE RATARA OF EEWDT3-REC   TO RATARA OF EEWSB3(ESBACT)
                                          RATARA OF EETSUB(ESBACT).
           MOVE RATEFF OF EEWDT3-REC   TO TARDAT
                                          RATEFF OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RATEFF OF EEWSB3(ESBACT).
           MOVE RATEXP OF EEWDT3-REC   TO TARDAT
                                          RATEXP OF EETSUB(ESBACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RATEXP OF EEWSB3(ESBACT).
           MOVE REQTIM OF EEWDT3-REC   TO REQTIM OF EEWSB3(ESBACT)
                                          REQTIM OF EETSUB(ESBACT).
           MOVE REQEFF OF EEWDT3-REC   TO REQEFF OF EETSUB(ESBACT)
                                          REQEFF OF EEWSB3(ESBACT).
           MOVE REQEXP OF EEWDT3-REC   TO REQEXP OF EETSUB(ESBACT)
                                          REQEXP OF EEWSB3(ESBACT).
           MOVE TENTID OF EEWDT3-REC   TO TENTID OF EEWSB3(ESBACT)
                                          TENTID OF EETSUB(ESBACT).
           MOVE TENEFF OF EEWDT3-REC   TO TENEFF OF EETSUB(ESBACT)
                                          TENEFF OF EEWSB3(ESBACT).
           MOVE TENEXP OF EEWDT3-REC   TO TENEXP OF EETSUB(ESBACT)
                                          TENEXP OF EEWSB3(ESBACT).
           MOVE SEPREA OF EEWDT3-REC   TO SEPREA OF EEWSB3(ESBACT)
                                          SEPREA OF EETSUB(ESBACT).
           MOVE SEPEFF OF EEWDT3-REC   TO SEPEFF OF EETSUB(ESBACT)
                                          SEPEFF OF EEWSB3(ESBACT).
           MOVE SEPEXP OF EEWDT3-REC   TO SEPEXP OF EETSUB(ESBACT)
                                          SEPEXP OF EEWSB3(ESBACT).
           MOVE REAEFF OF EEWDT3-REC   TO REAEFF OF EETSUB(ESBACT)
                                          REAEFF OF EEWSB3(ESBACT).
           MOVE REAEXP OF EEWDT3-REC   TO REAEXP OF EETSUB(ESBACT)
                                          REAEXP OF EEWSB3(ESBACT).
      *
           MOVE WS-APLORG1             TO APLORG OF EEWDT3-REC.
           MOVE APLORG OF EEWDT3-REC   TO APLORG OF EETSUB(ESBACT)
                                          APLORG OF EEWSB3(ESBACT).
      *
           IF CURENT(15) < EBYACT
              MOVE EBYACT                        TO CURENT(15).
      *
           IF EBYACT > (EBYMAX * WS-MAXPCT) / 100
           AND WS-FLG-EEWBYP NOT = 'Y'
              MOVE EBYACT                        TO WS-EBYACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'EEWBYP'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE SUBSNO OF EEWDET-WRK          TO MI-PARM7
              MOVE GRPNUM OF EEWDET-WRK          TO MI-PARM8
              MOVE WS-EBYACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-EEWBYP
           END-IF.
      *
           IF EBYACT > EBYMAX
              MOVE 'Y'                  TO PRCERR OF PGM-WORK
              MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
              MOVE SPACES               TO ERR-LINE
              MOVE GRPNUM OF EEWDET-WRK TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDET-WRK TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDET-WRK TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDET-WRK TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDET-WRK TO CHGTYP OF ERR-LINE
              MOVE 'EI08001'            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI08001'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A219-EXIT.

           IF IN-DEBUG
              DISPLAY '@@@ BY-PASS EDIT: ' BYPEDT OF EDIENR-REC
              DISPLAY '@@@ SUB'
                      ' MEMEFF: ' MEMEFF OF EEWSUB(ESBACT)
                      ' MEMEXP: ' MEMEXP OF EEWSUB(ESBACT)
                      ' ENBEFF: ' ENBEFF OF EEWSUB(ESBACT)
                      ' ENBEXP: ' ENBEXP OF EEWSUB(ESBACT)
                      ' PCPEFF: ' PCPEFF OF EEWSUB(ESBACT)
                      ' PCPEXP: ' PCPEXP OF EEWSUB(ESBACT)
           END-IF.

           MOVE EEWSUB(ESBACT)                   TO EEWBYP(EBYACT).
           MOVE EEWSB2(ESBACT)                   TO EEWBY2(EBYACT).
           MOVE EEWSB3(ESBACT)                   TO EEWBY3(EBYACT).
      *
           MOVE 'S'                    TO TBLLNK(EBYACT).
           MOVE ESBACT                 TO TBLSEQ(EBYACT).
      *
           GO TO A219-EXIT.
       A215-DEPEND.
           ADD 1                                 TO EDPLST.
           ADD 1                                 TO EDPACT.
      *
           IF CURENT(07) < EDPACT
              MOVE EDPACT                        TO CURENT(07).
      *
           IF EDPACT > (EDPMAX * WS-MAXPCT) / 100
           AND WS-FLG-EEWDEP NOT = 'Y'
              MOVE EDPACT                        TO WS-EDPACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'EEWDEP'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE SUBSNO OF EEWDET-WRK          TO MI-PARM7
              MOVE GRPNUM OF EEWDET-WRK          TO MI-PARM8
              MOVE WS-EDPACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-EEWDEP
           END-IF.
      *
           IF EDPACT > EDPMAX
              MOVE 'Y'                  TO PRCERR OF PGM-WORK
              MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
              MOVE SPACES                         TO ERR-LINE
              MOVE GRPNUM OF EEWDET-WRK TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDET-WRK TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDET-WRK TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDET-WRK TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDET-WRK TO CHGTYP OF ERR-LINE
              MOVE 'EI08002'            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                       TO LINE-E
              MOVE 'EI08002'                      TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR            THRU X109-EXIT
              GO TO A219-EXIT.
      *
           MOVE EEWDET-WRK                       TO EEWMAS-REC.
           MOVE RECTYP OF EEWDET-REC   TO RECTYP OF EEWDEP(EDPACT)
                                          RECTYP OF EETDEP(EDPACT).
           MOVE DETTYP OF EEWDET-REC   TO DETTYP OF EEWDEP(EDPACT)
                                          RECTYP OF EETDEP(EDPACT).
           MOVE GRPNUM OF EEWDET-REC   TO GRPNUM OF EEWDEP(EDPACT)
                                          WS-DT2-GRPNUM
                                          GRPNUM OF EETDEP(EDPACT).
           MOVE SUBSNO OF EEWDET-REC   TO SUBSNO OF EEWDEP(EDPACT)
                                          SUBSNO OF EETDEP(EDPACT).
           MOVE RELCOD OF EEWDET-REC   TO RELCOD OF EEWDEP(EDPACT)
                                          RELCOD OF EETDEP(EDPACT).
           MOVE RELTYP OF EEWDET-REC   TO RELTYP OF EEWDEP(EDPACT)
                                          RELTYP OF EETDEP(EDPACT).
           MOVE MEMBNO OF EEWDET-REC   TO MEMBNO OF EEWDEP(EDPACT)
                                          MEMBNO OF EETDEP(EDPACT).
           MOVE BTHDAT OF EEWDET-REC   TO TARDAT
                                          BTHDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO BTHDAT OF EEWDEP(EDPACT).
           MOVE BTHSEQ OF EEWDET-REC   TO BTHSEQ OF EEWDEP(EDPACT)
                                          BTHSEQ OF EETDEP(EDPACT).
           MOVE BTHCHG OF EEWDET-REC   TO BTHCHG OF EEWDEP(EDPACT)
                                          BTHCHG OF EETDEP(EDPACT).
           MOVE SEXCOD OF EEWDET-REC   TO SEXCOD OF EEWDEP(EDPACT)
                                          SEXCOD OF EETDEP(EDPACT).
           MOVE SEXCHG OF EEWDET-REC   TO SEXCHG OF EEWDEP(EDPACT)
                                          SEXCHG OF EETDEP(EDPACT).
           MOVE CHGTYP OF EEWDET-REC   TO CHGTYP OF EEWDEP(EDPACT)
                                          CHGTYP OF EETDEP(EDPACT).
           MOVE CHGDAT OF EEWDET-REC   TO TARDAT
                                          CHGDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGDAT OF EEWDEP(EDPACT).
           MOVE CHGTIM OF EEWDET-REC   TO CHGTIM OF EEWDEP(EDPACT)
                                          CHGTIM OF EETDEP(EDPACT).
           MOVE CHGEFF OF EEWDET-REC   TO TARDAT
                                          CHGEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGEFF OF EEWDEP(EDPACT).
           MOVE NAMCHG OF EEWDET-REC   TO NAMCHG OF EEWDEP(EDPACT)
                                          NAMCHG OF EETDEP(EDPACT).
           MOVE LSTNAM OF EEWDET-REC   TO LSTNAM OF EEWDEP(EDPACT)
                                          LSTNAM OF EETDEP(EDPACT).
           MOVE FSTNAM OF EEWDET-REC   TO FSTNAM OF EEWDEP(EDPACT)
                                          FSTNAM OF EETDEP(EDPACT).
           MOVE MIDNAM OF EEWDET-REC   TO MIDNAM OF EEWDEP(EDPACT)
                                          MIDNAM OF EETDEP(EDPACT).
           MOVE TITLCD OF EEWDET-REC   TO TITLCD OF EEWDEP(EDPACT)
                                          TITLCD OF EETDEP(EDPACT).
           MOVE FORNAM OF EEWDET-REC   TO FORNAM OF EEWDEP(EDPACT)
                                          FORNAM OF EETDEP(EDPACT).
           MOVE MEMCHG OF EEWDET-REC   TO MEMCHG OF EEWDEP(EDPACT)
                                          MEMCHG OF EETDEP(EDPACT).
           MOVE EMPSTA OF EEWDET-REC   TO EMPSTA OF EEWDEP(EDPACT)
                                          EMPSTA OF EETDEP(EDPACT).
           MOVE PRTCOD OF EEWDET-REC   TO PRTCOD OF EEWDEP(EDPACT)
                                          PRTCOD OF EETDEP(EDPACT).
           MOVE MEMEFF OF EEWDET-REC   TO TARDAT
                                          MEMEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEMEFF OF EEWDEP(EDPACT).
           MOVE MEMEXP OF EEWDET-REC   TO TARDAT
                                          MEMEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEMEXP OF EEWDEP(EDPACT).
           MOVE MEMREA OF EEWDET-REC   TO MEMREA OF EEWDEP(EDPACT)
                                          MEMREA OF EETDEP(EDPACT).
           MOVE MEMTRM OF EEWDET-REC   TO MEMTRM OF EEWDEP(EDPACT)
                                          MEMTRM OF EETDEP(EDPACT).
           MOVE DEMCHG OF EEWDET-REC   TO DEMCHG OF EEWDEP(EDPACT)
                                          DEMCHG OF EETDEP(EDPACT).
           MOVE ADRLN1 OF EEWDET-REC   TO ADRLN1 OF EEWDEP(EDPACT)
                                          ADRLN1 OF EETDEP(EDPACT).
           MOVE ADRLN2 OF EEWDET-REC   TO ADRLN2 OF EEWDEP(EDPACT)
                                          ADRLN2 OF EETDEP(EDPACT).
           MOVE CITYCD OF EEWDET-REC   TO CITYCD OF EEWDEP(EDPACT)
                                          CITYCD OF EETDEP(EDPACT).
           MOVE STACOD OF EEWDET-REC   TO STACOD OF EEWDEP(EDPACT)
                                          STATCD OF EETDEP(EDPACT).
           MOVE ZIPCOD OF EEWDET-REC   TO ZIPCOD OF EEWDEP(EDPACT)
                                          ZIPCOD OF EETDEP(EDPACT).
           MOVE CTRYCD OF EEWDET-REC   TO CTRYCD OF EEWDEP(EDPACT)
                                          CTRYCD OF EETDEP(EDPACT).
           MOVE LOCQLF OF EEWDET-REC   TO LOCQLF OF EEWDEP(EDPACT)
                                          LOCQLF OF EETDEP(EDPACT).
           MOVE AREACD OF EEWDET-REC   TO AREACD OF EEWDEP(EDPACT)
                                          AREACD OF EETDEP(EDPACT).
           MOVE HOMPH1 OF EEWDET-REC   TO HOMPH1 OF EEWDEP(EDPACT)
                                          HOMPH1 OF EETDEP(EDPACT).
           MOVE HOMPH2 OF EEWDET-REC   TO HOMPH2 OF EEWDEP(EDPACT)
                                          HOMPH2 OF EETDEP(EDPACT).
           MOVE HOMPH3 OF EEWDET-REC   TO HOMPH3 OF EEWDEP(EDPACT)
                                          HOMPH3 OF EETDEP(EDPACT).
           MOVE WRKPH1 OF EEWDET-REC   TO WRKPH1 OF EEWDEP(EDPACT)
                                          WRKPH1 OF EETDEP(EDPACT).
           MOVE WRKPH2 OF EEWDET-REC   TO WRKPH2 OF EEWDEP(EDPACT)
                                          WRKPH2 OF EETDEP(EDPACT).
           MOVE WRKPH3 OF EEWDET-REC   TO WRKPH3 OF EEWDEP(EDPACT)
                                          WRKPH3 OF EETDEP(EDPACT).
           MOVE WRKEXT OF EEWDET-REC   TO WRKEXT OF EEWDEP(EDPACT)
                                          WRKEXT OF EETDEP(EDPACT).
           MOVE FAXNUM OF EEWDET-REC   TO FAXNUM OF EEWDEP(EDPACT)
                                          FAXNUM OF EETDEP(EDPACT).
           MOVE OTHPHN OF EEWDET-REC   TO OTHPHN OF EEWDEP(EDPACT)
                                          OTHPHN OF EETDEP(EDPACT).
           MOVE EMLIND OF EEWDET-REC   TO EMLIND OF EEWDEP(EDPACT)
                                          EMLIND OF EETDEP(EDPACT).
           MOVE ELMAIL OF EEWDET-REC   TO ELMAIL OF EEWDEP(EDPACT)
                                          ELMAIL OF EETDEP(EDPACT).
           MOVE HIRDAT OF EEWDET-REC   TO TARDAT
                                          HIRDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO HIRDAT OF EEWDEP(EDPACT).
           MOVE TRMDAT OF EEWDET-REC   TO TARDAT
                                          TRMDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO TRMDAT OF EEWDEP(EDPACT).
           MOVE SOCSEC OF EEWDET-REC   TO SOCSEC OF EEWDEP(EDPACT)
                                          SOCSEC OF EETDEP(EDPACT).
           MOVE OLDLST OF EEWDET-REC   TO OLDLST OF EEWDEP(EDPACT)
                                          OLDLST OF EETDEP(EDPACT).
           MOVE OLDFST OF EEWDET-REC   TO OLDFST OF EEWDEP(EDPACT)
                                          OLDFST OF EETDEP(EDPACT).
           MOVE OLDMID OF EEWDET-REC   TO OLDMID OF EEWDEP(EDPACT)
                                          OLDMID OF EETDEP(EDPACT).
           MOVE OLDTLC OF EEWDET-REC   TO OLDTLC OF EEWDEP(EDPACT)
                                          OLDTLC OF EETDEP(EDPACT).
           MOVE OLDSSN OF EEWDET-REC   TO OLDSSN OF EEWDEP(EDPACT)
                                          OLDSSN OF EETDEP(EDPACT).
           MOVE OLDBTH OF EEWDET-REC   TO TARDAT
                                          OLDBTH OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OLDBTH OF EEWDEP(EDPACT).
           MOVE OLDSEX OF EEWDET-REC   TO OLDSEX OF EEWDEP(EDPACT)
                                          OLDSEX OF EETDEP(EDPACT).
           MOVE RACECD OF EEWDET-REC   TO RACECD OF EEWDEP(EDPACT)
                                          RACECD OF EETDEP(EDPACT).
           MOVE TYPCOD OF EEWDET-REC   TO TYPCOD OF EEWDEP(EDPACT)
                                          TYPCOD OF EETDEP(EDPACT).
           MOVE HOLDCD OF EEWDET-REC   TO HOLDCD OF EEWDEP(EDPACT)
                                          HOLDCD OF EETDEP(EDPACT).
           MOVE MEMSTA OF EEWDET-REC   TO MEMSTA OF EEWDEP(EDPACT)
                                          MEMSTA OF EETDEP(EDPACT).
           MOVE STUSTA OF EEWDET-REC   TO STUSTA OF EEWDEP(EDPACT)
                                          STUSTA OF EETDEP(EDPACT).
           MOVE EDUBEG OF EEWDET-REC   TO TARDAT
                                          EDUBEG OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EDUBEG OF EEWDEP(EDPACT).
           MOVE EDUEND OF EEWDET-REC   TO TARDAT
                                          EDUEND OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EDUEND OF EEWDEP(EDPACT).
           MOVE HNDIND OF EEWDET-REC   TO HNDIND OF EEWDEP(EDPACT)
                                          HNDIND OF EETDEP(EDPACT).
           MOVE AUTEXP OF EEWDET-REC   TO AUTEXP OF EEWDEP(EDPACT)
                                          AUTEXP OF EETDEP(EDPACT).
           MOVE ALTNUM OF EEWDET-REC   TO ALTNUM OF EEWDEP(EDPACT)
                                          ALTNUM OF EETDEP(EDPACT).
           MOVE INTKCD OF EEWDET-REC   TO INTKCD OF EEWDEP(EDPACT)
                                          INTKCD OF EETDEP(EDPACT).
           MOVE PCPCHG OF EEWDET-REC   TO PCPCHG OF EEWDEP(EDPACT)
                                          PCPCHG OF EETDEP(EDPACT).
           MOVE PCPCOD OF EEWDET-REC   TO PCPCOD OF EEWDEP(EDPACT)
                                          PCPCOD OF EETDEP(EDPACT).
           MOVE PCPORG OF EEWDET-REC   TO PCPORG OF EEWDEP(EDPACT)
                                          PCPORG OF EETDEP(EDPACT).
           MOVE PCPOVR OF EEWDET-REC   TO PCPOVR OF EEWDEP(EDPACT)
                                          PCPOVR OF EETDEP(EDPACT).
           MOVE PCPMCP OF EEWDET-REC   TO PCPMCP OF EEWDEP(EDPACT)
                                          PCPMCP OF EETDEP(EDPACT).
           MOVE PCPEFF OF EEWDET-REC   TO TARDAT
                                          PCPEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PCPEFF OF EEWDEP(EDPACT).
           MOVE PCPEXP OF EEWDET-REC   TO TARDAT
                                          PCPEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PCPEXP OF EEWDEP(EDPACT).
           MOVE PCPREA OF EEWDET-REC   TO PCPREA OF EEWDEP(EDPACT)
                                          PCPREA OF EETDEP(EDPACT).
           MOVE PCPTRM OF EEWDET-REC   TO PCPTRM OF EEWDEP(EDPACT)
                                          PCPTRM OF EETDEP(EDPACT).
           MOVE SECCHG OF EEWDET-REC   TO SECCHG OF EEWDEP(EDPACT)
                                          SECCHG OF EETDEP(EDPACT).
           MOVE SECCOD OF EEWDET-REC   TO SECCOD OF EEWDEP(EDPACT)
                                          SECCOD OF EETDEP(EDPACT).
           MOVE SECORG OF EEWDET-REC   TO SECORG OF EEWDEP(EDPACT)
                                          SECORG OF EETDEP(EDPACT).
           MOVE SECOVR OF EEWDET-REC   TO SECOVR OF EEWDEP(EDPACT)
                                          SECOVR OF EETDEP(EDPACT).
           MOVE SECMCP OF EEWDET-REC   TO SECMCP OF EEWDEP(EDPACT)
                                          SECMCP OF EETDEP(EDPACT).
           MOVE SECEFF OF EEWDET-REC   TO TARDAT
                                          SECEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SECEFF OF EEWDEP(EDPACT).
           MOVE SECEXP OF EEWDET-REC   TO TARDAT
                                          SECEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SECEXP OF EEWDEP(EDPACT).
           MOVE SECREA OF EEWDET-REC   TO SECREA OF EEWDEP(EDPACT)
                                          SECREA OF EETDEP(EDPACT).
           MOVE SECTRM OF EEWDET-REC   TO SECTRM OF EEWDEP(EDPACT)
                                          SECTRM OF EETDEP(EDPACT).
           MOVE MEDCHG OF EEWDET-REC   TO MEDCHG OF EEWDEP(EDPACT)
                                          MEDCHG OF EETDEP(EDPACT).
           MOVE MEDCTY OF EEWDET-REC   TO MEDCTY OF EEWDEP(EDPACT)
                                          MEDCTY OF EETDEP(EDPACT).
           MOVE MEDSTS OF EEWDET-REC   TO MEDSTS OF EEWDEP(EDPACT)
                                          MEDSTS OF EETDEP(EDPACT).
           MOVE MEDEFF OF EEWDET-REC   TO TARDAT
                                          MEDEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEDEFF OF EEWDEP(EDPACT).
           MOVE MEDEXP OF EEWDET-REC   TO TARDAT
                                          MEDEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MEDEXP OF EEWDEP(EDPACT).
           MOVE MEDREA OF EEWDET-REC   TO MEDREA OF EEWDEP(EDPACT)
                                          MEDREA OF EETDEP(EDPACT).
           MOVE MEDTRM OF EEWDET-REC   TO MEDTRM OF EEWDEP(EDPACT)
                                          MEDTRM OF EETDEP(EDPACT).
           MOVE FEECHG OF EEWDET-REC   TO FEECHG OF EEWDEP(EDPACT)
                                          FEECHG OF EETDEP(EDPACT).
           MOVE FEECOD OF EEWDET-REC   TO FEECOD OF EEWDEP(EDPACT)
                                          FEECOD OF EETDEP(EDPACT).
           MOVE FEEEFF OF EEWDET-REC   TO TARDAT
                                          FEEEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO FEEEFF OF EEWDEP(EDPACT).
           MOVE FEEEXP OF EEWDET-REC   TO TARDAT
                                          FEEEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO FEEEXP OF EEWDEP(EDPACT).
           MOVE FEEREA OF EEWDET-REC   TO FEEREA OF EEWDEP(EDPACT)
                                          FEEREA OF EETDEP(EDPACT).
           MOVE FEETRM OF EEWDET-REC   TO FEETRM OF EEWDEP(EDPACT)
                                          FEETRM OF EETDEP(EDPACT).
           MOVE ENBCHG OF EEWDET-REC   TO ENBCHG OF EEWDEP(EDPACT)
                                          ENBCHG OF EETDEP(EDPACT).
           MOVE ACCTNO OF EEWDET-REC   TO ACCTNO OF EEWDEP(EDPACT)
                                          ACCTNO OF EETDEP(EDPACT).
           MOVE TIRCAL OF EEWDET-REC   TO TIRCAL OF EEWDEP(EDPACT)
                                          TIRCAL OF EETDEP(EDPACT).
           MOVE TIERCD OF EEWDET-REC   TO TIERCD OF EEWDEP(EDPACT)
                                          TIERCD OF EETDEP(EDPACT).
           MOVE TIRFLG OF EEWDET-REC   TO TIRFLG OF EEWDEP(EDPACT)
                                          TIRFLG OF EETDEP(EDPACT).
           MOVE BENPKG OF EEWDET-REC   TO BENPKG OF EEWDEP(EDPACT)
                                          BENPKG OF EETDEP(EDPACT).
           MOVE BILEXC OF EEWDET-REC   TO BILEXC OF EEWDEP(EDPACT)
                                          BILEXC OF EETDEP(EDPACT).
           MOVE ENBEFF OF EEWDET-REC   TO TARDAT
                                          ENBEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO ENBEFF OF EEWDEP(EDPACT).
           MOVE ENBEXP OF EEWDET-REC   TO TARDAT
                                          ENBEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO ENBEXP OF EEWDEP(EDPACT).
           MOVE ENBREA OF EEWDET-REC   TO ENBREA OF EEWDEP(EDPACT)
                                          ENBREA OF EETDEP(EDPACT).
           MOVE ENBTRM OF EEWDET-REC   TO ENBTRM OF EEWDEP(EDPACT)
                                          ENBTRM OF EETDEP(EDPACT).
           MOVE CPAIND OF EEWDET-REC   TO CPAIND OF EEWDEP(EDPACT)
                                          CPAIND OF EETDEP(EDPACT).
           MOVE CPLNAM OF EEWDET-REC   TO CPLNAM OF EEWDEP(EDPACT)
                                          CPLNAM OF EETDEP(EDPACT).
           MOVE CPFNAM OF EEWDET-REC   TO CPFNAM OF EEWDEP(EDPACT)
                                          CPFNAM OF EETDEP(EDPACT).
           MOVE CPMNAM OF EEWDET-REC   TO CPMNAM OF EEWDEP(EDPACT)
                                          CPMNAM OF EETDEP(EDPACT).
           MOVE CPTITL OF EEWDET-REC   TO CPTITL OF EEWDEP(EDPACT)
                                          CPTITL OF EETDEP(EDPACT).
           MOVE CPFORM OF EEWDET-REC   TO CPFORM OF EEWDEP(EDPACT)
                                          CPFORM OF EETDEP(EDPACT).
           MOVE CPARNT OF EEWDET-REC   TO CPARNT OF EEWDEP(EDPACT)
                                          CPARNT OF EETDEP(EDPACT).
           MOVE CPCONT OF EEWDET-REC   TO CPCONT OF EEWDEP(EDPACT)
                                          CPCONT OF EETDEP(EDPACT).
           MOVE CPHPH1 OF EEWDET-REC   TO CPHPH1 OF EEWDEP(EDPACT)
                                          CPHPH1 OF EETDEP(EDPACT).
           MOVE CPHPH2 OF EEWDET-REC   TO CPHPH2 OF EEWDEP(EDPACT)
                                          CPHPH2 OF EETDEP(EDPACT).
           MOVE CPHPH3 OF EEWDET-REC   TO CPHPH3 OF EEWDEP(EDPACT)
                                          CPHPH3 OF EETDEP(EDPACT).
           MOVE CPWPH1 OF EEWDET-REC   TO CPWPH1 OF EEWDEP(EDPACT)
                                          CPWPH1 OF EETDEP(EDPACT).
           MOVE CPWPH2 OF EEWDET-REC   TO CPWPH2 OF EEWDEP(EDPACT)
                                          CPWPH2 OF EETDEP(EDPACT).
           MOVE CPWPH3 OF EEWDET-REC   TO CPWPH3 OF EEWDEP(EDPACT)
                                          CPWPH3 OF EETDEP(EDPACT).
           MOVE CPWEXT OF EEWDET-REC   TO CPWEXT OF EEWDEP(EDPACT)
                                          CPWEXT OF EETDEP(EDPACT).
           MOVE CFAXNB OF EEWDET-REC   TO CFAXNB OF EEWDEP(EDPACT)
                                          CFAXNB OF EETDEP(EDPACT).
           MOVE COTHPH OF EEWDET-REC   TO COTHPH OF EEWDEP(EDPACT)
                                          COTHPH OF EETDEP(EDPACT).
           MOVE CEMLIN OF EEWDET-REC   TO CEMLIN OF EEWDEP(EDPACT)
                                          CEMLIN OF EETDEP(EDPACT).
           MOVE CEMAIL OF EEWDET-REC   TO CEMAIL OF EEWDEP(EDPACT)
                                          CEMAIL OF EETDEP(EDPACT).
           MOVE CPADR1 OF EEWDET-REC   TO CPADR1 OF EEWDEP(EDPACT)
                                          CPADR1 OF EETDEP(EDPACT).
           MOVE CPADR2 OF EEWDET-REC   TO CPADR2 OF EEWDEP(EDPACT)
                                          CPADR2 OF EETDEP(EDPACT).
           MOVE CPCITY OF EEWDET-REC   TO CPCITY OF EEWDEP(EDPACT)
                                          CPCITY OF EETDEP(EDPACT).
           MOVE CPSTAT OF EEWDET-REC   TO CPSTAT OF EEWDEP(EDPACT)
                                          CPSTAT OF EETDEP(EDPACT).
           MOVE CPZCOD OF EEWDET-REC   TO CPZCOD OF EEWDEP(EDPACT)
                                          CPZCOD OF EETDEP(EDPACT).
           MOVE CCNTRY OF EEWDET-REC   TO CCNTRY OF EEWDEP(EDPACT)
                                          CCNTRY OF EETDEP(EDPACT).
           MOVE WRKLOC OF EEWDET-REC   TO WRKLOC OF EEWDEP(EDPACT)
                                          WRKLOC OF EETDEP(EDPACT).
           MOVE SSNXRF OF EEWDET-REC   TO SSNXRF OF EEWDEP(EDPACT)
                                          SSNXRF OF EETDEP(EDPACT).
           MOVE HICNNO OF EEWDET-REC   TO HICNNO OF EEWDEP(EDPACT)
                                          HICNNO OF EETDEP(EDPACT).
           MOVE PEBTFS OF EEWDET-REC   TO PEBTFS OF EEWDEP(EDPACT)
                                          PEBTFS OF EETDEP(EDPACT).
           MOVE MMDIND OF EEWDET-REC   TO MMDIND OF EEWDEP(EDPACT)
                                          MMDIND OF EETDEP(EDPACT).
           MOVE MMANUM OF EEWDET-REC   TO MMANUM OF EEWDEP(EDPACT)
                                          MMANUM OF EETDEP(EDPACT).
           MOVE MMAEFF OF EEWDET-REC   TO TARDAT
                                          MMAEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MMAEFF OF EEWDEP(EDPACT).
           MOVE MIDNUM OF EEWDET-REC   TO MIDNUM OF EEWDEP(EDPACT)
                                          MIDNUM OF EETDEP(EDPACT).
           MOVE MCTCOD OF EEWDET-REC   TO MCTCOD OF EEWDEP(EDPACT)
                                          MCTCOD OF EETDEP(EDPACT).
           MOVE MCTEFF OF EEWDET-REC   TO TARDAT
                                          MCTEFF OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MCTEFF OF EEWDEP(EDPACT).
           MOVE MPSCOD OF EEWDET-REC   TO MPSCOD OF EEWDEP(EDPACT)
                                          MPSCOD OF EETDEP(EDPACT).
           MOVE MCASNO OF EEWDET-REC   TO MCASNO OF EEWDEP(EDPACT)
                                          MCASNO OF EETDEP(EDPACT).
           MOVE MCAPCD OF EEWDET-REC   TO MCAPCD OF EEWDEP(EDPACT)
                                          MCAPCD OF EETDEP(EDPACT).
           MOVE MMCEXC OF EEWDET-REC   TO MMCEXC OF EEWDEP(EDPACT)
                                          MMCEXC OF EETDEP(EDPACT).
           MOVE MMCIND OF EEWDET-REC   TO MMCIND OF EEWDEP(EDPACT)
                                          MMCIND OF EETDEP(EDPACT).
           MOVE MPLNCD OF EEWDET-REC   TO MPLNCD OF EEWDEP(EDPACT)
                                          MPLNCD OF EETDEP(EDPACT).
           MOVE MSPRCD OF EEWDET-REC   TO MSPRCD OF EEWDEP(EDPACT)
                                          MSPRCD OF EETDEP(EDPACT).
           MOVE MPAEDT OF EEWDET-REC   TO TARDAT
                                          MPAEDT OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAEDT OF EEWDEP(EDPACT).
           MOVE MPAETD OF EEWDET-REC   TO TARDAT
                                          MPAETD OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAETD OF EEWDEP(EDPACT).
           MOVE MPAEFD OF EEWDET-REC   TO TARDAT
                                          MPAEFD OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPAEFD OF EEWDEP(EDPACT).
           MOVE MPATDT OF EEWDET-REC   TO TARDAT
                                          MPATDT OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPATDT OF EEWDEP(EDPACT).
           MOVE MPBEDT OF EEWDET-REC   TO TARDAT
                                          MPBEDT OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBEDT OF EEWDEP(EDPACT).
           MOVE MPBETD OF EEWDET-REC   TO TARDAT
                                          MPBETD OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBETD OF EEWDEP(EDPACT).
           MOVE MPBEFD OF EEWDET-REC   TO TARDAT
                                          MPBEFD OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBEFD OF EEWDEP(EDPACT).
           MOVE MPBTDT OF EEWDET-REC   TO TARDAT
                                          MPBTDT OF EETDEP(EDPACT)
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO MPBTDT OF EEWDEP(EDPACT).
           MOVE CRDCNT OF EEWDET-REC   TO CRDCNT OF EEWDEP(EDPACT)
                                          CRDCNT OF EETDEP(EDPACT).
           MOVE MHCIND OF EEWDET-REC   TO MHCIND OF EEWDEP(EDPACT)
                                          MHCIND OF EETDEP(EDPACT).
           MOVE INDUPD OF EEWDET-REC   TO INDUPD OF EEWDEP(EDPACT)
                                          INDUPD OF EETDEP(EDPACT).
           MOVE OMEDAT OF EEWDET-REC   TO TARDAT
                                          OMEDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OMEDAT OF EEWDEP(EDPACT).
           MOVE CRDMTH OF EEWDET-REC   TO CRDMTH OF EEWDEP(EDPACT)
                                          CRDMTH OF EETDEP(EDPACT).
           MOVE USRFL1 OF EEWDET-REC   TO USRFL1 OF EEWDEP(EDPACT)
                                          USRFL1 OF EETDEP(EDPACT).
           MOVE USRFL2 OF EEWDET-REC   TO USRFL2 OF EEWDEP(EDPACT)
                                          USRFL2 OF EETDEP(EDPACT).
           MOVE USRFL3 OF EEWDET-REC   TO USRFL3 OF EEWDEP(EDPACT)
                                          USRFL3 OF EETDEP(EDPACT).
           MOVE ACCTN2 OF EEWDET-REC   TO ACCTN2 OF EEWDEP(EDPACT)
                                          ACCTN2 OF EETDEP(EDPACT).
           MOVE EECOVR OF EEWDET-REC   TO EECOVR OF EEWDEP(EDPACT)
                                          EECOVR OF EETDEP(EDPACT).
           MOVE PKGOVR OF EEWDET-REC   TO PKGOVR OF EEWDEP(EDPACT)
                                          PKGOVR OF EETDEP(EDPACT).
           MOVE CGAOVR OF EEWDET-REC   TO CGAOVR OF EEWDEP(EDPACT)
                                          CGAOVR OF EETDEP(EDPACT).
           MOVE CGTOVR OF EEWDET-REC   TO CGTOVR OF EEWDEP(EDPACT)
                                          CGTOVR OF EETDEP(EDPACT).
           MOVE DALOVR OF EEWDET-REC   TO DALOVR OF EEWDEP(EDPACT)
                                          DALOVR OF EETDEP(EDPACT).
           MOVE SALOVR OF EEWDET-REC   TO SALOVR OF EEWDEP(EDPACT)
                                          SALOVR OF EETDEP(EDPACT).
           MOVE CBXOVR OF EEWDET-REC   TO CBXOVR OF EEWDEP(EDPACT)
                                          CBXOVR OF EETDEP(EDPACT).
           MOVE CBEOVR OF EEWDET-REC   TO CBEOVR OF EEWDEP(EDPACT)
                                          CBEOVR OF EETDEP(EDPACT).
           MOVE APCOVR OF EEWDET-REC   TO APCOVR OF EEWDEP(EDPACT)
                                          APCOVR OF EETDEP(EDPACT).
           MOVE SSSOVR OF EEWDET-REC   TO SSSOVR OF EEWDEP(EDPACT)
                                          SSSOVR OF EETDEP(EDPACT).
           MOVE VRCOVR OF EEWDET-REC   TO VRCOVR OF EEWDEP(EDPACT)
                                          VRCOVR OF EETDEP(EDPACT).
           MOVE RMTOVR OF EEWDET-REC   TO RMTOVR OF EEWDEP(EDPACT)
                                          RMTOVR OF EETDEP(EDPACT).
           MOVE EXTMEM OF EEWDET-REC   TO EXTMEM OF EEWDEP(EDPACT)
                                          EXTMEM OF EETDEP(EDPACT).
           MOVE EXTGRP OF EEWDET-REC   TO EXTGRP OF EEWDEP(EDPACT)
                                          EXTGRP OF EETDEP(EDPACT).
           MOVE EXTCON OF EEWDET-REC   TO EXTCON OF EEWDEP(EDPACT)
                                          EXTCON OF EETDEP(EDPACT).
           MOVE EXTEFF OF EEWDET-REC   TO TARDAT
                                          EXTEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO EXTEFF OF EEWDEP(EDPACT).
           MOVE EXTEXP OF EEWDET-REC   TO TARDAT
                                          EXTEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO EXTEXP OF EEWDEP(EDPACT).
           MOVE EXTSUB OF EEWDET-REC   TO EXTSUB OF EEWDEP(EDPACT)
                                          EXTSUB OF EETDEP(EDPACT).
           MOVE EXTREL OF EEWDET-REC   TO EXTREL OF EEWDEP(EDPACT)
                                          EXTREL OF EETDEP(EDPACT).
           MOVE HISSEQ OF EEWDET-REC   TO HISSEQ OF EEWDEP(EDPACT)
                                          HISSEQ OF EETDEP(EDPACT).
           MOVE CTLPLN OF EEWDET-REC   TO CTLPLN OF EEWDEP(EDPACT)
                                          CTLPLN OF EETDEP(EDPACT).
           MOVE PRVPLN OF EEWDET-REC   TO PRVPLN OF EEWDEP(EDPACT)
                                          PRVPLN OF EETDEP(EDPACT).
           MOVE PRVNET OF EEWDET-REC   TO PRVNET OF EEWDEP(EDPACT)
                                          PRVNET OF EETDEP(EDPACT).
           MOVE PROCOD OF EEWDET-REC   TO PROCOD OF EEWDEP(EDPACT)
                                          PROCOD OF EETDEP(EDPACT).
           MOVE BILMOD OF EEWDET-REC   TO BILMOD OF EEWDEP(EDPACT)
                                          BILMOD OF EETDEP(EDPACT).
           MOVE BEGMTH OF EEWDET-REC   TO BEGMTH OF EEWDEP(EDPACT)
                                          BEGMTH OF EETDEP(EDPACT).
           MOVE IMDBIL OF EEWDET-REC   TO IMDBIL OF EEWDEP(EDPACT)
                                          IMDBIL OF EETDEP(EDPACT).
           MOVE INTBIL OF EEWDET-REC   TO INTBIL OF EEWDEP(EDPACT)
                                          INTBIL OF EETDEP(EDPACT).
           MOVE BILCYC OF EEWDET-REC   TO BILCYC OF EEWDEP(EDPACT)
                                          BILCYC OF EETDEP(EDPACT).
           MOVE SALAMT OF EEWDET-REC   TO SALAMT OF EEWDEP(EDPACT)
                                          SALAMT OF EETDEP(EDPACT).
           MOVE PAYLOC OF EEWDET-REC   TO PAYLOC OF EEWDEP(EDPACT)
                                          PAYLOC OF EETDEP(EDPACT).
           MOVE PAYNUM OF EEWDET-REC   TO PAYNUM OF EEWDEP(EDPACT)
                                          PAYNUM OF EETDEP(EDPACT).
           MOVE DOCNUM OF EEWDET-REC   TO DOCNUM OF EEWDEP(EDPACT)
                                          DOCNUM OF EETDEP(EDPACT).
           MOVE SALEFF OF EEWDET-REC   TO TARDAT
                                          SALEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SALEFF OF EEWDEP(EDPACT).
           MOVE SALEXP OF EEWDET-REC   TO TARDAT
                                          SALEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO SALEXP OF EEWDEP(EDPACT).
           MOVE OTHINS OF EEWDET-REC   TO OTHINS OF EEWDEP(EDPACT)
                                          OTHINS OF EETDEP(EDPACT).
           MOVE COBDAT OF EEWDET-REC   TO TARDAT
                                          COBDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE             THRU A939-EXIT.
           MOVE CNVDAT                 TO COBDAT OF EEWDEP(EDPACT).
           MOVE PRICOD OF EEWDET-REC   TO PRICOD OF EEWDEP(EDPACT)
                                          PRICOD OF EETDEP(EDPACT).
           MOVE MEMNUM OF EEWDET-REC   TO MEMNUM OF EEWDEP(EDPACT)
                                          MEMNUM OF EETDEP(EDPACT).
           MOVE GRPPOL OF EEWDET-REC   TO GRPPOL OF EEWDEP(EDPACT)
                                          GRPPOL OF EETDEP(EDPACT).
           MOVE OINNAM OF EEWDET-REC   TO OINNAM OF EEWDEP(EDPACT)
                                          OINNAM OF EETDEP(EDPACT).
           MOVE MEDCOV OF EEWDET-REC   TO MEDCOV OF EEWDEP(EDPACT)
                                          MEDCOV OF EETDEP(EDPACT).
           MOVE DENCOV OF EEWDET-REC   TO DENCOV OF EEWDEP(EDPACT)
                                          DENCOV OF EETDEP(EDPACT).

           MOVE OINNUM OF EEWDET-REC   TO OINNUM OF EEWDEP(EDPACT)
                                          OINNUM OF EETDEP(EDPACT).
           MOVE COVEFF OF EEWDET-REC   TO TARDAT
                                          COVEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COVEFF OF EEWDEP(EDPACT).
           MOVE COVEXP OF EEWDET-REC   TO TARDAT
                                          COVEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COVEXP OF EEWDEP(EDPACT).
           MOVE CQLECD OF EEWDET-REC   TO CQLECD OF EEWDEP(EDPACT)
                                          CQLECD OF EETDEP(EDPACT).
           MOVE COBRAQ OF EEWDET-REC   TO TARDAT
                                          COBRAQ OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAQ OF EEWDEP(EDPACT).
           MOVE COBRAB OF EEWDET-REC   TO TARDAT
                                          COBRAB OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAB OF EEWDEP(EDPACT).
           MOVE COBRAE OF EEWDET-REC   TO TARDAT
                                          COBRAE OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO COBRAE OF EEWDEP(EDPACT).
           MOVE EMSTCD OF EEWDET-REC   TO EMSTCD OF EEWDEP(EDPACT)
                                          EMSTCD OF EETDEP(EDPACT).
           MOVE DETDAT OF EEWDET-REC   TO TARDAT
                                          DETDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO DETDAT OF EEWDEP(EDPACT).
           MOVE MARSTA OF EEWDET-REC   TO MARSTA OF EEWDEP(EDPACT)
                                          MARSTA OF EETDEP(EDPACT).
           MOVE PYMTID OF EEWDET-REC   TO PYMTID OF EEWDEP(EDPACT)
                                          PYMTID OF EETDEP(EDPACT).
           MOVE COUNTY OF EEWDET-REC   TO COUNTY OF EEWDEP(EDPACT)
                                          COUNTY OF EETDEP(EDPACT).
           MOVE ETHCD1 OF EEWDET-REC   TO ETHCD1 OF EEWDEP(EDPACT)
                                          ETHCD1 OF EETDEP(EDPACT).
           MOVE ETHCD2 OF EEWDET-REC   TO ETHCD2 OF EEWDEP(EDPACT)
                                          ETHCD2 OF EETDEP(EDPACT).
           MOVE ETHCD3 OF EEWDET-REC   TO ETHCD3 OF EEWDEP(EDPACT)
                                          ETHCD3 OF EETDEP(EDPACT).
           MOVE ETHCD4 OF EEWDET-REC   TO ETHCD4 OF EEWDEP(EDPACT)
                                          ETHCD4 OF EETDEP(EDPACT).
           MOVE ETHCD5 OF EEWDET-REC   TO ETHCD5 OF EEWDEP(EDPACT)
                                          ETHCD5 OF EETDEP(EDPACT).
           MOVE ETHCD6 OF EEWDET-REC   TO ETHCD6 OF EEWDEP(EDPACT)
                                          ETHCD6 OF EETDEP(EDPACT).
           MOVE ETHCD7 OF EEWDET-REC   TO ETHCD7 OF EEWDEP(EDPACT)
                                          ETHCD7 OF EETDEP(EDPACT).
           MOVE ETHCD8 OF EEWDET-REC   TO ETHCD8 OF EEWDEP(EDPACT)
                                          ETHCD8 OF EETDEP(EDPACT).
           MOVE ETHCD9 OF EEWDET-REC   TO ETHCD9 OF EEWDEP(EDPACT)
                                          ETHCD9 OF EETDEP(EDPACT).
           MOVE EXCMEM OF EEWDET-REC   TO EXCMEM OF EEWDEP(EDPACT)
                                          EXCMEM OF EETDEP(EDPACT).
           MOVE EXCSUB OF EEWDET-REC   TO EXCSUB OF EEWDEP(EDPACT)
                                          EXCSUB OF EETDEP(EDPACT).
      *
           MOVE EEWDT2-WRK                       TO EEWMAS-REC.
           MOVE DETTYP OF EEWDT2-REC   TO DETTYP OF EETDEP(EDPACT).
           MOVE EXTIND OF EEWDT2-REC   TO EXTIND OF EEWDP2(EDPACT)
                                          EXTIND OF EETDEP(EDPACT).
           MOVE CITZEN OF EEWDT2-REC   TO CITZEN OF EEWDP2(EDPACT)
                                          CITZEN OF EETDEP(EDPACT).
           MOVE FRQCOD OF EEWDT2-REC   TO FRQCOD OF EEWDP2(EDPACT)
                                          FRQCOD OF EETDEP(EDPACT).
           MOVE WAGAMT OF EEWDT2-REC   TO WAGAMT OF EEWDP2(EDPACT)
                                          WAGAMT OF EETDEP(EDPACT).
           MOVE WRKHRS OF EEWDT2-REC   TO WRKHRS OF EEWDP2(EDPACT)
                                          WRKHRS OF EETDEP(EDPACT).
           MOVE WORKLC OF EEWDT2-REC   TO WORKLC OF EEWDP2(EDPACT)
                                          WORKLC OF EETDEP(EDPACT).
           MOVE SALGRD OF EEWDT2-REC   TO SALGRD OF EEWDP2(EDPACT)
                                          SALGRD OF EETDEP(EDPACT).
           MOVE HLTCOD OF EEWDT2-REC   TO HLTCOD OF EEWDP2(EDPACT)
                                          HLTCOD OF EETDEP(EDPACT).
           MOVE HEIGHT OF EEWDT2-REC   TO HEIGHT OF EEWDP2(EDPACT)
                                          HEIGHT OF EETDEP(EDPACT).
           MOVE WEIGHT OF EEWDT2-REC   TO WEIGHT OF EEWDP2(EDPACT)
                                          WEIGHT OF EETDEP(EDPACT).
           MOVE LNGCD1 OF EEWDT2-REC   TO LNGCD1 OF EEWDP2(EDPACT)
                                          LNGCD1 OF EETDEP(EDPACT).
           MOVE LNGUS1 OF EEWDT2-REC   TO LNGUS1 OF EEWDP2(EDPACT)
                                          LNGUS1 OF EETDEP(EDPACT).
           MOVE LNGCD2 OF EEWDT2-REC   TO LNGCD2 OF EEWDP2(EDPACT)
                                          LNGCD2 OF EETDEP(EDPACT).
           MOVE LNGUS2 OF EEWDT2-REC   TO LNGUS2 OF EEWDP2(EDPACT)
                                          LNGUS2 OF EETDEP(EDPACT).
           MOVE LNGCD3 OF EEWDT2-REC   TO LNGCD3 OF EEWDP2(EDPACT)
                                          LNGCD3 OF EETDEP(EDPACT).
           MOVE LNGUS3 OF EEWDT2-REC   TO LNGUS3 OF EEWDP2(EDPACT)
                                          LNGUS3 OF EETDEP(EDPACT).
           MOVE LNGCD4 OF EEWDT2-REC   TO LNGCD4 OF EEWDP2(EDPACT)
                                          LNGCD4 OF EETDEP(EDPACT).
           MOVE LNGUS4 OF EEWDT2-REC   TO LNGUS4 OF EEWDP2(EDPACT)
                                          LNGUS4 OF EETDEP(EDPACT).
           MOVE LNGCD5 OF EEWDT2-REC   TO LNGCD5 OF EEWDP2(EDPACT)
                                          LNGCD5 OF EETDEP(EDPACT).
           MOVE LNGUS5 OF EEWDT2-REC   TO LNGUS5 OF EEWDP2(EDPACT)
                                          LNGUS5 OF EETDEP(EDPACT).
           MOVE SCHOOL OF EEWDT2-REC   TO SCHOOL OF EEWDP2(EDPACT)
                                          SCHOOL OF EETDEP(EDPACT).
           MOVE SPHNUM OF EEWDT2-REC   TO SPHNUM OF EEWDP2(EDPACT)
                                          SPHNUM OF EETDEP(EDPACT).
           MOVE SPHEXT OF EEWDT2-REC   TO SPHEXT OF EEWDP2(EDPACT)
                                          SPHEXT OF EETDEP(EDPACT).
           MOVE SFAXNB OF EEWDT2-REC   TO SFAXNB OF EEWDP2(EDPACT)
                                          SFAXNB OF EETDEP(EDPACT).
           MOVE SEMAIL OF EEWDT2-REC   TO SEMAIL OF EEWDP2(EDPACT)
                                          SEMAIL OF EETDEP(EDPACT).
           MOVE SADRL1 OF EEWDT2-REC   TO SADRL1 OF EEWDP2(EDPACT)
                                          SADRL1 OF EETDEP(EDPACT).
           MOVE SADRL2 OF EEWDT2-REC   TO SADRL2 OF EEWDP2(EDPACT)
                                          SADRL2 OF EETDEP(EDPACT).
           MOVE SCTYCD OF EEWDT2-REC   TO SCTYCD OF EEWDP2(EDPACT)
                                          SCTYCD OF EETDEP(EDPACT).
           MOVE SSTACD OF EEWDT2-REC   TO SSTACD OF EEWDP2(EDPACT)
                                          SSTACD OF EETDEP(EDPACT).
           MOVE SZIPCD OF EEWDT2-REC   TO SZIPCD OF EEWDP2(EDPACT)
                                          SZIPCD OF EETDEP(EDPACT).
           MOVE SCNTRY OF EEWDT2-REC   TO SCNTRY OF EEWDP2(EDPACT)
                                          SCNTRY OF EETDEP(EDPACT).
           MOVE RSPIND OF EEWDT2-REC   TO RSPIND OF EEWDP2(EDPACT)
                                          RSPIND OF EETDEP(EDPACT).
           MOVE RSPIDC OF EEWDT2-REC   TO RSPIDC OF EEWDP2(EDPACT)
                                          RSPIDC OF EETDEP(EDPACT).
           MOVE RSPLST OF EEWDT2-REC   TO RSPLST OF EEWDP2(EDPACT)
                                          RSPLST OF EETDEP(EDPACT).
           MOVE RSPFST OF EEWDT2-REC   TO RSPFST OF EEWDP2(EDPACT)
                                          RSPFST OF EETDEP(EDPACT).
           MOVE RSPMID OF EEWDT2-REC   TO RSPMID OF EEWDP2(EDPACT)
                                          RSPMID OF EETDEP(EDPACT).
           MOVE RSPTTL OF EEWDT2-REC   TO RSPTTL OF EEWDP2(EDPACT)
                                          RSPTTL OF EETDEP(EDPACT).
           MOVE RSPFRM OF EEWDT2-REC   TO RSPFRM OF EEWDP2(EDPACT)
                                          RSPFRM OF EETDEP(EDPACT).
           MOVE RESPNB OF EEWDT2-REC   TO RESPNB OF EEWDP2(EDPACT)
                                          RESPNB OF EETDEP(EDPACT).
           MOVE RHOMPH OF EEWDT2-REC   TO RHOMPH OF EEWDP2(EDPACT)
                                          RHOMPH OF EETDEP(EDPACT).
           MOVE RWRKPH OF EEWDT2-REC   TO RWRKPH OF EEWDP2(EDPACT)
                                          RWRKPH OF EETDEP(EDPACT).
           MOVE RWKEXT OF EEWDT2-REC   TO RWKEXT OF EEWDP2(EDPACT)
                                          RSPEXT OF EETDEP(EDPACT).
           MOVE RFAXNB OF EEWDT2-REC   TO RFAXNB OF EEWDP2(EDPACT)
                                          RFAXNB OF EETDEP(EDPACT).
           MOVE ROTHPH OF EEWDT2-REC   TO ROTHPH OF EEWDP2(EDPACT)
                                          ROTHPH OF EETDEP(EDPACT).
           MOVE REMLIN OF EEWDT2-REC   TO REMLIN OF EEWDP2(EDPACT)
                                          REMLIN OF EETDEP(EDPACT).
           MOVE REMAIL OF EEWDT2-REC   TO REMAIL OF EEWDP2(EDPACT)
                                          REMAIL OF EETDEP(EDPACT).
           MOVE RCNTCT OF EEWDT2-REC   TO RCNTCT OF EEWDP2(EDPACT)
                                          RCNTCT OF EETDEP(EDPACT).
           MOVE RADLN1 OF EEWDT2-REC   TO RADLN1 OF EEWDP2(EDPACT)
                                          RADLN1 OF EETDEP(EDPACT).
           MOVE RADLN2 OF EEWDT2-REC   TO RADLN2 OF EEWDP2(EDPACT)
                                          RADLN2 OF EETDEP(EDPACT).
           MOVE RCTYCD OF EEWDT2-REC   TO RCTYCD OF EEWDP2(EDPACT)
                                          RCTYCD OF EETDEP(EDPACT).
           MOVE RSTACD OF EEWDT2-REC   TO RSTACD OF EEWDP2(EDPACT)
                                          RSTACD OF EETDEP(EDPACT).
           MOVE RZIPCD OF EEWDT2-REC   TO RZIPCD OF EEWDP2(EDPACT)
                                          RZIPCD OF EETDEP(EDPACT).
           MOVE RCNTRY OF EEWDT2-REC   TO RCNTRY OF EEWDP2(EDPACT)
                                          RCNTRY OF EETDEP(EDPACT).
           MOVE BENIND OF EEWDT2-REC   TO BENIND OF EEWDP2(EDPACT)
                                          BENIND OF EETDEP(EDPACT).
           MOVE HSAIND OF EEWDT2-REC   TO HSAIND OF EEWDP2(EDPACT)
                                          HSAIND OF EETDEP(EDPACT).
           MOVE HRAIND OF EEWDT2-REC   TO HRAIND OF EEWDP2(EDPACT)
                                          HRAIND OF EETDEP(EDPACT).
           MOVE FSAIND OF EEWDT2-REC   TO FSAIND OF EEWDP2(EDPACT)
                                          FSAIND OF EETDEP(EDPACT).
           MOVE OTHIND OF EEWDT2-REC   TO OTHIND OF EEWDP2(EDPACT)
                                          OTHIND OF EETDEP(EDPACT).
           MOVE MPDIND OF EEWDT2-REC   TO MPDIND OF EEWDP2(EDPACT)
                                          MPDIND OF EETDEP(EDPACT).
           MOVE PHAIND OF EEWDT2-REC   TO PHAIND OF EEWDP2(EDPACT)
                                          PHAIND OF EETDEP(EDPACT).
           MOVE DENIND OF EEWDT2-REC   TO DENIND OF EEWDP2(EDPACT)
                                          DENIND OF EETDEP(EDPACT).
           MOVE VISIND OF EEWDT2-REC   TO VISIND OF EEWDP2(EDPACT)
                                          VISIND OF EETDEP(EDPACT).
           MOVE MHTIND OF EEWDT2-REC   TO MHTIND OF EEWDP2(EDPACT)
                                          MHTIND OF EETDEP(EDPACT).
           MOVE OTHBEN OF EEWDT2-REC   TO OTHBEN OF EEWDP2(EDPACT)
                                          OTHBEN OF EETDEP(EDPACT).
           MOVE FSAAMT OF EEWDT2-REC   TO FSAAMT OF EEWDP2(EDPACT)
                                          FSAAMT OF EETDEP(EDPACT).
           MOVE ALTIND OF EEWDT2-REC   TO ALTIND OF EEWDP2(EDPACT)
                                          ALTIND OF EETDEP(EDPACT).
           MOVE ALTAD1 OF EEWDT2-REC   TO ALTAD1 OF EEWDP2(EDPACT)
                                          ALTAD1 OF EETDEP(EDPACT).
           MOVE ALTAD2 OF EEWDT2-REC   TO ALTAD2 OF EEWDP2(EDPACT)
                                          ALTAD2 OF EETDEP(EDPACT).
           MOVE ALTCTY OF EEWDT2-REC   TO ALTCTY OF EEWDP2(EDPACT)
                                          ALTCTY OF EETDEP(EDPACT).
           MOVE ALTSTT OF EEWDT2-REC   TO ALTSTT OF EEWDP2(EDPACT)
                                          ALTSTT OF EETDEP(EDPACT).
           MOVE ALTPST OF EEWDT2-REC   TO ALTPST OF EEWDP2(EDPACT)
                                          ALTPST OF EETDEP(EDPACT).
           MOVE ALTCNR OF EEWDT2-REC   TO ALTCNR OF EEWDP2(EDPACT)
                                          ALTCNR OF EETDEP(EDPACT).
           MOVE EPCLS1 OF EEWDT2-REC   TO EPCLS1 OF EEWDP2(EDPACT)
                                          EPCLS1 OF EETDEP(EDPACT).
           MOVE EPCLS2 OF EEWDT2-REC   TO EPCLS2 OF EEWDP2(EDPACT)
                                          EPCLS2 OF EETDEP(EDPACT).
           MOVE EPCLS3 OF EEWDT2-REC   TO EPCLS3 OF EEWDP2(EDPACT)
                                          EPCLS3 OF EETDEP(EDPACT).
           MOVE RPCTNM OF EEWDT2-REC   TO RPCTNM OF EEWDP2(EDPACT)
                                          RPCTNM OF EETDEP(EDPACT).
           MOVE RPCTQL OF EEWDT2-REC   TO RPCTQL OF EEWDP2(EDPACT)
                                          RPCTQL OF EETDEP(EDPACT).
           MOVE RPCTID OF EEWDT2-REC   TO RPCTID OF EEWDP2(EDPACT)
                                          RPCTID OF EETDEP(EDPACT).
           MOVE RDTFMT OF EEWDT2-REC   TO RDTFMT OF EEWDP2(EDPACT)
                                          RDTFMT OF EETDEP(EDPACT).
           MOVE RCTDAT OF EEWDT2-REC   TO RCTDAT OF EEWDP2(EDPACT)
                                          RCTDAT OF EETDEP(EDPACT).
           MOVE DOLLST OF EEWDT2-REC   TO DOLLST OF EEWDP2(EDPACT)
                                          DOLLST OF EETDEP(EDPACT).
           MOVE DOLFST OF EEWDT2-REC   TO DOLFST OF EEWDP2(EDPACT)
                                          DOLFST OF EETDEP(EDPACT).
           MOVE DOLMID OF EEWDT2-REC   TO DOLMID OF EEWDP2(EDPACT)
                                          DOLMID OF EETDEP(EDPACT).
           MOVE DOLPRE OF EEWDT2-REC   TO DOLPRE OF EEWDP2(EDPACT)
                                          DOLPRE OF EETDEP(EDPACT).
           MOVE DOLSUF OF EEWDT2-REC   TO DOLSUF OF EEWDP2(EDPACT)
                                          DOLSUF OF EETDEP(EDPACT).
           MOVE DOLAD1 OF EEWDT2-REC   TO DOLAD1 OF EEWDP2(EDPACT)
                                          DOLAD1 OF EETDEP(EDPACT).
           MOVE DOLAD2 OF EEWDT2-REC   TO DOLAD2 OF EEWDP2(EDPACT)
                                          DOLAD2 OF EETDEP(EDPACT).
           MOVE DOLCTY OF EEWDT2-REC   TO DOLCTY OF EEWDP2(EDPACT)
                                          DOLCTY OF EETDEP(EDPACT).
           MOVE DOLSTA OF EEWDT2-REC   TO DOLSTA OF EEWDP2(EDPACT)
                                          DOLSTA OF EETDEP(EDPACT).
           MOVE DOLZIP OF EEWDT2-REC   TO DOLZIP OF EEWDP2(EDPACT)
                                          DOLZIP OF EETDEP(EDPACT).
           MOVE DOLCCD OF EEWDT2-REC   TO DOLCCD OF EEWDP2(EDPACT)
                                          DOLCCD OF EETDEP(EDPACT).
           MOVE DOLSCD OF EEWDT2-REC   TO DOLSCD OF EEWDP2(EDPACT)
                                          DOLSCD OF EETDEP(EDPACT).
           MOVE ICMRCQ OF EEWDT2-REC   TO ICMRCQ OF EEWDP2(EDPACT)
                                          ICMRCQ OF EETDEP(EDPACT).
           MOVE ICMRCC OF EEWDT2-REC   TO ICMRCC OF EEWDP2(EDPACT)
                                          ICMRCC OF EETDEP(EDPACT).
           MOVE MDRCCC OF EEWDT2-REC   TO MDRCCC OF EEWDP2(EDPACT)
                                          MDRCCC OF EETDEP(EDPACT).
           MOVE COBAD1 OF EEWDT2-REC   TO COBAD1 OF EEWDP2(EDPACT)
                                          COBAD1 OF EETDEP(EDPACT).
           MOVE COBAD2 OF EEWDT2-REC   TO COBAD2 OF EEWDP2(EDPACT)
                                          COBAD2 OF EETDEP(EDPACT).
           MOVE COBCTY OF EEWDT2-REC   TO COBCTY OF EEWDP2(EDPACT)
                                          COBCTY OF EETDEP(EDPACT).
           MOVE COBSTA OF EEWDT2-REC   TO COBSTA OF EEWDP2(EDPACT)
                                          COBSTA OF EETDEP(EDPACT).
           MOVE COBZIP OF EEWDT2-REC   TO COBZIP OF EEWDP2(EDPACT)
                                          COBZIP OF EETDEP(EDPACT).
           MOVE COBCCD OF EEWDT2-REC   TO COBCCD OF EEWDP2(EDPACT)
                                          COBCCD OF EETDEP(EDPACT).
           MOVE COBCSB OF EEWDT2-REC   TO COBCSB OF EEWDP2(EDPACT)
                                          COBCSB OF EETDEP(EDPACT).
           MOVE COBPHN OF EEWDT2-REC   TO COBPHN OF EEWDP2(EDPACT)
                                          COBPHN OF EETDEP(EDPACT).
           MOVE CSPCSB OF EEWDT2-REC   TO CSPCSB OF EEWDP2(EDPACT)
                                          CSPCSB OF EETDEP(EDPACT).
           MOVE CNTSCD OF EEWDT2-REC   TO CNTSCD OF EEWDP2(EDPACT)
                                          CNTSCD OF EETDEP(EDPACT).
           MOVE SCHSCD OF EEWDT2-REC   TO SCHSCD OF EEWDP2(EDPACT)
                                          SCHSCD OF EETDEP(EDPACT).
           MOVE RPTCSB OF EEWDT2-REC   TO RPTCSB OF EEWDP2(EDPACT)
                                          RPTCSB OF EETDEP(EDPACT).
           MOVE MBMCSB OF EEWDT2-REC   TO MBMCSB OF EEWDP2(EDPACT)
                                          MBMCSB OF EETDEP(EDPACT).
           MOVE CALTPH OF EEWDT2-REC   TO CALTPH OF EEWDP2(EDPACT)
                                          CALTPH OF EETDEP(EDPACT).
           MOVE CBEPNB OF EEWDT2-REC   TO CBEPNB OF EEWDP2(EDPACT)
                                          CBEPNB OF EETDEP(EDPACT).
           MOVE CCELPH OF EEWDT2-REC   TO CCELPH OF EEWDP2(EDPACT)
                                          CCELPH OF EETDEP(EDPACT).
           MOVE RALTPH OF EEWDT2-REC   TO RALTPH OF EEWDP2(EDPACT)
                                          RALTPH OF EETDEP(EDPACT).
           MOVE RBEPNB OF EEWDT2-REC   TO RBEPNB OF EEWDP2(EDPACT)
                                          RBEPNB OF EETDEP(EDPACT).
           MOVE RCELPH OF EEWDT2-REC   TO RCELPH OF EEWDP2(EDPACT)
                                          RCELPH OF EETDEP(EDPACT).
           MOVE ALTPHN OF EEWDT2-REC   TO ALTPHN OF EEWDP2(EDPACT)
                                          ALTPHN OF EETDEP(EDPACT).
           MOVE BEPNBR OF EEWDT2-REC   TO BEPNBR OF EEWDP2(EDPACT)
                                          BEPNBR OF EETDEP(EDPACT).
           MOVE CELPHN OF EEWDT2-REC   TO CELPHN OF EEWDP2(EDPACT)
                                          CELPHN OF EETDEP(EDPACT).
           MOVE SCHCLK OF EEWDT2-REC   TO SCHCLK OF EEWDP2(EDPACT)
                                          SCHCLK OF EETDEP(EDPACT).
           MOVE CNFCOD OF EEWDT2-REC   TO CNFCOD OF EEWDP2(EDPACT)
                                          CNFCOD OF EETDEP(EDPACT).
           PERFORM D100-DEP-VERIFY               THRU D109-EXIT.

           MOVE PRVSUB OF EEWDT2-REC   TO PRVSUB OF EEWDP2(EDPACT)
                                          PRVSUB OF EETDEP(EDPACT).
           MOVE SMKCES OF EEWDT2-REC   TO SMKCES OF EEWDP2(EDPACT)
                                          SMKCES OF EETDEP(EDPACT).
           MOVE EXCPOL OF EEWDT2-REC   TO EXCPOL OF EEWDP2(EDPACT)
                                          EXCPOL OF EETDEP(EDPACT).
           MOVE WS-APLORG1             TO APLORG OF EEWDT3-REC.
           MOVE APLORG OF EEWDT3-REC   TO APLORG OF EEWDP3(EDPACT)
                                          APLORG OF EETDEP(EDPACT).
      *
           MOVE SHPGRP OF EEWDT2-REC   TO SHPGRP OF EEWDP2(EDPACT)
                                          SHPGRP OF EETDEP(EDPACT).
           MOVE EXCHNG OF EEWDT2-REC   TO EXCHNG OF EEWDP2(EDPACT)
                                          EXCHNG OF EETDEP(EDPACT).
      *
           MOVE EEWDT3-WRK                       TO EEWMAS-REC.
           MOVE DETTYP OF EEWDT3-REC   TO DETTYP OF EETDEP(EDPACT).
           MOVE GRPNUM OF EEWDT3-REC   TO GRPNUM OF EEWDP3(EDPACT)
                                          GRPNUM OF EETDEP(EDPACT).
           MOVE SUBSNO OF EEWDT3-REC   TO SUBSNO OF EEWDP3(EDPACT)
                                          SUBSNO OF EETDEP(EDPACT).
           MOVE RELTYP OF EEWDT3-REC   TO RELTYP OF EEWDP3(EDPACT)
                                          RELTYP OF EETDEP(EDPACT).
           MOVE RELCOD OF EEWDT3-REC   TO RELCOD OF EEWDP3(EDPACT)
                                          RELCOD OF EETDEP(EDPACT).
           MOVE MEMBNO OF EEWDT3-REC   TO MEMBNO OF EEWDP3(EDPACT)
                                          MEMBNO OF EETDEP(EDPACT).
           MOVE BTHDAT OF EEWDT3-REC   TO TARDAT
                                          BTHDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO BTHDAT OF EEWDP3(EDPACT).
           MOVE SEXCOD OF EEWDT3-REC   TO SEXCOD OF EEWDP3(EDPACT)
                                          SEXCOD OF EETDEP(EDPACT).
           MOVE CHGTYP OF EEWDT3-REC   TO CHGTYP OF EEWDP3(EDPACT)
                                          CHGTYP OF EETDEP(EDPACT).
           MOVE ASSQHP OF EEWDT3-REC   TO ASSQHP OF EEWDP3(EDPACT)
                                          WS-DT3-ASSQHP
                                          ASSQHP OF EETDEP(EDPACT).
           MOVE CHGDAT OF EEWDT3-REC   TO TARDAT
                                          CHGDAT OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CHGDAT OF EEWDP3(EDPACT).
           MOVE CHGTIM OF EEWDT3-REC   TO CHGTIM OF EEWDP3(EDPACT)
                                          CHGTIM OF EETDEP(EDPACT).
           MOVE ENTSEQ OF EEWDT3-REC   TO ENTSEQ OF EEWDP3(EDPACT)
                                          ENTSEQ OF EETDEP(EDPACT).
           MOVE REPNAM OF EEWDT3-REC   TO REPNAM OF EEWDP3(EDPACT)
                                          REPNAM OF EETDEP(EDPACT).
           MOVE REPRFQ OF EEWDT3-REC   TO REPRFQ OF EEWDP3(EDPACT)
                                          REPRFQ OF EETDEP(EDPACT).
           MOVE REPREF OF EEWDT3-REC   TO REPREF OF EEWDP3(EDPACT)
                                          REPREF OF EETDEP(EDPACT).
           MOVE REPEFQ OF EEWDT3-REC   TO REPEFQ OF EEWDP3(EDPACT)
                                          REPEFQ OF EETDEP(EDPACT).
           MOVE REPEFF OF EEWDT3-REC   TO REPEFF OF EEWDP3(EDPACT)
                                          REPEFF OF EETDEP(EDPACT).
           MOVE OPYAMT OF EEWDT3-REC   TO OPYAMT OF EEWDP3(EDPACT)
                                          OPYAMT OF EETDEP(EDPACT).
           MOVE OPYEFF OF EEWDT3-REC   TO TARDAT
                                          OPYEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OPYEFF OF EEWDP3(EDPACT).
           MOVE OPYEXP OF EEWDT3-REC   TO TARDAT
                                          OPYEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO OPYEXP OF EEWDP3(EDPACT).
           MOVE OPYSRC OF EEWDT3-REC   TO OPYSRC OF EEWDP3(EDPACT)
                                          OPYSRC OF EETDEP(EDPACT).
           MOVE APTAMT OF EEWDT3-REC   TO APTAMT OF EEWDP3(EDPACT)
                                          APTAMT OF EETDEP(EDPACT).
           MOVE APTEFF OF EEWDT3-REC   TO TARDAT
                                          APTEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO APTEFF OF EEWDP3(EDPACT).
           MOVE APTEXP OF EEWDT3-REC   TO TARDAT
                                          APTEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO APTEXP OF EEWDP3(EDPACT).
           MOVE CSRAMT OF EEWDT3-REC   TO CSRAMT OF EEWDP3(EDPACT)
                                          CSRAMT OF EETDEP(EDPACT).
           MOVE CSREFF OF EEWDT3-REC   TO TARDAT
                                          CSREFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CSREFF OF EEWDP3(EDPACT).
           MOVE CSREXP OF EEWDT3-REC   TO TARDAT
                                          CSREXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CSREXP OF EEWDP3(EDPACT).
           MOVE PREAMT OF EEWDT3-REC   TO PREAMT OF EEWDP3(EDPACT)
                                          PREAMT OF EETDEP(EDPACT).
           MOVE PREEFF OF EEWDT3-REC   TO TARDAT
                                          PREEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PREEFF OF EEWDP3(EDPACT).
           MOVE PREEXP OF EEWDT3-REC   TO TARDAT
                                          PREEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PREEXP OF EEWDP3(EDPACT).
           MOVE RSPTOT OF EEWDT3-REC   TO RSPTOT OF EEWDP3(EDPACT)
                                          RSPTOT OF EETDEP(EDPACT).
           MOVE RSPEFF OF EEWDT3-REC   TO TARDAT
                                          RSPEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RSPEFF OF EEWDP3(EDPACT).
           MOVE RSPEXP OF EEWDT3-REC   TO TARDAT
                                          RSPEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RSPEXP OF EEWDP3(EDPACT).
           MOVE PRETOT OF EEWDT3-REC   TO PRETOT OF EEWDP3(EDPACT)
                                          PRETOT OF EETDEP(EDPACT).
           MOVE PTOEFF OF EEWDT3-REC   TO TARDAT
                                          PTOEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PTOEFF OF EEWDP3(EDPACT).
           MOVE PTOEXP OF EEWDT3-REC   TO TARDAT
                                          PTOEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO PTOEXP OF EEWDP3(EDPACT).
           MOVE EMPTOT OF EEWDT3-REC   TO EMPTOT OF EEWDP3(EDPACT)
                                          EMPTOT OF EETDEP(EDPACT).
           MOVE EMPEFF OF EEWDT3-REC   TO TARDAT
                                          EMPEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EMPEFF OF EEWDP3(EDPACT).
           MOVE EMPEXP OF EEWDT3-REC   TO TARDAT
                                          EMPEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO EMPEXP OF EEWDP3(EDPACT).
           MOVE WS-REACAT2             TO REACAT OF EEWDT3-REC.
           MOVE REACAT OF EEWDT3-REC   TO REACAT OF EEWDP3(EDPACT)
                                          REACAT OF EETDEP(EDPACT).
           MOVE WS-CANEFF1             TO CANEFF OF EEWDT3-REC.
           MOVE CANEFF OF EEWDT3-REC   TO TARDAT
                                          CANEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO CANEFF OF EEWDP3(EDPACT).
           MOVE WS-TRMEFF1             TO TRMEFF OF EEWDT3-REC.
           MOVE TRMEFF OF EEWDT3-REC   TO TARDAT
                                          TRMEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO TRMEFF OF EEWDP3(EDPACT).
           MOVE RATARA OF EEWDT3-REC   TO RATARA OF EEWDP3(EDPACT)
                                          RATARA OF EETDEP(EDPACT).
           MOVE RATEFF OF EEWDT3-REC   TO TARDAT
                                          RATEFF OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RATEFF OF EEWDP3(EDPACT).
           MOVE RATEXP OF EEWDT3-REC   TO TARDAT
                                          RATEXP OF EETDEP(EDPACT).
           PERFORM A930-CONVERT-DATE            THRU A939-EXIT.
           MOVE CNVDAT                 TO RATEXP OF EEWDP3(EDPACT).
           MOVE REQTIM OF EEWDT3-REC   TO REQTIM OF EEWDP3(EDPACT)
                                          REQTIM OF EETDEP(EDPACT).
           MOVE REQEFF OF EEWDT3-REC   TO REQEFF OF EETDEP(EDPACT)
                                          REQEFF OF EEWDP3(EDPACT).
           MOVE REQEXP OF EEWDT3-REC   TO REQEXP OF EETDEP(EDPACT)
                                          REQEXP OF EEWDP3(EDPACT).
           MOVE TENTID OF EEWDT3-REC   TO TENTID OF EEWDP3(EDPACT)
                                          TENTID OF EETDEP(EDPACT).
           MOVE TENEFF OF EEWDT3-REC   TO TENEFF OF EETDEP(EDPACT)
                                          TENEFF OF EEWDP3(EDPACT).
           MOVE TENEXP OF EEWDT3-REC   TO TENEXP OF EETDEP(EDPACT)
                                          TENEXP OF EEWDP3(EDPACT).
      *
           MOVE SEPREA OF EEWDT3-REC   TO SEPREA OF EEWDP3(EDPACT)
                                          SEPREA OF EETDEP(EDPACT).
           MOVE SEPEFF OF EEWDT3-REC   TO SEPEFF OF EETDEP(EDPACT)
                                          SEPEFF OF EEWDP3(EDPACT).
           MOVE SEPEXP OF EEWDT3-REC   TO SEPEXP OF EETDEP(EDPACT)
                                          SEPEXP OF EEWDP3(EDPACT).
      *
           MOVE REAEFF OF EEWDT3-REC   TO REAEFF OF EETDEP(EDPACT)
                                          REAEFF OF EEWDP3(EDPACT).
           MOVE REAEXP OF EEWDT3-REC   TO REAEXP OF EETDEP(EDPACT)
                                          REAEXP OF EEWDP3(EDPACT).
           MOVE WS-APLORG1             TO APLORG OF EEWDT3-REC.
           MOVE APLORG OF EEWDT3-REC   TO APLORG OF EETDEP(EDPACT)
                                          APLORG OF EEWDP3(EDPACT).
      *
           IF CURENT(15) < EBYACT
              MOVE EBYACT                        TO CURENT(15).
      *
           IF EBYACT > (EBYMAX * WS-MAXPCT) / 100
           AND WS-FLG-EEWBYP NOT = 'Y'
              MOVE EBYACT                        TO WS-EBYACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'EEWBYP'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE SUBSNO OF EEWDET-WRK          TO MI-PARM7
              MOVE GRPNUM OF EEWDET-WRK          TO MI-PARM8
              MOVE WS-EBYACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-EEWBYP
           END-IF.
      *
           IF EBYACT > EBYMAX
              MOVE 'Y'                  TO PRCERR OF PGM-WORK
              MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
              MOVE SPACES               TO ERR-LINE
              MOVE GRPNUM OF EEWDET-WRK TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDET-WRK TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDET-WRK TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDET-WRK TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDET-WRK TO CHGTYP OF ERR-LINE
              MOVE 'EI08001'            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI08001'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A219-EXIT.

           IF IN-DEBUG
              DISPLAY '@@@ DEP'
                      ' MEMEFF: ' MEMEFF OF EEWDEP(EDPACT)
                      ' MEMEXP: ' MEMEXP OF EEWDEP(EDPACT)
                      ' ENBEFF: ' ENBEFF OF EEWDEP(EDPACT)
                      ' ENBEXP: ' ENBEXP OF EEWDEP(EDPACT)
                      ' PCPEFF: ' PCPEFF OF EEWDEP(EDPACT)
                      ' PCPEXP: ' PCPEXP OF EEWDEP(EDPACT)
           END-IF.

           MOVE EEWDEP(EDPACT)                   TO EEWBYP(EBYACT).
           MOVE EEWDP2(EDPACT)                   TO EEWBY2(EBYACT).
           MOVE EEWDP3(EDPACT)                   TO EEWBY3(EBYACT).
      *
           MOVE 'D'                    TO TBLLNK(EBYACT).
           MOVE EDPACT                 TO TBLSEQ(EBYACT).
      *
       A219-EXIT.
           EXIT.
      *
       A220-ERR-FAMILY.
      ***************************************************************
      * USES THE EET TABLE TO POPULATE THE EEEMAS RECORD AND WRITE  *
      * EEEMAS RECORDS FOR FAMILY MEMBERS OF ERRORED MEMBERS        *
      ***************************************************************
           MOVE ZEROES                           TO ESBACT.
       A222-NEXT.
           MOVE 'Y'                              TO SW-NEWRECORD.
           MOVE 'Y'                              TO SW-NEWRECORD-WRN.
      *
           IF ESBACT NOT < ESBLST                GO TO A225-NEXT.
      *
           ADD 1                                 TO ESBACT.
      *
           IF SUBSNO OF EEWSUB(ESBACT) = SPACES
              GO TO A222-NEXT.
      *
           SET ERRINX TO 1.
           SEARCH ERRTAB                  AT END GO TO A223-NEXT
           WHEN MEMBNO OF ERRTAB(ERRINX) = MEMBNO OF EEWSUB(ESBACT)
            AND ERRMEM OF EEWSUB(ESBACT) = 'Y'
               GO TO A222-NEXT
           END-SEARCH.
       A223-NEXT.
           MOVE SPACES                 TO MESSAGE-INTERFACE-PARAMETERS.
           MOVE 'EI02471'                        TO MI-PRIMARY-ID.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE.
           MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE.
           MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE.
           MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE.
           MOVE ERR-LINE                         TO LINE-E.
           PERFORM X100-PRINT-ERROR              THRU X109-EXIT.
      *
           MOVE RECTYP OF EETSUB(ESBACT) TO RECTYP OF EEEMAS-REC.
           MOVE GRPNUM OF EETSUB(ESBACT) TO GRPNUM OF EEEMAS-REC.
           MOVE SUBSNO OF EETSUB(ESBACT) TO SUBSNO OF EEEMAS-REC.
           MOVE RELTYP OF EETSUB(ESBACT) TO RELTYP OF EEEMAS-REC.
           MOVE RELCOD OF EETSUB(ESBACT) TO RELCOD OF EEEMAS-REC.
           MOVE MEMBNO OF EETSUB(ESBACT) TO MEMBNO OF EEEMAS-REC.
           MOVE BTHDAT OF EETSUB(ESBACT) TO BTHDAT OF EEEMAS-REC.
           MOVE BTHSEQ OF EETSUB(ESBACT) TO BTHSEQ OF EEEMAS-REC.
           MOVE BTHCHG OF EETSUB(ESBACT) TO BTHCHG OF EEEMAS-REC.
           MOVE SEXCOD OF EETSUB(ESBACT) TO SEXCOD OF EEEMAS-REC.
           MOVE SEXCHG OF EETSUB(ESBACT) TO SEXCHG OF EEEMAS-REC.
           MOVE CHGTYP OF EETSUB(ESBACT) TO CHGTYP OF EEEMAS-REC.
           MOVE CHGDAT OF EETSUB(ESBACT) TO CHGDAT OF EEEMAS-REC.
           MOVE CHGTIM OF EETSUB(ESBACT) TO CHGTIM OF EEEMAS-REC.
           MOVE CHGEFF OF EETSUB(ESBACT) TO CHGEFF OF EEEMAS-REC.
           MOVE NAMCHG OF EETSUB(ESBACT) TO NAMCHG OF EEEMAS-REC.
           MOVE LSTNAM OF EETSUB(ESBACT) TO LSTNAM OF EEEMAS-REC.
           MOVE FSTNAM OF EETSUB(ESBACT) TO FSTNAM OF EEEMAS-REC.
           MOVE MIDNAM OF EETSUB(ESBACT) TO MIDNAM OF EEEMAS-REC.
           MOVE TITLCD OF EETSUB(ESBACT) TO TITLCD OF EEEMAS-REC.
           MOVE FORNAM OF EETSUB(ESBACT) TO FORNAM OF EEEMAS-REC.
           MOVE MEMCHG OF EETSUB(ESBACT) TO MEMCHG OF EEEMAS-REC.
           MOVE EMPSTA OF EETSUB(ESBACT) TO EMPSTA OF EEEMAS-REC.
           MOVE PRTCOD OF EETSUB(ESBACT) TO PRTCOD OF EEEMAS-REC.
           MOVE MEMEFF OF EETSUB(ESBACT) TO MEMEFF OF EEEMAS-REC.
           MOVE MEMEXP OF EETSUB(ESBACT) TO MEMEXP OF EEEMAS-REC.
           MOVE MEMREA OF EETSUB(ESBACT) TO MEMREA OF EEEMAS-REC.
           MOVE MEMTRM OF EETSUB(ESBACT) TO MEMTRM OF EEEMAS-REC.
           MOVE DEMCHG OF EETSUB(ESBACT) TO DEMCHG OF EEEMAS-REC.
           MOVE ADRLN1 OF EETSUB(ESBACT) TO ADRLN1 OF EEEMAS-REC.
           MOVE ADRLN2 OF EETSUB(ESBACT) TO ADRLN2 OF EEEMAS-REC.
           MOVE CITYCD OF EETSUB(ESBACT) TO CITYCD OF EEEMAS-REC.
           MOVE STATCD OF EETSUB(ESBACT) TO STACOD OF EEEMAS-REC.
           MOVE ZIPCOD OF EETSUB(ESBACT) TO ZIPCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETSUB(ESBACT) TO CCNTRY OF EEEMAS-REC.
           MOVE LOCQLF OF EETSUB(ESBACT) TO LOCQLF OF EEEMAS-REC.
           MOVE AREACD OF EETSUB(ESBACT) TO AREACD OF EEEMAS-REC.
           MOVE HOMPH1 OF EETSUB(ESBACT) TO HOMPH1 OF EEEMAS-REC.
           MOVE HOMPH2 OF EETSUB(ESBACT) TO HOMPH2 OF EEEMAS-REC.
           MOVE HOMPH3 OF EETSUB(ESBACT) TO HOMPH3 OF EEEMAS-REC.
           MOVE WRKPH1 OF EETSUB(ESBACT) TO WRKPH1 OF EEEMAS-REC.
           MOVE WRKPH2 OF EETSUB(ESBACT) TO WRKPH2 OF EEEMAS-REC.
           MOVE WRKPH3 OF EETSUB(ESBACT) TO WRKPH3 OF EEEMAS-REC.
           MOVE WRKEXT OF EETSUB(ESBACT) TO WRKEXT OF EEEMAS-REC.
           MOVE FAXNUM OF EETSUB(ESBACT) TO FAXNUM OF EEEMAS-REC.
           MOVE OTHPHN OF EETSUB(ESBACT) TO OTHPHN OF EEEMAS-REC.
           MOVE EMLIND OF EETSUB(ESBACT) TO EMLIND OF EEEMAS-REC.
           MOVE ELMAIL OF EETSUB(ESBACT) TO ELMAIL OF EEEMAS-REC.
           MOVE HIRDAT OF EETSUB(ESBACT) TO HIRDAT OF EEEMAS-REC.
           MOVE TRMDAT OF EETSUB(ESBACT) TO TRMDAT OF EEEMAS-REC.
           MOVE SOCSEC OF EETSUB(ESBACT) TO SOCSEC OF EEEMAS-REC.
           MOVE OLDLST OF EETSUB(ESBACT) TO OLDLST OF EEEMAS-REC.
           MOVE OLDFST OF EETSUB(ESBACT) TO OLDFST OF EEEMAS-REC.
           MOVE OLDMID OF EETSUB(ESBACT) TO OLDMID OF EEEMAS-REC.
           MOVE OLDTLC OF EETSUB(ESBACT) TO OLDTLC OF EEEMAS-REC.
           MOVE OLDSSN OF EETSUB(ESBACT) TO OLDSSN OF EEEMAS-REC.
           MOVE OLDBTH OF EETSUB(ESBACT) TO OLDBTH OF EEEMAS-REC.
           MOVE OLDSEX OF EETSUB(ESBACT) TO OLDSEX OF EEEMAS-REC.
           MOVE RACECD OF EETSUB(ESBACT) TO RACECD OF EEEMAS-REC.
           MOVE TYPCOD OF EETSUB(ESBACT) TO TYPCOD OF EEEMAS-REC.
           MOVE HOLDCD OF EETSUB(ESBACT) TO HOLDCD OF EEEMAS-REC.
           MOVE MEMSTA OF EETSUB(ESBACT) TO MEMSTA OF EEEMAS-REC.
           MOVE STUSTA OF EETSUB(ESBACT) TO STUSTA OF EEEMAS-REC.
           MOVE EDUBEG OF EETSUB(ESBACT) TO EDUBEG OF EEEMAS-REC.
           MOVE EDUEND OF EETSUB(ESBACT) TO EDUEND OF EEEMAS-REC.
           MOVE HNDIND OF EETSUB(ESBACT) TO HNDIND OF EEEMAS-REC.
           MOVE AUTEXP OF EETSUB(ESBACT) TO AUTEXP OF EEEMAS-REC.
           MOVE ALTNUM OF EETSUB(ESBACT) TO ALTNUM OF EEEMAS-REC.
           MOVE INTKCD OF EETSUB(ESBACT) TO INTKCD OF EEEMAS-REC.
           MOVE PCPCHG OF EETSUB(ESBACT) TO PCPCHG OF EEEMAS-REC.
           MOVE PCPCOD OF EETSUB(ESBACT) TO PCPCOD OF EEEMAS-REC.
           MOVE PCPORG OF EETSUB(ESBACT) TO PCPORG OF EEEMAS-REC.
           MOVE PCPOVR OF EETSUB(ESBACT) TO PCPOVR OF EEEMAS-REC.
           MOVE PCPMCP OF EETSUB(ESBACT) TO PCPMCP OF EEEMAS-REC.
           MOVE PCPEFF OF EETSUB(ESBACT) TO PCPEFF OF EEEMAS-REC.
           MOVE PCPEXP OF EETSUB(ESBACT) TO PCPEXP OF EEEMAS-REC.
           MOVE PCPREA OF EETSUB(ESBACT) TO PCPREA OF EEEMAS-REC.
           MOVE PCPTRM OF EETSUB(ESBACT) TO PCPTRM OF EEEMAS-REC.
           MOVE SECCHG OF EETSUB(ESBACT) TO SECCHG OF EEEMAS-REC.
           MOVE SECCOD OF EETSUB(ESBACT) TO SECCOD OF EEEMAS-REC.
           MOVE SECORG OF EETSUB(ESBACT) TO SECORG OF EEEMAS-REC.
           MOVE SECOVR OF EETSUB(ESBACT) TO SECOVR OF EEEMAS-REC.
           MOVE SECMCP OF EETSUB(ESBACT) TO SECMCP OF EEEMAS-REC.
           MOVE SECEFF OF EETSUB(ESBACT) TO SECEFF OF EEEMAS-REC.
           MOVE SECEXP OF EETSUB(ESBACT) TO SECEXP OF EEEMAS-REC.
           MOVE SECREA OF EETSUB(ESBACT) TO SECREA OF EEEMAS-REC.
           MOVE SECTRM OF EETSUB(ESBACT) TO SECTRM OF EEEMAS-REC.
           MOVE MEDCHG OF EETSUB(ESBACT) TO MEDCHG OF EEEMAS-REC.
           MOVE MEDCTY OF EETSUB(ESBACT) TO MEDCTY OF EEEMAS-REC.
           MOVE MEDSTS OF EETSUB(ESBACT) TO MEDSTS OF EEEMAS-REC.
           MOVE MEDEFF OF EETSUB(ESBACT) TO MEDEFF OF EEEMAS-REC.
           MOVE MEDEXP OF EETSUB(ESBACT) TO MEDEXP OF EEEMAS-REC.
           MOVE MEDREA OF EETSUB(ESBACT) TO MEDREA OF EEEMAS-REC.
           MOVE MEDTRM OF EETSUB(ESBACT) TO MEDTRM OF EEEMAS-REC.
           MOVE FEECHG OF EETSUB(ESBACT) TO FEECHG OF EEEMAS-REC.
           MOVE FEECOD OF EETSUB(ESBACT) TO FEECOD OF EEEMAS-REC.
           MOVE FEEEFF OF EETSUB(ESBACT) TO FEEEFF OF EEEMAS-REC.
           MOVE FEEEXP OF EETSUB(ESBACT) TO FEEEXP OF EEEMAS-REC.
           MOVE FEEREA OF EETSUB(ESBACT) TO FEEREA OF EEEMAS-REC.
           MOVE FEETRM OF EETSUB(ESBACT) TO FEETRM OF EEEMAS-REC.
           MOVE ENBCHG OF EETSUB(ESBACT) TO ENBCHG OF EEEMAS-REC.
           MOVE ACCTNO OF EETSUB(ESBACT) TO ACCTNO OF EEEMAS-REC.
           MOVE TIRCAL OF EETSUB(ESBACT) TO TIRCAL OF EEEMAS-REC.
           MOVE TIERCD OF EETSUB(ESBACT) TO TIERCD OF EEEMAS-REC.
           MOVE TIRFLG OF EETSUB(ESBACT) TO TIRFLG OF EEEMAS-REC.
           MOVE BENPKG OF EETSUB(ESBACT) TO BENPKG OF EEEMAS-REC.
           MOVE BILEXC OF EETSUB(ESBACT) TO BILEXC OF EEEMAS-REC.
           MOVE ENBEFF OF EETSUB(ESBACT) TO ENBEFF OF EEEMAS-REC.
           MOVE ENBEXP OF EETSUB(ESBACT) TO ENBEXP OF EEEMAS-REC.
           MOVE ENBREA OF EETSUB(ESBACT) TO ENBREA OF EEEMAS-REC.
           MOVE ENBTRM OF EETSUB(ESBACT) TO ENBTRM OF EEEMAS-REC.
           MOVE CPAIND OF EETSUB(ESBACT) TO CPAIND OF EEEMAS-REC.
           MOVE CPLNAM OF EETSUB(ESBACT) TO CPLNAM OF EEEMAS-REC.
           MOVE CPFNAM OF EETSUB(ESBACT) TO CPFNAM OF EEEMAS-REC.
           MOVE CPMNAM OF EETSUB(ESBACT) TO CPMNAM OF EEEMAS-REC.
           MOVE CPTITL OF EETSUB(ESBACT) TO CPTITL OF EEEMAS-REC.
           MOVE CPFORM OF EETSUB(ESBACT) TO CPFORM OF EEEMAS-REC.
           MOVE CPARNT OF EETSUB(ESBACT) TO CPARNT OF EEEMAS-REC.
           MOVE CPCONT OF EETSUB(ESBACT) TO CPCONT OF EEEMAS-REC.
           MOVE CPHPH1 OF EETSUB(ESBACT) TO CPHPH1 OF EEEMAS-REC.
           MOVE CPHPH2 OF EETSUB(ESBACT) TO CPHPH2 OF EEEMAS-REC.
           MOVE CPHPH3 OF EETSUB(ESBACT) TO CPHPH3 OF EEEMAS-REC.
           MOVE CPWPH1 OF EETSUB(ESBACT) TO CPWPH1 OF EEEMAS-REC.
           MOVE CPWPH2 OF EETSUB(ESBACT) TO CPWPH2 OF EEEMAS-REC.
           MOVE CPWPH3 OF EETSUB(ESBACT) TO CPWPH3 OF EEEMAS-REC.
           MOVE CPWEXT OF EETSUB(ESBACT) TO CPWEXT OF EEEMAS-REC.
           MOVE CFAXNB OF EETSUB(ESBACT) TO CFAXNB OF EEEMAS-REC.
           MOVE COTHPH OF EETSUB(ESBACT) TO COTHPH OF EEEMAS-REC.
           MOVE CEMLIN OF EETSUB(ESBACT) TO CEMLIN OF EEEMAS-REC.
           MOVE CEMAIL OF EETSUB(ESBACT) TO CEMAIL OF EEEMAS-REC.
           MOVE CPADR1 OF EETSUB(ESBACT) TO CPADR1 OF EEEMAS-REC.
           MOVE CPADR2 OF EETSUB(ESBACT) TO CPADR2 OF EEEMAS-REC.
           MOVE CPCITY OF EETSUB(ESBACT) TO CPCITY OF EEEMAS-REC.
           MOVE CPSTAT OF EETSUB(ESBACT) TO CPSTAT OF EEEMAS-REC.
           MOVE CPZCOD OF EETSUB(ESBACT) TO CPZCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETSUB(ESBACT) TO CCNTRY OF EEEMAS-REC.
           MOVE WRKLOC OF EETSUB(ESBACT) TO WRKLOC OF EEEMAS-REC.
           MOVE SSNXRF OF EETSUB(ESBACT) TO SSNXRF OF EEEMAS-REC.
           MOVE HICNNO OF EETSUB(ESBACT) TO HICNNO OF EEEMAS-REC.
           MOVE PEBTFS OF EETSUB(ESBACT) TO PEBTFS OF EEEMAS-REC.
           MOVE MMDIND OF EETSUB(ESBACT) TO MMDIND OF EEEMAS-REC.
           MOVE MMANUM OF EETSUB(ESBACT) TO MMANUM OF EEEMAS-REC.
           MOVE MMAEFF OF EETSUB(ESBACT) TO MMAEFF OF EEEMAS-REC.
           MOVE MIDNUM OF EETSUB(ESBACT) TO MIDNUM OF EEEMAS-REC.
           MOVE MCTCOD OF EETSUB(ESBACT) TO MCTCOD OF EEEMAS-REC.
           MOVE MCTEFF OF EETSUB(ESBACT) TO MCTEFF OF EEEMAS-REC.
           MOVE MPSCOD OF EETSUB(ESBACT) TO MPSCOD OF EEEMAS-REC.
           MOVE MCASNO OF EETSUB(ESBACT) TO MCASNO OF EEEMAS-REC.
           MOVE MCAPCD OF EETSUB(ESBACT) TO MCAPCD OF EEEMAS-REC.
           MOVE MMCEXC OF EETSUB(ESBACT) TO MMCEXC OF EEEMAS-REC.
           MOVE MMCIND OF EETSUB(ESBACT) TO MMCIND OF EEEMAS-REC.
           MOVE MPLNCD OF EETSUB(ESBACT) TO MPLNCD OF EEEMAS-REC.
           MOVE MSPRCD OF EETSUB(ESBACT) TO MSPRCD OF EEEMAS-REC.
           MOVE MPAEDT OF EETSUB(ESBACT) TO MPAEDT OF EEEMAS-REC.
           MOVE MPAETD OF EETSUB(ESBACT) TO MPAETD OF EEEMAS-REC.
           MOVE MPAEFD OF EETSUB(ESBACT) TO MPAEFD OF EEEMAS-REC.
           MOVE MPATDT OF EETSUB(ESBACT) TO MPATDT OF EEEMAS-REC.
           MOVE MPBEDT OF EETSUB(ESBACT) TO MPBEDT OF EEEMAS-REC.
           MOVE MPBETD OF EETSUB(ESBACT) TO MPBETD OF EEEMAS-REC.
           MOVE MPBEFD OF EETSUB(ESBACT) TO MPBEFD OF EEEMAS-REC.
           MOVE MPBTDT OF EETSUB(ESBACT) TO MPBTDT OF EEEMAS-REC.
           MOVE CRDCNT OF EETSUB(ESBACT) TO CRDCNT OF EEEMAS-REC.
           MOVE MHCIND OF EETSUB(ESBACT) TO MHCIND OF EEEMAS-REC.
           MOVE INDUPD OF EETSUB(ESBACT) TO INDUPD OF EEEMAS-REC.
           MOVE OMEDAT OF EETSUB(ESBACT) TO OMEDAT OF EEEMAS-REC.
           MOVE CRDMTH OF EETSUB(ESBACT) TO CRDMTH OF EEEMAS-REC.
           MOVE USRFL1 OF EETSUB(ESBACT) TO USRFL1 OF EEEMAS-REC.
           MOVE USRFL2 OF EETSUB(ESBACT) TO USRFL2 OF EEEMAS-REC.
           MOVE USRFL3 OF EETSUB(ESBACT) TO USRFL3 OF EEEMAS-REC.
           MOVE ACCTN2 OF EETSUB(ESBACT) TO ACCTN2 OF EEEMAS-REC.
           MOVE EECOVR OF EETSUB(ESBACT) TO EECOVR OF EEEMAS-REC.
           MOVE PKGOVR OF EETSUB(ESBACT) TO PKGOVR OF EEEMAS-REC.
           MOVE DALOVR OF EETSUB(ESBACT) TO DALOVR OF EEEMAS-REC.
           MOVE CGAOVR OF EETSUB(ESBACT) TO CGAOVR OF EEEMAS-REC.
           MOVE CGTOVR OF EETSUB(ESBACT) TO CGTOVR OF EEEMAS-REC.
           MOVE SALOVR OF EETSUB(ESBACT) TO SALOVR OF EEEMAS-REC.
           MOVE CBXOVR OF EETSUB(ESBACT) TO CBXOVR OF EEEMAS-REC.
           MOVE CBEOVR OF EETSUB(ESBACT) TO CBEOVR OF EEEMAS-REC.
           MOVE APCOVR OF EETSUB(ESBACT) TO APCOVR OF EEEMAS-REC.
           MOVE SSSOVR OF EETSUB(ESBACT) TO SSSOVR OF EEEMAS-REC.
           MOVE VRCOVR OF EETSUB(ESBACT) TO VRCOVR OF EEEMAS-REC.
           MOVE RMTOVR OF EETSUB(ESBACT) TO RMTOVR OF EEEMAS-REC.
           MOVE EXTMEM OF EETSUB(ESBACT) TO EXTMEM OF EEEMAS-REC.
           MOVE EXTGRP OF EETSUB(ESBACT) TO EXTGRP OF EEEMAS-REC.
           MOVE EXTCON OF EETSUB(ESBACT) TO EXTCON OF EEEMAS-REC.
           MOVE EXTEFF OF EETSUB(ESBACT) TO EXTEFF OF EEEMAS-REC.
           MOVE EXTEXP OF EETSUB(ESBACT) TO EXTEXP OF EEEMAS-REC.
           MOVE EXTSUB OF EETSUB(ESBACT) TO EXTSUB OF EEEMAS-REC.
           MOVE EXTREL OF EETSUB(ESBACT) TO EXTREL OF EEEMAS-REC.
           MOVE HISSEQ OF EETSUB(ESBACT) TO HISSEQ OF EEEMAS-REC.
           MOVE CTLPLN OF EETSUB(ESBACT) TO CTLPLN OF EEEMAS-REC.
           MOVE PRVPLN OF EETSUB(ESBACT) TO PRVPLN OF EEEMAS-REC.
           MOVE PRVNET OF EETSUB(ESBACT) TO PRVNET OF EEEMAS-REC.
           MOVE PROCOD OF EETSUB(ESBACT) TO PROCOD OF EEEMAS-REC.
           MOVE BILMOD OF EETSUB(ESBACT) TO BILMOD OF EEEMAS-REC.
           MOVE BEGMTH OF EETSUB(ESBACT) TO BEGMTH OF EEEMAS-REC.
           MOVE IMDBIL OF EETSUB(ESBACT) TO IMDBIL OF EEEMAS-REC.
           MOVE INTBIL OF EETSUB(ESBACT) TO INTBIL OF EEEMAS-REC.
           MOVE BILCYC OF EETSUB(ESBACT) TO BILCYC OF EEEMAS-REC.
           MOVE SALAMT OF EETSUB(ESBACT) TO SALAMT OF EEEMAS-REC.
           MOVE PAYLOC OF EETSUB(ESBACT) TO PAYLOC OF EEEMAS-REC.
           MOVE PAYNUM OF EETSUB(ESBACT) TO PAYNUM OF EEEMAS-REC.
           MOVE DOCNUM OF EETSUB(ESBACT) TO DOCNUM OF EEEMAS-REC.
           MOVE SALEFF OF EETSUB(ESBACT) TO SALEFF OF EEEMAS-REC.
           MOVE SALEXP OF EETSUB(ESBACT) TO SALEXP OF EEEMAS-REC.
           MOVE OTHINS OF EETSUB(ESBACT) TO OTHINS OF EEEMAS-REC.
           MOVE COBDAT OF EETSUB(ESBACT) TO COBDAT OF EEEMAS-REC.
           MOVE PRICOD OF EETSUB(ESBACT) TO PRICOD OF EEEMAS-REC.
           MOVE MEMNUM OF EETSUB(ESBACT) TO MEMNUM OF EEEMAS-REC.
           MOVE GRPPOL OF EETSUB(ESBACT) TO GRPPOL OF EEEMAS-REC.
           MOVE OINNAM OF EETSUB(ESBACT) TO OINNAM OF EEEMAS-REC.
           IF MEDCOV OF EETSUB(ESBACT) = ' '
              MOVE 'N'                   TO MEDCOV OF EEEMAS-REC
           ELSE
              MOVE MEDCOV OF EETSUB(ESBACT) TO MEDCOV OF EEEMAS-REC.
           IF DENCOV OF EETSUB(ESBACT) = ' '
              MOVE 'N'                   TO DENCOV OF EEEMAS-REC
           ELSE
              MOVE DENCOV OF EETSUB(ESBACT) TO DENCOV OF EEEMAS-REC.

           MOVE OINNUM OF EETSUB(ESBACT) TO OINNUM OF EEEMAS-REC.
           MOVE COVEFF OF EETSUB(ESBACT) TO COVEFF OF EEEMAS-REC.
           MOVE COVEXP OF EETSUB(ESBACT) TO COVEXP OF EEEMAS-REC.
           MOVE CQLECD OF EETSUB(ESBACT) TO CQLECD OF EEEMAS-REC.
           MOVE COBRAQ OF EETSUB(ESBACT) TO COBRAQ OF EEEMAS-REC.
           MOVE COBRAB OF EETSUB(ESBACT) TO COBRAB OF EEEMAS-REC.
           MOVE COBRAE OF EETSUB(ESBACT) TO COBRAE OF EEEMAS-REC.
           MOVE EMSTCD OF EETSUB(ESBACT) TO EMSTCD OF EEEMAS-REC.
           MOVE DETDAT OF EETSUB(ESBACT) TO DETDAT OF EEEMAS-REC.
           MOVE MARSTA OF EETSUB(ESBACT) TO MARSTA OF EEEMAS-REC.
           MOVE DETTYP OF EETSUB(ESBACT) TO DETTYP OF EEEMAS-REC.
           MOVE EXTIND OF EETSUB(ESBACT) TO EXTIND OF EEEMAS-REC.
           MOVE CITZEN OF EETSUB(ESBACT) TO CITZEN OF EEEMAS-REC.
           MOVE FRQCOD OF EETSUB(ESBACT) TO FRQCOD OF EEEMAS-REC.
           MOVE WAGAMT OF EETSUB(ESBACT) TO WAGAMT OF EEEMAS-REC.
           MOVE WRKHRS OF EETSUB(ESBACT) TO WRKHRS OF EEEMAS-REC.
           MOVE WORKLC OF EETSUB(ESBACT) TO WORKLC OF EEEMAS-REC.
           MOVE SALGRD OF EETSUB(ESBACT) TO SALGRD OF EEEMAS-REC.
           MOVE HLTCOD OF EETSUB(ESBACT) TO HLTCOD OF EEEMAS-REC.
           MOVE HEIGHT OF EETSUB(ESBACT) TO HEIGHT OF EEEMAS-REC.
           MOVE WEIGHT OF EETSUB(ESBACT) TO WEIGHT OF EEEMAS-REC.
           MOVE LNGCD1 OF EETSUB(ESBACT) TO LNGCD1 OF EEEMAS-REC.
           MOVE LNGUS1 OF EETSUB(ESBACT) TO LNGUS1 OF EEEMAS-REC.
           MOVE LNGCD2 OF EETSUB(ESBACT) TO LNGCD2 OF EEEMAS-REC.
           MOVE LNGUS2 OF EETSUB(ESBACT) TO LNGUS2 OF EEEMAS-REC.
           MOVE LNGCD3 OF EETSUB(ESBACT) TO LNGCD3 OF EEEMAS-REC.
           MOVE LNGUS3 OF EETSUB(ESBACT) TO LNGUS3 OF EEEMAS-REC.
           MOVE LNGCD4 OF EETSUB(ESBACT) TO LNGCD4 OF EEEMAS-REC.
           MOVE LNGUS4 OF EETSUB(ESBACT) TO LNGUS4 OF EEEMAS-REC.
           MOVE LNGCD5 OF EETSUB(ESBACT) TO LNGCD5 OF EEEMAS-REC.
           MOVE LNGUS5 OF EETSUB(ESBACT) TO LNGUS5 OF EEEMAS-REC.
           MOVE SCHOOL OF EETSUB(ESBACT) TO SCHOOL OF EEEMAS-REC.
           MOVE SPHNUM OF EETSUB(ESBACT) TO SPHNUM OF EEEMAS-REC.
           MOVE SPHEXT OF EETSUB(ESBACT) TO SPHEXT OF EEEMAS-REC.
           MOVE SFAXNB OF EETSUB(ESBACT) TO SFAXNB OF EEEMAS-REC.
           MOVE SEMAIL OF EETSUB(ESBACT) TO SEMAIL OF EEEMAS-REC.
           MOVE SADRL1 OF EETSUB(ESBACT) TO SADRL1 OF EEEMAS-REC.
           MOVE SADRL2 OF EETSUB(ESBACT) TO SADRL2 OF EEEMAS-REC.
           MOVE SCTYCD OF EETSUB(ESBACT) TO SCTYCD OF EEEMAS-REC.
           MOVE SSTACD OF EETSUB(ESBACT) TO SSTACD OF EEEMAS-REC.
           MOVE SZIPCD OF EETSUB(ESBACT) TO SZIPCD OF EEEMAS-REC.
           MOVE SCNTRY OF EETSUB(ESBACT) TO SCNTRY OF EEEMAS-REC.
           MOVE RSPIND OF EETSUB(ESBACT) TO RSPIND OF EEEMAS-REC.
           MOVE RSPIDC OF EETSUB(ESBACT) TO RSPIDC OF EEEMAS-REC.
           MOVE RSPLST OF EETSUB(ESBACT) TO RSPLST OF EEEMAS-REC.
           MOVE RSPFST OF EETSUB(ESBACT) TO RSPFST OF EEEMAS-REC.
           MOVE RSPMID OF EETSUB(ESBACT) TO RSPMID OF EEEMAS-REC.
           MOVE RSPTTL OF EETSUB(ESBACT) TO RSPTTL OF EEEMAS-REC.
           MOVE RSPFRM OF EETSUB(ESBACT) TO RSPFRM OF EEEMAS-REC.
           MOVE RESPNB OF EETSUB(ESBACT) TO RESPNB OF EEEMAS-REC.
           MOVE RHOMPH OF EETSUB(ESBACT) TO RHOMPH OF EEEMAS-REC.
           MOVE RWRKPH OF EETSUB(ESBACT) TO RWRKPH OF EEEMAS-REC.
           MOVE RSPEXT OF EETSUB(ESBACT) TO RSPEXT OF EEEMAS-REC.
           MOVE RFAXNB OF EETSUB(ESBACT) TO RFAXNB OF EEEMAS-REC.
           MOVE ROTHPH OF EETSUB(ESBACT) TO ROTHPH OF EEEMAS-REC.
           MOVE REMLIN OF EETSUB(ESBACT) TO REMLIN OF EEEMAS-REC.
           MOVE REMAIL OF EETSUB(ESBACT) TO REMAIL OF EEEMAS-REC.
           MOVE RCNTCT OF EETSUB(ESBACT) TO RCNTCT OF EEEMAS-REC.
           MOVE RADLN1 OF EETSUB(ESBACT) TO RADLN1 OF EEEMAS-REC.
           MOVE RADLN2 OF EETSUB(ESBACT) TO RADLN2 OF EEEMAS-REC.
           MOVE RCTYCD OF EETSUB(ESBACT) TO RCTYCD OF EEEMAS-REC.
           MOVE RSTACD OF EETSUB(ESBACT) TO RSTACD OF EEEMAS-REC.
           MOVE RZIPCD OF EETSUB(ESBACT) TO RZIPCD OF EEEMAS-REC.
           MOVE RCNTRY OF EETSUB(ESBACT) TO RCNTRY OF EEEMAS-REC.
           MOVE BENIND OF EETSUB(ESBACT) TO BENIND OF EEEMAS-REC.
           MOVE HSAIND OF EETSUB(ESBACT) TO HSAIND OF EEEMAS-REC.
           MOVE HRAIND OF EETSUB(ESBACT) TO HRAIND OF EEEMAS-REC.
           MOVE FSAIND OF EETSUB(ESBACT) TO FSAIND OF EEEMAS-REC.
           MOVE OTHIND OF EETSUB(ESBACT) TO OTHIND OF EEEMAS-REC.
           MOVE MPDIND OF EETSUB(ESBACT) TO MPDIND OF EEEMAS-REC.
           MOVE PHAIND OF EETSUB(ESBACT) TO PHAIND OF EEEMAS-REC.
           MOVE DENIND OF EETSUB(ESBACT) TO DENIND OF EEEMAS-REC.
           MOVE VISIND OF EETSUB(ESBACT) TO VISIND OF EEEMAS-REC.
           MOVE MHTIND OF EETSUB(ESBACT) TO MHTIND OF EEEMAS-REC.
           MOVE OTHBEN OF EETSUB(ESBACT) TO OTHBEN OF EEEMAS-REC.
           MOVE FSAAMT OF EETSUB(ESBACT) TO FSAAMT OF EEEMAS-REC.
           MOVE ALTIND OF EETSUB(ESBACT) TO ALTIND OF EEEMAS-REC.
           MOVE ALTAD1 OF EETSUB(ESBACT) TO ALTAD1 OF EEEMAS-REC.
           MOVE ALTAD2 OF EETSUB(ESBACT) TO ALTAD2 OF EEEMAS-REC.
           MOVE ALTCTY OF EETSUB(ESBACT) TO ALTCTY OF EEEMAS-REC.
           MOVE ALTSTT OF EETSUB(ESBACT) TO ALTSTT OF EEEMAS-REC.
           MOVE ALTPST OF EETSUB(ESBACT) TO ALTPST OF EEEMAS-REC.
           MOVE ALTCNR OF EETSUB(ESBACT) TO ALTCNR OF EEEMAS-REC.
           MOVE OLDMAR OF EETSUB(ESBACT) TO OLDMAR OF EEEMAS-REC.
           MOVE OLDRCD OF EETSUB(ESBACT) TO OLDRCD OF EEEMAS-REC.
           MOVE OLDCTZ OF EETSUB(ESBACT) TO OLDCTZ OF EEEMAS-REC.
           MOVE SCHCLK OF EETSUB(ESBACT) TO SCHCLK OF EEEMAS-REC.
           MOVE CNFCOD OF EETSUB(ESBACT) TO CNFCOD OF EEEMAS-REC.
           MOVE CALTPH OF EETSUB(ESBACT) TO CALTPH OF EEEMAS-REC.
           MOVE CBEPNB OF EETSUB(ESBACT) TO CBEPNB OF EEEMAS-REC.
           MOVE CCELPH OF EETSUB(ESBACT) TO CCELPH OF EEEMAS-REC.
           MOVE RALTPH OF EETSUB(ESBACT) TO RALTPH OF EEEMAS-REC.
           MOVE RBEPNB OF EETSUB(ESBACT) TO RBEPNB OF EEEMAS-REC.
           MOVE RCELPH OF EETSUB(ESBACT) TO RCELPH OF EEEMAS-REC.
           MOVE ALTPHN OF EETSUB(ESBACT) TO ALTPHN OF EEEMAS-REC.
           MOVE BEPNBR OF EETSUB(ESBACT) TO BEPNBR OF EEEMAS-REC.
           MOVE CELPHN OF EETSUB(ESBACT) TO CELPHN OF EEEMAS-REC.
           MOVE EXCMEM OF EETSUB(ESBACT) TO EXCMEM OF EEEMAS-REC.
           MOVE EXCSUB OF EETSUB(ESBACT) TO EXCSUB OF EEEMAS-REC.
           MOVE PRVSUB OF EETSUB(ESBACT) TO PRVSUB OF EEEMAS-REC.
           MOVE SMKCES OF EETSUB(ESBACT) TO SMKCES OF EEEMAS-REC.
           MOVE REPNAM OF EETSUB(ESBACT) TO REPNAM OF EEEMAS-REC.
           MOVE REPRFQ OF EETSUB(ESBACT) TO REPRFQ OF EEEMAS-REC.
           MOVE REPREF OF EETSUB(ESBACT) TO REPREF OF EEEMAS-REC.
           MOVE REPEFQ OF EETSUB(ESBACT) TO REPEFQ OF EEEMAS-REC.
           MOVE REPEFF OF EETSUB(ESBACT) TO REPEFF OF EEEMAS-REC.
           MOVE OPYAMT OF EETSUB(ESBACT) TO OPYAMT OF EEEMAS-REC.
           MOVE OPYEFF OF EETSUB(ESBACT) TO OPYEFF OF EEEMAS-REC.
           MOVE OPYEXP OF EETSUB(ESBACT) TO OPYEXP OF EEEMAS-REC.
           MOVE OPYSRC OF EETSUB(ESBACT) TO OPYSRC OF EEEMAS-REC.
           MOVE APTAMT OF EETSUB(ESBACT) TO APTAMT OF EEEMAS-REC.
           MOVE APTEFF OF EETSUB(ESBACT) TO APTEFF OF EEEMAS-REC.
           MOVE APTEXP OF EETSUB(ESBACT) TO APTEXP OF EEEMAS-REC.
           MOVE CSRAMT OF EETSUB(ESBACT) TO CSRAMT OF EEEMAS-REC.
           MOVE CSREFF OF EETSUB(ESBACT) TO CSREFF OF EEEMAS-REC.
           MOVE CSREXP OF EETSUB(ESBACT) TO CSREXP OF EEEMAS-REC.
           MOVE PREAMT OF EETSUB(ESBACT) TO PREAMT OF EEEMAS-REC.
           MOVE PREEFF OF EETSUB(ESBACT) TO PREEFF OF EEEMAS-REC.
           MOVE PREEXP OF EETSUB(ESBACT) TO PREEXP OF EEEMAS-REC.
           MOVE RSPTOT OF EETSUB(ESBACT) TO RSPTOT OF EEEMAS-REC.
           MOVE RSPEFF OF EETSUB(ESBACT) TO RSPEFF OF EEEMAS-REC.
           MOVE RSPEXP OF EETSUB(ESBACT) TO RSPEXP OF EEEMAS-REC.
           MOVE PRETOT OF EETSUB(ESBACT) TO PRETOT OF EEEMAS-REC.
           MOVE PTOEFF OF EETSUB(ESBACT) TO PTOEFF OF EEEMAS-REC.
           MOVE PTOEXP OF EETSUB(ESBACT) TO PTOEXP OF EEEMAS-REC.
           MOVE EMPTOT OF EETSUB(ESBACT) TO EMPTOT OF EEEMAS-REC.
           MOVE EMPEFF OF EETSUB(ESBACT) TO EMPEFF OF EEEMAS-REC.
           MOVE EMPEXP OF EETSUB(ESBACT) TO EMPEXP OF EEEMAS-REC.
           MOVE RATARA OF EETSUB(ESBACT) TO RATARA OF EEEMAS-REC.
           MOVE RATEFF OF EETSUB(ESBACT) TO RATEFF OF EEEMAS-REC.
           MOVE RATEXP OF EETSUB(ESBACT) TO RATEXP OF EEEMAS-REC.
           MOVE EXCPOL OF EETSUB(ESBACT) TO EXCPOL OF EEEMAS-REC.
           MOVE ASSQHP OF EETSUB(ESBACT) TO ASSQHP OF EEEMAS-REC.
           MOVE SHPGRP OF EETSUB(ESBACT) TO SHPGRP OF EEEMAS-REC.
           MOVE PYMTID OF EETSUB(ESBACT) TO PYMTID OF EEEMAS-REC.
           MOVE EXCHNG OF EETSUB(ESBACT) TO EXCHNG OF EEEMAS-REC.
           MOVE COUNTY OF EETSUB(ESBACT) TO COUNTY OF EEEMAS-REC.
           MOVE ETHCD1 OF EETSUB(ESBACT) TO ETHCD1 OF EEEMAS-REC.
           MOVE ETHCD2 OF EETSUB(ESBACT) TO ETHCD2 OF EEEMAS-REC.
           MOVE ETHCD3 OF EETSUB(ESBACT) TO ETHCD3 OF EEEMAS-REC.
           MOVE ETHCD4 OF EETSUB(ESBACT) TO ETHCD4 OF EEEMAS-REC.
           MOVE ETHCD5 OF EETSUB(ESBACT) TO ETHCD5 OF EEEMAS-REC.
           MOVE ETHCD6 OF EETSUB(ESBACT) TO ETHCD6 OF EEEMAS-REC.
           MOVE ETHCD7 OF EETSUB(ESBACT) TO ETHCD7 OF EEEMAS-REC.
           MOVE ETHCD8 OF EETSUB(ESBACT) TO ETHCD8 OF EEEMAS-REC.
           MOVE ETHCD9 OF EETSUB(ESBACT) TO ETHCD9 OF EEEMAS-REC.
           MOVE REQTIM OF EETSUB(ESBACT) TO REQTIM OF EEEMAS-REC.
           MOVE REQEFF OF EETSUB(ESBACT) TO REQEFF OF EEEMAS-REC.
           MOVE REQEXP OF EETSUB(ESBACT) TO REQEXP OF EEEMAS-REC.
           MOVE TENTID OF EETSUB(ESBACT) TO TENTID OF EEEMAS-REC.
           MOVE TENEFF OF EETSUB(ESBACT) TO TENEFF OF EEEMAS-REC.
           MOVE TENEXP OF EETSUB(ESBACT) TO TENEXP OF EEEMAS-REC.
           MOVE SEPREA OF EETSUB(ESBACT) TO SEPREA OF EEEMAS-REC.
           MOVE SEPEFF OF EETSUB(ESBACT) TO SEPEFF OF EEEMAS-REC.
           MOVE SEPEXP OF EETSUB(ESBACT) TO SEPEXP OF EEEMAS-REC.
           MOVE REACAT OF EETSUB(ESBACT) TO REACAT OF EEEMAS-REC.
           MOVE REAEFF OF EETSUB(ESBACT) TO REAEFF OF EEEMAS-REC.
           MOVE REAEXP OF EETSUB(ESBACT) TO REAEXP OF EEEMAS-REC.
      *
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF EEEMAS-REC.
           MOVE CTLNUM OF EEWHDR-WRK   TO CTLNUM OF EEEMAS-REC.
           MOVE TRNDAT OF EEWHDR-WRK   TO TRNDAT OF EEEMAS-REC.
           MOVE TRNTIM OF EEWHDR-WRK   TO TRNTIM OF EEEMAS-REC.
           MOVE TRANID OF EEWHDR-WRK   TO TRANID OF EEEMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF EEEMAS-REC
                                          LSTCHG OF EEEMAS-REC.
           MOVE 'ED201C'               TO USERID OF EEEMAS-REC.
           MOVE 'EDI'                  TO TERMID OF EEEMAS-REC.
      *
           PERFORM EEEMAS-WRITE                  IF INVALID-KEY
              IF EEEMAS-STATUS = '22'
                 GO TO A222-NEXT
              ELSE
                 MOVE 'Y'                 TO PRCERR OF PGM-WORK
                 MOVE SPACES            TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EEEMAS'                      TO MI-PARM4
                 MOVE EEEMAS-STATUS                 TO MI-PARM5
                 MOVE 'EI06062'                     TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEEMAS-REC TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEEMAS-REC TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEEMAS-REC TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEEMAS-REC TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEEMAS-REC TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE             TO LINE-E
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                 GO TO A229-EXIT.
      *
           GO TO A222-NEXT.
       A225-NEXT.
           MOVE ZEROES                           TO EDPACT.
       A226-NEXT.
           MOVE 'Y'                              TO SW-NEWRECORD.
           MOVE 'Y'                              TO SW-NEWRECORD-WRN.
      *
           IF EDPACT NOT < EDPLST                GO TO A229-EXIT.
      *
           ADD 1                                 TO EDPACT.
      *
           IF SUBSNO OF EEWDEP(EDPACT) = SPACES
              GO TO A226-NEXT.
      *
           SET ERRINX TO 1.
      *
           SEARCH ERRTAB               AT END    GO TO A227-NEXT
           WHEN MEMBNO OF EEWDEP(EDPACT) = MEMBNO OF ERRTAB(ERRINX)
            AND ERRMEM OF EEWDEP(EDPACT) = 'Y'
              GO TO A226-NEXT
           END-SEARCH.
      *
       A227-NEXT.
           MOVE SPACES                 TO MESSAGE-INTERFACE-PARAMETERS.
           MOVE 'EI02471'                        TO MI-PRIMARY-ID.
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE.
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE.
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE.
           MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE.
           MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE.
           MOVE ERR-LINE                         TO LINE-E.
           PERFORM X100-PRINT-ERROR              THRU X109-EXIT.
      *
           MOVE RECTYP OF EETDEP(EDPACT) TO RECTYP OF EEEMAS-REC.
           MOVE GRPNUM OF EETDEP(EDPACT) TO GRPNUM OF EEEMAS-REC.
           MOVE SUBSNO OF EETDEP(EDPACT) TO SUBSNO OF EEEMAS-REC.
           MOVE RELTYP OF EETDEP(EDPACT) TO RELTYP OF EEEMAS-REC.
           MOVE RELCOD OF EETDEP(EDPACT) TO RELCOD OF EEEMAS-REC.
           MOVE MEMBNO OF EETDEP(EDPACT) TO MEMBNO OF EEEMAS-REC.
           MOVE BTHDAT OF EETDEP(EDPACT) TO BTHDAT OF EEEMAS-REC.
           MOVE BTHSEQ OF EETDEP(EDPACT) TO BTHSEQ OF EEEMAS-REC.
           MOVE BTHCHG OF EETDEP(EDPACT) TO BTHCHG OF EEEMAS-REC.
           MOVE SEXCOD OF EETDEP(EDPACT) TO SEXCOD OF EEEMAS-REC.
           MOVE SEXCHG OF EETDEP(EDPACT) TO SEXCHG OF EEEMAS-REC.
           MOVE CHGTYP OF EETDEP(EDPACT) TO CHGTYP OF EEEMAS-REC.
           MOVE CHGDAT OF EETDEP(EDPACT) TO CHGDAT OF EEEMAS-REC.
           MOVE CHGTIM OF EETDEP(EDPACT) TO CHGTIM OF EEEMAS-REC.
           MOVE CHGEFF OF EETDEP(EDPACT) TO CHGEFF OF EEEMAS-REC.
           MOVE NAMCHG OF EETDEP(EDPACT) TO NAMCHG OF EEEMAS-REC.
           MOVE LSTNAM OF EETDEP(EDPACT) TO LSTNAM OF EEEMAS-REC.
           MOVE FSTNAM OF EETDEP(EDPACT) TO FSTNAM OF EEEMAS-REC.
           MOVE MIDNAM OF EETDEP(EDPACT) TO MIDNAM OF EEEMAS-REC.
           MOVE TITLCD OF EETDEP(EDPACT) TO TITLCD OF EEEMAS-REC.
           MOVE FORNAM OF EETDEP(EDPACT) TO FORNAM OF EEEMAS-REC.
           MOVE MEMCHG OF EETDEP(EDPACT) TO MEMCHG OF EEEMAS-REC.
           MOVE EMPSTA OF EETDEP(EDPACT) TO EMPSTA OF EEEMAS-REC.
           MOVE PRTCOD OF EETDEP(EDPACT) TO PRTCOD OF EEEMAS-REC.
           MOVE MEMEFF OF EETDEP(EDPACT) TO MEMEFF OF EEEMAS-REC.
           MOVE MEMEXP OF EETDEP(EDPACT) TO MEMEXP OF EEEMAS-REC.
           MOVE MEMREA OF EETDEP(EDPACT) TO MEMREA OF EEEMAS-REC.
           MOVE MEMTRM OF EETDEP(EDPACT) TO MEMTRM OF EEEMAS-REC.
           MOVE DEMCHG OF EETDEP(EDPACT) TO DEMCHG OF EEEMAS-REC.
           MOVE ADRLN1 OF EETDEP(EDPACT) TO ADRLN1 OF EEEMAS-REC.
           MOVE ADRLN2 OF EETDEP(EDPACT) TO ADRLN2 OF EEEMAS-REC.
           MOVE CITYCD OF EETDEP(EDPACT) TO CITYCD OF EEEMAS-REC.
           MOVE STATCD OF EETDEP(EDPACT) TO STACOD OF EEEMAS-REC.
           MOVE ZIPCOD OF EETDEP(EDPACT) TO ZIPCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETDEP(EDPACT) TO CCNTRY OF EEEMAS-REC.
           MOVE LOCQLF OF EETDEP(EDPACT) TO LOCQLF OF EEEMAS-REC.
           MOVE AREACD OF EETDEP(EDPACT) TO AREACD OF EEEMAS-REC.
           MOVE HOMPH1 OF EETDEP(EDPACT) TO HOMPH1 OF EEEMAS-REC.
           MOVE HOMPH2 OF EETDEP(EDPACT) TO HOMPH2 OF EEEMAS-REC.
           MOVE HOMPH3 OF EETDEP(EDPACT) TO HOMPH3 OF EEEMAS-REC.
           MOVE WRKPH1 OF EETDEP(EDPACT) TO WRKPH1 OF EEEMAS-REC.
           MOVE WRKPH2 OF EETDEP(EDPACT) TO WRKPH2 OF EEEMAS-REC.
           MOVE WRKPH3 OF EETDEP(EDPACT) TO WRKPH3 OF EEEMAS-REC.
           MOVE WRKEXT OF EETDEP(EDPACT) TO WRKEXT OF EEEMAS-REC.
           MOVE FAXNUM OF EETDEP(EDPACT) TO FAXNUM OF EEEMAS-REC.
           MOVE OTHPHN OF EETDEP(EDPACT) TO OTHPHN OF EEEMAS-REC.
           MOVE EMLIND OF EETDEP(EDPACT) TO EMLIND OF EEEMAS-REC.
           MOVE ELMAIL OF EETDEP(EDPACT) TO ELMAIL OF EEEMAS-REC.
           MOVE HIRDAT OF EETDEP(EDPACT) TO HIRDAT OF EEEMAS-REC.
           MOVE TRMDAT OF EETDEP(EDPACT) TO TRMDAT OF EEEMAS-REC.
           MOVE SOCSEC OF EETDEP(EDPACT) TO SOCSEC OF EEEMAS-REC.
           MOVE OLDLST OF EETDEP(EDPACT) TO OLDLST OF EEEMAS-REC.
           MOVE OLDFST OF EETDEP(EDPACT) TO OLDFST OF EEEMAS-REC.
           MOVE OLDMID OF EETDEP(EDPACT) TO OLDMID OF EEEMAS-REC.
           MOVE OLDTLC OF EETDEP(EDPACT) TO OLDTLC OF EEEMAS-REC.
           MOVE OLDSSN OF EETDEP(EDPACT) TO OLDSSN OF EEEMAS-REC.
           MOVE OLDBTH OF EETDEP(EDPACT) TO OLDBTH OF EEEMAS-REC.
           MOVE OLDSEX OF EETDEP(EDPACT) TO OLDSEX OF EEEMAS-REC.
           MOVE RACECD OF EETDEP(EDPACT) TO RACECD OF EEEMAS-REC.
           MOVE TYPCOD OF EETDEP(EDPACT) TO TYPCOD OF EEEMAS-REC.
           MOVE HOLDCD OF EETDEP(EDPACT) TO HOLDCD OF EEEMAS-REC.
           MOVE MEMSTA OF EETDEP(EDPACT) TO MEMSTA OF EEEMAS-REC.
           MOVE STUSTA OF EETDEP(EDPACT) TO STUSTA OF EEEMAS-REC.
           MOVE EDUBEG OF EETDEP(EDPACT) TO EDUBEG OF EEEMAS-REC.
           MOVE EDUEND OF EETDEP(EDPACT) TO EDUEND OF EEEMAS-REC.
           MOVE HNDIND OF EETDEP(EDPACT) TO HNDIND OF EEEMAS-REC.
           MOVE AUTEXP OF EETDEP(EDPACT) TO AUTEXP OF EEEMAS-REC.
           MOVE ALTNUM OF EETDEP(EDPACT) TO ALTNUM OF EEEMAS-REC.
           MOVE INTKCD OF EETDEP(EDPACT) TO INTKCD OF EEEMAS-REC.
           MOVE PCPCHG OF EETDEP(EDPACT) TO PCPCHG OF EEEMAS-REC.
           MOVE PCPCOD OF EETDEP(EDPACT) TO PCPCOD OF EEEMAS-REC.
           MOVE PCPORG OF EETDEP(EDPACT) TO PCPORG OF EEEMAS-REC.
           MOVE PCPOVR OF EETDEP(EDPACT) TO PCPOVR OF EEEMAS-REC.
           MOVE PCPMCP OF EETDEP(EDPACT) TO PCPMCP OF EEEMAS-REC.
           MOVE PCPEFF OF EETDEP(EDPACT) TO PCPEFF OF EEEMAS-REC.
           MOVE PCPEXP OF EETDEP(EDPACT) TO PCPEXP OF EEEMAS-REC.
           MOVE PCPREA OF EETDEP(EDPACT) TO PCPREA OF EEEMAS-REC.
           MOVE PCPTRM OF EETDEP(EDPACT) TO PCPTRM OF EEEMAS-REC.
           MOVE SECCHG OF EETDEP(EDPACT) TO SECCHG OF EEEMAS-REC.
           MOVE SECCOD OF EETDEP(EDPACT) TO SECCOD OF EEEMAS-REC.
           MOVE SECORG OF EETDEP(EDPACT) TO SECORG OF EEEMAS-REC.
           MOVE SECOVR OF EETDEP(EDPACT) TO SECOVR OF EEEMAS-REC.
           MOVE SECMCP OF EETDEP(EDPACT) TO SECMCP OF EEEMAS-REC.
           MOVE SECEFF OF EETDEP(EDPACT) TO SECEFF OF EEEMAS-REC.
           MOVE SECEXP OF EETDEP(EDPACT) TO SECEXP OF EEEMAS-REC.
           MOVE SECREA OF EETDEP(EDPACT) TO SECREA OF EEEMAS-REC.
           MOVE SECTRM OF EETDEP(EDPACT) TO SECTRM OF EEEMAS-REC.
           MOVE MEDCHG OF EETDEP(EDPACT) TO MEDCHG OF EEEMAS-REC.
           MOVE MEDCTY OF EETDEP(EDPACT) TO MEDCTY OF EEEMAS-REC.
           MOVE MEDSTS OF EETDEP(EDPACT) TO MEDSTS OF EEEMAS-REC.
           MOVE MEDEFF OF EETDEP(EDPACT) TO MEDEFF OF EEEMAS-REC.
           MOVE MEDEXP OF EETDEP(EDPACT) TO MEDEXP OF EEEMAS-REC.
           MOVE MEDREA OF EETDEP(EDPACT) TO MEDREA OF EEEMAS-REC.
           MOVE MEDTRM OF EETDEP(EDPACT) TO MEDTRM OF EEEMAS-REC.
           MOVE FEECHG OF EETDEP(EDPACT) TO FEECHG OF EEEMAS-REC.
           MOVE FEECOD OF EETDEP(EDPACT) TO FEECOD OF EEEMAS-REC.
           MOVE FEEEFF OF EETDEP(EDPACT) TO FEEEFF OF EEEMAS-REC.
           MOVE FEEEXP OF EETDEP(EDPACT) TO FEEEXP OF EEEMAS-REC.
           MOVE FEEREA OF EETDEP(EDPACT) TO FEEREA OF EEEMAS-REC.
           MOVE FEETRM OF EETDEP(EDPACT) TO FEETRM OF EEEMAS-REC.
           MOVE ENBCHG OF EETDEP(EDPACT) TO ENBCHG OF EEEMAS-REC.
           MOVE ACCTNO OF EETDEP(EDPACT) TO ACCTNO OF EEEMAS-REC.
           MOVE TIRCAL OF EETDEP(EDPACT) TO TIRCAL OF EEEMAS-REC.
           MOVE TIERCD OF EETDEP(EDPACT) TO TIERCD OF EEEMAS-REC.
           MOVE TIRFLG OF EETDEP(EDPACT) TO TIRFLG OF EEEMAS-REC.
           MOVE BENPKG OF EETDEP(EDPACT) TO BENPKG OF EEEMAS-REC.
           MOVE BILEXC OF EETDEP(EDPACT) TO BILEXC OF EEEMAS-REC.
           MOVE ENBEFF OF EETDEP(EDPACT) TO ENBEFF OF EEEMAS-REC.
           MOVE ENBEXP OF EETDEP(EDPACT) TO ENBEXP OF EEEMAS-REC.
           MOVE ENBREA OF EETDEP(EDPACT) TO ENBREA OF EEEMAS-REC.
           MOVE ENBTRM OF EETDEP(EDPACT) TO ENBTRM OF EEEMAS-REC.
           MOVE CPAIND OF EETDEP(EDPACT) TO CPAIND OF EEEMAS-REC.
           MOVE CPLNAM OF EETDEP(EDPACT) TO CPLNAM OF EEEMAS-REC.
           MOVE CPFNAM OF EETDEP(EDPACT) TO CPFNAM OF EEEMAS-REC.
           MOVE CPMNAM OF EETDEP(EDPACT) TO CPMNAM OF EEEMAS-REC.
           MOVE CPTITL OF EETDEP(EDPACT) TO CPTITL OF EEEMAS-REC.
           MOVE CPFORM OF EETDEP(EDPACT) TO CPFORM OF EEEMAS-REC.
           MOVE CPARNT OF EETDEP(EDPACT) TO CPARNT OF EEEMAS-REC.
           MOVE CPCONT OF EETDEP(EDPACT) TO CPCONT OF EEEMAS-REC.
           MOVE CPHPH1 OF EETDEP(EDPACT) TO CPHPH1 OF EEEMAS-REC.
           MOVE CPHPH2 OF EETDEP(EDPACT) TO CPHPH2 OF EEEMAS-REC.
           MOVE CPHPH3 OF EETDEP(EDPACT) TO CPHPH3 OF EEEMAS-REC.
           MOVE CPWPH1 OF EETDEP(EDPACT) TO CPWPH1 OF EEEMAS-REC.
           MOVE CPWPH2 OF EETDEP(EDPACT) TO CPWPH2 OF EEEMAS-REC.
           MOVE CPWPH3 OF EETDEP(EDPACT) TO CPWPH3 OF EEEMAS-REC.
           MOVE CPWEXT OF EETDEP(EDPACT) TO CPWEXT OF EEEMAS-REC.
           MOVE CFAXNB OF EETDEP(EDPACT) TO CFAXNB OF EEEMAS-REC.
           MOVE COTHPH OF EETDEP(EDPACT) TO COTHPH OF EEEMAS-REC.
           MOVE CEMLIN OF EETDEP(EDPACT) TO CEMLIN OF EEEMAS-REC.
           MOVE CEMAIL OF EETDEP(EDPACT) TO CEMAIL OF EEEMAS-REC.
           MOVE CPADR1 OF EETDEP(EDPACT) TO CPADR1 OF EEEMAS-REC.
           MOVE CPADR2 OF EETDEP(EDPACT) TO CPADR2 OF EEEMAS-REC.
           MOVE CPCITY OF EETDEP(EDPACT) TO CPCITY OF EEEMAS-REC.
           MOVE CPSTAT OF EETDEP(EDPACT) TO CPSTAT OF EEEMAS-REC.
           MOVE CPZCOD OF EETDEP(EDPACT) TO CPZCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETDEP(EDPACT) TO CCNTRY OF EEEMAS-REC.
           MOVE WRKLOC OF EETDEP(EDPACT) TO WRKLOC OF EEEMAS-REC.
           MOVE SSNXRF OF EETDEP(EDPACT) TO SSNXRF OF EEEMAS-REC.
           MOVE HICNNO OF EETDEP(EDPACT) TO HICNNO OF EEEMAS-REC.
           MOVE PEBTFS OF EETDEP(EDPACT) TO PEBTFS OF EEEMAS-REC.
           MOVE MMDIND OF EETDEP(EDPACT) TO MMDIND OF EEEMAS-REC.
           MOVE MMANUM OF EETDEP(EDPACT) TO MMANUM OF EEEMAS-REC.
           MOVE MMAEFF OF EETDEP(EDPACT) TO MMAEFF OF EEEMAS-REC.
           MOVE MIDNUM OF EETDEP(EDPACT) TO MIDNUM OF EEEMAS-REC.
           MOVE MCTCOD OF EETDEP(EDPACT) TO MCTCOD OF EEEMAS-REC.
           MOVE MCTEFF OF EETDEP(EDPACT) TO MCTEFF OF EEEMAS-REC.
           MOVE MPSCOD OF EETDEP(EDPACT) TO MPSCOD OF EEEMAS-REC.
           MOVE MCASNO OF EETDEP(EDPACT) TO MCASNO OF EEEMAS-REC.
           MOVE MCAPCD OF EETDEP(EDPACT) TO MCAPCD OF EEEMAS-REC.
           MOVE MMCEXC OF EETDEP(EDPACT) TO MMCEXC OF EEEMAS-REC.
           MOVE MMCIND OF EETDEP(EDPACT) TO MMCIND OF EEEMAS-REC.
           MOVE MPLNCD OF EETDEP(EDPACT) TO MPLNCD OF EEEMAS-REC.
           MOVE MSPRCD OF EETDEP(EDPACT) TO MSPRCD OF EEEMAS-REC.
           MOVE MPAEDT OF EETDEP(EDPACT) TO MPAEDT OF EEEMAS-REC.
           MOVE MPAETD OF EETDEP(EDPACT) TO MPAETD OF EEEMAS-REC.
           MOVE MPAEFD OF EETDEP(EDPACT) TO MPAEFD OF EEEMAS-REC.
           MOVE MPATDT OF EETDEP(EDPACT) TO MPATDT OF EEEMAS-REC.
           MOVE MPBEDT OF EETDEP(EDPACT) TO MPBEDT OF EEEMAS-REC.
           MOVE MPBETD OF EETDEP(EDPACT) TO MPBETD OF EEEMAS-REC.
           MOVE MPBEFD OF EETDEP(EDPACT) TO MPBEFD OF EEEMAS-REC.
           MOVE MPBTDT OF EETDEP(EDPACT) TO MPBTDT OF EEEMAS-REC.
           MOVE CRDCNT OF EETDEP(EDPACT) TO CRDCNT OF EEEMAS-REC.
           MOVE MHCIND OF EETDEP(EDPACT) TO MHCIND OF EEEMAS-REC.
           MOVE INDUPD OF EETDEP(EDPACT) TO INDUPD OF EEEMAS-REC.
           MOVE OMEDAT OF EETDEP(EDPACT) TO OMEDAT OF EEEMAS-REC.
           MOVE CRDMTH OF EETDEP(EDPACT) TO CRDMTH OF EEEMAS-REC.
           MOVE USRFL1 OF EETDEP(EDPACT) TO USRFL1 OF EEEMAS-REC.
           MOVE USRFL2 OF EETDEP(EDPACT) TO USRFL2 OF EEEMAS-REC.
           MOVE USRFL3 OF EETDEP(EDPACT) TO USRFL3 OF EEEMAS-REC.
           MOVE ACCTN2 OF EETDEP(EDPACT) TO ACCTN2 OF EEEMAS-REC.
           MOVE EECOVR OF EETDEP(EDPACT) TO EECOVR OF EEEMAS-REC.
           MOVE PKGOVR OF EETDEP(EDPACT) TO PKGOVR OF EEEMAS-REC.
           MOVE DALOVR OF EETDEP(EDPACT) TO DALOVR OF EEEMAS-REC.
           MOVE CGAOVR OF EETDEP(EDPACT) TO CGAOVR OF EEEMAS-REC.
           MOVE CGTOVR OF EETDEP(EDPACT) TO CGTOVR OF EEEMAS-REC.
           MOVE SALOVR OF EETDEP(EDPACT) TO SALOVR OF EEEMAS-REC.
           MOVE CBXOVR OF EETDEP(EDPACT) TO CBXOVR OF EEEMAS-REC.
           MOVE CBEOVR OF EETDEP(EDPACT) TO CBEOVR OF EEEMAS-REC.
           MOVE APCOVR OF EETDEP(EDPACT) TO APCOVR OF EEEMAS-REC.
           MOVE SSSOVR OF EETDEP(EDPACT) TO SSSOVR OF EEEMAS-REC.
           MOVE VRCOVR OF EETDEP(EDPACT) TO VRCOVR OF EEEMAS-REC.
           MOVE RMTOVR OF EETDEP(EDPACT) TO RMTOVR OF EEEMAS-REC.
           MOVE EXTMEM OF EETDEP(EDPACT) TO EXTMEM OF EEEMAS-REC.
           MOVE EXTGRP OF EETDEP(EDPACT) TO EXTGRP OF EEEMAS-REC.
           MOVE EXTCON OF EETDEP(EDPACT) TO EXTCON OF EEEMAS-REC.
           MOVE EXTEFF OF EETDEP(EDPACT) TO EXTEFF OF EEEMAS-REC.
           MOVE EXTEXP OF EETDEP(EDPACT) TO EXTEXP OF EEEMAS-REC.
           MOVE EXTSUB OF EETDEP(EDPACT) TO EXTSUB OF EEEMAS-REC.
           MOVE EXTREL OF EETDEP(EDPACT) TO EXTREL OF EEEMAS-REC.
           MOVE HISSEQ OF EETDEP(EDPACT) TO HISSEQ OF EEEMAS-REC.
           MOVE CTLPLN OF EETDEP(EDPACT) TO CTLPLN OF EEEMAS-REC.
           MOVE PRVPLN OF EETDEP(EDPACT) TO PRVPLN OF EEEMAS-REC.
           MOVE PRVNET OF EETDEP(EDPACT) TO PRVNET OF EEEMAS-REC.
           MOVE PROCOD OF EETDEP(EDPACT) TO PROCOD OF EEEMAS-REC.
           MOVE BILMOD OF EETDEP(EDPACT) TO BILMOD OF EEEMAS-REC.
           MOVE BEGMTH OF EETDEP(EDPACT) TO BEGMTH OF EEEMAS-REC.
           MOVE IMDBIL OF EETDEP(EDPACT) TO IMDBIL OF EEEMAS-REC.
           MOVE INTBIL OF EETDEP(EDPACT) TO INTBIL OF EEEMAS-REC.
           MOVE BILCYC OF EETDEP(EDPACT) TO BILCYC OF EEEMAS-REC.
           MOVE SALAMT OF EETDEP(EDPACT) TO SALAMT OF EEEMAS-REC.
           MOVE PAYLOC OF EETDEP(EDPACT) TO PAYLOC OF EEEMAS-REC.
           MOVE PAYNUM OF EETDEP(EDPACT) TO PAYNUM OF EEEMAS-REC.
           MOVE DOCNUM OF EETDEP(EDPACT) TO DOCNUM OF EEEMAS-REC.
           MOVE SALEFF OF EETDEP(EDPACT) TO SALEFF OF EEEMAS-REC.
           MOVE SALEXP OF EETDEP(EDPACT) TO SALEXP OF EEEMAS-REC.
           MOVE OTHINS OF EETDEP(EDPACT) TO OTHINS OF EEEMAS-REC.
           MOVE COBDAT OF EETDEP(EDPACT) TO COBDAT OF EEEMAS-REC.
           MOVE PRICOD OF EETDEP(EDPACT) TO PRICOD OF EEEMAS-REC.
           MOVE MEMNUM OF EETDEP(EDPACT) TO MEMNUM OF EEEMAS-REC.
           MOVE GRPPOL OF EETDEP(EDPACT) TO GRPPOL OF EEEMAS-REC.
           MOVE OINNAM OF EETDEP(EDPACT) TO OINNAM OF EEEMAS-REC.
           IF MEDCOV OF EETDEP(EDPACT) = ' '
              MOVE 'N'                   TO MEDCOV OF EEEMAS-REC
           ELSE
              MOVE MEDCOV OF EETDEP(EDPACT) TO MEDCOV OF EEEMAS-REC.
           IF DENCOV OF EETDEP(EDPACT) = ' '
              MOVE 'N'                   TO DENCOV OF EEEMAS-REC
           ELSE
              MOVE DENCOV OF EETDEP(EDPACT) TO DENCOV OF EEEMAS-REC.

           MOVE OINNUM OF EETDEP(EDPACT) TO OINNUM OF EEEMAS-REC.
           MOVE COVEFF OF EETDEP(EDPACT) TO COVEFF OF EEEMAS-REC.
           MOVE COVEXP OF EETDEP(EDPACT) TO COVEXP OF EEEMAS-REC.
           MOVE CQLECD OF EETDEP(EDPACT) TO CQLECD OF EEEMAS-REC.
           MOVE COBRAQ OF EETDEP(EDPACT) TO COBRAQ OF EEEMAS-REC.
           MOVE COBRAB OF EETDEP(EDPACT) TO COBRAB OF EEEMAS-REC.
           MOVE COBRAE OF EETDEP(EDPACT) TO COBRAE OF EEEMAS-REC.
           MOVE EMSTCD OF EETDEP(EDPACT) TO EMSTCD OF EEEMAS-REC.
           MOVE DETDAT OF EETDEP(EDPACT) TO DETDAT OF EEEMAS-REC.
           MOVE MARSTA OF EETDEP(EDPACT) TO MARSTA OF EEEMAS-REC.
           MOVE DETTYP OF EETDEP(EDPACT) TO DETTYP OF EEEMAS-REC.
           MOVE EXTIND OF EETDEP(EDPACT) TO EXTIND OF EEEMAS-REC.
           MOVE CITZEN OF EETDEP(EDPACT) TO CITZEN OF EEEMAS-REC.
           MOVE FRQCOD OF EETDEP(EDPACT) TO FRQCOD OF EEEMAS-REC.
           MOVE WAGAMT OF EETDEP(EDPACT) TO WAGAMT OF EEEMAS-REC.
           MOVE WRKHRS OF EETDEP(EDPACT) TO WRKHRS OF EEEMAS-REC.
           MOVE WORKLC OF EETDEP(EDPACT) TO WORKLC OF EEEMAS-REC.
           MOVE SALGRD OF EETDEP(EDPACT) TO SALGRD OF EEEMAS-REC.
           MOVE HLTCOD OF EETDEP(EDPACT) TO HLTCOD OF EEEMAS-REC.
           MOVE HEIGHT OF EETDEP(EDPACT) TO HEIGHT OF EEEMAS-REC.
           MOVE WEIGHT OF EETDEP(EDPACT) TO WEIGHT OF EEEMAS-REC.
           MOVE LNGCD1 OF EETDEP(EDPACT) TO LNGCD1 OF EEEMAS-REC.
           MOVE LNGUS1 OF EETDEP(EDPACT) TO LNGUS1 OF EEEMAS-REC.
           MOVE LNGCD2 OF EETDEP(EDPACT) TO LNGCD2 OF EEEMAS-REC.
           MOVE LNGUS2 OF EETDEP(EDPACT) TO LNGUS2 OF EEEMAS-REC.
           MOVE LNGCD3 OF EETDEP(EDPACT) TO LNGCD3 OF EEEMAS-REC.
           MOVE LNGUS3 OF EETDEP(EDPACT) TO LNGUS3 OF EEEMAS-REC.
           MOVE LNGCD4 OF EETDEP(EDPACT) TO LNGCD4 OF EEEMAS-REC.
           MOVE LNGUS4 OF EETDEP(EDPACT) TO LNGUS4 OF EEEMAS-REC.
           MOVE LNGCD5 OF EETDEP(EDPACT) TO LNGCD5 OF EEEMAS-REC.
           MOVE LNGUS5 OF EETDEP(EDPACT) TO LNGUS5 OF EEEMAS-REC.
           MOVE SCHOOL OF EETDEP(EDPACT) TO SCHOOL OF EEEMAS-REC.
           MOVE SPHNUM OF EETDEP(EDPACT) TO SPHNUM OF EEEMAS-REC.
           MOVE SPHEXT OF EETDEP(EDPACT) TO SPHEXT OF EEEMAS-REC.
           MOVE SFAXNB OF EETDEP(EDPACT) TO SFAXNB OF EEEMAS-REC.
           MOVE SEMAIL OF EETDEP(EDPACT) TO SEMAIL OF EEEMAS-REC.
           MOVE SADRL1 OF EETDEP(EDPACT) TO SADRL1 OF EEEMAS-REC.
           MOVE SADRL2 OF EETDEP(EDPACT) TO SADRL2 OF EEEMAS-REC.
           MOVE SCTYCD OF EETDEP(EDPACT) TO SCTYCD OF EEEMAS-REC.
           MOVE SSTACD OF EETDEP(EDPACT) TO SSTACD OF EEEMAS-REC.
           MOVE SZIPCD OF EETDEP(EDPACT) TO SZIPCD OF EEEMAS-REC.
           MOVE SCNTRY OF EETDEP(EDPACT) TO SCNTRY OF EEEMAS-REC.
           MOVE RSPIND OF EETDEP(EDPACT) TO RSPIND OF EEEMAS-REC.
           MOVE RSPIDC OF EETDEP(EDPACT) TO RSPIDC OF EEEMAS-REC.
           MOVE RSPLST OF EETDEP(EDPACT) TO RSPLST OF EEEMAS-REC.
           MOVE RSPFST OF EETDEP(EDPACT) TO RSPFST OF EEEMAS-REC.
           MOVE RSPMID OF EETDEP(EDPACT) TO RSPMID OF EEEMAS-REC.
           MOVE RSPTTL OF EETDEP(EDPACT) TO RSPTTL OF EEEMAS-REC.
           MOVE RSPFRM OF EETDEP(EDPACT) TO RSPFRM OF EEEMAS-REC.
           MOVE RESPNB OF EETDEP(EDPACT) TO RESPNB OF EEEMAS-REC.
           MOVE RHOMPH OF EETDEP(EDPACT) TO RHOMPH OF EEEMAS-REC.
           MOVE RWRKPH OF EETDEP(EDPACT) TO RWRKPH OF EEEMAS-REC.
           MOVE RSPEXT OF EETDEP(EDPACT) TO RSPEXT OF EEEMAS-REC.
           MOVE RFAXNB OF EETDEP(EDPACT) TO RFAXNB OF EEEMAS-REC.
           MOVE ROTHPH OF EETDEP(EDPACT) TO ROTHPH OF EEEMAS-REC.
           MOVE REMLIN OF EETDEP(EDPACT) TO REMLIN OF EEEMAS-REC.
           MOVE REMAIL OF EETDEP(EDPACT) TO REMAIL OF EEEMAS-REC.
           MOVE RCNTCT OF EETDEP(EDPACT) TO RCNTCT OF EEEMAS-REC.
           MOVE RADLN1 OF EETDEP(EDPACT) TO RADLN1 OF EEEMAS-REC.
           MOVE RADLN2 OF EETDEP(EDPACT) TO RADLN2 OF EEEMAS-REC.
           MOVE RCTYCD OF EETDEP(EDPACT) TO RCTYCD OF EEEMAS-REC.
           MOVE RSTACD OF EETDEP(EDPACT) TO RSTACD OF EEEMAS-REC.
           MOVE RZIPCD OF EETDEP(EDPACT) TO RZIPCD OF EEEMAS-REC.
           MOVE RCNTRY OF EETDEP(EDPACT) TO RCNTRY OF EEEMAS-REC.
           MOVE BENIND OF EETDEP(EDPACT) TO BENIND OF EEEMAS-REC.
           MOVE HSAIND OF EETDEP(EDPACT) TO HSAIND OF EEEMAS-REC.
           MOVE HRAIND OF EETDEP(EDPACT) TO HRAIND OF EEEMAS-REC.
           MOVE FSAIND OF EETDEP(EDPACT) TO FSAIND OF EEEMAS-REC.
           MOVE OTHIND OF EETDEP(EDPACT) TO OTHIND OF EEEMAS-REC.
           MOVE MPDIND OF EETDEP(EDPACT) TO MPDIND OF EEEMAS-REC.
           MOVE PHAIND OF EETDEP(EDPACT) TO PHAIND OF EEEMAS-REC.
           MOVE DENIND OF EETDEP(EDPACT) TO DENIND OF EEEMAS-REC.
           MOVE VISIND OF EETDEP(EDPACT) TO VISIND OF EEEMAS-REC.
           MOVE MHTIND OF EETDEP(EDPACT) TO MHTIND OF EEEMAS-REC.
           MOVE OTHBEN OF EETDEP(EDPACT) TO OTHBEN OF EEEMAS-REC.
           MOVE FSAAMT OF EETDEP(EDPACT) TO FSAAMT OF EEEMAS-REC.
           MOVE ALTIND OF EETDEP(EDPACT) TO ALTIND OF EEEMAS-REC.
           MOVE ALTAD1 OF EETDEP(EDPACT) TO ALTAD1 OF EEEMAS-REC.
           MOVE ALTAD2 OF EETDEP(EDPACT) TO ALTAD2 OF EEEMAS-REC.
           MOVE ALTCTY OF EETDEP(EDPACT) TO ALTCTY OF EEEMAS-REC.
           MOVE ALTSTT OF EETDEP(EDPACT) TO ALTSTT OF EEEMAS-REC.
           MOVE ALTPST OF EETDEP(EDPACT) TO ALTPST OF EEEMAS-REC.
           MOVE ALTCNR OF EETDEP(EDPACT) TO ALTCNR OF EEEMAS-REC.
           MOVE OLDMAR OF EETDEP(EDPACT) TO OLDMAR OF EEEMAS-REC.
           MOVE OLDRCD OF EETDEP(EDPACT) TO OLDRCD OF EEEMAS-REC.
           MOVE OLDCTZ OF EETDEP(EDPACT) TO OLDCTZ OF EEEMAS-REC.
           MOVE SCHCLK OF EETDEP(EDPACT) TO SCHCLK OF EEEMAS-REC.
           MOVE CNFCOD OF EETDEP(EDPACT) TO CNFCOD OF EEEMAS-REC.
           MOVE CALTPH OF EETDEP(EDPACT) TO CALTPH OF EEEMAS-REC.
           MOVE CBEPNB OF EETDEP(EDPACT) TO CBEPNB OF EEEMAS-REC.
           MOVE CCELPH OF EETDEP(EDPACT) TO CCELPH OF EEEMAS-REC.
           MOVE RALTPH OF EETDEP(EDPACT) TO RALTPH OF EEEMAS-REC.
           MOVE RBEPNB OF EETDEP(EDPACT) TO RBEPNB OF EEEMAS-REC.
           MOVE RCELPH OF EETDEP(EDPACT) TO RCELPH OF EEEMAS-REC.
           MOVE ALTPHN OF EETDEP(EDPACT) TO ALTPHN OF EEEMAS-REC.
           MOVE BEPNBR OF EETDEP(EDPACT) TO BEPNBR OF EEEMAS-REC.
           MOVE CELPHN OF EETDEP(EDPACT) TO CELPHN OF EEEMAS-REC.
           MOVE EXCMEM OF EETDEP(EDPACT) TO EXCMEM OF EEEMAS-REC.
           MOVE EXCSUB OF EETDEP(EDPACT) TO EXCSUB OF EEEMAS-REC.
           MOVE PRVSUB OF EETDEP(EDPACT) TO PRVSUB OF EEEMAS-REC.
           MOVE SMKCES OF EETDEP(EDPACT) TO SMKCES OF EEEMAS-REC.
           MOVE REPNAM OF EETDEP(EDPACT) TO REPNAM OF EEEMAS-REC.
           MOVE REPRFQ OF EETDEP(EDPACT) TO REPRFQ OF EEEMAS-REC.
           MOVE REPREF OF EETDEP(EDPACT) TO REPREF OF EEEMAS-REC.
           MOVE REPEFQ OF EETDEP(EDPACT) TO REPEFQ OF EEEMAS-REC.
           MOVE REPEFF OF EETDEP(EDPACT) TO REPEFF OF EEEMAS-REC.
           MOVE OPYAMT OF EETDEP(EDPACT) TO OPYAMT OF EEEMAS-REC.
           MOVE OPYEFF OF EETDEP(EDPACT) TO OPYEFF OF EEEMAS-REC.
           MOVE OPYEXP OF EETDEP(EDPACT) TO OPYEXP OF EEEMAS-REC.
           MOVE OPYSRC OF EETDEP(EDPACT) TO OPYSRC OF EEEMAS-REC.
           MOVE APTAMT OF EETDEP(EDPACT) TO APTAMT OF EEEMAS-REC.
           MOVE APTEFF OF EETDEP(EDPACT) TO APTEFF OF EEEMAS-REC.
           MOVE APTEXP OF EETDEP(EDPACT) TO APTEXP OF EEEMAS-REC.
           MOVE CSRAMT OF EETDEP(EDPACT) TO CSRAMT OF EEEMAS-REC.
           MOVE CSREFF OF EETDEP(EDPACT) TO CSREFF OF EEEMAS-REC.
           MOVE CSREXP OF EETDEP(EDPACT) TO CSREXP OF EEEMAS-REC.
           MOVE PREAMT OF EETDEP(EDPACT) TO PREAMT OF EEEMAS-REC.
           MOVE PREEFF OF EETDEP(EDPACT) TO PREEFF OF EEEMAS-REC.
           MOVE PREEXP OF EETDEP(EDPACT) TO PREEXP OF EEEMAS-REC.
           MOVE RSPTOT OF EETDEP(EDPACT) TO RSPTOT OF EEEMAS-REC.
           MOVE RSPEFF OF EETDEP(EDPACT) TO RSPEFF OF EEEMAS-REC.
           MOVE RSPEXP OF EETDEP(EDPACT) TO RSPEXP OF EEEMAS-REC.
           MOVE PRETOT OF EETDEP(EDPACT) TO PRETOT OF EEEMAS-REC.
           MOVE PTOEFF OF EETDEP(EDPACT) TO PTOEFF OF EEEMAS-REC.
           MOVE PTOEXP OF EETDEP(EDPACT) TO PTOEXP OF EEEMAS-REC.
           MOVE EMPTOT OF EETDEP(EDPACT) TO EMPTOT OF EEEMAS-REC.
           MOVE EMPEFF OF EETDEP(EDPACT) TO EMPEFF OF EEEMAS-REC.
           MOVE EMPEXP OF EETDEP(EDPACT) TO EMPEXP OF EEEMAS-REC.
           MOVE RATARA OF EETDEP(EDPACT) TO RATARA OF EEEMAS-REC.
           MOVE RATEFF OF EETDEP(EDPACT) TO RATEFF OF EEEMAS-REC.
           MOVE RATEXP OF EETDEP(EDPACT) TO RATEXP OF EEEMAS-REC.
           MOVE EXCPOL OF EETDEP(EDPACT) TO EXCPOL OF EEEMAS-REC.
           MOVE ASSQHP OF EETDEP(EDPACT) TO ASSQHP OF EEEMAS-REC.
           MOVE SHPGRP OF EETDEP(EDPACT) TO SHPGRP OF EEEMAS-REC.
           MOVE PYMTID OF EETDEP(EDPACT) TO PYMTID OF EEEMAS-REC.
           MOVE EXCHNG OF EETDEP(EDPACT) TO EXCHNG OF EEEMAS-REC.
           MOVE COUNTY OF EETDEP(EDPACT) TO COUNTY OF EEEMAS-REC.
           MOVE ETHCD1 OF EETDEP(EDPACT) TO ETHCD1 OF EEEMAS-REC.
           MOVE ETHCD2 OF EETDEP(EDPACT) TO ETHCD2 OF EEEMAS-REC.
           MOVE ETHCD3 OF EETDEP(EDPACT) TO ETHCD3 OF EEEMAS-REC.
           MOVE ETHCD4 OF EETDEP(EDPACT) TO ETHCD4 OF EEEMAS-REC.
           MOVE ETHCD5 OF EETDEP(EDPACT) TO ETHCD5 OF EEEMAS-REC.
           MOVE ETHCD6 OF EETDEP(EDPACT) TO ETHCD6 OF EEEMAS-REC.
           MOVE ETHCD7 OF EETDEP(EDPACT) TO ETHCD7 OF EEEMAS-REC.
           MOVE ETHCD8 OF EETDEP(EDPACT) TO ETHCD8 OF EEEMAS-REC.
           MOVE ETHCD9 OF EETDEP(EDPACT) TO ETHCD9 OF EEEMAS-REC.
           MOVE REQTIM OF EETDEP(EDPACT) TO REQTIM OF EEEMAS-REC.
           MOVE REQEFF OF EETDEP(EDPACT) TO REQEFF OF EEEMAS-REC.
           MOVE REQEXP OF EETDEP(EDPACT) TO REQEXP OF EEEMAS-REC.
           MOVE TENTID OF EETDEP(EDPACT) TO TENTID OF EEEMAS-REC.
           MOVE TENEFF OF EETDEP(EDPACT) TO TENEFF OF EEEMAS-REC.
           MOVE TENEXP OF EETDEP(EDPACT) TO TENEXP OF EEEMAS-REC.
           MOVE SEPREA OF EETDEP(EDPACT) TO SEPREA OF EEEMAS-REC.
           MOVE SEPEFF OF EETDEP(EDPACT) TO SEPEFF OF EEEMAS-REC.
           MOVE SEPEXP OF EETDEP(EDPACT) TO SEPEXP OF EEEMAS-REC.
           MOVE REACAT OF EETDEP(EDPACT) TO REACAT OF EEEMAS-REC.
           MOVE REAEFF OF EETDEP(EDPACT) TO REAEFF OF EEEMAS-REC.
           MOVE REAEXP OF EETDEP(EDPACT) TO REAEXP OF EEEMAS-REC.
      *
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF EEEMAS-REC.
           MOVE CTLNUM OF EEWHDR-WRK   TO CTLNUM OF EEEMAS-REC.
           MOVE TRNDAT OF EEWHDR-WRK   TO TRNDAT OF EEEMAS-REC.
           MOVE TRNTIM OF EEWHDR-WRK   TO TRNTIM OF EEEMAS-REC.
           MOVE TRANID OF EEWHDR-WRK   TO TRANID OF EEEMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF EEEMAS-REC
                                          LSTCHG OF EEEMAS-REC.
           MOVE 'ED201C'               TO USERID OF EEEMAS-REC.
           MOVE 'EDI'                  TO TERMID OF EEEMAS-REC.
      *
           PERFORM EEEMAS-WRITE                  IF INVALID-KEY
              IF EEEMAS-STATUS = '22'
                 GO TO A226-NEXT
              ELSE
                 MOVE 'Y'                 TO PRCERR OF PGM-WORK
                 MOVE SPACES            TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EEEMAS'                      TO MI-PARM4
                 MOVE EEEMAS-STATUS                 TO MI-PARM5
                 MOVE 'EI06062'                     TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEEMAS-REC TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEEMAS-REC TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEEMAS-REC TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEEMAS-REC TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEEMAS-REC TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                 GO TO A229-EXIT.
      *
           GO TO A226-NEXT.
       A229-EXIT.
           EXIT.
      *
       A240-LOAD-SUBERR.
      ***************************************************************
      * LOAD EACH SUBSCRIBER THAT GETS AN ERROR INTO ERRTAB      *
      ***************************************************************
           SET ERRINX TO 1.
      *
           SEARCH ERRTAB                 AT END  GO TO A242-NEXT
           WHEN MEMBNO OF EEWSUB(ESBACT) = MEMBNO OF ERRTAB(ERRINX)
           GO TO A249-EXIT.
       A242-NEXT.
           ADD 1                                 TO ERRACT.
      *
           IF ERRACT > ERRMAX
              GO TO A249-EXIT.
      *
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERRTAB(ERRACT).
           MOVE 'Y'                      TO ERRMEM OF EEWSUB(ESBACT).
       A249-EXIT.
           EXIT.
      *
       A250-LOAD-MEMERR.
      ***************************************************************
      * LOAD EACH MEMBER THAT GETS AN ERROR INTO ERRTAB             *
      ***************************************************************
           SET ERRINX TO 1.
      *
           SEARCH ERRTAB                 AT END  GO TO A252-NEXT
           WHEN MEMBNO OF EEWDEP(EDPACT) = MEMBNO OF ERRTAB(ERRINX)
           GO TO A259-EXIT.
       A252-NEXT.
           ADD 1                                 TO ERRACT.
      *
           IF ERRACT > ERRMAX
              GO TO A259-EXIT.
      *
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERRTAB(ERRACT).
           MOVE 'Y'                      TO ERRMEM OF EEWDEP(EDPACT).
       A259-EXIT.
           EXIT.
      *
       A300-MHS-INFO.
      **************************************************************
      * RETRIVE MHS INNFORMATION FOR GROUP/SUBSNO COMBO            *
      **************************************************************
           MOVE SPACES                 TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA.
      *
           MOVE SPACES                           TO WS-EXCHNG.
      *
           IF ESBACT NOT = ZEROES
              MOVE EXCHNG OF EEWSB2(ESBACT)      TO WS-EXCHNG
           ELSE
              IF EDPACT NOT = ZEROES
                 MOVE EXCHNG OF EEWDP2(EDPACT)   TO WS-EXCHNG
              END-IF
           END-IF.
      *
           IF WS-EXCHNG = 'EI' OR 'ES'
              PERFORM A460-EXCHNG-EDITS          THRU A469-EXIT
              IF WS-EXCHNG = 'ES'
              AND ENRTYP OF MDTMAS-REC NOT = 'RE'
                 MOVE 'R'              TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA.
      *
           IF WS-EXCHNG NOT = 'EI'
           AND WS-EXCHNG NOT = 'ES'
              PERFORM A350-CHKIF-EXCSUB          THRU A359-EXIT
              GO TO A303-CONTINUE.
      *
           MOVE SPACES                           TO GRPMAS-REC
           MOVE OLDGRP                 TO GRPNUM OF GRPMAS-REC.
           PERFORM GRPMAS-READ                   IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
                                                    GROUP-FLAG
              MOVE 'GROUP NUMBER'                TO MI-PARM4
              MOVE 'EI02414'                     TO MI-PRIMARY-ID
                                          MSGNUM OF ERR-LINE
              MOVE OLDGRP              TO GRPNUM OF ERR-LINE
              MOVE ERR-LINE            TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
           IF WS-EXCHNG = 'EI'
           AND INDBIL OF GRPMAS-REC NOT = 'Y'
              MOVE 'Y'                           TO FAMILY-FLAG
                                                    GROUP-FLAG
              MOVE 'EI09147'                     TO MI-PRIMARY-ID
                                          MSGNUM OF ERR-LINE
              MOVE OLDGRP              TO GRPNUM OF ERR-LINE
              MOVE ERR-LINE            TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
           IF WS-EXCHNG  = 'ES'
           AND INDBIL OF GRPMAS-REC = 'Y'
              MOVE 'Y'                           TO FAMILY-FLAG
                                                    GROUP-FLAG
              MOVE 'EI09148'                     TO MI-PRIMARY-ID
                                          MSGNUM OF ERR-LINE
              MOVE OLDGRP              TO GRPNUM OF ERR-LINE
              MOVE ERR-LINE            TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
           MOVE ZEROES                           TO ESBACT.
           MOVE ZEROES                           TO EDPACT.
      *
           IF ESBACT NOT < ESBLST                GO TO A301-DEP.
      *
           ADD 1                                 TO ESBACT.
      *
           MOVE SPACES                           TO WS-ACCTNO.
           MOVE SPACES                           TO WS-ACCTN2.
           MOVE ACCTNO OF EEWSUB(ESBACT)         TO WS-ACCTNO.
           MOVE ACCTN2 OF EEWSUB(ESBACT)         TO WS-ACCTN2.
           MOVE SPACES                           TO WS-DT2-EXCHNG
                                                    WS-EXCHNG.
           MOVE EXCHNG OF EEWSB2(ESBACT)         TO WS-DT2-EXCHNG
                                                    WS-EXCHNG.
      *
           PERFORM A430-SAVE-EXCSUB              THRU A439-EXIT.
      *
           GO TO A302-NEXT.
      *
       A301-DEP.
      ****--------------------------------------------------------****
      ****  PMHS-374  KCT  Fix                                    ****
      ****  Continue processing after all dependents have been    ****
      ****  captured.                                             ****
      ****--------------------------------------------------------****
      **** IF EDPACT NOT < EDPLST
      ****    IF EDPACT NOT = ZEROES
      ****       IF (EXCHNG OF EEWDP2(EDPACT)='EI'
      ****       AND ENRSTA OF MDTMAS-REC = 'R')
      ****       OR (EXCHNG OF EEWDP2(EDPACT) = 'ES')
      ****           MOVE EXCHNG OF EEWDP2(EDPACT)
      ****                                       TO WS-EXCHNG
      ****           GO TO A303-CONTINUE
      ****       END-IF
      ****    END-IF
      **** IF EDPLST = ZEROES
      ****    GO TO A303-CONTINUE
      **** ELSE
      ****    GO TO A309-EXIT.
      *
           ADD 1                                 TO EDPACT.
           MOVE SPACES                           TO WS-DT2-EXCHNG
                                                    WS-EXCHNG.
           MOVE EXCHNG OF EEWDP2(EDPACT)         TO WS-DT2-EXCHNG
                                                    WS-EXCHNG.
           PERFORM A440-SAVE-EXCDEP              THRU A449-EXIT.
      *
       A302-NEXT.
           PERFORM A420-EEIDT3-EDITS          THRU A429-EXIT.
      *
           IF FAMILY-ERROR
              GO TO A309-EXIT.
      *
           MOVE SPACES                        TO WS-ACCTNO
                                                 WS-ACCTN2.
      *
           IF  ESBACT > ZEROES
           AND EDPACT = ZEROES
              MOVE WS-DT3-TRMEFF       TO TRMEFF OF EEWSB3(ESBACT).
      *
           IF EDPACT > ZEROES
              MOVE WS-DT3-TRMEFF       TO TRMEFF OF EEWDP3(EDPACT).
      *
           IF  ESBACT > ZEROES
           AND EDPACT > ZEROES
              MOVE WS-DT3-TRMEFF       TO TRMEFF OF EEWDP3(EDPACT).
      *
           IF  WS-EXCHNG = 'EI'
              PERFORM A410-CHECK-PREENROLL       THRU A419-EXIT
              IF FAMILY-ERROR                    GO TO A309-EXIT
           END-IF.
      *
           IF ENRTYP OF MDTMAS-REC = 'RE'
              MOVE SPACES              TO WS-ENRSTA
                                          ENRSTA OF MDTMAS-REC.

           IF  WS-EXCHNG = 'ES'
           AND WS-DT3-RELCOD NOT = '1'
           AND WS-DT3-MEMBNO = SPACES
              IF WS-DT3-CHGTYP = 'A'
                 PERFORM A580-GENNUM             THRU A589-EXIT
                 GO TO A303-FOLLOW.
      *
           IF  WS-EXCHNG = 'ES' OR 'EI'
              IF WS-DT3-CHGTYP NOT = 'A'
                 IF WS-DT3-RELCOD = '1'
                    IF MEMBNO OF EEWSUB(ESBACT) = SPACES
                       PERFORM B700-RTVMBR          THRU B709-EXIT
                    END-IF
                 ELSE
                    IF MEMBNO OF EEWDEP(EDPACT) = SPACES
                       PERFORM B700-RTVMBR          THRU B709-EXIT
                    END-IF
                 END-IF
              END-IF.
      *
       A303-FOLLOW.
           IF WS-EXCHNG = 'EI'
           AND ENRSTA OF MDTMAS-REC = ' '
              IF WS-DT3-RELCOD = '1'
                 IF WS-DT3-CHGTYP = ' '
                    MOVE 'A'           TO CHGTYP OF EEWSUB(ESBACT)
                 END-IF
              ELSE
                 IF WS-DT3-CHGTYP = ' '
                    MOVE 'A'           TO CHGTYP OF EEWDEP(EDPACT)
                 END-IF
              END-IF
           END-IF.
      *
      ****--------------------------------------------------------****
      ****  PMHS-374  KCT  Fix                                    ****
      ****  Continue processing after all dependents have been    ****
      ****  captured.                                             ****
      ****--------------------------------------------------------****
      **** GO TO A301-DEP.
           IF EDPACT < EDPLST
              GO TO A301-DEP.
      *
       A303-CONTINUE.
           MOVE SPACES                           TO FAMILY-FLAG
           MOVE 'N'                              TO SW-SET-ERROR.
      *
           PERFORM A400-INIT-MEMTAB              THRU A409-EXIT.
      *
           PERFORM A310-MEMMAS                   THRU A319-EXIT.
           IF FAMILY-ERROR                       GO TO A309-EXIT.
      *
      * READ THE GRPMAS RECORD FOR THE GROUP
      *
           MOVE SPACES                           TO GRPMAS-REC
           MOVE OLDGRP                 TO GRPNUM OF GRPMAS-REC.
           PERFORM GRPMAS-READ                   IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
                                                    GROUP-FLAG
              MOVE 'GROUP NUMBER'                TO MI-PARM4
              MOVE 'EI02414'                     TO MI-PRIMARY-ID
                                          MSGNUM OF ERR-LINE
              MOVE OLDGRP              TO GRPNUM OF ERR-LINE
              MOVE ERR-LINE            TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
           PERFORM A500-SUB-CHECK                THRU A509-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A309-EXIT.
      *
           PERFORM A510-MEM-CHECK                THRU A519-EXIT.
      *
       A309-EXIT.
           EXIT.
      *
       A310-MEMMAS.
      ***************************************************************
      * RETRIEVE MEMMAS INFO FOR FAMILY MEMBERS                     *
      ***************************************************************
           MOVE ZEROES                           TO MEMACT
                                                    MESACT.
      *
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE OLDSUB                 TO SUBSNO OF MEMSBS-KEY.
           MOVE ZEROES                 TO EXPDAT OF MEMSBS-KEY
                                          TRNSEQ OF MEMSBS-KEY.
           MOVE SPACES                           TO SUB-EXIST-FLAG.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
                                                 GO TO A319-EXIT.
      *
       A312-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
                                                 GO TO A319-EXIT.
      *
           IF SUBSNO OF MEMMAS-REC NOT = OLDSUB
                                                 GO TO A319-EXIT.
      *
           IF GRPNUM OF MEMMAS-REC NOT = OLDGRP
              GO TO A312-NEXT.
      *
           IF EXPDAT OF MEMMAS-REC = EFFDAT OF MEMMAS-REC
              GO TO A312-NEXT.
           MOVE 'H'                              TO SUB-EXIST-FLAG.
      *
           PERFORM A360-LOAD-MEMDATA             THRU A369-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A319-EXIT.
      *
           IF (MEMBNO OF MEMMAS-REC NOT = MEMBNO-HLD)
           OR (GRPNUM OF MEMMAS-REC NOT = OLDGRP)
           OR (SUBACT = ZERO)
              PERFORM A390-DEMMAS                THRU A399-EXIT
              MOVE MEMBNO OF MEMMAS-REC          TO MEMBNO-HLD.
      *
           PERFORM A320-ENBMAS                   THRU A329-EXIT.
      *
           GO TO A312-NEXT.
      *
       A319-EXIT.
           EXIT.
      *
       A320-ENBMAS.
      ***************************************************************
      * GET ENBMAS INFORMATION FOR EACH MEMBER
      ***************************************************************
           MOVE ZEROES                           TO ENBACT
                                                    ENSACT.
      *
           MOVE SPACES                           TO ENBMEM-KEY.
           MOVE MEMBNO-HLD             TO MEMBNO OF ENBMEM-KEY.
           MOVE ZEROES                 TO EXPDAT OF ENBMEM-KEY
                                          TRNSEQ OF ENBMEM-KEY.
           PERFORM ENBMEM-STARTGE                IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00303'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00303'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A329-EXIT.
      *
       A322-NEXT.
           PERFORM ENBMEM-READNX                 IF AT-END
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00303'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00303'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A329-EXIT.
      *
           IF MEMBNO-HLD NOT = MEMBNO OF ENBMAS-REC
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00303'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00303'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A329-EXIT.
      *
           IF GRPNUM OF ENBMAS-REC NOT = OLDGRP
              GO TO A322-NEXT.
      *
           IF SUBSNO OF ENBMAS-REC NOT = OLDSUB
              GO TO A322-NEXT.
      *
           PERFORM A370-LOAD-ENBDATA             THRU A379-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A329-EXIT.
       A325-NEXT.
           PERFORM ENBMEM-READNX                 IF AT-END
                                                 GO TO A328-END.
      *
           IF MEMBNO-HLD NOT = MEMBNO OF ENBMAS-REC
              GO TO A328-END.
      *
           IF SUBSNO OF ENBMAS-REC NOT = OLDSUB
              GO TO A325-NEXT.
      *
           IF GRPNUM OF ENBMAS-REC NOT = OLDGRP
              GO TO A325-NEXT.
      *
           PERFORM A370-LOAD-ENBDATA             THRU A379-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A329-EXIT.
      *
           GO TO A325-NEXT.
       A328-END.
           PERFORM A330-ENPMAS                   THRU A339-EXIT.
       A329-EXIT.
           EXIT.
      *
       A330-ENPMAS.
      ***************************************************************
      * GET ENPMAS INFORMATION FOR MEMBER                           *
      ***************************************************************
           MOVE ZEROES                           TO PCPACT
                                                    SECACT
                                                    FEEACT
                                                    MEDACT
                                                    PPSACT
                                                    SPSACT
                                                    SMDACT
                                                    SFEACT.

           MOVE 'N'                              TO WS-FLG-MEDTAB
                                                    WS-FLG-SUBPCP
                                                    WS-FLG-SUBSEC
                                                    WS-FLG-SUBMED
                                                    WS-FLG-SUBFEE.
      *
           MOVE SPACES                           TO PCP-FLAG.
      *
           MOVE SPACES                           TO ENPGRP-KEY.
           MOVE OLDGRP                 TO GRPNUM OF ENPGRP-KEY.
           MOVE MEMBNO-HLD             TO MEMBNO OF ENPGRP-KEY.
           PERFORM ENPGRP-STARTGE                IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00304'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00304'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A339-EXIT.
       A332-NEXT.
           PERFORM ENPGRP-READNX                 IF AT-END
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00304'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00304'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A339-EXIT.
      *
           IF MEMBNO OF ENPMAS-REC NOT = MEMBNO-HLD
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00304'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00304'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A339-EXIT.
      *
           IF GRPNUM OF ENPMAS-REC NOT = OLDGRP
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00304'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00304'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A339-EXIT.
      *
           PERFORM A380-ENPDATA                  THRU A389-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A339-EXIT.
       A335-NEXT.
           PERFORM ENPGRP-READNX                 IF AT-END
                                                 GO TO A338-END.
      *
           IF MEMBNO OF ENPMAS-REC NOT = MEMBNO-HLD
                                                 GO TO A338-END.
      *
           IF GRPNUM OF ENPMAS-REC NOT = OLDGRP
                                                 GO TO A338-END.
      *
           PERFORM A380-ENPDATA                  THRU A389-EXIT.
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A339-EXIT.
      *
           GO TO A335-NEXT.
       A338-END.
      *  CHECK FOR PRIMARY CARE PROVIDER RECORD
           IF NOT PCP-FOUND
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00304'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI00304'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
       A339-EXIT.
           EXIT.
      *
       A340-MEM-EFFEXP.
      *
           MOVE 'Y'                              TO SW-FST-REC.
           INITIALIZE MEMMAS-REC.
           MOVE WS-DT3-SUBSNO          TO SUBSNO OF MEMSBS-KEY.
           MOVE WS-DT3-RELCOD          TO RELCOD OF MEMSBS-KEY.
           MOVE WS-DT3-MEMBNO          TO MEMBNO OF MEMSBS-KEY.
           MOVE WS-DT3-GRPNUM          TO GRPNUM OF MEMSBS-KEY.
           MOVE ZEROES                 TO TRNSEQ OF MEMSBS-KEY
      *                                   EXPDAT OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              MOVE ZEROES                        TO WS-SAV-MEMEFF
              MOVE ZEROES                        TO WS-SAV-MEMEXP
              GO TO A349-EXIT.
      *
       A341-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
              GO TO A349-EXIT.
      *
           IF  WS-DT3-SUBSNO = SUBSNO OF MEMMAS-REC
           AND WS-DT3-GRPNUM = GRPNUM OF MEMMAS-REC
           AND WS-DT3-MEMBNO = MEMBNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC NOT = EXPDAT OF MEMMAS-REC
              MOVE EFFDAT OF MEMMAS-REC          TO WS-SAV-MEMEFF
              MOVE EXPDAT OF MEMMAS-REC          TO WS-SAV-MEMEXP
              MOVE 'N'                           TO SW-FST-REC
              GO TO A341-NEXT.
      *
           IF  WS-DT3-SUBSNO = SUBSNO OF MEMMAS-REC
           AND WS-DT3-GRPNUM = GRPNUM OF MEMMAS-REC
           AND WS-DT3-MEMBNO = MEMBNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC = EXPDAT OF MEMMAS-REC
              GO TO A341-NEXT.
      *
           IF (WS-DT3-SUBSNO NOT = SUBSNO OF MEMMAS-REC
           OR WS-DT3-GRPNUM NOT = GRPNUM OF MEMMAS-REC
           OR WS-DT3-MEMBNO NOT = MEMBNO OF MEMMAS-REC)
           AND FST-REC
              MOVE ZEROES                        TO WS-SAV-MEMEFF
              MOVE ZEROES                        TO WS-SAV-MEMEXP
              GO TO A349-EXIT.
      *
       A349-EXIT.
           EXIT.
      *
       A350-CHKIF-EXCSUB.
      **********************************************************************
      *‚If a dependant is being added/modified as a Non-exchange member, € *
      *‚Confirm if the Subscriber is also Non-exchange, Else error out   € *
      **********************************************************************
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Set Exchange Subscriber field to default value.       ****
      ****--------------------------------------------------------****
           MOVE 'N'                              TO WS-EXC-SUB.
      *
           IF ESBLST > 0
              GO TO A359-EXIT.
      *
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Remove extraneous logic.                              ****
      ****--------------------------------------------------------****
      **** IF ESBLST = 0
      **** AND EDPLST > 0
      ****   CONTINUE.
      *
           MOVE 1                             TO EDPACT
           MOVE 'Y'                    TO SW-FST-REC.
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MEMMAS-KEY.
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MEMMAS-KEY.
           MOVE ZEROES                 TO TRNSEQ OF MEMMAS-KEY.
           PERFORM MEMMAS-STARTGE                IF INVALID-KEY
                                                 GO TO A359-EXIT.
       A351-NEXT.
           PERFORM MEMMAS-READNX
      *
           IF  SUBSNO OF EEWDEP(EDPACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWDEP(EDPACT) = GRPNUM OF MEMMAS-KEY
           AND MEMBNO OF MEMMAS-REC     = SUBSNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC NOT = EXPDAT OF MEMMAS-REC
              MOVE MEMSEQ OF MEMMAS-REC          TO EXC-MEMSEQ
              MOVE TRNSEQ OF MEMMAS-REC          TO EXC-TRNSEQ
              MOVE 'N'                           TO SW-FST-REC
              GO TO A351-NEXT.
      *
           IF  SUBSNO OF EEWDEP(EDPACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWDEP(EDPACT) = GRPNUM OF MEMMAS-KEY
           AND EFFDAT OF MEMMAS-REC     = EXPDAT OF MEMMAS-REC
              GO TO A351-NEXT.
      *
           IF (SUBSNO OF EEWDEP(EDPACT) NOT = SUBSNO OF MEMMAS-REC
           OR GRPNUM OF EEWDEP(EDPACT) NOT = GRPNUM OF MEMMAS-KEY)
           AND FST-REC
              GO TO A359-EXIT.
      *
       A352-CONTINUE.
           MOVE EXC-MEMSEQ             TO MEMSEQ OF EXCMEMBT-KEY.
           MOVE EXC-TRNSEQ             TO TRNSEQ OF EXCMEMBT-KEY.
           MOVE ZEROES                 TO SEQNUM OF EXCMEMBT-KEY.
           PERFORM EXCMEMBT-STARTGE              IF INVALID-KEY
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A354-CHECK.

       A353-READNXT.
           PERFORM EXCMEMBT-READNX               IF AT-END
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A354-CHECK.
      *
           IF  EXC-MEMSEQ = MEMSEQ OF EXCMEMBT-KEY
           AND EXC-TRNSEQ = TRNSEQ OF EXCMEMBT-KEY
             MOVE 'Y'                            TO WS-EXC-SUB
                                                 GO TO A354-CHECK.
      *
           IF EXC-MEMSEQ = MEMSEQ OF EXCMEMBT-KEY
           AND EXC-TRNSEQ NOT = TRNSEQ OF EXCMEMBT-KEY
                                                 GO TO A353-READNXT
      *
           IF EXC-MEMSEQ NOT = MEMSEQ OF EXCMEMBT-KEY
           OR EXC-TRNSEQ NOT = TRNSEQ OF EXCMEMBT-KEY
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A354-CHECK.
      *
       A354-CHECK.
           IF EXCHANGE-SUBSCRIBER
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE 'EI09173'        TO MSGNUM OF ERR-LINE
                                       MI-PRIMARY-ID
              MOVE OLDSUB           TO SUBSNO OF ERR-LINE
              MOVE OLDGRP           TO GRPNUM OF ERR-LINE
              MOVE MEMBNO OF EEWDP3(EDPACT)
                                    TO FIELDV OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.

       A359-EXIT.
           EXIT.
      *
       A360-LOAD-MEMDATA.
      ***************************************************************
      * TABLES MEMMAS RECORDS                                       *
      ***************************************************************
      ****--------------------------------------------------------****
      ****  PMHS-362  GZK  Fix                                    ****
      ****  Populate EXCHNG field value to the table as it's going****
      ****  to be used in A1510-, A1520-, C1510- and C1520- para. ****
      ****--------------------------------------------------------****
           IF RELCOD OF MEMMAS-REC = '1'
              ADD 1                              TO MESACT
              IF CURENT(12) < MESACT
                 MOVE MESACT                  TO CURENT(12)
              END-IF
              IF MESACT > (MESMAX * WS-MAXPCT) / 100
              AND WS-FLG-SUBMEM NOT = 'Y'
                 MOVE MESACT                     TO WS-MESACT
                 MOVE SPACES             TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI09137'                  TO MI-PRIMARY-ID
                 MOVE 'SUBMEM'                   TO MI-PARM4
                 MOVE 'SUBSNO'                   TO MI-PARM5
                 MOVE 'GRPNUM'                   TO MI-PARM6
                 MOVE SUBSNO OF MEMMAS-REC       TO MI-PARM7
                 MOVE GRPNUM OF MEMMAS-REC       TO MI-PARM8
                 MOVE WS-MESACT                  TO MI-PARM9
                 PERFORM X130-TBL-WRNING         THRU X139-EXIT
                 MOVE 'Y'                        TO WS-FLG-SUBMEM
              END-IF
              ADD 1                              TO MESLST
              IF MESACT > MESMAX
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF MEMMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF MEMMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF MEMMAS-REC       TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF MEMMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08003'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08003'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 GO TO A369-EXIT
              END-IF
              MOVE SUBSNO OF MEMMAS-REC TO SUBSNO OF SUBMEM(MESACT)
              MOVE MEMBNO OF MEMMAS-REC TO MEMBNO OF SUBMEM(MESACT)
              MOVE NAMKEY OF MEMMAS-REC TO NAMKEY OF SUBMEM(MESACT)
              MOVE GRPNUM OF MEMMAS-REC TO GRPNUM OF SUBMEM(MESACT)
              MOVE TRNSEQ OF MEMMAS-REC TO TRNSEQ OF SUBMEM(MESACT)
              MOVE MEMSEQ OF MEMMAS-REC TO MEMSEQ OF SUBMEM(MESACT)
              MOVE RELCOD OF MEMMAS-REC TO RELCOD OF SUBMEM(MESACT)
              MOVE RELTYP OF MEMMAS-REC TO RELTYP OF SUBMEM(MESACT)
              MOVE EXPDAT OF MEMMAS-REC TO MEMEXP OF SUBMEM(MESACT)
              MOVE EFFDAT OF MEMMAS-REC TO MEMEFF OF SUBMEM(MESACT)
              MOVE NXTDUE OF MEMMAS-REC TO NXTDUE OF SUBMEM(MESACT)
              MOVE BILMTC OF MEMMAS-REC TO BILMTC OF SUBMEM(MESACT)
              MOVE TITLCD OF MEMMAS-REC TO TITLCD OF SUBMEM(MESACT)
              MOVE FORNAM OF MEMMAS-REC TO FORNAM OF SUBMEM(MESACT)
              MOVE EMPSTA OF MEMMAS-REC TO EMPSTA OF SUBMEM(MESACT)
              MOVE PRTCOD OF MEMMAS-REC TO PRTCOD OF SUBMEM(MESACT)
              MOVE PRTCNT OF MEMMAS-REC TO PRTCNT OF SUBMEM(MESACT)
              MOVE CRDDAT OF MEMMAS-REC TO CRDDAT OF SUBMEM(MESACT)
              MOVE CBWIND OF MEMMAS-REC TO CBWIND OF SUBMEM(MESACT)
              MOVE HIRDAT OF MEMMAS-REC TO HIRDAT OF SUBMEM(MESACT)
              MOVE TRMDAT OF MEMMAS-REC TO TRMDAT OF SUBMEM(MESACT)
              MOVE HIRDAT OF MEMMAS-REC TO HIRDAT OF SUBMEM(MESACT)
              MOVE TRMDAT OF MEMMAS-REC TO TRMDAT OF SUBMEM(MESACT)
              MOVE CRDCNT OF MEMMAS-REC TO CRDCNT OF SUBMEM(MESACT)
              MOVE MMCEXC OF MEMMAS-REC TO MMCEXC OF SUBMEM(MESACT)
              MOVE EXCHNG OF MEMMAS-REC TO EXCHNG OF SUBMEM(MESACT)
           ELSE
              ADD 1                              TO MEMACT
              IF CURENT(10) < MEMACT
                 MOVE MEMACT                        TO CURENT(10)
              END-IF
              IF MEMACT > (MEMMAX * WS-MAXPCT) / 100
              AND WS-FLG-MEMTAB NOT = 'Y'
               MOVE MEMACT                       TO WS-MEMACT
               MOVE SPACES             TO MESSAGE-INTERFACE-PARAMETERS
               MOVE 'EI09137'                    TO MI-PRIMARY-ID
               MOVE 'MEMTAB'                     TO MI-PARM4
               MOVE 'MEMBNO'                     TO MI-PARM5
               MOVE 'GRPNUM'                     TO MI-PARM6
               MOVE MEMBNO OF MEMMAS-REC         TO MI-PARM7
               MOVE GRPNUM OF MEMMAS-REC         TO MI-PARM8
               MOVE WS-MEMACT                    TO MI-PARM9
               PERFORM X130-TBL-WRNING           THRU X139-EXIT
               MOVE 'Y'                          TO WS-FLG-MEMTAB
              END-IF
              ADD +1                             TO MEMLST
              IF MEMACT > MEMMAX
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF MEMMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF MEMMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF MEMMAS-REC       TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF MEMMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08004'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08004'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 GO TO A369-EXIT
              END-IF
              MOVE SUBSNO OF MEMMAS-REC TO SUBSNO OF MEMTAB(MEMACT)
              MOVE MEMBNO OF MEMMAS-REC TO MEMBNO OF MEMTAB(MEMACT)
              MOVE NAMKEY OF MEMMAS-REC TO NAMKEY OF MEMTAB(MEMACT)
              MOVE GRPNUM OF MEMMAS-REC TO GRPNUM OF MEMTAB(MEMACT)
              MOVE TRNSEQ OF MEMMAS-REC TO TRNSEQ OF MEMTAB(MEMACT)
              MOVE MEMSEQ OF MEMMAS-REC TO MEMSEQ OF MEMTAB(MEMACT)
              MOVE RELCOD OF MEMMAS-REC TO RELCOD OF MEMTAB(MEMACT)
              MOVE RELTYP OF MEMMAS-REC TO RELTYP OF MEMTAB(MEMACT)
              MOVE EXPDAT OF MEMMAS-REC TO MEMEXP OF MEMTAB(MEMACT)
              MOVE EFFDAT OF MEMMAS-REC TO MEMEFF OF MEMTAB(MEMACT)
              MOVE NXTDUE OF MEMMAS-REC TO NXTDUE OF MEMTAB(MEMACT)
              MOVE BILMTC OF MEMMAS-REC TO BILMTC OF MEMTAB(MEMACT)
              MOVE TITLCD OF MEMMAS-REC TO TITLCD OF MEMTAB(MEMACT)
              MOVE FORNAM OF MEMMAS-REC TO FORNAM OF MEMTAB(MEMACT)
              MOVE EMPSTA OF MEMMAS-REC TO EMPSTA OF MEMTAB(MEMACT)
              MOVE PRTCOD OF MEMMAS-REC TO PRTCOD OF MEMTAB(MEMACT)
              MOVE PRTCNT OF MEMMAS-REC TO PRTCNT OF MEMTAB(MEMACT)
              MOVE CRDDAT OF MEMMAS-REC TO CRDDAT OF MEMTAB(MEMACT)
              MOVE HIRDAT OF MEMMAS-REC TO HIRDAT OF MEMTAB(MEMACT)
              MOVE TRMDAT OF MEMMAS-REC TO TRMDAT OF MEMTAB(MEMACT)
              MOVE CRDCNT OF MEMMAS-REC TO CRDCNT OF MEMTAB(MEMACT)
              MOVE CBWIND OF MEMMAS-REC TO CBWIND OF MEMTAB(MEMACT)
              MOVE EXCHNG OF MEMMAS-REC TO EXCHNG OF MEMTAB(MEMACT)
              MOVE MMCEXC OF MEMMAS-REC TO MMCEXC OF MEMTAB(MEMACT).
       A369-EXIT.
           EXIT.
      *
       A370-LOAD-ENBDATA.
      **************************************************************
      * TABLE ENBMAS INFORMATION                                   *
      **************************************************************
           IF RELCOD OF MEMMAS-REC = '1'
              ADD 1                              TO ENSACT
              IF CURENT(13) < ENSACT
                 MOVE ENSACT                     TO CURENT(13)
              END-IF
              IF ENSACT > (ENSMAX * WS-MAXPCT) / 100
              AND WS-FLG-SUBENB NOT = 'Y'
                MOVE ENSACT                      TO WS-ENSACT
                MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                MOVE 'EI09137'                   TO MI-PRIMARY-ID
                MOVE 'SUBENB'                    TO MI-PARM4
                MOVE 'SUBSNO'                    TO MI-PARM5
                MOVE 'GRPNUM'                    TO MI-PARM6
                MOVE SUBSNO OF ENBMAS-REC        TO MI-PARM7
                MOVE GRPNUM OF ENBMAS-REC        TO MI-PARM8
                MOVE WS-ENSACT                   TO MI-PARM9
                PERFORM X130-TBL-WRNING          THRU X139-EXIT
                MOVE 'Y'                         TO WS-FLG-SUBENB
              END-IF
              ADD +1                             TO ENSLST(MESACT)
              IF ENSACT > ENSMAX
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENBMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF ENBMAS-REC       TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF ENBMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08005'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08005'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A379-EXIT
              END-IF
              MOVE GRPNUM OF ENBMAS-REC   TO
                             ENBGRP OF SUBENB(MESACT, ENSACT)
              MOVE ACCTNO OF ENBMAS-REC   TO
                             ACCTNO OF SUBENB(MESACT, ENSACT)
 RLW?         MOVE RELCOD OF ENBMAS-REC   TO
                             ENBREL OF SUBENB(MESACT, ENSACT)
              MOVE MEMBNO OF ENBMAS-REC   TO
                             ENBMEB OF SUBENB(MESACT, ENSACT)
              MOVE EXPDAT OF ENBMAS-REC   TO
                             ENBEXP OF SUBENB(MESACT, ENSACT)
              MOVE TRNSEQ OF ENBMAS-REC   TO
                             ENBTRN OF SUBENB(MESACT, ENSACT)
              MOVE EFFDAT OF ENBMAS-REC   TO
                             ENBEFF OF SUBENB(MESACT, ENSACT)
              MOVE BTHDAT OF ENBMAS-REC   TO
                             BTHDAT OF SUBENB(MESACT, ENSACT)
              MOVE SEXCOD OF ENBMAS-REC   TO
                             SEXCOD OF SUBENB(MESACT, ENSACT)
              MOVE TIERCD OF ENBMAS-REC(01)   TO
                             TIERCD OF SUBENB(MESACT, ENSACT 1)
              MOVE FSTUPD OF ENBMAS-REC   TO
                             FSTUPD OF SUBENB(MESACT, ENSACT)
              MOVE LSTUPD OF ENBMAS-REC   TO
                             LSTUPD OF SUBENB(MESACT, ENSACT)
              MOVE MEMSEQ OF ENBMAS-REC   TO
                             ENBSEQ OF SUBENB(MESACT, ENSACT)
              MOVE BENPKG OF ENBMAS-REC   TO
                             BENPKG OF SUBENB(MESACT, ENSACT)
              MOVE BILEXC OF ENBMAS-REC   TO
                             BILEXC OF SUBENB(MESACT, ENSACT)
              MOVE USRFL1 OF ENBMAS-REC   TO
                             USRFL1 OF SUBENB(MESACT, ENSACT)
              MOVE USRFL2 OF ENBMAS-REC   TO
                             USRFL2 OF SUBENB(MESACT, ENSACT)
              MOVE USRFL3 OF ENBMAS-REC   TO
                             USRFL3 OF SUBENB(MESACT, ENSACT)
              MOVE ACCTN2 OF ENBMAS-REC   TO
                             ACCTN2 OF SUBENB(MESACT, ENSACT)
           ELSE
              ADD 1                                 TO ENBACT
                                                       ENBLST(MEMACT)
              IF ENBACT > ENBMAX
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENBMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF ENBMAS-REC       TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF ENBMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08006'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08006'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A379-EXIT
              END-IF
              IF CURENT(11) < ENBACT
                 MOVE ENBACT                     TO CURENT(11)
              END-IF
              IF ENBACT > (ENBMAX * WS-MAXPCT) / 100
              AND WS-FLG-ENBTAB NOT = 'Y'
                 MOVE ENBACT                  TO WS-ENBACT
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI09137'                  TO MI-PRIMARY-ID
                 MOVE 'ENBTAB'                   TO MI-PARM4
                 MOVE 'MEMBNO'                   TO MI-PARM5
                 MOVE 'GRPNUM'                   TO MI-PARM6
                 MOVE MEMBNO OF ENBMAS-REC       TO MI-PARM7
                 MOVE GRPNUM OF ENBMAS-REC       TO MI-PARM8
                 MOVE WS-ENBACT                  TO MI-PARM9
                 PERFORM X130-TBL-WRNING         THRU X139-EXIT
                 MOVE 'Y'                        TO WS-FLG-ENBTAB
              END-IF
              MOVE GRPNUM OF ENBMAS-REC   TO
                             ENBGRP OF ENBTAB(MEMACT, ENBACT)
              MOVE ACCTNO OF ENBMAS-REC   TO
                             ACCTNO OF ENBTAB(MEMACT, ENBACT)
RLW?          MOVE RELCOD OF ENBMAS-REC   TO
                             ENBREL OF ENBTAB(MEMACT, ENBACT)
              MOVE MEMBNO OF ENBMAS-REC   TO
                             ENBMEB OF ENBTAB(MEMACT, ENBACT)
              MOVE EXPDAT OF ENBMAS-REC   TO
                             ENBEXP OF ENBTAB(MEMACT, ENBACT)
              MOVE TRNSEQ OF ENBMAS-REC   TO
                             ENBTRN OF ENBTAB(MEMACT, ENBACT)
              MOVE EFFDAT OF ENBMAS-REC   TO
                             ENBEFF OF ENBTAB(MEMACT, ENBACT)
              MOVE BTHDAT OF ENBMAS-REC   TO
                             BTHDAT OF ENBTAB(MEMACT, ENBACT)
              MOVE SEXCOD OF ENBMAS-REC   TO
                             SEXCOD OF ENBTAB(MEMACT, ENBACT)
              MOVE TIERCD OF ENBMAS-REC(01)   TO
                             TIERCD OF ENBTAB(MEMACT, ENBACT 1)
              MOVE FSTUPD OF ENBMAS-REC   TO
                             FSTUPD OF ENBTAB(MEMACT, ENBACT)
              MOVE LSTUPD OF ENBMAS-REC   TO
                             LSTUPD OF ENBTAB(MEMACT, ENBACT)
              MOVE MEMSEQ OF ENBMAS-REC   TO
                             ENBSEQ OF ENBTAB(MEMACT, ENBACT)
              MOVE BENPKG OF ENBMAS-REC   TO
                             BENPKG OF ENBTAB(MEMACT, ENBACT)
              MOVE BILEXC OF ENBMAS-REC   TO
                             BILEXC OF ENBTAB(MEMACT, ENBACT)
              MOVE USRFL1 OF ENBMAS-REC   TO
                             USRFL1 OF ENBTAB(MEMACT, ENBACT)
              MOVE USRFL2 OF ENBMAS-REC   TO
                             USRFL2 OF ENBTAB(MEMACT, ENBACT)
              MOVE USRFL3 OF ENBMAS-REC   TO
                             USRFL3 OF ENBTAB(MEMACT, ENBACT)
              MOVE ACCTN2 OF ENBMAS-REC   TO
                             ACCTN2 OF ENBTAB(MEMACT, ENBACT).
       A379-EXIT.
           EXIT.
      *
       A380-ENPDATA.
      ***************************************************************
      * TABLE ENPMAS INFORMATION                                    *
      ***************************************************************
           IF RELCOD OF MEMMAS-REC NOT = '1'
              GO TO A385-NEXT.
      *
           IF RELCOD OF MEMMAS-REC = '1'
              IF RECTYP OF ENPMAS-REC = '1P'
                 ADD 1                           TO PPSACT
                 ADD +1                          TO PPSLST(MESACT)
                 IF PPSACT > PPSMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                  MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                  MOVE SPACES                    TO ERR-LINE
                  MOVE GRPNUM OF ENPMAS-REC      TO GRPNUM OF ERR-LINE
                  MOVE SUBSNO OF ENBMAS-REC      TO GRPNUM OF ERR-LINE
                  MOVE MEMBNO OF ENPMAS-REC      TO MEMBNO OF ERR-LINE
                 MOVE 'EI08007'        TO MSGNUM OF ERR-LINE
                  MOVE ERR-LINE                  TO LINE-E
                  MOVE 'EI08007'                 TO MI-PRIMARY-ID
                  PERFORM X100-PRINT-ERROR       THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(03) < PPSACT
                    MOVE PPSACT                  TO CURENT(03)
                 END-IF
                 IF PPSACT > (PPSMAX * WS-MAXPCT) / 100
                 AND WS-FLG-SUBPCP NOT = 'Y'
                    MOVE PPSACT                  TO WS-PPSACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'SUBPCP'                TO MI-PARM4
                    MOVE 'SUBSNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE SUBSNO OF ENBMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-PPSACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-SUBPCP
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              PCPGRP OF SUBPCP(MESACT, PPSACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              PCPMEM OF SUBPCP(MESACT, PPSACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              PCPEXP OF SUBPCP(MESACT, PPSACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              PCPTRN OF SUBPCP(MESACT, PPSACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              PCPEFF OF SUBPCP(MESACT, PPSACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              PCPSEQ OF SUBPCP(MESACT, PPSACT)
                 MOVE PRVORG OF ENPMAS-REC TO
                              PRVORG OF SUBPCP(MESACT, PPSACT)
                 MOVE PROVNO OF ENPMAS-REC TO
                              PROVNO OF SUBPCP(MESACT, PPSACT)
                 MOVE PCPOVR OF ENPMAS-REC TO
                              PCPOVR OF SUBPCP(MESACT, PPSACT)
                 MOVE MEMCAP OF ENPMAS-REC TO
                              MEMCAP OF SUBPCP(MESACT, PPSACT)
                 MOVE 'Y'                  TO PCP-FLAG
              ELSE
              IF RECTYP OF ENPMAS-REC = '1S'
                 ADD 1                           TO SPSACT
                 ADD +1                          TO SPSLST(MESACT)
                 IF SPSACT > SPSMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08008'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08008'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(04) < SPSACT
                    MOVE SPSACT                  TO CURENT(04)
                 END-IF
                 IF SPSACT > (SPSMAX * WS-MAXPCT) / 100
                 AND WS-FLG-SUBSEC NOT = 'Y'
                    MOVE SPSACT                  TO WS-SPSACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'SUBSEC'                TO MI-PARM4
                    MOVE 'SUBSNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE SUBSNO OF ENBMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-SPSACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-SUBSEC
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              SECGRP OF SUBSEC(MESACT, SPSACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              SECMEM OF SUBSEC(MESACT, SPSACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              SECEXP OF SUBSEC(MESACT, SPSACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              SECTRN OF SUBSEC(MESACT, SPSACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              SECEFF OF SUBSEC(MESACT, SPSACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              SECSEQ OF SUBSEC(MESACT, SPSACT)
                 MOVE PRVORG OF ENPMAS-REC TO
                              PRVORG OF SUBSEC(MESACT, SPSACT)
                 MOVE PROVNO OF ENPMAS-REC TO
                              PROVNO OF SUBSEC(MESACT, SPSACT)
                 MOVE SECOVR OF ENPMAS-REC TO
                              SECOVR OF SUBSEC(MESACT, SPSACT)
                 MOVE MEMCAP OF ENPMAS-REC TO
                              MEMCAP OF SUBSEC(MESACT, SPSACT)
              ELSE
              IF RECTYP OF ENPMAS-REC = '1F'
                 ADD 1                           TO SFEACT
                 ADD +1                          TO SFELST(MESACT)
                 IF SFEACT > SFEMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                  MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                  MOVE SPACES                    TO ERR-LINE
                  MOVE GRPNUM OF ENPMAS-REC      TO GRPNUM OF ERR-LINE
                  MOVE SUBSNO OF ENBMAS-REC      TO SUBSNO OF ERR-LINE
                  MOVE MEMBNO OF ENPMAS-REC      TO MEMBNO OF ERR-LINE
                 MOVE 'EI08009'        TO MSGNUM OF ERR-LINE
                  MOVE ERR-LINE                  TO LINE-E
                  MOVE 'EI08009'                 TO MI-PRIMARY-ID
                  PERFORM X100-PRINT-ERROR       THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(05) < SFEACT
                    MOVE SFEACT                  TO CURENT(05)
                 END-IF
                 IF SFEACT > (SFEMAX * WS-MAXPCT) / 100
                 AND WS-FLG-SUBFEE NOT = 'Y'
                    MOVE SFEACT                  TO WS-SFEACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'SUBFEE'                TO MI-PARM4
                    MOVE 'SUBSNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE SUBSNO OF ENBMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-SFEACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-SUBFEE
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              FEEGRP OF SUBFEE(MESACT, SFEACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              FEEMEM OF SUBFEE(MESACT, SFEACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              FEEEXP OF SUBFEE(MESACT, SFEACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              FEETRN OF SUBFEE(MESACT, SFEACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              FEEEFF OF SUBFEE(MESACT, SFEACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              FEESEQ OF SUBFEE(MESACT, SFEACT)
                 MOVE FEECOD OF ENPMAS-REC TO
                              FEECOD OF SUBFEE(MESACT, SFEACT)
              ELSE
              IF RECTYP OF ENPMAS-REC = '1M'
                 ADD 1                           TO SMDACT
                 ADD +1                          TO SMDLST(MESACT)
                 IF SMDACT > SMDMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08010'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08010'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(06) < SMDACT
                    MOVE SMDACT                  TO CURENT(06)
                 END-IF
                 IF SMDACT > (SMDMAX * WS-MAXPCT) / 100
                 AND WS-FLG-SUBMED NOT = 'Y'
                    MOVE SMDACT                  TO WS-SMDACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'SUBMED'                TO MI-PARM4
                    MOVE 'SUBSNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE SUBSNO OF ENBMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-SMDACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-SUBMED
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              MEDGRP OF SUBMED(MESACT, SMDACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              MEDMEM OF SUBMED(MESACT, SMDACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              MEDEXP OF SUBMED(MESACT, SMDACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              MEDTRN OF SUBMED(MESACT, SMDACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              MEDEFF OF SUBMED(MESACT, SMDACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              MEDSEQ OF SUBMED(MESACT, SMDACT)
                 MOVE MEDSTS OF ENPMAS-REC TO
                              MEDSTS OF SUBMED(MESACT, SMDACT)
                 MOVE MEDCTY OF ENPMAS-REC TO
                              MEDCTY OF SUBMED(MESACT, SMDACT).
      *
           GO TO A389-EXIT.
       A385-NEXT.
      *
           IF RECTYP OF ENPMAS-REC = '1P'
              ADD 1                              TO PCPACT
              ADD +1                             TO PCPLST(MEMACT)
              IF PCPACT > PCPMAX
                 MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08011'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08011'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
              END-IF
              MOVE GRPNUM OF ENPMAS-REC TO
                              PCPGRP OF PCPTAB(MEMACT, PCPACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              PCPMEM OF PCPTAB(MEMACT, PCPACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              PCPEXP OF PCPTAB(MEMACT, PCPACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              PCPTRN OF PCPTAB(MEMACT, PCPACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              PCPEFF OF PCPTAB(MEMACT, PCPACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              PCPSEQ OF PCPTAB(MEMACT, PCPACT)
                 MOVE PRVORG OF ENPMAS-REC TO
                              PRVORG OF PCPTAB(MEMACT, PCPACT)
                 MOVE PROVNO OF ENPMAS-REC TO
                              PROVNO OF PCPTAB(MEMACT, PCPACT)
                 MOVE PCPOVR OF ENPMAS-REC TO
                              PCPOVR OF PCPTAB(MEMACT, PCPACT)
                 MOVE MEMCAP OF ENPMAS-REC TO
                              MEMCAP OF PCPTAB(MEMACT, PCPACT)
                 MOVE 'Y'                        TO PCP-FLAG
              ELSE
              IF RECTYP OF ENPMAS-REC = '1S'
                 ADD 1                           TO SECACT
                 IF SECACT > SECMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08012'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08012'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              SECGRP OF SECTAB(MEMACT, SECACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              SECMEM OF SECTAB(MEMACT, SECACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              SECEXP OF SECTAB(MEMACT, SECACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              SECTRN OF SECTAB(MEMACT, SECACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              SECEFF OF SECTAB(MEMACT, SECACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              SECSEQ OF SECTAB(MEMACT, SECACT)
                 MOVE PRVORG OF ENPMAS-REC TO
                              PRVORG OF SECTAB(MEMACT, SECACT)
                 MOVE PROVNO OF ENPMAS-REC TO
                              PROVNO OF SECTAB(MEMACT, SECACT)
                 MOVE SECOVR OF ENPMAS-REC TO
                              SECOVR OF SECTAB(MEMACT, SECACT)
                 MOVE MEMCAP OF ENPMAS-REC TO
                              MEMCAP OF SECTAB(MEMACT, SECACT)
              ELSE
              IF RECTYP OF ENPMAS-REC = '1F'
                 ADD 1                           TO FEEACT
                 IF FEEACT > FEEMAX
                    MOVE 'Y'              TO PRCERR OF PGM-WORK
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08013'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08013'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(01) < FEEACT
                    MOVE FEEACT                  TO CURENT(01)
                 END-IF
                 IF FEEACT > (FEEMAX * WS-MAXPCT) / 100
                 AND WS-FLG-FEETAB NOT = 'Y'
                    MOVE FEEACT                  TO WS-FEEACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'FEETAB'                TO MI-PARM4
                    MOVE 'MEMBNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE MEMBNO OF ENPMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-FEEACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-FEETAB
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              FEEGRP OF FEETAB(MEMACT, FEEACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              FEEMEM OF FEETAB(MEMACT, FEEACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              FEEEXP OF FEETAB(MEMACT, FEEACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              FEETRN OF FEETAB(MEMACT, FEEACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              FEEEFF OF FEETAB(MEMACT, FEEACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              FEESEQ OF FEETAB(MEMACT, FEEACT)
                 MOVE FEECOD OF ENPMAS-REC TO
                              FEECOD OF FEETAB(MEMACT, FEEACT)
              ELSE
              IF RECTYP OF ENPMAS-REC = '1M'
                 ADD 1                           TO MEDACT
                 IF MEDACT > MEDMAX
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES                     TO ERR-LINE
                 MOVE GRPNUM OF ENPMAS-REC       TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF ENBMAS-REC       TO SUBSNO OF ERR-LINE
                 MOVE MEMBNO OF ENPMAS-REC       TO MEMBNO OF ERR-LINE
                 MOVE 'EI08014'        TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI08014'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A389-EXIT
                 END-IF
                 IF CURENT(02) < MEDACT
                    MOVE MEDACT                  TO CURENT(02)
                 END-IF
                 IF MEDACT > (MEDMAX * WS-MAXPCT) / 100
                 AND WS-FLG-MEDTAB NOT = 'Y'
                    MOVE MEDACT                  TO WS-MEDACT
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI09137'               TO MI-PRIMARY-ID
                    MOVE 'MEDTAB'                TO MI-PARM4
                    MOVE 'MEMBNO'                TO MI-PARM5
                    MOVE 'GRPNUM'                TO MI-PARM6
                    MOVE MEMBNO OF ENPMAS-REC    TO MI-PARM7
                    MOVE GRPNUM OF ENPMAS-REC    TO MI-PARM8
                    MOVE WS-MEDACT               TO MI-PARM9
                    PERFORM X130-TBL-WRNING      THRU X139-EXIT
                    MOVE 'Y'                     TO WS-FLG-MEDTAB
                 END-IF
                 MOVE GRPNUM OF ENPMAS-REC TO
                              MEDGRP OF MEDTAB(MEMACT, MEDACT)
                 MOVE MEMBNO OF ENPMAS-REC TO
                              MEDMEM OF MEDTAB(MEMACT, MEDACT)
                 MOVE EXPDAT OF ENPMAS-REC TO
                              MEDEXP OF MEDTAB(MEMACT, MEDACT)
                 MOVE TRNSEQ OF ENPMAS-REC TO
                              MEDTRN OF MEDTAB(MEMACT, MEDACT)
                 MOVE EFFDAT OF ENPMAS-REC TO
                              MEDEFF OF MEDTAB(MEMACT, MEDACT)
                 MOVE MEMSEQ OF ENPMAS-REC TO
                              MEDSEQ OF MEDTAB(MEMACT, MEDACT)
                 MOVE MEDSTS OF ENPMAS-REC TO
                              MEDSTS OF MEDTAB(MEMACT, MEDACT)
                 MOVE MEDCTY OF ENPMAS-REC TO
                              MEDCTY OF MEDTAB(MEMACT, MEDACT).
       A389-EXIT.
           EXIT.
      *
       A390-DEMMAS.
      ****************************************************************
      * TABLE DEMMAS INFORMATION                                     *
      ****************************************************************
           MOVE SPACES                           TO DEMMAS-REC.
           MOVE MEMSEQ OF MEMMAS-REC   TO MEMSEQ OF DEMMAS-KEY.
           PERFORM DEMMAS-READ                   IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00301'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE DEMMAS-STATUS                 TO MI-PARM7
              MOVE 'EI00301'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A399-EXIT.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE DEMEXTBT-REC.
           MOVE MEMSEQ OF MEMMAS-REC   TO MEMSEQ OF DEMEXTBT-REC.
           CALL 'DEMEXTBTM'   USING IO-COMMUNICATION DEMEXTBT-LM-PARMS.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE EMLPTRBV-REC.
           MOVE 'C'                     TO EMLTYP OF EMLPTRBV-REC.
           IF CPAIND OF DEMMAS-REC = 'M'
              MOVE MEMBNO OF MEMMAS-REC TO EMLEID OF EMLPTRBV-REC
           ELSE
              MOVE SUBSNO OF MEMMAS-REC TO EMLEID OF EMLPTRBV-REC.
           CALL 'EMLPTRBVM'   USING IO-COMMUNICATION EMLPTRBV-LM-PARMS.
      *
           IF RELCOD OF MEMMAS-REC NOT = '1'
              GO TO A395-NEXT.
      *
           ADD 1                                 TO SUBACT.
           IF CURENT(14) < SUBACT
              MOVE SUBACT                        TO CURENT(14).
           IF SUBACT > (SUBMAX * WS-MAXPCT) / 100
           AND WS-FLG-SUBTAB NOT = 'Y'
              MOVE SUBACT                        TO WS-SUBACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'SUBTAB'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO MI-PARM7
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM8
              MOVE WS-SUBACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-SUBTAB
           END-IF.
      *
           ADD +1                                TO SUBLST.
           IF SUBACT > SUBMAX
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE SPACES                        TO ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF DEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF MEMMAS-REC          TO MEMBNO OF ERR-LINE
              MOVE 'EI08015'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI08015'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                                                 GO TO A399-EXIT
           END-IF
           PERFORM VARYING INDK FROM 1 BY 1 UNTIL INDK >= SUBACT
              IF SUBSNO OF MEMMAS-REC = MEMBNO OF SUBTAB(INDK)
              AND GRPNUM OF MEMMAS-REC = GRPNUM OF SUBTAB(INDK)
                                                 GO TO A399-EXIT
              END-IF
           END-PERFORM.
           MOVE MEMBNO OF MEMMAS-REC   TO MEMBNO OF SUBTAB(SUBACT).
           MOVE GRPNUM OF MEMMAS-REC   TO GRPNUM OF SUBTAB(SUBACT).
           MOVE MEMSEQ OF DEMMAS-REC   TO MEMSEQ OF SUBTAB(SUBACT).
           MOVE TYPCOD OF DEMMAS-REC   TO TYPCOD OF SUBTAB(SUBACT).
           MOVE RELCOD OF DEMMAS-REC   TO RELCOD OF SUBTAB(SUBACT).
           MOVE ADRLN1 OF DEMMAS-REC   TO ADRLN1 OF SUBTAB(SUBACT).
           MOVE ADRLN2 OF DEMMAS-REC   TO ADRLN2 OF SUBTAB(SUBACT).
           MOVE CITYCD OF DEMMAS-REC   TO CITYCD OF SUBTAB(SUBACT).
           MOVE STACOD OF DEMMAS-REC   TO STACOD OF SUBTAB(SUBACT).
           MOVE ZIPCOD OF DEMMAS-REC   TO ZIPCOD OF SUBTAB(SUBACT).
           MOVE AREACD OF DEMMAS-REC   TO AREACD OF SUBTAB(SUBACT).
           MOVE HOMPH1 OF DEMMAS-REC   TO HOMPH1 OF SUBTAB(SUBACT).
           MOVE HOMPH2 OF DEMMAS-REC   TO HOMPH2 OF SUBTAB(SUBACT).
           MOVE HOMPH3 OF DEMMAS-REC   TO HOMPH3 OF SUBTAB(SUBACT).
           MOVE WRKPH1 OF DEMMAS-REC   TO WRKPH1 OF SUBTAB(SUBACT).
           MOVE WRKPH2 OF DEMMAS-REC   TO WRKPH2 OF SUBTAB(SUBACT).
           MOVE WRKPH3 OF DEMMAS-REC   TO WRKPH3 OF SUBTAB(SUBACT).
           MOVE WRKEXT OF DEMMAS-REC   TO WRKEXT OF SUBTAB(SUBACT).
           MOVE SOCSEC OF DEMMAS-REC   TO SOCSEC OF SUBTAB(SUBACT).
           MOVE BTHDAT OF DEMMAS-REC   TO BTHDAT OF SUBTAB(SUBACT).
           MOVE SEXCOD OF DEMMAS-REC   TO SEXCOD OF SUBTAB(SUBACT).
           MOVE RACECD OF DEMMAS-REC   TO RACECD OF SUBTAB(SUBACT).
           MOVE COMMNT OF DEMMAS-REC   TO COMMNT OF SUBTAB(SUBACT).
           MOVE MEMEDT OF DEMMAS-REC   TO MEMEDT OF SUBTAB(SUBACT).
           MOVE MMCIND OF DEMMAS-REC   TO MMCIND OF SUBTAB(SUBACT)
           MOVE LABCOD OF DEMMAS-REC   TO LABCOD OF SUBTAB(SUBACT).
           MOVE LABCNT OF DEMMAS-REC   TO LABCNT OF SUBTAB(SUBACT).
           MOVE MEMSTA OF DEMMAS-REC   TO MEMSTA OF SUBTAB(SUBACT).
           MOVE MEMDAT OF DEMMAS-REC   TO MEMDAT OF SUBTAB(SUBACT).
           MOVE ALTNUM OF DEMMAS-REC   TO ALTNUM OF SUBTAB(SUBACT).
           MOVE COBDAT OF DEMMAS-REC   TO COBDAT OF SUBTAB(SUBACT).
           MOVE AUTEXP OF DEMMAS-REC   TO AUTEXP OF SUBTAB(SUBACT).
           MOVE CPYCOD OF DEMMAS-REC   TO CPYCOD OF SUBTAB(SUBACT).
           MOVE EDTCOD OF DEMMAS-REC   TO EDTCOD OF SUBTAB(SUBACT).
           MOVE EDTEFF OF DEMMAS-REC   TO EDTEFF OF SUBTAB(SUBACT).
           MOVE EDTEXP OF DEMMAS-REC   TO EDTEXP OF SUBTAB(SUBACT).
           MOVE EMPLCD OF DEMMAS-REC   TO EMPLCD OF SUBTAB(SUBACT).
           MOVE PEBTFS OF DEMMAS-REC   TO PEBTFS OF SUBTAB(SUBACT).
           MOVE VENDOR OF DEMMAS-REC   TO VENDOR OF SUBTAB(SUBACT).
           MOVE ACCTNO OF DEMMAS-REC   TO ACCTNO OF SUBTAB(SUBACT).
           MOVE STATCD OF DEMMAS-REC   TO STATCD OF SUBTAB(SUBACT).
           MOVE INTAKE OF DEMMAS-REC   TO INTAKE OF SUBTAB(SUBACT).
           MOVE INTKCD OF DEMMAS-REC   TO INTKCD OF SUBTAB(SUBACT).
           MOVE INTDAT OF DEMMAS-REC   TO INTDAT OF SUBTAB(SUBACT).
           MOVE MARSTA OF DEMMAS-REC   TO MARSTA OF SUBTAB(SUBACT).
           MOVE PAYGRD OF DEMMAS-REC   TO PAYGRD OF SUBTAB(SUBACT).
           MOVE CHAREL OF DEMMAS-REC   TO CHAREL OF SUBTAB(SUBACT).
           MOVE SVCBRN OF DEMMAS-REC   TO SVCBRN OF SUBTAB(SUBACT).
           MOVE DERDPN OF DEMMAS-REC   TO DERDPN OF SUBTAB(SUBACT).
           MOVE DERELG OF DEMMAS-REC   TO DERELG OF SUBTAB(SUBACT).
           MOVE MILINF OF DEMMAS-REC   TO MILINF OF SUBTAB(SUBACT).
           MOVE PRIVDT OF DEMMAS-REC   TO PRIVDT OF SUBTAB(SUBACT).
           MOVE PRIVNM OF DEMMAS-REC   TO PRIVNM OF SUBTAB(SUBACT).
           MOVE PRIVRL OF DEMMAS-REC   TO PRIVRL OF SUBTAB(SUBACT).
           MOVE CHADIS OF DEMMAS-REC   TO CHADIS OF SUBTAB(SUBACT).
           IF SSNXRF OF DEMMAS-REC NOT NUMERIC
              MOVE ZEROS               TO SSNXRF OF DEMMAS-REC.
           MOVE SSNXRF OF DEMMAS-REC   TO SSNXRF OF SUBTAB(SUBACT).
           MOVE HICNNO OF DEMMAS-REC   TO HICNNO OF SUBTAB(SUBACT).
           MOVE MMDIND OF DEMMAS-REC   TO MMDIND OF SUBTAB(SUBACT).
           MOVE CPAIND OF DEMMAS-REC   TO CPAIND OF SUBTAB(SUBACT).
           MOVE WRKLOC OF DEMMAS-REC   TO WRKLOC OF SUBTAB(SUBACT).
           MOVE LOCQLF OF DEMMAS-REC   TO LOCQLF OF SUBTAB(SUBACT).
           MOVE CTRYCD OF DEMMAS-REC   TO CTRYCD OF SUBTAB(SUBACT).
           MOVE BTHSEQ OF DEMMAS-REC   TO BTHSEQ OF SUBTAB(SUBACT).
           MOVE EMSTCD OF DEMMAS-REC   TO EMSTCD OF SUBTAB(SUBACT).
           MOVE CQLECD OF DEMMAS-REC   TO CQLECD OF SUBTAB(SUBACT).
           MOVE COBRAQ OF DEMMAS-REC   TO COBRAQ OF SUBTAB(SUBACT).
           MOVE COBRAB OF DEMMAS-REC   TO COBRAB OF SUBTAB(SUBACT).
           MOVE COBRAE OF DEMMAS-REC   TO COBRAE OF SUBTAB(SUBACT).
           MOVE STUSTA OF DEMMAS-REC   TO STUSTA OF SUBTAB(SUBACT).
           MOVE EDUBEG OF DEMMAS-REC   TO EDUBEG OF SUBTAB(SUBACT).
           MOVE EDUEND OF DEMMAS-REC   TO EDUEND OF SUBTAB(SUBACT).
           MOVE DETDAT OF DEMMAS-REC   TO DETDAT OF SUBTAB(SUBACT).
           MOVE OTHPHN OF DEMMAS-REC   TO OTHPHN OF SUBTAB(SUBACT).
           MOVE FAXNUM OF DEMMAS-REC   TO FAXNUM OF SUBTAB(SUBACT).
           MOVE EMLIND OF DEMMAS-REC   TO EMLIND OF SUBTAB(SUBACT).
           MOVE EMLTXT OF EMLPTRBV-REC TO ELMAIL OF SUBTAB(SUBACT).
           MOVE EXTIND OF DEMMAS-REC   TO EXTIND OF SUBTAB(SUBACT).
           MOVE RSPIND OF DEMMAS-REC   TO RSPIND OF SUBTAB(SUBACT).
           MOVE BENIND OF DEMMAS-REC   TO BENIND OF SUBTAB(SUBACT).
           MOVE ALTIND OF DEMMAS-REC   TO ALTIND OF SUBTAB(SUBACT).
           MOVE CITZEN OF DEMEXTBT-REC TO CITZEN OF SUBEXT(SUBACT).
           MOVE FRQCOD OF DEMEXTBT-REC TO FRQCOD OF SUBEXT(SUBACT).
           MOVE WAGAMT OF DEMEXTBT-REC TO WAGAMT OF SUBEXT(SUBACT).
           MOVE WRKHRS OF DEMEXTBT-REC TO WRKHRS OF SUBEXT(SUBACT).
           MOVE WORKLC OF DEMEXTBT-REC TO WORKLC OF SUBEXT(SUBACT).
           MOVE SALGRD OF DEMEXTBT-REC TO SALGRD OF SUBEXT(SUBACT).
           MOVE HLTCOD OF DEMEXTBT-REC TO HLTCOD OF SUBEXT(SUBACT).
           MOVE SMKCES OF DEMEXTBT-REC TO SMKCES OF SUBEXT(SUBACT).
           MOVE HEIGHT OF DEMEXTBT-REC TO HEIGHT OF SUBEXT(SUBACT).
           MOVE WEIGHT OF DEMEXTBT-REC TO WEIGHT OF SUBEXT(SUBACT).
           MOVE LNGCD1 OF DEMEXTBT-REC TO LNGCD1 OF SUBEXT(SUBACT).
           MOVE LNGUS1 OF DEMEXTBT-REC TO LNGUS1 OF SUBEXT(SUBACT).
           MOVE LNGCD2 OF DEMEXTBT-REC TO LNGCD2 OF SUBEXT(SUBACT).
           MOVE LNGUS2 OF DEMEXTBT-REC TO LNGUS2 OF SUBEXT(SUBACT).
           MOVE LNGCD3 OF DEMEXTBT-REC TO LNGCD3 OF SUBEXT(SUBACT).
           MOVE LNGUS3 OF DEMEXTBT-REC TO LNGUS3 OF SUBEXT(SUBACT).
           MOVE LNGCD4 OF DEMEXTBT-REC TO LNGCD4 OF SUBEXT(SUBACT).
           MOVE LNGUS4 OF DEMEXTBT-REC TO LNGUS4 OF SUBEXT(SUBACT).
           MOVE LNGCD5 OF DEMEXTBT-REC TO LNGCD5 OF SUBEXT(SUBACT).
           MOVE LNGUS5 OF DEMEXTBT-REC TO LNGUS5 OF SUBEXT(SUBACT).
           MOVE SCHOOL OF DEMEXTBT-REC TO SCHOOL OF SUBEXT(SUBACT).
           MOVE SPHNUM OF DEMEXTBT-REC TO SPHNUM OF SUBEXT(SUBACT).
           MOVE SPHEXT OF DEMEXTBT-REC TO SPHEXT OF SUBEXT(SUBACT).
           MOVE SFAXNB OF DEMEXTBT-REC TO SFAXNB OF SUBEXT(SUBACT).
           MOVE SEMAIL OF DEMEXTBT-REC TO SEMAIL OF SUBEXT(SUBACT).
           MOVE SADRL1 OF DEMEXTBT-REC TO SADRL1 OF SUBEXT(SUBACT).
           MOVE SADRL2 OF DEMEXTBT-REC TO SADRL2 OF SUBEXT(SUBACT).
           MOVE SCTYCD OF DEMEXTBT-REC TO SCTYCD OF SUBEXT(SUBACT).
           MOVE SSTACD OF DEMEXTBT-REC TO SSTACD OF SUBEXT(SUBACT).
           MOVE SZIPCD OF DEMEXTBT-REC TO SZIPCD OF SUBEXT(SUBACT).
           MOVE SCNTRY OF DEMEXTBT-REC TO SCNTRY OF SUBEXT(SUBACT).
           MOVE SCHCLK OF DEMEXTBT-REC TO SCHCLK OF SUBEXT(SUBACT).
           MOVE CNFCOD OF DEMEXTBT-REC TO CNFCOD OF SUBEXT(SUBACT).
           MOVE ALTPHN OF DEMEXTBT-REC TO ALTPHN OF SUBEXT(SUBACT).
           MOVE BEPNBR OF DEMEXTBT-REC TO BEPNBR OF SUBEXT(SUBACT).
           MOVE CELPHN OF DEMEXTBT-REC TO CELPHN OF SUBEXT(SUBACT).
      *
           GO TO A399-EXIT.
       A395-NEXT.
           ADD 1                                 TO DEPACT.
           ADD +1                                TO DEPLST.
           IF DEPACT > DEPMAX
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              MOVE 'EI08016'           TO MSGNUM OF ERR-LINE
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI08016'         TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A399-EXIT.
           IF CURENT(09) < DEPACT
              MOVE DEPACT                        TO CURENT(09).
           IF DEPACT > (DEPMAX * WS-MAXPCT) / 100
           AND WS-FLG-DEPTAB NOT = 'Y'
              MOVE DEPACT                        TO WS-DEPACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09137'                     TO MI-PRIMARY-ID
              MOVE 'DEPTAB'                      TO MI-PARM4
              MOVE 'SUBSNO'                      TO MI-PARM5
              MOVE 'GRPNUM'                      TO MI-PARM6
              MOVE OLDSUB                        TO MI-PARM7
              MOVE OLDGRP                        TO MI-PARM8
              MOVE WS-DEPACT                     TO MI-PARM9
              PERFORM X130-TBL-WRNING            THRU X139-EXIT
              MOVE 'Y'                           TO WS-FLG-DEPTAB
           END-IF.
      *
           PERFORM VARYING INDK FROM 1 BY 1 UNTIL INDK >= DEPACT
              IF MEMBNO OF MEMMAS-REC = MEMBNO OF DEPTAB(INDK)
              AND GRPNUM OF MEMMAS-REC = GRPNUM OF DEPTAB(INDK)
                                                 GO TO A399-EXIT
              END-IF
           END-PERFORM.
           MOVE MEMSEQ OF DEMMAS-REC   TO MEMSEQ OF DEPTAB(DEPACT).
           MOVE MEMBNO OF MEMMAS-REC   TO MEMBNO OF DEPTAB(DEPACT).
           MOVE GRPNUM OF MEMMAS-REC   TO GRPNUM OF DEPTAB(DEPACT).
           MOVE TYPCOD OF DEMMAS-REC   TO TYPCOD OF DEPTAB(DEPACT).
           MOVE RELCOD OF DEMMAS-REC   TO RELCOD OF DEPTAB(DEPACT).
           MOVE ADRLN1 OF DEMMAS-REC   TO ADRLN1 OF DEPTAB(DEPACT).
           MOVE ADRLN2 OF DEMMAS-REC   TO ADRLN2 OF DEPTAB(DEPACT).
           MOVE CITYCD OF DEMMAS-REC   TO CITYCD OF DEPTAB(DEPACT).
           MOVE STACOD OF DEMMAS-REC   TO STACOD OF DEPTAB(DEPACT).
           MOVE ZIPCOD OF DEMMAS-REC   TO ZIPCOD OF DEPTAB(DEPACT).
           MOVE AREACD OF DEMMAS-REC   TO AREACD OF DEPTAB(DEPACT).
           MOVE HOMPH1 OF DEMMAS-REC   TO HOMPH1 OF DEPTAB(DEPACT).
           MOVE HOMPH2 OF DEMMAS-REC   TO HOMPH2 OF DEPTAB(DEPACT).
           MOVE HOMPH3 OF DEMMAS-REC   TO HOMPH3 OF DEPTAB(DEPACT).
           MOVE WRKPH1 OF DEMMAS-REC   TO WRKPH1 OF DEPTAB(DEPACT).
           MOVE WRKPH2 OF DEMMAS-REC   TO WRKPH2 OF DEPTAB(DEPACT).
           MOVE WRKPH3 OF DEMMAS-REC   TO WRKPH3 OF DEPTAB(DEPACT).
           MOVE WRKEXT OF DEMMAS-REC   TO WRKEXT OF DEPTAB(DEPACT).
           MOVE SOCSEC OF DEMMAS-REC   TO SOCSEC OF DEPTAB(DEPACT).
           MOVE BTHDAT OF DEMMAS-REC   TO BTHDAT OF DEPTAB(DEPACT).
           MOVE SEXCOD OF DEMMAS-REC   TO SEXCOD OF DEPTAB(DEPACT).
           MOVE RACECD OF DEMMAS-REC   TO RACECD OF DEPTAB(DEPACT).
           MOVE COMMNT OF DEMMAS-REC   TO COMMNT OF DEPTAB(DEPACT).
           MOVE MEMEDT OF DEMMAS-REC   TO MEMEDT OF DEPTAB(DEPACT).
           MOVE MMCIND OF DEMMAS-REC   TO MMCIND OF DEPTAB(DEPACT).
           MOVE LABCOD OF DEMMAS-REC   TO LABCOD OF DEPTAB(DEPACT).
           MOVE LABCNT OF DEMMAS-REC   TO LABCNT OF DEPTAB(DEPACT).
           MOVE MEMSTA OF DEMMAS-REC   TO MEMSTA OF DEPTAB(DEPACT).
           MOVE MEMDAT OF DEMMAS-REC   TO MEMDAT OF DEPTAB(DEPACT).
           MOVE ALTNUM OF DEMMAS-REC   TO ALTNUM OF DEPTAB(DEPACT).
           MOVE COBDAT OF DEMMAS-REC   TO COBDAT OF DEPTAB(DEPACT).
           MOVE AUTEXP OF DEMMAS-REC   TO AUTEXP OF DEPTAB(DEPACT).
           MOVE CPYCOD OF DEMMAS-REC   TO CPYCOD OF DEPTAB(DEPACT).
           MOVE EDTCOD OF DEMMAS-REC   TO EDTCOD OF DEPTAB(DEPACT).
           MOVE EDTEFF OF DEMMAS-REC   TO EDTEFF OF DEPTAB(DEPACT).
           MOVE EDTEXP OF DEMMAS-REC   TO EDTEXP OF DEPTAB(DEPACT).
           MOVE EMPLCD OF DEMMAS-REC   TO EMPLCD OF DEPTAB(DEPACT).
           MOVE PEBTFS OF DEMMAS-REC   TO PEBTFS OF DEPTAB(DEPACT).
           MOVE VENDOR OF DEMMAS-REC   TO VENDOR OF DEPTAB(DEPACT).
           MOVE ACCTNO OF DEMMAS-REC   TO ACCTNO OF DEPTAB(DEPACT).
           MOVE STATCD OF DEMMAS-REC   TO STATCD OF DEPTAB(DEPACT).
           MOVE INTAKE OF DEMMAS-REC   TO INTAKE OF DEPTAB(DEPACT).
           MOVE INTKCD OF DEMMAS-REC   TO INTKCD OF DEPTAB(DEPACT).
           MOVE INTDAT OF DEMMAS-REC   TO INTDAT OF DEPTAB(DEPACT).
           MOVE MARSTA OF DEMMAS-REC   TO MARSTA OF DEPTAB(DEPACT).
           MOVE PAYGRD OF DEMMAS-REC   TO PAYGRD OF DEPTAB(DEPACT).
           MOVE CHAREL OF DEMMAS-REC   TO CHAREL OF DEPTAB(DEPACT).
           MOVE SVCBRN OF DEMMAS-REC   TO SVCBRN OF DEPTAB(DEPACT).
           MOVE DERDPN OF DEMMAS-REC   TO DERDPN OF DEPTAB(DEPACT).
           MOVE DERELG OF DEMMAS-REC   TO DERELG OF DEPTAB(DEPACT).
           MOVE MILINF OF DEMMAS-REC   TO MILINF OF DEPTAB(DEPACT).
           MOVE PRIVDT OF DEMMAS-REC   TO PRIVDT OF DEPTAB(DEPACT).
           MOVE PRIVNM OF DEMMAS-REC   TO PRIVNM OF DEPTAB(DEPACT).
           MOVE PRIVRL OF DEMMAS-REC   TO PRIVRL OF DEPTAB(DEPACT).
           MOVE CHADIS OF DEMMAS-REC   TO CHADIS OF DEPTAB(DEPACT).
           IF SSNXRF OF DEMMAS-REC NOT NUMERIC
              MOVE ZEROS               TO SSNXRF OF DEMMAS-REC.
           MOVE SSNXRF OF DEMMAS-REC   TO SSNXRF OF DEPTAB(DEPACT).
           MOVE HICNNO OF DEMMAS-REC   TO HICNNO OF DEPTAB(DEPACT).
           MOVE MMDIND OF DEMMAS-REC   TO MMDIND OF DEPTAB(DEPACT).
           MOVE CPAIND OF DEMMAS-REC   TO CPAIND OF DEPTAB(DEPACT).
           MOVE WRKLOC OF DEMMAS-REC   TO WRKLOC OF DEPTAB(DEPACT).
           MOVE LOCQLF OF DEMMAS-REC   TO LOCQLF OF DEPTAB(DEPACT).
           MOVE CTRYCD OF DEMMAS-REC   TO CTRYCD OF DEPTAB(DEPACT).
           MOVE BTHSEQ OF DEMMAS-REC   TO BTHSEQ OF DEPTAB(DEPACT).
           MOVE EMSTCD OF DEMMAS-REC   TO EMSTCD OF DEPTAB(DEPACT).
           MOVE CQLECD OF DEMMAS-REC   TO CQLECD OF DEPTAB(DEPACT).
           MOVE COBRAQ OF DEMMAS-REC   TO COBRAQ OF DEPTAB(DEPACT).
           MOVE COBRAB OF DEMMAS-REC   TO COBRAB OF DEPTAB(DEPACT).
           MOVE COBRAE OF DEMMAS-REC   TO COBRAE OF DEPTAB(DEPACT).
           MOVE STUSTA OF DEMMAS-REC   TO STUSTA OF DEPTAB(DEPACT).
           MOVE EDUBEG OF DEMMAS-REC   TO EDUBEG OF DEPTAB(DEPACT).
           MOVE EDUEND OF DEMMAS-REC   TO EDUEND OF DEPTAB(DEPACT).
           MOVE DETDAT OF DEMMAS-REC   TO DETDAT OF DEPTAB(DEPACT).
           MOVE OTHPHN OF DEMMAS-REC   TO OTHPHN OF DEPTAB(DEPACT).
           MOVE FAXNUM OF DEMMAS-REC   TO FAXNUM OF DEPTAB(DEPACT).
           MOVE EMLIND OF DEMMAS-REC   TO EMLIND OF DEPTAB(DEPACT).
           MOVE EMLTXT OF EMLPTRBV-REC TO ELMAIL OF DEPTAB(DEPACT).
           MOVE EXTIND OF DEMMAS-REC   TO EXTIND OF DEPTAB(DEPACT).
           MOVE RSPIND OF DEMMAS-REC   TO RSPIND OF DEPTAB(DEPACT).
           MOVE BENIND OF DEMMAS-REC   TO BENIND OF DEPTAB(DEPACT).
           MOVE ALTIND OF DEMMAS-REC   TO ALTIND OF DEPTAB(DEPACT).
           MOVE CITZEN OF DEMEXTBT-REC TO CITZEN OF DEPEXT(DEPACT).
           MOVE FRQCOD OF DEMEXTBT-REC TO FRQCOD OF DEPEXT(DEPACT).
           MOVE WAGAMT OF DEMEXTBT-REC TO WAGAMT OF DEPEXT(DEPACT).
           MOVE WRKHRS OF DEMEXTBT-REC TO WRKHRS OF DEPEXT(DEPACT).
           MOVE WORKLC OF DEMEXTBT-REC TO WORKLC OF DEPEXT(DEPACT).
           MOVE SALGRD OF DEMEXTBT-REC TO SALGRD OF DEPEXT(DEPACT).
           MOVE HLTCOD OF DEMEXTBT-REC TO HLTCOD OF DEPEXT(DEPACT).
           MOVE SMKCES OF DEMEXTBT-REC TO SMKCES OF DEPEXT(DEPACT).
           MOVE HEIGHT OF DEMEXTBT-REC TO HEIGHT OF DEPEXT(DEPACT).
           MOVE WEIGHT OF DEMEXTBT-REC TO WEIGHT OF DEPEXT(DEPACT).
           MOVE LNGCD1 OF DEMEXTBT-REC TO LNGCD1 OF DEPEXT(DEPACT).
           MOVE LNGUS1 OF DEMEXTBT-REC TO LNGUS1 OF DEPEXT(DEPACT).
           MOVE LNGCD2 OF DEMEXTBT-REC TO LNGCD2 OF DEPEXT(DEPACT).
           MOVE LNGUS2 OF DEMEXTBT-REC TO LNGUS2 OF DEPEXT(DEPACT).
           MOVE LNGCD3 OF DEMEXTBT-REC TO LNGCD3 OF DEPEXT(DEPACT).
           MOVE LNGUS3 OF DEMEXTBT-REC TO LNGUS3 OF DEPEXT(DEPACT).
           MOVE LNGCD4 OF DEMEXTBT-REC TO LNGCD4 OF DEPEXT(DEPACT).
           MOVE LNGUS4 OF DEMEXTBT-REC TO LNGUS4 OF DEPEXT(DEPACT).
           MOVE LNGCD5 OF DEMEXTBT-REC TO LNGCD5 OF DEPEXT(DEPACT).
           MOVE LNGUS5 OF DEMEXTBT-REC TO LNGUS5 OF DEPEXT(DEPACT).
           MOVE SCHOOL OF DEMEXTBT-REC TO SCHOOL OF DEPEXT(DEPACT).
           MOVE SPHNUM OF DEMEXTBT-REC TO SPHNUM OF DEPEXT(DEPACT).
           MOVE SPHEXT OF DEMEXTBT-REC TO SPHEXT OF DEPEXT(DEPACT).
           MOVE SFAXNB OF DEMEXTBT-REC TO SFAXNB OF DEPEXT(DEPACT).
           MOVE SEMAIL OF DEMEXTBT-REC TO SEMAIL OF DEPEXT(DEPACT).
           MOVE SADRL1 OF DEMEXTBT-REC TO SADRL1 OF DEPEXT(DEPACT).
           MOVE SADRL2 OF DEMEXTBT-REC TO SADRL2 OF DEPEXT(DEPACT).
           MOVE SCTYCD OF DEMEXTBT-REC TO SCTYCD OF DEPEXT(DEPACT).
           MOVE SSTACD OF DEMEXTBT-REC TO SSTACD OF DEPEXT(DEPACT).
           MOVE SZIPCD OF DEMEXTBT-REC TO SZIPCD OF DEPEXT(DEPACT).
           MOVE SCNTRY OF DEMEXTBT-REC TO SCNTRY OF DEPEXT(DEPACT).
           MOVE SCHCLK OF DEMEXTBT-REC TO SCHCLK OF DEPEXT(DEPACT).
           MOVE CNFCOD OF DEMEXTBT-REC TO CNFCOD OF DEPEXT(DEPACT).
           MOVE ALTPHN OF DEMEXTBT-REC TO ALTPHN OF DEPEXT(DEPACT).
           MOVE BEPNBR OF DEMEXTBT-REC TO BEPNBR OF DEPEXT(DEPACT).
           MOVE CELPHN OF DEMEXTBT-REC TO CELPHN OF DEPEXT(DEPACT).
      *
       A399-EXIT.
           EXIT.
      *
       A400-INIT-MEMTAB.
      ****************************************************************
      ****************************************************************
           MOVE 'N'                              TO WS-FLG-DEPTAB
                                                    WS-FLG-SUBTAB.
           INITIALIZE DEPTAB(1)
                      SUBTAB(1).
      *
           PERFORM VARYING INDX FROM 2 BY 1
             UNTIL INDX > DEPMAX OR INDX > DEPLST
              MOVE DEPTAB(1)                     TO DEPTAB(INDX)
           END-PERFORM.
      *
           PERFORM VARYING INDX                  FROM 2 BY 1
             UNTIL INDX > SUBMAX OR INDX > SUBLST
              MOVE SUBTAB(1)                     TO SUBTAB(INDX)
           END-PERFORM.
      *
           MOVE ZERO                             TO DEPACT
                                                    DEPLST
                                                    SUBACT
                                                    SUBLST.
      *
           MOVE 'N'                              TO WS-FLG-MEMTAB
                                                    WS-FLG-SUBMEM
                                                    WS-FLG-ENBTAB
                                                    WS-FLG-SUBENB
                                                    WS-FLG-SUBPCP
                                                    WS-FLG-SUBSEC
                                                    WS-FLG-FEETAB
                                                    WS-FLG-SUBFEE
                                                    WS-FLG-MEDTAB
                                                    WS-FLG-SUBMED.
      *
           INITIALIZE MEMTAB(1)
                      SUBMEM(1)
                      ENBTAB(1, 1)
                      SUBENB(1, 1)
                      PCPTAB(1, 1)
                      SUBPCP(1, 1)
                      SECTAB(1, 1)
                      SUBSEC(1, 1)
                      FEETAB(1, 1)
                      SUBFEE(1, 1)
                      MEDTAB(1, 1)
                      SUBMED(1, 1).
      *
           MOVE 1 TO INDZ.
      *
       A401-LOOP.
           PERFORM VARYING INDX FROM 2 BY 1      UNTIL INDX > ENBMAX
                                                    OR INDX > ENBLST(1)
              MOVE ENBTAB(1, 1)                  TO ENBTAB(INDZ, INDX)
              MOVE SUBENB(1, 1)                  TO SUBENB(INDZ, INDX)
           END-PERFORM.
           ADD 1 TO INDZ
           MOVE 2 TO INDX
           IF ENBMEB OF SUBENB(INDZ, INDX) NOT = SPACES
              GO TO A401-LOOP.

           MOVE 1 TO INDZ.
       A402-LOOP.
      *
           PERFORM VARYING INDX   FROM 2 BY 1    UNTIL INDX > PCPMAX
                                                    OR INDX > PCPLST(1)
              MOVE PCPTAB(1, 1)                  TO PCPTAB(INDZ, INDX)
              MOVE SUBPCP(1, 1)                  TO SUBPCP(INDZ, INDX)
           END-PERFORM.
           ADD 1 TO INDZ
           MOVE 2 TO INDX
           IF PCPMEM OF SUBPCP(INDZ, INDX) NOT = SPACES
              GO TO A402-LOOP.

           MOVE 1 TO INDZ.
       A403-LOOP.
      *
           PERFORM VARYING INDX   FROM 2 BY 1    UNTIL INDX > SECMAX
                                                    OR INDX > SECLST(1)
              MOVE SECTAB(1, 1)                  TO SECTAB(INDZ, INDX)
              MOVE SUBSEC(1, 1)                  TO SUBSEC(INDZ, INDX)
           END-PERFORM.
           ADD 1 TO INDZ
           MOVE 2 TO INDX
           IF SECMEM OF SUBSEC(INDZ, INDX) NOT = SPACES
              GO TO A403-LOOP.

           MOVE 1 TO INDZ.
       A404-LOOP.
      *
           PERFORM VARYING INDX   FROM 2 BY 1    UNTIL INDX > FEEMAX
                                                    OR INDX > FEELST(1)
              MOVE FEETAB(1, 1)                  TO FEETAB(INDZ, INDX)
              MOVE SUBFEE(1, 1)                  TO SUBFEE(INDZ, INDX)
           END-PERFORM.
           ADD 1 TO INDZ
           MOVE 2 TO INDX
           IF FEEMEM OF SUBFEE(INDZ, INDX) NOT = SPACES
              GO TO A404-LOOP.

           MOVE 1 TO INDZ.
       A405-LOOP.
      *
           PERFORM VARYING INDX   FROM 2 BY 1    UNTIL INDX > MEDMAX
                                                    OR INDX > MEDLST(1)
              MOVE MEDTAB(1, 1)                  TO MEDTAB(INDZ, INDX)
              MOVE SUBMED(1, 1)                  TO SUBMED(INDZ, INDX)
           END-PERFORM.
           ADD 1 TO INDZ
           MOVE 2 TO INDX
           IF MEDMEM OF SUBMED(INDZ, INDX) NOT = SPACES
              GO TO A405-LOOP.
      *
           MOVE ZERO                             TO MEMACT
                                                    MESACT
                                                    ENBACT
                                                    ENSACT
                                                    PCPACT
                                                    PPSACT
                                                    SECACT
                                                    SPSACT
                                                    FEEACT
                                                    SFEACT
                                                    MEDACT
                                                    SMDACT.
      *
           PERFORM VARYING INDX   FROM 2 BY 1    UNTIL INDX > MEMMAX
                                                    OR INDX > MEMLST
              MOVE MEMTAB(1)                     TO MEMTAB(INDX)
              MOVE SUBMEM(1)                     TO SUBMEM(INDX)
              MOVE ZERO                          TO ENBLST(INDX)
                                                    ENSLST(INDX)
                                                    PCPLST(INDX)
                                                    PPSLST(INDX)
                                                    SECLST(INDX)
                                                    SPSLST(INDX)
                                                    FEELST(INDX)
                                                    SFELST(INDX)
                                                    MEDLST(INDX)
                                                    SMDLST(INDX)
           END-PERFORM.
      *
           MOVE 0                                TO MEMLST.
           MOVE 0                                TO MESLST.
           MOVE SPACES                           TO EXIST-FLAG.
       A409-EXIT.
           EXIT.
      *
       A410-CHECK-PREENROLL.
           IF  WS-DT3-PRVSUB NOT = ' '
              INITIALIZE MEMMAS-REC
              MOVE WS-DT3-PRVSUB       TO MEMBNO OF MEMMAS-KEY
              MOVE SPACES              TO GRPNUM OF MEMMAS-KEY
              MOVE ZEROES              TO TRNSEQ OF MEMMAS-KEY
              PERFORM MEMMAS-STARTGE             IF INVALID-KEY
                 GO TO A419-EXIT
              ELSE
                 PERFORM MEMMAS-READNX           IF AT-END
                    GO TO A419-EXIT
                 END-IF
              END-IF
              IF WS-DT3-PRVSUB = MEMBNO OF MEMMAS-KEY
                 MOVE 'R'              TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
              END-IF.
      *
           IF WS-DT3-MEMBNO = ' '
              CONTINUE
           ELSE
              GO TO A412-CONTINUE.
      *
           MOVE 'Y'                              TO SW-FST-REC.
           INITIALIZE REXCMEMBT OF EXCSMSBI-REC
           MOVE WS-DT3-EXCSUB          TO EXCSUB OF EXCSMSBI-REC
           MOVE WS-DT3-EXCMEM          TO EXCMEM OF EXCSMSBI-REC
           MOVE WS-DT3-GRPNUM          TO GRPNUM OF EXCSMSBI-REC
           MOVE ZEROES                 TO TRNSEQ OF EXCSMSBI-REC
           MOVE ZEROES                 TO SEQNUM OF EXCSMSBI-REC
           PERFORM EXCSMSBI-STARTGE              IF INVALID-KEY
           GO TO A419-EXIT.
      *
       A411-NEXT.
           PERFORM EXCSMSBI-READNX       IF AT-END
           GO TO A412-CONTINUE.
      *
           IF  EXCSUB OF EXCSMSBI-REC = WS-DT3-EXCSUB
           AND EXCMEM OF EXCSMSBI-REC = WS-DT3-EXCMEM
              IF GRPNUM OF EXCSMSBI-REC NOT = WS-DT3-GRPNUM
              AND WS-DT3-CHGTYP = 'T'
                 MOVE 'R'             TO ENRSTA OF MDTMAS-REC
                                         WS-ENRSTA
                 GO TO A412-CONTINUE
              END-IF
              IF (GRPNUM OF EXCSMSBI-REC NOT = WS-DT3-GRPNUM
              OR MEMBNO OF EXCSMSBI-REC = SPACES)
              AND FST-REC
                 MOVE ' '              TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
                 GO TO A411-NEXT
              END-IF
              MOVE 'N'                           TO SW-FST-REC
              MOVE SEQNUM OF EXCSMSBI-REC        TO WS-SAV-SEQNUM
              MOVE TRNSEQ OF EXCSMSBI-REC        TO WS-SAV-TRNSEQ
              GO TO A411-NEXT.
      *
           IF  EXCSUB OF EXCSMSBI-REC = WS-DT3-EXCSUB
           AND EXCMEM OF EXCSMSBI-REC NOT = WS-DT3-EXCMEM
           AND WS-DT3-EXCMEM = SPACES
           AND FST-REC
           AND WS-DT3-CHGTYP NOT = 'T'
              PERFORM A580-GENNUM                THRU A589-EXIT
              MOVE 'R'                 TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
              GO TO A412-CONTINUE.
      *
           IF (EXCSUB OF EXCSMSBI-REC NOT = WS-DT3-EXCSUB
           OR EXCMEM OF EXCSMSBI-REC NOT = WS-DT3-EXCMEM)
           AND NOT-FST-REC
              INITIALIZE REXCMEMBT OF EXCSMSBI-REC
              MOVE WS-DT3-EXCSUB       TO EXCSUB OF EXCSMSBI-REC
              MOVE WS-DT3-EXCMEM       TO EXCMEM OF EXCSMSBI-REC
              MOVE WS-DT3-GRPNUM       TO GRPNUM OF EXCSMSBI-REC
              MOVE WS-SAV-TRNSEQ       TO TRNSEQ OF EXCSMSBI-REC
              MOVE WS-SAV-SEQNUM       TO SEQNUM OF EXCSMSBI-REC
              MOVE WS-SAV-MEMSEQ       TO MEMSEQ OF EXCSMSBI-REC
              PERFORM EXCSMSBI-READ              IF NOT INVALID-KEY
                 MOVE MEMBNO OF EXCSMSBI-REC     TO WS-DT3-MEMBNO
                 MOVE SUBSNO OF EXCSMSBI-REC     TO WS-DT3-SUBSNO
                 MOVE 'R'              TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA.
           IF EXCSUB OF EXCSMSBI-REC  = WS-DT3-EXCSUB
           AND EXCMEM OF EXCSMSBI-REC = WS-DT3-EXCMEM
              IF GRPNUM OF EXCSMSBI-REC = WS-DT3-GRPNUM
                 MOVE 'R'              TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
              END-IF
           END-IF.
      *
       A412-CONTINUE.
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
      **** IF WS-DT3-CHGTYP NOT = 'A'
      ****    GO TO A419-EXIT.
      *
           MOVE 'N'                              TO WS-EXCSUB-FOUND.
           IF WS-DT3-EXCSUB NOT = SPACES
              MOVE WS-DT3-EXCSUB                 TO WS-EXCSUB-HOLD
           ELSE
              MOVE WS-DT3-EXCMEM                 TO WS-EXCSUB-HOLD
           END-IF.
      *
           PERFORM B710-RTVMBR                   THRU B719-EXIT.
           IF EXCSUB-NOT-FOUND                   GO TO A419-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR142605  CXB  Fix                                    ****
      ****--------------------------------------------------------****
      **** IF WS-DT3-CHGTYP NOT = 'A'
      ****    GO TO A419-EXIT.
      *
           MOVE TRNSEQ OF PE4SBS-REC
                                    TO TRNSEQ OF PEMMAS-KEY
           MOVE SEQNUM OF PE4SBS-REC
                                    TO SEQNUM OF PEMMAS-KEY
           PERFORM PEMMAS-READ      IF INVALID-KEY
              GO TO A419-EXIT
           END-IF
      *
      ****--------------------------------------------------------****
      ****  CR142605  CXB  Fix                                    ****
      ****--------------------------------------------------------****
      **** IF  WS-DT3-GRPNUM = GRPNUM OF PEMMAS-REC
      **** AND STATCD OF PEMMAS-REC NOT = '9'
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Check for valid index.                                ****
      ****  Populate field value with Exchange subscriber.        ****
      ****--------------------------------------------------------****
      **** IF NOT LICENSE-FOR-125573
      **** OR (STATCD OF PEMMAS-REC = '4'
      **** AND CHGEFF OF EEWSUB(ESBACT) = ZEROES)
      **** AND WS-DT3-CHGTYP = 'A'
           IF  (NOT LICENSE-FOR-125573)
           OR  (WS-DT3-CHGTYP = 'A'
           AND  STATCD OF PEMMAS-REC = '4'
           AND (ESBACT = 0
           OR   ESBACT > ESBLST
           OR   CHGEFF OF EEWSUB(ESBACT) = ZEROES))
              MOVE 'Y'                        TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09146'                  TO MI-PRIMARY-ID
                                                 MSGNUM OF ERR-LINE
              MOVE WS-DT3-MEMBNO    TO MEMBNO OF ERR-LINE
              MOVE WS-DT3-SUBSNO    TO SUBSNO OF ERR-LINE
              MOVE WS-DT3-RELCOD    TO RELCOD OF ERR-LINE
              MOVE WS-DT3-GRPNUM    TO GRPNUM OF ERR-LINE
              MOVE WS-DT3-CHGTYP    TO CHGTYP OF ERR-LINE
              MOVE WS-DT3-EXCSUB    TO FIELDV OF ERR-LINE
              MOVE 'N'                        TO SW-MEMBER-ERROR
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR142605  CXB  Fix                                    ****
      ****--------------------------------------------------------****
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Check for valid index.                                ****
      ****  Populate field value with Exchange subscriber.        ****
      ****--------------------------------------------------------****
      **** IF NOT LICENSE-FOR-125573
      **** OR (STATCD OF PEMMAS-REC = '4'
      **** AND CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES)
      **** AND WS-DT3-CHGTYP = 'C'
           IF   (NOT LICENSE-FOR-125573)
           OR   (WS-DT3-CHGTYP = 'C'
           AND   STATCD OF PEMMAS-REC = '4'
           AND  (ESBACT = 0
           OR    ESBACT > ESBLST
           OR    CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES))
              MOVE 'Y'                        TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09140'                  TO MI-PRIMARY-ID
                                                 MSGNUM OF ERR-LINE
              MOVE WS-DT3-MEMBNO    TO MEMBNO OF ERR-LINE
              MOVE WS-DT3-SUBSNO    TO SUBSNO OF ERR-LINE
              MOVE WS-DT3-RELCOD    TO RELCOD OF ERR-LINE
              MOVE WS-DT3-GRPNUM    TO GRPNUM OF ERR-LINE
              MOVE WS-DT3-CHGTYP    TO CHGTYP OF ERR-LINE
              MOVE WS-DT3-EXCSUB    TO FIELDV OF ERR-LINE
              MOVE 'N'                        TO SW-MEMBER-ERROR
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR142605  CXB  Fix                                    ****
      ****--------------------------------------------------------****
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Check for valid index.                                ****
      ****--------------------------------------------------------****
      **** IF  CANEFF OF EETSUB(ESBACT) NOT = ZEROES
      **** AND CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
           IF  ESBACT > 0
           AND ESBACT NOT > ESBLST
           AND CANEFF OF EETSUB(ESBACT) NOT = ZEROES
           AND CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
              MOVE ESBACT                        TO WS-ESBACT
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09183'                     TO MI-PRIMARY-ID
              PERFORM X130-TBL-WRNING            THRU X139-EXIT.
      *
       A419-EXIT.
           EXIT.
      *
       A430-SAVE-EXCSUB.
      *
           MOVE GRPNUM OF EEWSB3(ESBACT)         TO WS-DT3-GRPNUM.
           MOVE SUBSNO OF EEWSB3(ESBACT)         TO WS-DT3-SUBSNO
                                                    WS-PRVSUB.
           MOVE RELCOD OF EEWSUB(ESBACT)         TO WS-DT3-RELCOD.
           MOVE MEMBNO OF EEWSB3(ESBACT)         TO WS-DT3-MEMBNO.
           MOVE BTHDAT OF EEWSB3(ESBACT)         TO WS-DT3-BTHDAT.
           MOVE SEXCOD OF EEWSB3(ESBACT)         TO WS-DT3-SEXCOD.
           MOVE CHGTYP OF EEWSUB(ESBACT)         TO WS-DT3-CHGTYP.
           MOVE EXCMEM OF EEWSUB(ESBACT)         TO WS-DT3-EXCMEM.
           MOVE EXCSUB OF EEWSUB(ESBACT)         TO WS-DT3-EXCSUB.
           MOVE PRVSUB OF EEWSB2(ESBACT)         TO WS-DT3-PRVSUB
                                                    WS-SUB-PRVSUB.
           MOVE SMKCES OF EEWSB2(ESBACT)         TO WS-DT3-SMKCES.
           MOVE OPYAMT OF EEWSB3(ESBACT)         TO WS-DT3-OPYAMT.
           MOVE OPYEFF OF EEWSB3(ESBACT)         TO WS-DT3-OPYEFF.
           MOVE OPYEXP OF EEWSB3(ESBACT)         TO WS-DT3-OPYEXP.
           MOVE OPYSRC OF EEWSB3(ESBACT)         TO WS-DT3-OPYSRC.
           MOVE APTAMT OF EEWSB3(ESBACT)         TO WS-DT3-APTAMT.
           MOVE APTEFF OF EEWSB3(ESBACT)         TO WS-DT3-APTEFF.
           MOVE APTEXP OF EEWSB3(ESBACT)         TO WS-DT3-APTEXP.
           MOVE CSRAMT OF EEWSB3(ESBACT)         TO WS-DT3-CSRAMT.
           MOVE CSREFF OF EEWSB3(ESBACT)         TO WS-DT3-CSREFF.
           MOVE CSREXP OF EEWSB3(ESBACT)         TO WS-DT3-CSREXP.
           MOVE PREAMT OF EEWSB3(ESBACT)         TO WS-DT3-PREAMT.
           MOVE PREEFF OF EEWSB3(ESBACT)         TO WS-DT3-PREEFF.
           MOVE PREEXP OF EEWSB3(ESBACT)         TO WS-DT3-PREEXP.
           MOVE RSPTOT OF EEWSB3(ESBACT)         TO WS-DT3-RSPTOT.
           MOVE RSPEFF OF EEWSB3(ESBACT)         TO WS-DT3-RSPEFF.
           MOVE RSPEXP OF EEWSB3(ESBACT)         TO WS-DT3-RSPEXP.
           MOVE PRETOT OF EEWSB3(ESBACT)         TO WS-DT3-PRETOT.
           MOVE PTOEFF OF EEWSB3(ESBACT)         TO WS-DT3-PTOEFF.
           MOVE PTOEXP OF EEWSB3(ESBACT)         TO WS-DT3-PTOEXP.
           MOVE EMPTOT OF EEWSB3(ESBACT)         TO WS-DT3-EMPTOT.
           MOVE EMPEFF OF EEWSB3(ESBACT)         TO WS-DT3-EMPEFF.
           MOVE EMPEXP OF EEWSB3(ESBACT)         TO WS-DT3-EMPEXP.
           MOVE REACAT OF EEWSB3(ESBACT)         TO WS-DT3-REACAT.
           MOVE CANEFF OF EEWSB3(ESBACT)         TO WS-DT3-CANEFF.
           MOVE TRMEFF OF EEWSB3(ESBACT)         TO WS-DT3-TRMEFF.
           MOVE HLTCOD OF EEWSB2(ESBACT)         TO WS-DT2-HLTCOD.
           MOVE RENREA OF EEWSUB(ESBACT)         TO WS-DT2-ENRTYP.
           MOVE MEMEXP OF EEWSUB(ESBACT)         TO WS-DT1-MEMEXP.
           MOVE MEMEFF OF EEWSUB(ESBACT)         TO WS-DT1-MEMEFF.
           IF WS-DT1-MEMEXP NOT = ZEROES
           AND WS-DT1-MEMEXP NOT = '9999999'
           AND WS-DT3-TRMEFF NOT = ZEROES
           AND (WS-DT3-CHGTYP = 'C'
           OR WS-DT3-CHGTYP = 'T')
              MOVE WS-DT1-MEMEXP                 TO WS-DT3-TRMEFF.
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF SUB-INFO.
           MOVE RATARA OF EEWSB3(ESBACT)         TO WS-DT3-RATARA.
           MOVE RATEFF OF EEWSB3(ESBACT)         TO WS-DT3-RATEFF.
           MOVE RATEXP OF EEWSB3(ESBACT)         TO WS-DT3-RATEXP.
           MOVE EXCPOL OF EEWSB2(ESBACT)         TO WS-DT3-EXCPOL.
           MOVE ASSQHP OF EEWSB3(ESBACT)         TO WS-DT3-ASSQHP.
           MOVE SHPGRP OF EEWSB2(ESBACT)         TO WS-DT3-SHPGRP.
           MOVE PYMTID OF EEWSUB(ESBACT)         TO WS-DT3-PYMTID.
      *
       A439-EXIT.
           EXIT.
      *
       A440-SAVE-EXCDEP.
      *
              MOVE GRPNUM OF EEWDP3(EDPACT)      TO WS-DT3-GRPNUM.
              MOVE SUBSNO OF EEWDP3(EDPACT)      TO WS-DT3-SUBSNO.
              MOVE RELCOD OF EEWDP3(EDPACT)      TO WS-DT3-RELCOD.
              MOVE MEMBNO OF EEWDP3(EDPACT)      TO WS-DT3-MEMBNO.
              MOVE BTHDAT OF EEWDP3(EDPACT)      TO WS-DT3-BTHDAT.
              MOVE SEXCOD OF EEWDP3(EDPACT)      TO WS-DT3-SEXCOD.
              MOVE CHGTYP OF EEWDP3(EDPACT)      TO WS-DT3-CHGTYP.
              MOVE EXCMEM OF EEWDEP(EDPACT)      TO WS-DT3-EXCMEM.
              MOVE EXCSUB OF EEWDEP(EDPACT)      TO WS-DT3-EXCSUB.
              MOVE PRVSUB OF EEWDP2(EDPACT)      TO WS-DT3-PRVSUB.
      *
              IF WS-DT3-SUBSNO = WS-PRVSUB
                 IF WS-SUB-PRVSUB = SPACES
                    MOVE SPACES                  TO WS-DT3-PRVSUB.
      *
              MOVE SMKCES OF EEWDP2(EDPACT)      TO WS-DT3-SMKCES.
              MOVE OPYAMT OF EEWDP3(EDPACT)      TO WS-DT3-OPYAMT.
              MOVE OPYEFF OF EEWDP3(EDPACT)      TO WS-DT3-OPYEFF.
              MOVE OPYEXP OF EEWDP3(EDPACT)      TO WS-DT3-OPYEXP.
              MOVE OPYSRC OF EEWDP3(EDPACT)      TO WS-DT3-OPYSRC.
              MOVE APTAMT OF EEWDP3(EDPACT)      TO WS-DT3-APTAMT.
              MOVE APTEFF OF EEWDP3(EDPACT)      TO WS-DT3-APTEFF.
              MOVE APTEXP OF EEWDP3(EDPACT)      TO WS-DT3-APTEXP.
              MOVE CSRAMT OF EEWDP3(EDPACT)      TO WS-DT3-CSRAMT.
              MOVE CSREFF OF EEWDP3(EDPACT)      TO WS-DT3-CSREFF.
              MOVE CSREXP OF EEWDP3(EDPACT)      TO WS-DT3-CSREXP.
              MOVE PREAMT OF EEWDP3(EDPACT)      TO WS-DT3-PREAMT.
              MOVE PREEFF OF EEWDP3(EDPACT)      TO WS-DT3-PREEFF.
              MOVE PREEXP OF EEWDP3(EDPACT)      TO WS-DT3-PREEXP.
              MOVE RSPTOT OF EEWDP3(EDPACT)      TO WS-DT3-RSPTOT.
              MOVE RSPEFF OF EEWDP3(EDPACT)      TO WS-DT3-RSPEFF.
              MOVE RSPEXP OF EEWDP3(EDPACT)      TO WS-DT3-RSPEXP.
              MOVE PRETOT OF EEWDP3(EDPACT)      TO WS-DT3-PRETOT.
              MOVE PTOEFF OF EEWDP3(EDPACT)      TO WS-DT3-PTOEFF.
              MOVE PTOEXP OF EEWDP3(EDPACT)      TO WS-DT3-PTOEXP.
              MOVE EMPTOT OF EEWDP3(EDPACT)      TO WS-DT3-EMPTOT.
              MOVE EMPEFF OF EEWDP3(EDPACT)      TO WS-DT3-EMPEFF.
              MOVE EMPEXP OF EEWDP3(EDPACT)      TO WS-DT3-EMPEXP.
              MOVE REACAT OF EEWDP3(EDPACT)      TO WS-DT3-REACAT.
              MOVE CANEFF OF EEWDP3(EDPACT)      TO WS-DT3-CANEFF.
              MOVE TRMEFF OF EEWDP3(EDPACT)      TO WS-DT3-TRMEFF.
              MOVE HLTCOD OF EEWDP2(EDPACT)      TO WS-DT2-HLTCOD.
              MOVE RENREA OF EEWDEP(EDPACT)      TO WS-DT2-ENRTYP.
              MOVE MEMEXP OF EEWDEP(EDPACT)      TO WS-DT1-MEMEXP.
              MOVE MEMEFF OF EEWDEP(EDPACT)      TO WS-DT1-MEMEFF.
              IF WS-DT1-MEMEXP NOT = ZEROES
              AND WS-DT1-MEMEXP NOT = '9999999'
              AND WS-DT3-TRMEFF NOT = ZEROES
              AND (WS-DT3-CHGTYP = 'C'
              OR WS-DT3-CHGTYP = 'T')
                 MOVE WS-DT1-MEMEXP              TO WS-DT3-TRMEFF.
              MOVE RATARA OF EEWDP3(EDPACT)      TO WS-DT3-RATARA.
              MOVE RATEFF OF EEWDP3(EDPACT)      TO WS-DT3-RATEFF.
              MOVE RATEXP OF EEWDP3(EDPACT)      TO WS-DT3-RATEXP.
              MOVE EXCPOL OF EEWDP2(EDPACT)      TO WS-DT3-EXCPOL.
              MOVE ASSQHP OF EEWDP3(EDPACT)      TO WS-DT3-ASSQHP.
              MOVE SHPGRP OF EEWDP2(EDPACT)      TO WS-DT3-SHPGRP.
              MOVE PYMTID OF EEWDEP(EDPACT)      TO WS-DT3-PYMTID.
      *
       A449-EXIT.
           EXIT.
      *
       A450-EEWDT3-WRK.
      *
           IF WS-REACAT2 = SPACES
              MOVE  REACAT OF  EEWDT3-REC
                                       TO WS-REACAT2.
           IF WS-TRMEFF1 = ZEROES
              MOVE TRMEFF OF EEWDT3-REC
                                       TO WS-TRMEFF1.
           IF WS-CANEFF1 = ZEROES
              MOVE CANEFF OF EEWDT3-REC
                                       TO WS-CANEFF1.
           IF WS-APLORG1 = SPACES
              MOVE APLORG OF EEWDT3-REC
                                       TO WS-APLORG1.

           IF FIRST-DT3-REC = 'Y'
              MOVE ZEROES                        TO WS-TB3CNT
              MOVE EEWDT3-REC                    TO EEWDT3-WRK
              MOVE 'N'                           TO FIRST-DT3-REC
              GO TO A459-EXIT
           END-IF.
      *
           IF ASSQHP OF EEWDT3-REC NOT = SPACES
              MOVE ASSQHP OF EEWDT3-REC
                                       TO ASSQHP OF EEWDT3-WRK
           END-IF.
           IF OPYAMT OF EEWDT3-REC > 0
           OR OPYEFF OF EEWDT3-REC > ZEROES
           OR OPYEXP OF EEWDT3-REC > ZEROES
              IF OPYAMT OF EEWDT3-WRK = ZEROES
                 MOVE OPYAMT OF EEWDT3-REC TO OPYAMT OF EEWDT3-WRK
                 MOVE OPYEFF OF EEWDT3-REC TO OPYEFF OF EEWDT3-WRK
                 MOVE OPYEXP OF EEWDT3-REC TO OPYEXP OF EEWDT3-WRK
                 MOVE OPYSRC OF EEWDT3-REC TO OPYSRC OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE OPYAMT OF EEWDT3-REC TO WS-TB3-OPYAMT(WS-TB3CNT)
                 MOVE OPYEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-OPYEFF(WS-TB3CNT)
                 MOVE OPYEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-OPYEXP(WS-TB3CNT)
                 MOVE OPYSRC OF EEWDT3-REC TO WS-TB3-OPYSRC(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF APTAMT OF EEWDT3-REC > ZEROES
           OR APTEFF OF EEWDT3-REC > ZEROES
           OR APTEXP OF EEWDT3-REC > ZEROES
              IF APTAMT OF EEWDT3-WRK = ZEROES
                 MOVE APTAMT OF EEWDT3-REC TO APTAMT OF EEWDT3-WRK
                 MOVE APTEFF OF EEWDT3-REC TO APTEFF OF EEWDT3-WRK
                 MOVE APTEXP OF EEWDT3-REC TO APTEXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE APTAMT OF EEWDT3-REC TO WS-TB3-APTAMT(WS-TB3CNT)
                 MOVE APTEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-APTEFF(WS-TB3CNT)
                 MOVE APTEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-APTEXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF CSRAMT OF EEWDT3-REC > ZEROES
           OR CSREFF OF EEWDT3-REC > ZEROES
           OR CSREXP OF EEWDT3-REC > ZEROES
              IF CSRAMT OF EEWDT3-WRK = ZEROES
                 MOVE CSRAMT OF EEWDT3-REC TO CSRAMT OF EEWDT3-WRK
                 MOVE CSREFF OF EEWDT3-REC TO CSREFF OF EEWDT3-WRK
                 MOVE CSREXP OF EEWDT3-REC TO CSREXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE CSRAMT OF EEWDT3-REC TO WS-TB3-CSRAMT(WS-TB3CNT)
                 MOVE CSREFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-CSREFF(WS-TB3CNT)
                 MOVE CSREXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-CSREXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF PREAMT OF EEWDT3-REC > ZEROES
           OR PREEFF OF EEWDT3-REC > ZEROES
           OR PREEXP OF EEWDT3-REC > ZEROES
              IF PREAMT OF EEWDT3-WRK = ZEROES
                 MOVE PREAMT OF EEWDT3-REC TO PREAMT OF EEWDT3-WRK
                 MOVE PREEFF OF EEWDT3-REC TO PREEFF OF EEWDT3-WRK
                 MOVE PREEXP OF EEWDT3-REC TO PREEXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE PREAMT OF EEWDT3-REC TO WS-TB3-PREAMT(WS-TB3CNT)
                 MOVE PREEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-PREEFF(WS-TB3CNT)
                 MOVE PREEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-PREEXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF RSPTOT OF EEWDT3-REC > ZEROES
           OR RSPEFF OF EEWDT3-REC > ZEROES
           OR RSPEXP OF EEWDT3-REC > ZEROES
              IF RSPTOT OF EEWDT3-WRK = ZEROES
                 MOVE RSPTOT OF EEWDT3-REC TO RSPTOT OF EEWDT3-WRK
                 MOVE RSPEFF OF EEWDT3-REC TO RSPEFF OF EEWDT3-WRK
                 MOVE RSPEXP OF EEWDT3-REC TO RSPEXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE RSPTOT OF EEWDT3-REC TO WS-TB3-RSPTOT(WS-TB3CNT)
                 MOVE RSPEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-RSPEFF(WS-TB3CNT)
                 MOVE RSPEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-RSPEXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF PRETOT OF EEWDT3-REC > ZEROES
           OR PTOEFF OF EEWDT3-REC > ZEROES
           OR PTOEXP OF EEWDT3-REC > ZEROES
              IF PRETOT OF EEWDT3-WRK = ZEROES
                 MOVE PRETOT OF EEWDT3-REC TO PRETOT OF EEWDT3-WRK
                 MOVE PTOEFF OF EEWDT3-REC TO PTOEFF OF EEWDT3-WRK
                 MOVE PTOEXP OF EEWDT3-REC TO PTOEXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE PRETOT OF EEWDT3-REC TO WS-TB3-PRETOT(WS-TB3CNT)
                 MOVE PTOEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-PTOEFF(WS-TB3CNT)
                 MOVE PTOEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-PTOEXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF EMPTOT OF EEWDT3-REC > ZEROES
           OR EMPEFF OF EEWDT3-REC > ZEROES
           OR EMPEXP OF EEWDT3-REC > ZEROES
              IF EMPTOT OF EEWDT3-WRK = ZEROES
                 MOVE EMPTOT OF EEWDT3-REC TO EMPTOT OF EEWDT3-WRK
                 MOVE EMPEFF OF EEWDT3-REC TO EMPEFF OF EEWDT3-WRK
                 MOVE EMPEXP OF EEWDT3-REC TO EMPEXP OF EEWDT3-WRK
              ELSE
                 ADD +1                             TO WS-TB3CNT
                 INITIALIZE WS-EEWTB3(WS-TB3CNT)
                 MOVE EMPTOT OF EEWDT3-REC TO WS-TB3-EMPTOT(WS-TB3CNT)
                 MOVE EMPEFF OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-EMPEFF(WS-TB3CNT)
                 MOVE EMPEXP OF EEWDT3-REC TO TARDAT
                 PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                 MOVE CNVDAT               TO WS-TB3-EMPEXP(WS-TB3CNT)
                 GO TO A459-EXIT.
           IF REQTIM OF EEWDT3-REC NOT = SPACES
              MOVE REQTIM OF EEWDT3-REC TO REQTIM OF EEWDT3-WRK.
      *
       A459-EXIT.
           EXIT.
      *
       A460-EXCHNG-EDITS.
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Set Exchange Subscriber field to default value.       ****
      ****--------------------------------------------------------****
           MOVE 'N'                              TO WS-EXC-SUB.
      *
           IF ESBLST > 0
              MOVE 1                             TO ESBACT
              IF (CHGTYP OF EEWSUB(ESBACT) = 'C'
              OR  CHGTYP OF EEWSUB(ESBACT) = 'T'
              OR CHGTYP OF EEWSUB(ESBACT) = 'A'
              OR CHGTYP OF EEWSUB(ESBACT) = SPACE )
                 PERFORM A470-CHECK-IFEXCDEP     THRU A479-EXIT
              END-IF.
      *
           IF  ESBLST = 0
           AND EDPLST > 0
              MOVE 1                             TO EDPACT
              PERFORM A480-CHECK-IFEXCSUB        THRU A489-EXIT
              IF NOT EXCHANGE-SUBSCRIBER
                 MOVE SPACES                     TO EXCSUB OF PE4SBS-REC
                 MOVE ZEROES                     TO TRNSEQ OF PE4SBS-REC
                                                    SEQNUM OF PE4SBS-REC
                 MOVE EXCSUB OF EEWDEP(EDPACT)   TO EXCSUB OF PE4SBS-REC
                 PERFORM PE4SBS-STARTGE          IF NOT INVALID-KEY
                    PERFORM PE4SBS-READNX        IF NOT AT-END
                       AND EXCSUB OF EEWDEP(EDPACT)
                         = EXCSUB OF PE4SBS-REC
                          MOVE 'Y'               TO WS-EXC-SUB
                    END-IF
                 END-IF
              END-IF
              IF NOT EXCHANGE-SUBSCRIBER
                 MOVE 'Y'                           TO FAMILY-FLAG
                 MOVE 'EI09161'        TO MSGNUM OF ERR-LINE
                                          MI-PRIMARY-ID
                 MOVE OLDSUB           TO SUBSNO OF ERR-LINE
                 MOVE OLDGRP           TO GRPNUM OF ERR-LINE
                 MOVE EXCMEM OF EEWDEP(EDPACT)
                                       TO FIELDV OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
       A469-EXIT.
           EXIT.
      *
       A470-CHECK-IFEXCDEP.
      ******************************************************************
      *‚Before changing the subscriber as an Exchange subscriber verify*
      *‚if the dependants are all Exchange                             *
      ******************************************************************
           MOVE 'Y'                              TO SW-FST-REC.
           MOVE RENREA OF EEWSUB(ESBACT) TO WS-DT2-ENRTYP.
           INITIALIZE MEMMAS-REC.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO MEMBNO OF MEMMAS-KEY.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MEMMAS-KEY.
           MOVE ZEROES                 TO TRNSEQ OF MEMMAS-KEY.
           PERFORM MEMMAS-STARTGE                IF INVALID-KEY
                                                 GO TO A479-EXIT.
       A471-NEXT.
           PERFORM MEMMAS-READNX                 IF AT-END
                                                 GO TO A479-EXIT.
      *
           IF  SUBSNO OF EEWSUB(ESBACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWSUB(ESBACT) = GRPNUM OF MEMMAS-KEY
           AND MEMBNO OF MEMMAS-KEY     = SUBSNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC NOT = EXPDAT OF MEMMAS-REC
              MOVE MEMSEQ OF MEMMAS-REC          TO EXC-MEMSEQ
              MOVE TRNSEQ OF MEMMAS-REC          TO EXC-TRNSEQ
              MOVE 'N'                           TO SW-FST-REC
                                                 GO TO A471-NEXT.
      *
           IF  SUBSNO OF EEWSUB(ESBACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWSUB(ESBACT) = GRPNUM OF MEMMAS-KEY
           AND EFFDAT OF MEMMAS-REC = EXPDAT OF MEMMAS-REC
                                                 GO TO A471-NEXT.
      *
           IF (SUBSNO OF EEWSUB(ESBACT) NOT = SUBSNO OF MEMMAS-REC
           OR GRPNUM OF EEWSUB(ESBACT) NOT = GRPNUM OF MEMMAS-KEY)
           AND FST-REC
                                                 GO TO A479-EXIT.
      *
       A472-CONTINUE.
           MOVE EXC-MEMSEQ             TO MEMSEQ OF EXCMEMBT-KEY
           MOVE EXC-TRNSEQ             TO TRNSEQ OF EXCMEMBT-KEY
           MOVE ZEROES                 TO SEQNUM OF EXCMEMBT-KEY
           PERFORM EXCMEMBT-STARTGE              IF INVALID-KEY
           MOVE 'N'                              TO WS-EXC-SUB
                                                 GO TO A473-DEP.
           PERFORM EXCMEMBT-READNX               IF AT-END
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A473-DEP.
      *
           IF EXC-MEMSEQ NOT = MEMSEQ OF EXCMEMBT-KEY
             MOVE 'N'                            TO WS-EXC-SUB
           ELSE
             MOVE 'Y'                            TO WS-EXC-SUB
             MOVE 'R'                  TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
             IF LICENSE-FOR-125573
                MOVE GRPNUM OF EEWSUB(ESBACT)    TO WRKGRP
                MOVE ACCTNO OF EEWSUB(ESBACT)    TO WRKACT
                MOVE MEMBNO OF EEWSUB(ESBACT)    TO WRKMEM
                MOVE BENPKG OF EEWSUB(ESBACT)    TO WRKPKG
                MOVE MEMEFF OF EEWSUB(ESBACT)    TO WRKEFF
                MOVE MEMEXP OF EEWSUB(ESBACT)    TO WRKEXP
                PERFORM E400-FNDEXC              THRU E409-EXIT
             END-IF
             IF ENRTYP OF MDTMAS-REC = 'RE'
                MOVE SPACES            TO WS-ENRSTA
                                          ENRSTA OF MDTMAS-REC
             END-IF
             MOVE ENRTYP OF MDTMAS-REC TO RENREA OF EEWSUB(ESBACT)
             MOVE HOLDCD OF MDTMAS-REC TO HOLDCD OF EEWSUB(ESBACT)
             GO TO A479-EXIT.
      *
       A473-DEP.
           INITIALIZE MEMMAS-REC.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MEMSBS-KEY.
           MOVE 1                      TO RELCOD OF MEMSBS-KEY.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO MEMBNO OF MEMSBS-KEY.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MEMSBS-KEY.
           MOVE ZEROES                 TO TRNSEQ OF MEMSBS-KEY
                                          EXPDAT OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
                                                 GO TO A479-EXIT.
       A474-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
                                                 GO TO A479-EXIT.
      *
           IF  SUBSNO OF EEWSUB(ESBACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWSUB(ESBACT) = GRPNUM OF MEMMAS-REC
           AND MEMBNO OF MEMMAS-REC NOT = SUBSNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC NOT = EXPDAT OF MEMMAS-REC
              MOVE MEMBNO OF MEMMAS-REC          TO EXC-MEMBNO
              GO TO A475-NEXT.
      *
           IF  SUBSNO OF EEWSUB(ESBACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWSUB(ESBACT) = GRPNUM OF MEMMAS-REC
           AND (MEMBNO OF MEMMAS-REC    = SUBSNO OF MEMMAS-REC
           OR  EFFDAT OF MEMMAS-REC     = EXPDAT OF MEMMAS-REC)
              GO TO A474-NEXT.
      *
           IF SUBSNO OF EEWSUB(ESBACT) NOT = SUBSNO OF MEMMAS-REC
           OR GRPNUM OF EEWSUB(ESBACT) NOT = GRPNUM OF MEMMAS-REC
              GO TO A479-EXIT.
      *
       A475-NEXT.
           MOVE ' '                              TO WS-DEP-REC.
           IF EDPLST > 0
              MOVE 1                             TO EDPACT
              PERFORM UNTIL EDPACT > EDPLST
                 IF  CHGTYP OF EEWDEP(EDPACT) = 'A'
                    MOVE ENRTYP OF MDTMAS-REC
                                       TO RENREA OF EEWDEP(EDPACT)
                    MOVE HOLDCD OF MDTMAS-REC
                                       TO HOLDCD OF EEWDEP(EDPACT)
                 END-IF
                 ADD 1                           TO EDPACT
              END-PERFORM
           END-IF.
      *
           IF EDPLST > 0
              MOVE 1                             TO EDPACT
              PERFORM UNTIL EDPACT > EDPLST OR DEP-REC-FOUND
                 IF  MEMBNO OF EEWDEP(EDPACT) = EXC-MEMBNO
                 AND (CHGTYP OF EEWDEP(EDPACT) = 'C'
                 OR (CHGTYP OF EEWDEP(EDPACT) = 'A'
                 AND ENRTYP OF MDTMAS-REC NOT = 'RE'))
                    MOVE 'Y'                     TO WS-DEP-REC
                    MOVE 'R'           TO ENRSTA OF MDTMAS-REC
                                          WS-ENRSTA
                 END-IF
                 ADD 1                           TO EDPACT
              END-PERFORM
           END-IF.
      *
           IF (EDPLST > 0 AND WS-DEP-REC = ' ')
           OR EDPLST = 0
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE 'EI09162'           TO MSGNUM OF ERR-LINE
                                          MI-PRIMARY-ID
              MOVE OLDSUB              TO SUBSNO OF ERR-LINE
              MOVE OLDGRP              TO GRPNUM OF ERR-LINE
              MOVE ERR-LINE                         TO LINE-E
              PERFORM X100-PRINT-ERROR              THRU X109-EXIT
              GO TO A479-EXIT
           END-IF.
      *
           GO TO A474-NEXT.
      *
       A479-EXIT.
           EXIT.
      *
       A480-CHECK-IFEXCSUB.
      ******************************************************************
      *‚Before adding an Exchange dependant verify if the Subscriber is*
      *‚an Exchange Subscriber                                         *
      ******************************************************************
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Set Exchange Subscriber field to default value.       ****
      ****--------------------------------------------------------****
           MOVE 'N'                              TO WS-EXC-SUB.
      *
           MOVE 'Y'                    TO SW-FST-REC.
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MEMMAS-KEY.
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MEMMAS-KEY.
           MOVE ZEROES                 TO TRNSEQ OF MEMMAS-KEY.
           PERFORM MEMMAS-STARTGE                IF INVALID-KEY
                                                 GO TO A489-EXIT.
      *
       A481-NEXT.
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Exit if end of file.                                  ****
      ****--------------------------------------------------------****
      **** PERFORM MEMMAS-READNX.
           PERFORM MEMMAS-READNX                 IF AT-END
              IF FST-REC
                 GO TO A489-EXIT
              END-IF
              GO TO A482-CONTINUE.
      *
           IF  SUBSNO OF EEWDEP(EDPACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWDEP(EDPACT) = GRPNUM OF MEMMAS-KEY
           AND MEMBNO OF MEMMAS-REC     = SUBSNO OF MEMMAS-REC
           AND EFFDAT OF MEMMAS-REC NOT = EXPDAT OF MEMMAS-REC
              MOVE MEMSEQ OF MEMMAS-REC          TO EXC-MEMSEQ
              MOVE TRNSEQ OF MEMMAS-REC          TO EXC-TRNSEQ
              MOVE 'N'                           TO SW-FST-REC
              GO TO A481-NEXT.
      *
           IF  SUBSNO OF EEWDEP(EDPACT) = SUBSNO OF MEMMAS-REC
           AND GRPNUM OF EEWDEP(EDPACT) = GRPNUM OF MEMMAS-KEY
           AND EFFDAT OF MEMMAS-REC     = EXPDAT OF MEMMAS-REC
              GO TO A481-NEXT.
      *
           IF (SUBSNO OF EEWDEP(EDPACT) NOT = SUBSNO OF MEMMAS-REC
           OR GRPNUM OF EEWDEP(EDPACT) NOT = GRPNUM OF MEMMAS-KEY)
           AND FST-REC
              GO TO A489-EXIT.
      *
       A482-CONTINUE.
           MOVE EXC-MEMSEQ             TO MEMSEQ OF EXCMEMBT-KEY.
           MOVE EXC-TRNSEQ             TO TRNSEQ OF EXCMEMBT-KEY.
           MOVE ZEROES                 TO SEQNUM OF EXCMEMBT-KEY.
           PERFORM EXCMEMBT-STARTGE              IF INVALID-KEY
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A489-EXIT.
      *
       A483-READNXT.
           PERFORM EXCMEMBT-READNX               IF AT-END
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A489-EXIT.
      *
           IF EXC-MEMSEQ NOT = MEMSEQ OF EXCMEMBT-KEY
             MOVE 'N'                            TO WS-EXC-SUB
                                                 GO TO A483-READNXT
           ELSE
             MOVE 'Y'                            TO WS-EXC-SUB
             MOVE 'R'                  TO ENRSTA OF MDTMAS-REC
                                                 WS-ENRSTA
             IF LICENSE-FOR-125573
                MOVE GRPNUM OF EEWDEP(EDPACT)    TO WRKGRP
                MOVE ACCTNO OF EEWDEP(EDPACT)    TO WRKACT
                MOVE MEMBNO OF EEWDEP(EDPACT)    TO WRKMEM
                MOVE BENPKG OF EEWDEP(EDPACT)    TO WRKPKG
                MOVE MEMEFF OF EEWDEP(EDPACT)    TO WRKEFF
                MOVE MEMEXP OF EEWDEP(EDPACT)    TO WRKEXP
                PERFORM E400-FNDEXC              THRU E409-EXIT
             END-IF
             MOVE ENRTYP OF MDTMAS-REC TO RENREA OF EEWDEP(EDPACT)
             MOVE HOLDCD OF MDTMAS-REC TO HOLDCD OF EEWDEP(EDPACT).
      *
       A489-EXIT.
           EXIT.
      *
       A490-CONV-DATE.
      **************************************************************
      *‚CONVERT 7 BYTES DATE (CYYMMDD) TO 8 BYTES DATE (CCYMMDD)   *
      **************************************************************
            IF CNVDAT = ZEROES
               MOVE ZEROES                        TO TARDAT
               GO TO A499-EXIT.
      *
           IF CNVDAT = 9999999
              MOVE 99999999                      TO TARDAT
              GO TO A499-EXIT.
      *
           MOVE DATYY OF TARDAT-CONV   TO DATYY OF TARDAT.
           MOVE DATMM OF TARDAT-CONV   TO DATMM OF TARDAT.
           MOVE DATDD OF TARDAT-CONV   TO DATDD OF TARDAT.
           IF DATCC OF TARDAT-CONV = 1
              MOVE 19                  TO DATCC OF TARDAT
           END-IF
           IF DATCC OF TARDAT-CONV = 2
               MOVE 20                 TO DATCC OF TARDAT
           END-IF.
      *
       A499-EXIT.
           EXIT.
      *
       A500-SUB-CHECK.
      ***************************************************************
      *‚EDIT SUBSCIBER INFORMATION                                  *
      ***************************************************************
           MOVE ZEROES                           TO ESBACT.
       A502-NEXT.
           MOVE 'Y'                              TO SW-NEWRECORD.
           MOVE 'Y'                              TO SW-NEWRECORD-WRN.
           IF ESBACT NOT < ESBLST                GO TO A509-EXIT.
      *
           ADD 1                                 TO ESBACT.
      *
           IF ESBACT > ESBLST
              GO TO A509-EXIT.
      *
           MOVE 'N'                              TO WRITTEN-FLAG.
      *
           IF MEMBNO OF EEWSUB(ESBACT) = SPACES
           AND RELCOD OF EEWSUB(ESBACT) = '1'
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF EEWSUB(ESBACT).
      *
      *‚GET THE MOST CURRENT MEMMAS RECORD FOR THE SUB FOR COMPARISON
      *
           PERFORM A540-CURSUB                   THRU A549-EXIT.
      *
           IF FULLUP OF EEWHDR-WRK = 'Y' OR 'A'
           AND  MESLST > ZERO
           AND (CHGTYP OF EEWSUB(ESBACT) = 'A' OR SPACES)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO EEWEFF OF WS-WORK
              MOVE MEMEXP OF EEWSUB(ESBACT) TO EEWEXP OF WS-WORK
              IF  EEWEFF OF WS-WORK = 0
              AND EEWEXP OF WS-WORK = 0
                 MOVE MEMEFF OF WS-WORK     TO EEWEFF OF WS-WORK
                 MOVE MEMEXP OF WS-WORK     TO EEWEXP OF WS-WORK
              END-IF
              PERFORM A550-DATE-CHK              THRU A559-EXIT
              IF DATECOD = 'Y'
                 MOVE 'C'              TO CHGTYP OF EEWSUB(ESBACT)
              ELSE
                 MOVE 'A'              TO CHGTYP OF EEWSUB(ESBACT).
      *
           IF DUPMEM OF EEWHDR-REC = 'Y'
                                                 GO TO A503-NEXT.
      *
           IF FULLUP OF EEWHDR-WRK = 'N'
           AND (CHGTYP OF EEWSUB(ESBACT) = 'A' OR SPACES)
           AND MESLST > ZERO
              MOVE MEMEFF OF EEWSUB(ESBACT) TO EEWEFF OF WS-WORK
              MOVE MEMEXP OF EEWSUB(ESBACT) TO EEWEXP OF WS-WORK
              PERFORM A550-DATE-CHK              THRU A559-EXIT
              IF DATECOD = 'Y'
              AND CHGTYP OF EEWSUB(ESBACT) = 'A'
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02465'               TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    MOVE 'EI02465'               TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A509-EXIT
                    END-IF
                 END-IF
              END-IF
              IF DATECOD = 'Y'
              AND CHGTYP OF EEWSUB(ESBACT) = SPACES
                 MOVE 'C'              TO CHGTYP OF EEWSUB(ESBACT)
              END-IF
              IF DATECOD NOT = 'Y'
              AND CHGTYP OF EEWSUB(ESBACT) = SPACES
                 MOVE 'A'              TO CHGTYP OF EEWSUB(ESBACT).

       A503-NEXT.
      *
      *‚EXTRA CHECK TO MAKE SURE NO SPACES ARE IN THE CHTGTYP
      *
           IF CHGTYP OF EEWSUB(ESBACT) = SPACES
              IF FULLUP OF EEWHDR-WRK = 'Y' OR 'A'
                 IF MESLST > 0
                    MOVE MEMEFF OF EEWSUB(ESBACT) TO EEWEFF OF WS-WORK
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO EEWEXP OF WS-WORK
                    PERFORM A550-DATE-CHK              THRU A559-EXIT
                    IF DATECOD = 'Y'
                       MOVE 'C'        TO CHGTYP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'A'        TO CHGTYP OF EEWSUB(ESBACT)
                    END-IF
                 ELSE
                    MOVE 'A'           TO CHGTYP OF EEWSUB(ESBACT)
                 END-IF
              ELSE
              IF FULLUP OF EEWHDR-WRK = 'N'
                 IF MESLST > 0
                    MOVE MEMEFF OF EEWSUB(ESBACT) TO EEWEFF OF WS-WORK
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO EEWEXP OF WS-WORK
                    PERFORM A550-DATE-CHK              THRU A559-EXIT
                    IF DATECOD = 'Y'
                       MOVE 'C'        TO CHGTYP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'A'        TO CHGTYP OF EEWSUB(ESBACT)
                    END-IF
                 ELSE
                    MOVE 'A'           TO CHGTYP OF EEWSUB(ESBACT).

           IF CHGTYP OF EEWSUB(ESBACT) = 'A'
           AND (EXCHNG OF EEWSB2(ESBACT) = 'EI'
           OR   EXCHNG OF EEWSB2(ESBACT) = 'ES')
           AND EXCSUB OF EEWSUB(ESBACT) = SPACES
           AND EXCMEM OF EEWSUB(ESBACT) = SPACES
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09168'                     TO MI-PRIMARY-ID
                                                    MSGNUM OF WRN-LINE
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              PERFORM X110-WRNING                THRU X119-EXIT
              IF EXTSUB OF EEWSUB(ESBACT) = SPACES
              AND SUBSNO OF EEWSUB(ESBACT) = SPACES
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI02487'                  TO MI-PRIMARY-ID
                                                    MSGNUM OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.

           IF CHGTYP OF EEWSUB(ESBACT) = 'A'
           AND EXCHNG OF EEWSB2(ESBACT) NOT = 'EI'
           AND EXCHNG OF EEWSB2(ESBACT) NOT = 'ES'
           AND (EXCSUB OF EEWSUB(ESBACT) NOT = SPACES
           OR EXCMEM OF EEWSUB(ESBACT) NOT = SPACES)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09168'                     TO MI-PRIMARY-ID
                                                    MSGNUM OF WRN-LINE
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              PERFORM X110-WRNING                THRU X119-EXIT
              IF EXTSUB OF EEWDET-REC = SPACES
              AND SUBSNO OF EEWDET-REC = SPACES
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI02487'                     TO MI-PRIMARY-ID
                                                    MSGNUM OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
      *
           IF EXTSUB OF EEWSUB(ESBACT) = SPACES
           AND SUBSNO OF EEWSUB(ESBACT) = SPACES
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI02487'                     TO MI-PRIMARY-ID
                                                    MSGNUM OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.

      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           IF GRPNUM OF GRPMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
              MOVE SPACES                        TO GRPMAS-REC
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF GRPMAS-REC
              PERFORM GRPMAS-READ                IF INVALID-KEY
                 MOVE SPACES           TO GRPNUM OF GRPMAS-REC.
      *
           IF COMPNO OF GRPMAS-REC > SPACES
              IF RECTYP OF CMPANY-REC NOT = 'A'
              OR COMPNO OF CMPANY-REC NOT = COMPNO OF GRPMAS-REC
                 MOVE SPACES                     TO CMPANY-REC
                 MOVE 'A'              TO RECTYP OF CMPANY-REC
                 MOVE COMPNO OF GRPMAS-REC
                                       TO COMPNO OF CMPANY-REC
                 PERFORM CMPANY-READ             IF INVALID-KEY
                    MOVE SPACES                  TO CMPANY-REC.
      *
      **** IF CHGTYP OF EEWSUB(ESBACT) = 'C'
      **** AND EXCHNG OF EEWSB2(ESBACT) = 'EI'
           IF (PREUPD OF CMPANY-REC NOT = 'Y'
           OR NOT LICENSE-FOR-125573)
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND EXCHNG OF EEWSB2(ESBACT) = 'EI'
           AND STATCD OF PEMMAS-REC = '4'
           AND (EFFDAT OF PEMMAS-REC >= CHGEFF OF EEWSUB(ESBACT)
           AND EXPDAT OF PEMMAS-REC <= CHGEFF OF EEWSUB(ESBACT))
              MOVE EXCSUB OF EEWSUB(ESBACT)      TO WS-EXCSUB-HOLD
              MOVE 'N'                           TO WS-EXCSUB-FOUND
              PERFORM B710-RTVMBR                THRU B719-EXIT
              IF EXCSUB-NOT-FOUND
                 CONTINUE
              ELSE
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI09140'                  TO MI-PRIMARY-ID
                                                    MSGNUM OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
      *
           IF  CHGTYP OF EEWSUB(ESBACT) = 'A'
           AND FULLUP OF EEWHDR-WRK = 'Y' OR 'A'
              MOVE 'N'                           TO SW-FULLUP-ERROR
              IF BTHDAT OF EEWSUB(ESBACT) = 0
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'BIRTH DATE'               TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF SEXCOD OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'SEX CODE'                 TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF LSTNAM OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'LAST NAME'                TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF FSTNAM OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'FIRST NAME'               TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF FORNAM OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'FORMAT CODE'              TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF ADRLN1 OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'ADDRESS LINE 1'           TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF  (PCPCOD OF EEWSUB(ESBACT) = ' ')
              AND (PCPDFT OF EEWHDR-WRK NOT = 'Y')
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'PRIMARY PROVIDER'         TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF  (ACCTNO OF EEWSUB(ESBACT) = ' ')
              AND (INDBIL OF GRPMAS-REC NOT = 'Y')
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'ACCOUNT NUMBER'           TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF TIERCD OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'TIER CODE'                TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF CITYCD OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'CITY'                     TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF STACOD OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'STATE CODE'               TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF ZIPCOD OF EEWSUB(ESBACT) = ' '
                 SET FULLUP-ERROR                TO TRUE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02424'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02424'                  TO MI-PRIMARY-ID
                 MOVE 'ZIP CODE'                 TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
              END-IF
              IF FULLUP-ERROR
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A509-EXIT.

           IF (CHGTYP OF EEWSUB(ESBACT) = 'C' OR 'T')
           AND MESLST = ZERO
              IF BYPEDT OF EDIENR-REC = 'Y'
                 MOVE 'Y'                        TO SW-SET-ERROR
              ELSE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02466'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02466'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A509-EXIT.
      *
      *‚SAVE EXP AND EFF FOR CHECKING DEP AGAINST SUBSCRIBER INFO
      *
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF SUB-INFO.
           MOVE MEMEFF OF EEWSUB(ESBACT) TO MEMEFF OF SUB-INFO.
           MOVE MEMEXP OF EEWSUB(ESBACT) TO MEMEXP OF SUB-INFO.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF SUB-INFO.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'A'
              GO TO A507-NEXT.
      *
      *‚ CHECK MEMEFF AND EXP FOR ZEROES
      *
           IF MEMEFF OF EEWSUB(ESBACT) = ZEROES
              MOVE 'Y'                        TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MEM EFF DATE'             TO MI-PARM4
              MOVE 'EI02424'                  TO MI-PRIMARY-ID
              MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT
              PERFORM A920-ERR-SUB            THRU A929-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A509-EXIT
              END-IF.

           IF MEMEXP OF EEWSUB(ESBACT) = ZEROES
              MOVE 'Y'                        TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MEM EXP DATE'             TO MI-PARM4
              MOVE 'EI02424'                  TO MI-PRIMARY-ID
              MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR        THRU X109-EXIT
              PERFORM A920-ERR-SUB            THRU A929-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A509-EXIT
              END-IF.
      *
           IF PCPEFF OF EEWSUB(ESBACT) NOT = ZERO
           AND PCPEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF EEWSUB(ESBACT)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO PCPEFF OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'PRIMARY PROVIDER'            TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWSUB(ESBACT) TO PCPEFF OF EEWSUB(ESBACT).
      *
           IF SECEFF OF EEWSUB(ESBACT) NOT = ZERO
           AND SECEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF EEWSUB(ESBACT)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO SECEFF OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'SECONDARY PROVIDER'          TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO SECEFF OF EEWSUB(ESBACT).
      *
           IF MEDEFF OF EEWSUB(ESBACT) NOT = ZERO
           AND MEDEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF EEWSUB(ESBACT)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO MEDEFF OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'MEDICARE'                    TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO MEDEFF OF EEWSUB(ESBACT).
      *
           IF FEEEFF OF EEWSUB(ESBACT) NOT = ZERO
           AND FEEEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF EEWSUB(ESBACT)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO FEEEFF OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'FEE SCHEDULE'                TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO FEEEFF OF EEWSUB(ESBACT).
      *
           IF ENBEFF OF EEWSUB(ESBACT) NOT = ZERO
           AND ENBEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF EEWSUB(ESBACT)
              MOVE MEMEFF OF EEWSUB(ESBACT) TO ENBEFF OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'ENROLLMENT BILLING'          TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO ENBEFF OF EEWSUB(ESBACT).
      *
           IF PCPEXP OF EEWSUB(ESBACT) NOT = ZERO
           AND PCPEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF EEWSUB(ESBACT)
              MOVE MEMEXP OF EEWSUB(ESBACT) TO PCPEXP OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'PRIMARY PROVIDER'            TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO PCPEXP OF EEWSUB(ESBACT).
      *
           IF SECEXP OF EEWSUB(ESBACT) NOT = ZERO
           AND SECEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF EEWSUB(ESBACT)
              MOVE MEMEXP OF EEWSUB(ESBACT) TO SECEXP OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'SECONDARY PROVIDER'          TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO SECEXP OF EEWSUB(ESBACT).
      *
           IF MEDEXP OF EEWSUB(ESBACT) NOT = ZERO
           AND MEDEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF EEWSUB(ESBACT)
              MOVE MEMEXP OF EEWSUB(ESBACT) TO MEDEXP OF EEWSUB(ESBACT)
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'MEDICARE'                    TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO MEDEXP OF EEWSUB(ESBACT).
      *
           IF FEEEXP OF EEWSUB(ESBACT) NOT = ZERO
           AND FEEEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF EEWSUB(ESBACT)
              MOVE MEMEXP OF EEWSUB(ESBACT) TO FEEEXP OF EEWSUB(ESBACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'FEE SCHEDULE'                TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO FEEEXP OF EEWSUB(ESBACT).
      *
           IF ENBEXP OF EEWSUB(ESBACT) NOT = ZERO
           AND ENBEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF EEWSUB(ESBACT)
              MOVE MEMEXP OF EEWSUB(ESBACT) TO ENBEXP OF EEWSUB(ESBACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'ENROLLMENT BILLING'          TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO ENBEXP OF EEWSUB(ESBACT).
      *
       A507-NEXT.
           IF NOT GROUP-ERROR
              IF INDBIL OF GRPMAS-REC = 'Y'
              AND ACCTNO OF EEWSUB(ESBACT) = SPACES
                 MOVE 'INDBIL'            TO ACCTNO OF EEWSUB(ESBACT).
      *
           IF CHGTYP OF EEWSUB(ESBACT) = 'C' OR 'T'
              PERFORM B200-CHECK-FOR-SUB         THRU B209-EXIT
              IF ((NOT SUB-MHS-EXISTS) AND SUBADD-MDT-EXISTS)
              AND BYPEDT OF EDIENR-REC = 'Y'
                 PERFORM B880-SUBCHG-EDITS       THRU B889-EXIT
              ELSE IF SUB-MHS-EXISTS
                 PERFORM A880-SUBCHG-EDITS       THRU A889-EXIT.
      *
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A509-EXIT.
      *
           GO TO A502-NEXT.
       A509-EXIT.
           EXIT.
      *
       A510-MEM-CHECK.
      **************************************************************
      *‚EDIT DEPENDANT INFORMATION                                *
      **************************************************************
           MOVE ZEROES                           TO EDPACT.
       A512-NEXT.
           MOVE 'Y'                              TO SW-NEWRECORD.
           MOVE 'Y'                              TO SW-NEWRECORD-WRN.
      *
           IF EDPACT NOT < EDPLST                GO TO A519-EXIT.
           ADD 1                                 TO EDPACT.
      *
           IF EDPACT > EDPLST
              GO TO A519-EXIT.
      *
           MOVE 'N'                              TO WRITTEN-FLAG.
      *
           IF MESLST = ZERO
           AND ESBLST = ZERO
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF ERR-LINE
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF ERR-LINE
              MOVE 'EI02462'                     TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI02462'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              IF PRCERR OF PGM-WORK = 'Y'        GO TO A519-EXIT.
      *
           IF MEMBNO OF EEWDEP(EDPACT) = SPACES
              IF OLDBTH OF EEWDEP(EDPACT) = ZEROES
                 MOVE BTHDAT OF EEWDEP(EDPACT) TO BTHDAT-SRCH
              ELSE
                 MOVE OLDBTH OF EEWDEP(EDPACT) TO BTHDAT-SRCH
              END-IF
              IF OLDSEX OF EEWDEP(EDPACT) = SPACES
                 MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD-SRCH
              ELSE
                 MOVE OLDSEX OF EEWDEP(EDPACT) TO SEXCOD-SRCH.
      *
           IF MEMBNO OF EEWDEP(EDPACT) = SPACES
           AND RELCOD OF EEWDEP(EDPACT) NOT = '1'
           AND MESLST > ZEROES
              PERFORM A520-FIND-MEMNUM           THRU A529-EXIT
              IF NUMCNT > 1
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES                  TO MEMBNO-INPUT
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02463'               TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    MOVE 'EI02463'               TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    GO TO A515-NEXT
                 END-IF
              END-IF
              IF NUMCNT = 1
                 MOVE MEMBNO-INPUT     TO MEMBNO OF EEWDEP(EDPACT)
                 GO TO A515-NEXT
              END-IF
              IF NUMCNT = ZEROES
                 PERFORM A530-GETNUM             THRU A539-EXIT
                 IF NUMCNT > 1
                    IF BYPEDT OF EDIENR-REC = 'Y'
                       MOVE 'Y'                  TO SW-SET-ERROR
                    ELSE
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'Y'                  TO FAMILY-FLAG
                       MOVE SPACES               TO MEMBNO-INPUT
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02463'               TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    MOVE 'EI02463'               TO MI-PRIMARY-ID
                       PERFORM X100-PRINT-ERROR  THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER   THRU A919-EXIT
                       GO TO A515-NEXT
                    END-IF
                 END-IF
                 IF NUMCNT = 1
                    MOVE MEMBNO-SAVE  TO MEMBNO OF EEWDEP(EDPACT)
                    GO TO A515-NEXT
                 END-IF
                 IF NUMCNT = ZEROES
                    IF FULLUP OF PGM-WORK = 'Y' OR 'A'
                    OR (CHGTYP OF EEWDEP(EDPACT) = 'A' OR SPACES)
                       PERFORM A580-GENNUM       THRU A589-EXIT
                    END-IF
                 END-IF
              END-IF.
      *
           IF MEMBNO OF EEWDEP(EDPACT) = SPACES
              PERFORM A530-GETNUM             THRU A539-EXIT
              IF NUMCNT > 1
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES                  TO MEMBNO-INPUT
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02463'                TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                 TO LINE-E
                    MOVE 'EI02463'                TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR      THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER       THRU A919-EXIT
                    GO TO A515-NEXT
                 END-IF
              END-IF
              IF NUMCNT = 1
                 MOVE MEMBNO-SAVE   TO MEMBNO OF EEWDEP(EDPACT)
                 GO TO A515-NEXT
              END-IF
              IF NUMCNT = ZEROES
                 IF FULLUP OF PGM-WORK = 'Y' OR 'A'
                 OR (CHGTYP OF EEWDEP(EDPACT) = 'A' OR SPACES)
                    PERFORM A580-GENNUM       THRU A589-EXIT
                 END-IF
              END-IF.
      *
           IF PRCERR OF PGM-WORK = 'Y'
              GO TO A519-EXIT.
      *
       A515-NEXT.
      *
      *‚RETREIVE CURRENT INFO FOR DEP
           PERFORM A560-CURDEP                   THRU A569-EXIT.
      *
           IF FULLUP OF EEWHDR-WRK = 'Y' OR 'A'
           AND MEM-EXISTS
           AND (CHGTYP OF EEWDEP(EDPACT) = 'A' OR SPACES)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO EEWEFF OF WS-WORK
              MOVE MEMEXP OF EEWDEP(EDPACT) TO EEWEXP OF WS-WORK
              IF  EEWEFF OF WS-WORK = 0
              AND EEWEXP OF WS-WORK = 0
                 MOVE MEMEFF OF WS-WORK     TO EEWEFF OF WS-WORK
                 MOVE MEMEXP OF WS-WORK     TO EEWEXP OF WS-WORK
              END-IF
              PERFORM A550-DATE-CHK              THRU A559-EXIT
              IF DATECOD = 'Y'
                 MOVE 'C'              TO CHGTYP OF EEWDEP(EDPACT)
              ELSE
                 MOVE 'A'              TO CHGTYP OF EEWDEP(EDPACT).
      *
           IF DUPMEM OF EEWHDR-REC = 'Y'
                                                 GO TO A518-NEXT.
      *
           IF FULLUP OF EEWHDR-WRK = 'N'
           AND (CHGTYP OF EEWDEP(EDPACT) = 'A' OR SPACES)
           AND MEM-EXISTS
              MOVE MEMEFF OF EEWDEP(EDPACT) TO EEWEFF OF WS-WORK
              MOVE MEMEXP OF EEWDEP(EDPACT) TO EEWEXP OF WS-WORK
              PERFORM A550-DATE-CHK              THRU A559-EXIT
              IF DATECOD = 'Y'
              AND CHGTYP OF EEWDEP(EDPACT) = 'A'
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02465'                TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                 TO LINE-E
                    MOVE 'EI02465'                TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR      THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER       THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A519-EXIT
                    END-IF
                 END-IF
              END-IF
              IF DATECOD = 'Y'
              AND CHGTYP OF EEWDEP(EDPACT) = SPACES
                 MOVE 'C'              TO CHGTYP OF EEWDEP(EDPACT)
              END-IF
              IF DATECOD NOT = 'Y'
              AND CHGTYP OF EEWDEP(EDPACT) = SPACES
                 MOVE 'A'              TO CHGTYP OF EEWDEP(EDPACT).
       A518-NEXT.
      *
      *‚EXTRA CHECK TO MAKE SURE NO SPACES ARE IN THE CHTGTYP
      *
           IF CHGTYP OF EEWDEP(EDPACT) = SPACES
              IF FULLUP OF EEWHDR-WRK = 'Y' OR 'A'
                 IF MEM-EXISTS
                    MOVE MEMEFF OF EEWDEP(EDPACT) TO EEWEFF OF WS-WORK
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO EEWEXP OF WS-WORK
                    IF  EEWEFF OF WS-WORK = 0
                    AND EEWEXP OF WS-WORK = 0
                       MOVE MEMEFF OF WS-WORK     TO EEWEFF OF WS-WORK
                       MOVE MEMEXP OF WS-WORK     TO EEWEXP OF WS-WORK
                    END-IF
                    PERFORM A550-DATE-CHK              THRU A559-EXIT
                    IF DATECOD = 'Y'
                       MOVE 'C'        TO CHGTYP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'A'        TO CHGTYP OF EEWDEP(EDPACT)
                    END-IF
                 ELSE
                    MOVE 'A'           TO CHGTYP OF EEWDEP(EDPACT)
                 END-IF
              ELSE
              IF FULLUP OF EEWHDR-WRK = 'N'
                 IF MEM-EXISTS
                    MOVE MEMEFF OF EEWDEP(EDPACT) TO EEWEFF OF WS-WORK
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO EEWEXP OF WS-WORK
                    PERFORM A550-DATE-CHK              THRU A559-EXIT
                    IF DATECOD = 'Y'
                       MOVE 'C'        TO CHGTYP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'A'        TO CHGTYP OF EEWDEP(EDPACT)
                    END-IF
                 ELSE
                    MOVE 'A'           TO CHGTYP OF EEWDEP(EDPACT).
      *
           IF (CHGTYP OF EEWDEP(EDPACT) = 'C' OR 'T')
           AND NOT MEM-EXISTS
              IF BYPEDT OF EDIENR-REC = 'Y'
                 MOVE 'Y'                        TO SW-SET-ERROR
              ELSE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02466'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE 'EI02466'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A519-EXIT.
      *
           IF MEMBNO OF EEWDEP(EDPACT) = SPACES
              GO TO A512-NEXT.
      *
           IF  (RELCOD OF EEWDEP(EDPACT) NOT = '3' AND '4' AND '5')
           OR  (CHGTYP OF EEWDEP(EDPACT) NOT = 'A' AND 'C')
              GO TO A516-NEXT.
      *
           MOVE BTHSEQ OF EEWDEP(EDPACT)         TO WS-BTHSEQ
           MOVE BTHDAT OF EEWDEP(EDPACT)         TO WS-BTHDAT
           IF  CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND (BTHCHG OF EEWDEP(EDPACT) NOT = 'Y'
           OR   BTHSEQ OF EEWDEP(EDPACT) = ZEROES)
              PERFORM A870-DEPDEM                THRU A879-EXIT
              IF DEPTMP > ZERO
                 IF BTHCHG OF EEWDEP(EDPACT) NOT = 'Y'
                    MOVE BTHDAT OF DEPTAB(DEPTMP)  TO WS-BTHDAT
                 END-IF
                 IF BTHSEQ OF EEWDEP(EDPACT) = ZEROES
                    MOVE BTHSEQ OF DEPTAB(DEPTMP)  TO WS-BTHSEQ
                 END-IF
              END-IF
           END-IF.
      *
           MOVE 'N'                              TO SW-SEARCH-OK
           PERFORM A1470-SEARCH-EEWDEP           THRU A1479-EXIT
           IF NOT SEARCH-OK
              PERFORM A1480-SEARCH-DEPTAB        THRU A1489-EXIT
           END-IF.
           IF PRCERR OF PGM-WORK = 'Y'
           AND SEARCH-OK
              GO TO A519-EXIT
           END-IF.
      *
       A516-NEXT.
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'A'
              GO TO A517-NEXT.
           IF GRPNUM OF SUB-INFO NOT = SPACES
              GO TO A516B-NEXT.
      *
           INITIALIZE MEMSBS-KEY.
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MEMSBS-REC.
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EXPDAT OF MEMSBS-REC.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              GO TO A516B-NEXT.
       A516A-MEMSBS.
           PERFORM MEMSBS-READNX                 IF INVALID-KEY
              GO TO A516B-NEXT.

           IF SUBSNO OF MEMMAS-REC NOT  = SUBSNO OF EEWDEP(EDPACT) OR
              RELCOD OF MEMMAS-REC NOT = '1'
              GO TO A516B-NEXT.
      *
           IF EFFDAT OF MEMMAS-REC <= MEMEFF OF EEWDEP(EDPACT) AND
              EXPDAT OF MEMMAS-REC >= MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMBNO OF MEMMAS-REC TO SUBSNO OF SUB-INFO
              MOVE EFFDAT OF MEMMAS-REC TO MEMEFF OF SUB-INFO
              MOVE EXPDAT OF MEMMAS-REC TO MEMEXP OF SUB-INFO
              MOVE GRPNUM OF MEMMAS-REC TO GRPNUM OF SUB-INFO
           ELSE
              GO TO A516A-MEMSBS.
      *
       A516B-NEXT.
      ****-----------------------------------------------------------
      ****  CR140155  CBW  Rep
      ****-----------------------------------------------------------
           IF  SUB-ADDED
           AND SUBSNO OF EEWDEP(EDPACT)     = SUBSNO OF SUB-INFO
           AND GRPNUM OF EEWDEP(EDPACT) NOT = GRPNUM OF SUB-INFO
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI02415'                     TO MI-PRIMARY-ID
              MOVE 'GROUP NUMBER'                TO MI-PARM4
              MOVE 'FOR SUBSCRIBER'              TO MI-PARM5
              MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
              MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A519-EXIT
              END-IF.
      *
      *‚CHECK MEMEFF AND MEMEXP
           IF MEMEFF OF EEWDEP(EDPACT) = ZEROES
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MEM EFF DATE'                TO MI-PARM4
              MOVE 'EI02424'                     TO MI-PRIMARY-ID
              MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A519-EXIT
              END-IF.

           IF MEMEXP OF EEWDEP(EDPACT) = ZEROES
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MEM EXP DATE'                TO MI-PARM4
              MOVE 'EI02424'                     TO MI-PRIMARY-ID
              MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
              MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A519-EXIT
              END-IF.
      *
           IF PCPEFF OF EEWDEP(EDPACT) NOT = ZERO
           AND PCPEFF OF EEWDEP(EDPACT) NOT = MEMEFF OF EEWDEP(EDPACT)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO PCPEFF OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'PRIMARY PROVIDER'            TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO PCPEFF OF EEWDEP(EDPACT).
      *
           IF SECEFF OF EEWDEP(EDPACT) NOT = ZERO
           AND SECEFF OF EEWDEP(EDPACT) NOT = MEMEFF OF EEWDEP(EDPACT)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO SECEFF OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'SECONDARY PROVIDER'          TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO SECEFF OF EEWDEP(EDPACT).
      *
           IF MEDEFF OF EEWDEP(EDPACT) NOT = ZERO
           AND MEDEFF OF EEWDEP(EDPACT) NOT = MEMEFF OF EEWDEP(EDPACT)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO MEDEFF OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'MEDICARE'                    TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO MEDEFF OF EEWDEP(EDPACT).
      *
           IF FEEEFF OF EEWDEP(EDPACT) NOT = ZERO
           AND FEEEFF OF EEWDEP(EDPACT) NOT = MEMEFF OF EEWDEP(EDPACT)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO FEEEFF OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'FEE SCHEDULE'                TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO FEEEFF OF EEWDEP(EDPACT).
      *
           IF ENBEFF OF EEWDEP(EDPACT) NOT = ZERO
           AND ENBEFF OF EEWDEP(EDPACT) NOT = MEMEFF OF EEWDEP(EDPACT)
              MOVE MEMEFF OF EEWDEP(EDPACT) TO ENBEFF OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02447'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'ENROLLMENT BILLING'          TO MI-PARM4
              MOVE 'EI02447'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO ENBEFF OF EEWDEP(EDPACT).
      *
           IF PCPEXP OF EEWDEP(EDPACT) NOT = ZERO
           AND PCPEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMEXP OF EEWDEP(EDPACT) TO PCPEXP OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'PRIMARY PROVIDER'            TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO PCPEXP OF EEWDEP(EDPACT).
      *
           IF SECEXP OF EEWDEP(EDPACT) NOT = ZERO
           AND SECEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMEXP OF EEWDEP(EDPACT) TO SECEXP OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'SECONDARY PROVIDER'          TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO SECEXP OF EEWDEP(EDPACT).
      *
           IF MEDEXP OF EEWDEP(EDPACT) NOT = ZERO
           AND MEDEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMEXP OF EEWDEP(EDPACT) TO MEDEXP OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'MEDICARE'                    TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO MEDEXP OF EEWDEP(EDPACT).
      *
           IF FEEEXP OF EEWDEP(EDPACT) NOT = ZERO
           AND FEEEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMEXP OF EEWDEP(EDPACT) TO FEEEXP OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'FEE SCHEDULE'                TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO FEEEXP OF EEWDEP(EDPACT).
      *
           IF ENBEXP OF EEWDEP(EDPACT) NOT = ZERO
           AND ENBEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF EEWDEP(EDPACT)
              MOVE MEMEXP OF EEWDEP(EDPACT) TO ENBEXP OF EEWDEP(EDPACT)
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF WRN-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF WRN-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF WRN-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF WRN-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WRN-LINE
              MOVE 'EI02448'                     TO MSGNUM OF WRN-LINE
              MOVE WRN-LINE                      TO LINE-W
              MOVE 'ENROLLMENT BILLING'          TO MI-PARM4
              MOVE 'EI02448'                     TO MI-PRIMARY-ID
              PERFORM X110-WRNING                THRU X119-EXIT
           ELSE
              MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO ENBEXP OF EEWDEP(EDPACT).
      *
       A517-NEXT.
           IF NOT GROUP-ERROR
              IF INDBIL OF GRPMAS-REC = 'Y'
              AND ACCTNO OF EEWDEP(EDPACT) = SPACES
                 MOVE 'INDBIL'            TO ACCTNO OF EEWDEP(EDPACT).
      *
           IF MESLST = ZEROES
           AND MEMEFF OF SUB-INFO NOT = ZEROES
           AND MEMEXP OF SUB-INFO NOT = ZEROES
              IF MEMEFF OF EEWDEP(EDPACT) < MEMEFF OF SUB-INFO
              OR MEMEXP OF EEWDEP(EDPACT) > MEMEXP OF SUB-INFO
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI02467'               TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    MOVE 'EI02467'               TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO A519-EXIT.
      *
           IF CHGTYP OF EEWDEP(EDPACT) = 'C' OR 'T'
              PERFORM B210-CHECK-FOR-MEM         THRU B219-EXIT
              IF BYPEDT OF EDIENR-REC = 'Y'
              AND ((NOT MEM-MHS-EXISTS) AND MEMADD-MDT-EXISTS)
                 PERFORM B890-DEPCHG-EDITS       THRU B899-EXIT
              ELSE IF MEM-MHS-EXISTS
                 PERFORM A890-DEPCHG-EDITS       THRU A899-EXIT.
      *
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A519-EXIT.
      *
           GO TO A512-NEXT.
       A519-EXIT.
           EXIT.
      *
       A520-FIND-MEMNUM.
      ***************************************************************
      *‚ SEARCH DEMMAS TABLE TO FIND MEMBER NUMBER                  *
      ***************************************************************
           MOVE ZEROES                           TO DEPACT
                                                    NUMCNT.
           MOVE SPACES                           TO MEMBNO-HLD.
      *
       A522-NEXT.
      *
           ADD 1                                 TO DEPACT.
      *
           IF DEPACT > DEPLST
           OR DEPACT > DEPMAX
                                                 GO TO A529-EXIT.
           IF MEMBNO OF DEPTAB(DEPACT) NOT = MEMBNO-HLD
              IF SEXCOD OF DEPTAB(DEPACT) = SEXCOD-SRCH
              AND BTHDAT OF DEPTAB(DEPACT) = BTHDAT-SRCH
                 ADD 1                           TO NUMCNT
                 MOVE MEMBNO OF DEPTAB(DEPACT)   TO MEMBNO-INPUT
                                                    MEMBNO-HLD.
      *
           GO TO A522-NEXT.
       A529-EXIT.
           EXIT.
      *
       A530-GETNUM.
      *************************************************************
      *‚                                                          *
      *************************************************************
           MOVE ZEROES                           TO NUMCNT.
      *
           MOVE SPACES                           TO MEMBNO-HIGH.
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE OLDSUB                 TO SUBSNO OF MEMSBS-KEY.
           MOVE '2'                    TO RELCOD OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
                                                 GO TO A539-EXIT.
      *
       A531-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
                                                 GO TO A539-EXIT.
      *
           IF SUBSNO OF MEMMAS-REC NOT = OLDSUB
              GO TO A539-EXIT.
      *
           IF MEMBNO OF MEMMAS-REC > MEMBNO-HIGH OF WS-WORK
              MOVE MEMBNO OF MEMMAS-REC TO MEMBNO-HIGH OF WS-WORK.
      *
           PERFORM A570-DEPTAB-LOOKUP            THRU A579-EXIT.
      *
           IF DEP-EXISTS
              GO TO A531-NEXT.
      *
           IF DEP-NOTEXISTS
              MOVE MEMSEQ OF MEMMAS-REC TO MEMSEQ OF DEMMAS-KEY
              PERFORM DEMMAS-READ               IF INVALID-KEY
                 NEXT SENTENCE
              ELSE
              IF MEMBNO OF MEMMAS-REC NOT = MEMBNO-SAVE
                 IF BTHDAT-SRCH = BTHDAT OF DEMMAS-REC
                 AND SEXCOD-SRCH = SEXCOD OF DEMMAS-REC
                    ADD 1                        TO NUMCNT
                    MOVE MEMBNO OF MEMMAS-REC    TO MEMBNO-SAVE
                 END-IF
              END-IF.
      *
           GO TO A531-NEXT.
       A539-EXIT.
           EXIT.
      *
       A540-CURSUB.
      ****************************************************************
      *‚                                                             *
      ****************************************************************
           MOVE ZEROES                 TO MEMEFF OF WS-WORK
                                          MEMEXP OF WS-WORK
                                          MESACT
                                          TMPACT.
      *
       A542-NEXT.
           ADD 1                                 TO MESACT.
      *
           IF MEMBNO OF SUBMEM(MESACT) = SPACES  GO TO A549-EXIT.
      *
           IF  MEMBNO OF SUBMEM(MESACT) = MEMBNO OF EEWSUB(ESBACT)
           AND GRPNUM OF SUBMEM(MESACT) = GRPNUM OF EEWSUB(ESBACT)
              IF ((MEMEFF OF SUBMEM(MESACT) > MEMEFF OF WS-WORK
              AND MEMEXP OF SUBMEM(MESACT) > MEMEXP OF WS-WORK)
              OR (MEMEFF OF SUBMEM(MESACT) = MEMEFF OF WS-WORK
              AND MEMEXP OF SUBMEM(MESACT) > MEMEXP OF WS-WORK)
              OR (MEMEFF OF SUBMEM(MESACT) = MEMEFF OF WS-WORK
              AND MEMEXP OF SUBMEM(MESACT) = MEMEXP OF WS-WORK))
              AND (MEMEFF OF SUBMEM(MESACT) NOT =
                                          MEMEXP OF SUBMEM(MESACT))
                 MOVE MESACT                               TO TMPACT
                 IF NAMKEY OF EEWSUB(ESBACT) = SPACES
                    MOVE NAMKEY OF SUBMEM(MESACT) TO
                                       NAMKEY OF EEWSUB(ESBACT)
                 END-IF
                 MOVE MEMEFF OF SUBMEM(MESACT)
                                       TO MEMEFF OF WS-WORK
                 MOVE MEMEXP OF SUBMEM(MESACT)
                                       TO MEMEXP OF WS-WORK.
      *
           GO TO A542-NEXT.
       A549-EXIT.
           EXIT.
      *
       A550-DATE-CHK.
      ****************************************************************
      *‚DATE CHECK ROUTINE                                            *
      ****************************************************************
           IF ENRTYP OF MDTMAS NOT = ' '         GO TO A559-EXIT.
           MOVE SPACES                        TO DATECOD.
           IF  EEWEFF OF WS-WORK = ZERO
           AND EEWEXP OF WS-WORK = ZERO
           AND MEMEFF OF WS-WORK = ZERO
           AND MEMEXP OF WS-WORK = ZERO
              GO TO A559-EXIT.
      *
           IF (EEWEFF OF WS-WORK NOT < MEMEFF OF WS-WORK
           AND EEWEFF OF WS-WORK NOT > MEMEXP OF WS-WORK)
           OR (EEWEXP OF WS-WORK NOT < MEMEFF OF WS-WORK
           AND EEWEXP OF WS-WORK NOT > MEMEXP OF WS-WORK)
           OR (EEWEFF OF WS-WORK     < MEMEFF OF WS-WORK
           AND EEWEXP OF WS-WORK     > MEMEXP OF WS-WORK)
             MOVE 'Y'                         TO DATECOD.
      *
           IF MEMEFF OF WS-WORK > EEWEXP OF WS-WORK
              INITIALIZE DAYS-AREA
              MOVE EEWEXP OF WS-WORK             TO DATFR
              MOVE MEMEFF OF WS-WORK             TO DATTO
              PERFORM 099-SCDAYS
              IF DAYS OF DAYS-AREA = 1
                 MOVE 'Y'                        TO DATECOD.
      *
           IF EEWEFF OF WS-WORK > MEMEXP OF WS-WORK
              INITIALIZE DAYS-AREA
              MOVE MEMEXP OF WS-WORK             TO DATFR
              MOVE EEWEFF OF WS-WORK             TO DATTO
              PERFORM 099-SCDAYS
              IF DAYS OF DAYS-AREA = 1
                 MOVE 'Y'                        TO DATECOD.
       A559-EXIT.
           EXIT.
      *
       A560-CURDEP.
      ****************************************************************
      *‚GET MOST CURRENT MEMMMAS RECORD FOR EACH DEP AS PROCESSED
      ****************************************************************
           MOVE SPACES                           TO EXIST-FLAG.
      *
       A561-NEXT.
           MOVE ZEROES                 TO MEMEFF OF WS-WORK
                                          MEMEXP OF WS-WORK
                                          MEMACT
                                          MEMTMP.
      *
       A562-NEXT.
           IF MEMACT NOT < MEMLST
              GO TO A569-EXIT.
      *
           ADD 1                                 TO MEMACT.
      *
           IF MEMBNO OF MEMTAB(MEMACT) = SPACES
              GO TO A569-EXIT.
      *
           IF  MEMBNO OF MEMTAB(MEMACT) = MEMBNO OF EEWDEP(EDPACT)
           AND GRPNUM OF MEMTAB(MEMACT) = GRPNUM OF EEWDEP(EDPACT)
              IF ((MEMEFF OF MEMTAB(MEMACT) > MEMEFF OF WS-WORK
              AND MEMEXP OF MEMTAB(MEMACT) > MEMEXP OF WS-WORK)
              OR (MEMEFF OF MEMTAB(MEMACT) = MEMEFF OF WS-WORK
              AND MEMEXP OF MEMTAB(MEMACT) > MEMEXP OF WS-WORK)
              OR (MEMEFF OF MEMTAB(MEMACT) = MEMEFF OF WS-WORK
              AND MEMEXP OF MEMTAB(MEMACT) = MEMEXP OF WS-WORK))
              AND (MEMEFF OF MEMTAB(MEMACT) NOT =
                                       MEMEXP OF MEMTAB(MEMACT))
                 MOVE 'Y'                           TO EXIST-FLAG
                 IF NAMKEY OF EEWDEP(EDPACT) = SPACES
                    MOVE NAMKEY OF MEMTAB(MEMACT)
                                       TO NAMKEY OF EEWDEP(EDPACT)
                 END-IF
                 MOVE MEMACT                               TO MEMTMP
                 MOVE MEMEFF OF MEMTAB(MEMACT) TO MEMEFF OF WS-WORK
                 MOVE MEMEXP OF MEMTAB(MEMACT) TO MEMEXP OF WS-WORK.
      *
           GO TO A562-NEXT.
       A569-EXIT.
           EXIT.
      *
       A570-DEPTAB-LOOKUP.
      ***************************************************************
      *‚                                                            *
      ***************************************************************
           MOVE 'N'                              TO DEP-EXIST-FLAG.
           MOVE ZEROES                           TO DEPACT.
       A571-NEXT.
           IF DEPACT NOT < DEPLST
           OR DEPACT NOT < DEPMAX
              GO TO A579-EXIT.
      *
           ADD 1                                 TO DEPACT.
      *
           IF MEMBNO OF DEPTAB(DEPACT) = MEMBNO OF MEMMAS-REC
              MOVE 'Y'                   TO DEP-EXIST-FLAG
              GO TO A579-EXIT.
      *
           GO TO A571-NEXT.
       A579-EXIT.
           EXIT.
      *
       A580-GENNUM.
      **************************************************************
      *‚                                                           *
      **************************************************************
           MOVE SPACES                           TO SUB-FLAG.
           MOVE SPACES                           TO MHSMAS-REC.
           MOVE 'C'                    TO RECTYP OF MHSMAS-KEY.
           MOVE COMPNO OF GRPMAS-REC   TO COMPNO OF MHSMAS-KEY.
           PERFORM MHSMAS-READ                   IF INVALID-KEY
              MOVE COMPNO OF GRPMAS-REC
                                       TO FIELDV OF ERR-LINE
              MOVE 'EI02414'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE            TO LINE-E
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE 'COMPANY NUMBER'              TO MI-PARM4
              MOVE 'EI02414'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A589-EXIT.
      *
           IF MEMSIZ OF MHSCNT-REC = ZERO
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF ERR-LINE
              MOVE 'EI02464'                     TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI02464'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              GO TO A589-EXIT.
      *
           IF MEMSUF OF MHSCNT-REC = 'Z' OR 'O'
              COMPUTE INDX = MEMSIZ OF MHSCNT-REC + 2
              IF INDX > MEMBNO-MAX
      *‚CAN'T GENERATE BECAUSE WRONG SIZE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02464'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02464'                  TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A589-EXIT.
      *
           IF MEMSUF OF MHSCNT-REC NOT = 'Z' AND 'O'
      *‚NO SUFFIX ASSIGNED SO CAN'T GEN MEMNUM
              MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE GRPNUM OF EEWDEP(EDPACT)      TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(EDPACT)      TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(EDPACT)      TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF EEWDEP(EDPACT)      TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF ERR-LINE
              MOVE 'EI02480'                     TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI02480'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              PERFORM A910-ERR-MEMBER            THRU A919-EXIT
              GO TO A589-EXIT.
      *
           IF MEMBNO-HIGH = SPACES
           OR OLDSUB = MEMBNO-HIGH
              MOVE 'Y'                           TO SUB-FLAG
              MOVE OLDSUB                        TO MEMBNO-HIGH.

           MOVE MEMBNO-HIGH                      TO MEMBNO-TBL.
           IF EXCHNG OF EEWDP2(EDPACT) = 'ES'
              MOVE ZERO TO GENSAV
              PERFORM B590-EXT-SUFFIX            THRU B599-EXIT
              VARYING INDX FROM 1 BY 1        UNTIL INDX > MEMBNO-MAX
           ELSE
              PERFORM A590-EXT-SUFFIX            THRU A599-EXIT
              VARYING INDX FROM 1 BY 1        UNTIL INDX > MEMBNO-MAX.
      *
           IF MEMSUF-9 NOT NUMERIC
              IF SUB-NUMBER
                 IF MEMSUF OF MHSCNT-REC = 'Z'
                    MOVE ZEROES                  TO MEMSUF-9
                 END-IF
                 IF MEMSUF OF MHSCNT-REC = 'O'
                    MOVE 01                      TO MEMSUF-9
                 END-IF
              ELSE
                 MOVE SPACES            TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'               TO FAMILY-FLAG
                 MOVE 'EI02474'         TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A589-EXIT.
      *
       A587-NEXT.
           ADD 1                       TO MEMSUF-9.
      *
           IF EXCHNG OF EEWDP2(EDPACT) = 'ES'
              MOVE MEMSUF-X(1) TO MEMBNO-TAB(GENSAV + 1)
              MOVE MEMSUF-X(2) TO MEMBNO-TAB(GENSAV + 2)
           ELSE
              MOVE MEMSUF-X(1) TO MEMBNO-TAB(MEMSIZ OF MHSCNT-REC + 1)
              MOVE MEMSUF-X(2) TO MEMBNO-TAB(MEMSIZ OF MHSCNT-REC + 2).
      *
           SET EEWINX TO 1.
           SEARCH EEWDEP               AT END   GO TO A588-END
           WHEN MEMBNO-TBL EQUAL TO MEMBNO OF EEWDEP(EEWINX)
              GO TO A587-NEXT.
      *
       A588-END.
           MOVE MEMBNO-TBL             TO MEMBNO OF EEWDEP(EDPACT).
      ****------------------------------------------------------****
      **** CR138302 CXB   FIX   REP# CR139264                   ****
      ****------------------------------------------------------****
           MOVE SPACES                           TO MEMMAS-KEY.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MEMMAS-KEY.
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MEMMAS-KEY.
           MOVE ZEROES                   TO TRNSEQ OF MEMMAS-KEY.
           PERFORM MEMMAS-STARTGE                IF INVALID-KEY
                                                 GO TO A589-EXIT.
      *
       A588-NEXT.
           PERFORM MEMMAS-READNX                 IF AT-END
                                                 GO TO A589-EXIT.
      *
           IF MEMBNO OF MEMMAS-REC = MEMBNO OF EEWDEP(EDPACT)
              GO TO A587-NEXT.
      *
       A589-EXIT.
           EXIT.
      *
       A590-EXT-SUFFIX.
      ***************************************************************
      *‚                                                            *
      ***************************************************************
           IF INDX > MEMSIZ OF MHSCNT-REC
              MOVE MEMBNO-TAB(INDX)    TO MEMSUF-X(1)
              IF INDX < 15
                 MOVE MEMBNO-TAB(INDX + 1) TO MEMSUF-X(2)
              END-IF
              MOVE 15                  TO INDX.
       A599-EXIT.
           EXIT.
      *
       A600-LOAD-MDTMAS.
      **************************************************************
      *‚MOVE EEWMAS DATA TO MHS FOR PROOF AND POST                 *
      *‚CREATE ME1021 SERIES BATCHES
      **************************************************************
           IF FIRST-MBH
              PERFORM A700-MBHMAS                THRU A709-EXIT.
      *
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A609-EXIT.
      *
           IF NOT OK                             GO TO A609-EXIT.
      *
           IF BYPEDT OF EDIENR-REC = 'Y'
‚             IF IN-DEBUG
 ‚               DISPLAY '@@ C600-MDT - PROCESS IN ENTRY ORDER'
  ‚           END-IF
              PERFORM C600-MDT                   THRU C609-EXIT
           ELSE
‚             IF IN-DEBUG
‚                DISPLAY '@@ C610-SUB-MDT - PROCESS ALL SUB REC FIRST'
‚             END-IF
              PERFORM A610-SUB-MDT               THRU A619-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A609-EXIT
              END-IF
‚             IF IN-DEBUG
‚                DISPLAY '@@ C620-MEM-MDT - PROCESS ALL DEP REC SECOND'
‚             END-IF
              PERFORM A620-MEM-MDT               THRU A629-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A609-EXIT
              END-IF
           END-IF.
      *
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MBHMAS-KEY.
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MBHMAS-KEY.
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MBHMAS-KEY.
           PERFORM MBHMAS-READ                   IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06063'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO A609-EXIT.
      *
           MOVE TIRHLD OF WS-WORK      TO TIRFLG OF MBHMAS-REC.
           MOVE SPACE                  TO TIRHLD OF WS-WORK.
      *
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MBHMAS-REC.
      *
           PERFORM MBHMAS-REWRITE                IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06064'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO A609-EXIT.
      *
       A609-EXIT.
           EXIT.
      *
       A610-SUB-MDT.
      **************************************************************
      *‚                                                           *
      **************************************************************
           MOVE SPACES                 TO SW-SUBADD-FLAG.
           MOVE ZEROES                           TO ESBACT.
           MOVE ZEROES                 TO LINENO OF WS-WORK.
      *
       A612-NEXT.
           IF ESBACT NOT < ESBLST                GO TO A619-EXIT.
      *
           ADD 1                                 TO ESBACT.
           IF SEQNUM OF WS-WORK < CTLDOC OF WS-WORK
           AND SEQ-USED
              ADD +1                   TO SEQNUM OF WS-WORK.

           IF SEQNUM OF MBHMAS-REC NOT < CTLDOC OF WS-WORK
              PERFORM A720-OLDBAT                THRU A729-EXIT
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A619-EXIT
              END-IF
              PERFORM A710-BATSEQ                THRU A719-EXIT
              PERFORM A730-INTMBH                THRU A739-EXIT
              MOVE +1                  TO SEQNUM OF MBHMAS-REC
                                          SEQNUM OF WS-WORK
  ‚           IF IN-DEBUG
  ‚              DISPLAY '@@ MBHMAS WRITE (1)'
  ‚              DISPLAY '@@ MBHMAS-KEY - '
  ‚                      'BRANCD ('
   ‚                      BRANCD OF MBHMAS-REC
   ‚                     ') BATDAT ('
   ‚                      BATDAT OF MBHMAS-REC
   ‚                     ') BATSEQ ('
   ‚                      BATSEQ OF MBHMAS-REC
   ‚                     ') SEQNUM ('
   ‚                      SEQNUM OF MBHMAS-REC
‚                        ')'
   ‚          END-IF
              PERFORM MBHMAS-WRITE               IF INVALID-KEY
     ‚           IF IN-DEBUG
     ‚              DISPLAY '@@ MBHMAS WRITE FAILURE '
     ‚              DISPLAY '@@ MBHMAS-STATUS ('
‚                            MBHMAS-STATUS
‚                END-IF
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'MBHMAS'                   TO MI-PARM4
                 MOVE MBHMAS-STATUS              TO MI-PARM5
                 MOVE 'EI06062'                  TO MI-PRIMARY-ID
                 MOVE 'Y'                        TO PRCERR OF PGM-WORK
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 GO TO A619-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR142605  CXB  Fix                                    ****
      ****--------------------------------------------------------****
           IF LICENSE-FOR-125573
           AND PREUPD OF CMPANY-REC = 'Y'
           AND STATCD OF PEMMAS-REC = '4'
           AND (EFFDAT OF PEMMAS-REC >= CHGEFF OF EEWSUB(ESBACT)
           AND EXPDAT OF PEMMAS-REC <= CHGEFF OF EEWSUB(ESBACT))
           AND WS-DT3-CHGTYP = 'C'
              MOVE 1                   TO LINENO OF WS-WORK
              MOVE 'A'                           TO WS-CNFCOD-FLG
              PERFORM A630-ME1022-SUB            THRU A639-EXIT
              MOVE SPACES                        TO WS-CNFCOD-FLG
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A619-EXIT
              END-IF
              MOVE 'Y'                           TO SW-SUBADD-FLAG
              MOVE SEQNUM OF WS-WORK             TO SEQNUM OF SUB-INFO
              MOVE SEQNUM OF WS-WORK   TO SEQNM2 OF WS-WORK
                                                 GO TO A615-CONTINUE.
      *
           IF CHGTYP OF EEWSUB(ESBACT) = 'A' OR SPACES
              MOVE 1                   TO LINENO OF WS-WORK
              MOVE 'A'                           TO WS-CNFCOD-FLG
              PERFORM A630-ME1022-SUB            THRU A639-EXIT
              MOVE SPACES                        TO WS-CNFCOD-FLG
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A619-EXIT
              END-IF
              MOVE 'Y'                           TO SW-SUBADD-FLAG
              MOVE SEQNUM OF WS-WORK             TO SEQNUM OF SUB-INFO
              MOVE SEQNUM OF WS-WORK   TO SEQNM2 OF WS-WORK
           ELSE
              IF CHGTYP OF EEWSUB(ESBACT) = 'C' OR 'T'
      *
      **‚Scan MDTMAS to check for subscriber.
      **‚If record found in MDTMAS, load SUBMDT in this routine.
      *
                 PERFORM B100-CHECK-FOR-SUB      THRU B109-EXIT
                 IF SUBADD-MDT-EXISTS
                 AND BYPEDT OF EDIENR-REC = 'Y'
                    PERFORM B640-ME1023-SUBCHG   THRU B649-EXIT
                 ELSE IF SUB-MHS-EXISTS
                 OR EXCSUB-FOUND
                    MOVE 'C'                     TO WS-CNFCOD-FLG
                    PERFORM A640-ME1023-SUBCHG   THRU A649-EXIT
                    MOVE SPACES                  TO WS-CNFCOD-FLG
                 ELSE
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI00302'                TO MSGNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO MI-PARM4
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MI-PARM5
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO MI-PARM6
                    MOVE PRCDAT OF EEWHDR-WRK    TO TARDAT
                    PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                    MOVE CNVDAT                  TO DATYMDN
                    MOVE CORR DATYMD             TO DATMDY
                    MOVE DATMDY                  TO MI-PARM7
                    MOVE 'EI00302'               TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    GO TO A619-EXIT.
      *
       A615-CONTINUE.
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A619-EXIT.
      *
           IF SEQNUM OF MDTMAS-REC NUMERIC
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF MBHMAS-REC.
      *
           IF SUBSNO OF MDTMAS-REC = SUBSNO OF SUB-INFO
              MOVE 'Y'                           TO CHGSUB-FLAG.
      *
           IF TIRFLG OF MDTMAS-REC = 'Y'
              MOVE TIRFLG OF MDTMAS-REC TO TIRHLD OF WS-WORK
              MOVE TIRFLG OF MDTMAS-REC TO TIRFLG OF MBHMAS-REC.
      *
           PERFORM MBHMAS-REWRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06064'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A619-EXIT.
      *
           MOVE 'N'                              TO FIRSTREC-FLAG.
      *
           GO TO A612-NEXT.
       A619-EXIT.
           EXIT.
      *
       A620-MEM-MDT.
      **************************************************************
      *‚CREATE DEP RECORDS                                         *
      **************************************************************
           MOVE ZEROES                           TO EDPACT.
       A622-NEXT.
           IF EDPACT NOT < EDPLST                GO TO A629-EXIT.
      *
           ADD 1                                 TO EDPACT.
      *
           PERFORM A740-INTMDT                   THRU A749-EXIT.
      *
           IF NOT SUB-ADDED
           AND SEQNUM OF WS-WORK < CTLDOC OF WS-WORK
           AND SEQ-USED
              ADD +1                TO SEQNUM OF WS-WORK.

           IF NOT SUB-ADDED
           AND SEQNUM OF WS-WORK NOT < CTLDOC OF WS-WORK
              PERFORM A720-OLDBAT             THRU A729-EXIT
              PERFORM A710-BATSEQ             THRU A719-EXIT
              PERFORM A730-INTMBH             THRU A739-EXIT
              MOVE +1               TO SEQNUM OF MBHMAS-REC
                                       SEQNUM OF WS-WORK
  ‚           IF IN-DEBUG
  ‚              DISPLAY '@@ MBHMAS WRITE (2)'
  ‚              DISPLAY '@@ MBHMAS-KEY - '
  ‚                      'BRANCD ('
   ‚                      BRANCD OF MBHMAS-REC
   ‚                     ') BATDAT ('
   ‚                      BATDAT OF MBHMAS-REC
   ‚                     ') BATSEQ ('
   ‚                      BATSEQ OF MBHMAS-REC
   ‚                     ') SEQNUM ('
   ‚                      SEQNUM OF MBHMAS-REC
 ‚                       ')'
   ‚          END-IF
              PERFORM MBHMAS-WRITE               IF INVALID-KEY
     ‚           IF IN-DEBUG
     ‚              DISPLAY '@@ MBHMAS WRITE FAILURE '
     ‚              DISPLAY '@@ MBHMAS-STATUS ('
‚                            MBHMAS-STATUS
‚                END-IF
                 MOVE 'Y'                     TO PRCERR
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'MBHMAS'                TO MI-PARM4
                 MOVE MBHMAS-STATUS           TO MI-PARM5
                 MOVE 'EI06062'               TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 GO TO A629-EXIT
              END-IF
           END-IF.

           IF  SUB-ADDED
           AND SUBSNO OF EEWDEP(EDPACT) = SUBSNO OF SUB-INFO
           AND CHGTYP OF EEWDEP(EDPACT) = 'A' OR SPACES
              ADD 1                    TO LINENO OF WS-WORK
              IF ADD-CHG-SAME
                 MOVE SEQNUM OF WS-WORK
                                       TO SEQNM2 OF WS-WORK
                 MOVE SEQNUM OF SUB-INFO
                                       TO SEQNUM OF WS-WORK
              END-IF
              PERFORM A650-ME1022-DEP            THRU A659-EXIT
              IF ADD-CHG-SAME
                 MOVE SEQNM2 OF WS-WORK
                                       TO SEQNUM OF WS-WORK
              END-IF
              IF PRCERR OF PGM-WORK = 'Y'
                 GO TO A629-EXIT
              END-IF
           ELSE
              MOVE SPACES                        TO SW-SUBADD-FLAG
              IF CHGTYP OF EEWDEP(EDPACT) = 'A'
                 PERFORM A660-ME1023-DEPADD      THRU A669-EXIT
              ELSE IF (CHGTYP OF EEWDEP(EDPACT) = 'C'
              OR CHGTYP OF EEWDEP(EDPACT) = 'T')
                 PERFORM B110-CHECK-FOR-MEM      THRU B119-EXIT
                 IF MEMADD-MDT-EXISTS
                    PERFORM B680-ME1023-DEPCHG   THRU B689-EXIT
                 ELSE
                 IF MEM-MHS-EXISTS
                 OR EXCSUB-FOUND
                    PERFORM A680-ME1023-DEPCHG   THRU A689-EXIT
                 ELSE
                    MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE 'EI00302'                TO MSGNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO MI-PARM4
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MI-PARM5
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO MI-PARM6
                    MOVE PRCDAT OF EEWHDR-WRK    TO TARDAT
                    PERFORM A930-CONVERT-DATE    THRU A939-EXIT
                    MOVE CNVDAT                  TO DATYMDN
                    MOVE CORR DATYMD             TO DATMDY
                    MOVE DATMDY                  TO MI-PARM7
                    MOVE 'EI00302'               TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    GO TO A629-EXIT.
      *
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A629-EXIT.
      *
           IF SEQNUM OF MDTMAS-REC NUMERIC
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF MBHMAS-REC.
      *
           PERFORM MBHMAS-REWRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06064'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              GO TO A629-EXIT.
      *
           MOVE 'N'                              TO FIRSTREC-FLAG.
      *
           GO TO A622-NEXT.
       A629-EXIT.
           EXIT.
      *
       A630-ME1022-SUB.
      **************************************************************
      *‚ADD SUBSCRIBER RECORD RECTYP '2'                           *
      **************************************************************
           PERFORM A740-INTMDT                   THRU A749-EXIT.
      *
           MOVE '2'                      TO RECTYP OF MDTMAS-REC.
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTMAS-REC.
           MOVE LINENO OF WS-WORK        TO LINENO OF MDTMAS-REC.
           MOVE 'A'                      TO CHGTYP OF MDTMAS-REC.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTMAS-REC.
           MOVE RELTYP OF EEWSUB(ESBACT) TO RELTYP OF MDTMAS-REC.
           MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF MDTMAS-REC.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTMAS-REC.
           MOVE NAMKEY OF EEWSUB(ESBACT) TO NAMKEY OF MDTMAS-REC.
           MOVE TITLCD OF EEWSUB(ESBACT) TO TITLCD OF MDTMAS-REC.
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF MDTMAS-REC.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTMAS-REC.
           MOVE MEMEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTMAS-REC.
           MOVE MEMEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTMAS-REC.
           MOVE MEMREA OF EEWSUB(ESBACT) TO REASCD OF MDTMAS-REC.
           MOVE EMPSTA OF EEWSUB(ESBACT) TO EMPSTA OF MDTMAS-REC.
           IF PRTCOD OF EEWSUB(ESBACT) NOT  = SPACES
              MOVE PRTCOD OF EEWSUB(ESBACT) TO PRTCOD OF MDTMAS-REC
           ELSE
              MOVE 'D'                   TO PRTCOD OF MDTMAS-REC.
           MOVE CRDCNT OF EEWSUB(ESBACT) TO CRDCNT OF MDTMAS-REC.
           MOVE HIRDAT OF EEWSUB(ESBACT) TO HIRDAT OF MDTMAS-REC.
           MOVE TRMDAT OF EEWSUB(ESBACT) TO TRMDAT OF MDTMAS-REC.
           MOVE EECOVR OF EEWSUB(ESBACT) TO EECOVR OF MDTMAS-REC.
           MOVE MMCEXC OF EEWSUB(ESBACT) TO MMCEXC OF MDTMAS-REC.
           MOVE MHCIND OF EEWSUB(ESBACT) TO MHCIND OF MDTMAS-REC.
           MOVE OMEDAT OF EEWSUB(ESBACT) TO OMEDAT OF MDTMAS-REC.
           MOVE CRDMTH OF EEWSUB(ESBACT) TO CRDMTH OF MDTMAS-REC.
           MOVE TYPCOD OF EEWSUB(ESBACT) TO TYPCOD OF MDTMAS-REC.
           MOVE ADRLN1 OF EEWSUB(ESBACT) TO ADRLN1 OF MDTMAS-REC.
           MOVE ADRLN2 OF EEWSUB(ESBACT) TO ADRLN2 OF MDTMAS-REC.
           MOVE CITYCD OF EEWSUB(ESBACT) TO CITYCD OF MDTMAS-REC.
           MOVE STACOD OF EEWSUB(ESBACT) TO STACOD OF MDTMAS-REC.
           MOVE ZIPCOD OF EEWSUB(ESBACT) TO ZIPCOD OF MDTMAS-REC.
           MOVE CTRYCD OF EEWSUB(ESBACT) TO CTRYCD OF MDTMAS-REC.
           MOVE LOCQLF OF EEWSUB(ESBACT) TO LOCQLF OF MDTMAS-REC.
           MOVE AREACD OF EEWSUB(ESBACT) TO AREACD OF MDTMAS-REC.
           MOVE HOMPH1 OF EEWSUB(ESBACT) TO HOMPH1 OF MDTMAS-REC.
           MOVE HOMPH2 OF EEWSUB(ESBACT) TO HOMPH2 OF MDTMAS-REC.
           MOVE HOMPH3 OF EEWSUB(ESBACT) TO HOMPH3 OF MDTMAS-REC.
           MOVE WRKPH1 OF EEWSUB(ESBACT) TO WRKPH1 OF MDTMAS-REC.
           MOVE WRKPH2 OF EEWSUB(ESBACT) TO WRKPH2 OF MDTMAS-REC.
           MOVE WRKPH3 OF EEWSUB(ESBACT) TO WRKPH3 OF MDTMAS-REC.
           MOVE WRKEXT OF EEWSUB(ESBACT) TO WRKEXT OF MDTMAS-REC.
           MOVE FAXNUM OF EEWSUB(ESBACT) TO FAXNUM OF MDTMAS-REC.
           MOVE OTHPHN OF EEWSUB(ESBACT) TO OTHPHN OF MDTMAS-REC.
           IF EMLIND OF EEWSUB(ESBACT) = SPACES
              MOVE 'N'                      TO EMLIND OF MDTMAS-REC
           ELSE
              MOVE EMLIND OF EEWSUB(ESBACT) TO EMLIND OF MDTMAS-REC.
           MOVE ELMAIL OF EEWSUB(ESBACT) TO ELMAIL OF MDTMAS-REC.
           MOVE SOCSEC OF EEWSUB(ESBACT) TO SOCSEC OF MDTMAS-REC.
           MOVE BTHDAT OF EEWSUB(ESBACT) TO BTHDAT OF MDTMAS-REC.
           MOVE BTHSEQ OF EEWSUB(ESBACT) TO BTHSEQ OF MDTMAS-REC.
           MOVE SEXCOD OF EEWSUB(ESBACT) TO SEXCOD OF MDTMAS-REC.
           MOVE RACECD OF EEWSUB(ESBACT) TO RACECD OF MDTMAS-REC.
           MOVE MEMSTA OF EEWSUB(ESBACT) TO MEMSTA OF MDTMAS-REC.
           MOVE STUSTA OF EEWSUB(ESBACT) TO STUSTA OF MDTMAS-REC.
           MOVE HNDIND OF EEWSUB(ESBACT) TO HNDIND OF MDTMAS-REC.
           MOVE EDUBEG OF EEWSUB(ESBACT) TO EDUBEG OF MDTMAS-REC.
           MOVE EDUEND OF EEWSUB(ESBACT) TO EDUEND OF MDTMAS-REC.
           MOVE MARSTA OF EEWSUB(ESBACT) TO MARSTA OF MDTMAS-REC.
           MOVE ALTNUM OF EEWSUB(ESBACT) TO ALTNUM OF MDTMAS-REC.
           MOVE COBDAT OF EEWSUB(ESBACT) TO COBDAT OF MDTMAS-REC.
           MOVE AUTEXP OF EEWSUB(ESBACT) TO AUTEXP OF MDTMAS-REC.
           MOVE PEBTFS OF EEWSUB(ESBACT) TO PEBTFS OF MDTMAS-REC.
           MOVE ACCTNO OF EEWSUB(ESBACT) TO ACCTNO OF MDTMAS-REC.
           MOVE '1'                      TO STATCD OF MDTMAS-REC.
           MOVE INTKCD OF EEWSUB(ESBACT) TO INTKCD OF MDTMAS-REC.
           MOVE SSNXRF OF EEWSUB(ESBACT) TO SSNXRF OF MDTMAS-REC.
           MOVE HICNNO OF EEWSUB(ESBACT) TO HICNNO OF MDTMAS-REC.
           MOVE WRKLOC OF EEWSUB(ESBACT) TO WRKLOC OF MDTMAS-REC.
           MOVE PAYLOC OF EEWSUB(ESBACT) TO PAYLOC OF MDTMAS-REC.
           MOVE PAYNUM OF EEWSUB(ESBACT) TO PAYNUM OF MDTMAS-REC.
           MOVE CPAIND OF EEWSUB(ESBACT) TO CPAIND OF MDTMAS-REC
           MOVE MMDIND OF EEWSUB(ESBACT) TO MMDIND OF MDTMAS-REC.
           MOVE MMCIND OF EEWSUB(ESBACT) TO MMCIND OF MDTMAS-REC.
           MOVE CQLECD OF EEWSUB(ESBACT) TO CQLECD OF MDTMAS-REC.
           MOVE COBRAQ OF EEWSUB(ESBACT) TO COBRAQ OF MDTMAS-REC.
           MOVE COBRAB OF EEWSUB(ESBACT) TO COBRAB OF MDTMAS-REC.
           MOVE COBRAE OF EEWSUB(ESBACT) TO COBRAE OF MDTMAS-REC.
           MOVE EMSTCD OF EEWSUB(ESBACT) TO EMSTCD OF MDTMAS-REC.
           MOVE DETDAT OF EEWSUB(ESBACT) TO DETDAT OF MDTMAS-REC.
           IF EXTIND OF EEWSB2(ESBACT) = SPACES
              MOVE 'N'                      TO EXTIND OF MDTMAS-REC
           ELSE
              MOVE EXTIND OF EEWSB2(ESBACT) TO EXTIND OF MDTMAS-REC.
           IF RSPIND OF EEWSB2(ESBACT) = SPACES
              MOVE 'N'                      TO RSPIND OF MDTMAS-REC
           ELSE
              MOVE RSPIND OF EEWSB2(ESBACT) TO RSPIND OF MDTMAS-REC.
           IF BENIND OF EEWSB2(ESBACT) = SPACES
              MOVE 'N'                 TO BENIND OF MDTMAS-REC
           ELSE
              MOVE BENIND OF EEWSB2(ESBACT) TO BENIND OF MDTMAS-REC.
           IF ALTIND OF EEWSB2(ESBACT) = SPACES
              MOVE 'N'                      TO ALTIND OF MDTMAS-REC
           ELSE
              MOVE ALTIND OF EEWSB2(ESBACT) TO ALTIND OF MDTMAS-REC.
           MOVE TIERCD OF EEWSUB(ESBACT) TO TIERCD OF MDTMAS-REC(01).
           MOVE TIRFLG OF EEWSUB(ESBACT) TO TIRFLG OF MDTMAS-REC.
           MOVE BENPKG OF EEWSUB(ESBACT) TO BENPKG OF MDTMAS-REC.
           MOVE BILEXC OF EEWSUB(ESBACT) TO BILEXC OF MDTMAS-REC.
           MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1 OF MDTMAS-REC.
           MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2 OF MDTMAS-REC.
           MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3 OF MDTMAS-REC.
           MOVE ACCTN2 OF EEWSUB(ESBACT) TO ACCTN2 OF MDTMAS-REC.
           MOVE PKGOVR OF EEWSUB(ESBACT) TO PKGOVR OF MDTMAS-REC.
           MOVE BILMOD OF EEWSUB(ESBACT) TO BILMOD OF MDTMAS-REC.
           MOVE BEGMTH OF EEWSUB(ESBACT) TO BEGMTH OF MDTMAS-REC.
           MOVE IMDBIL OF EEWSUB(ESBACT) TO IMDBIL OF MDTMAS-REC.
           MOVE INTBIL OF EEWSUB(ESBACT) TO INTBIL OF MDTMAS-REC.
           MOVE BILCYC OF EEWSUB(ESBACT) TO BILCYC OF MDTMAS-REC.
           MOVE PCPORG OF EEWSUB(ESBACT) TO PRVORG OF MDTMAS-REC.
           MOVE PCPCOD OF EEWSUB(ESBACT) TO PROVNO OF MDTMAS-REC.
           MOVE PCPOVR OF EEWSUB(ESBACT) TO PCPOVR OF MDTMAS-REC.
           MOVE PCPMCP OF EEWSUB(ESBACT) TO PCPMCP OF MDTMAS-REC.
           MOVE SECORG OF EEWSUB(ESBACT) TO SECORG OF MDTMAS-REC.
           MOVE SECCOD OF EEWSUB(ESBACT) TO SECPRV OF MDTMAS-REC.
           MOVE SECOVR OF EEWSUB(ESBACT) TO SECOVR OF MDTMAS-REC.
           MOVE SECMCP OF EEWSUB(ESBACT) TO SECMCP OF MDTMAS-REC.
           MOVE FEECOD OF EEWSUB(ESBACT) TO FEECOD OF MDTMAS-REC.
           MOVE MEDCTY OF EEWSUB(ESBACT) TO MEDCTY OF MDTMAS-REC.
           MOVE MEDSTS OF EEWSUB(ESBACT) TO MEDSTS OF MDTMAS-REC.
           MOVE HOLDCD OF EEWSUB(ESBACT) TO HOLDCD OF MDTMAS-REC.
           MOVE PRICOD OF EEWSUB(ESBACT)           TO DECWRK.
           PERFORM 099-INT                         IF DEC-ERROR
              NEXT SENTENCE
           ELSE
              MOVE DECINT                TO PRICOD OF MDTMAS-REC.
           MOVE OTHINS OF EEWSUB(ESBACT) TO OTHINS OF MDTMAS-REC.
           MOVE MEMNUM OF EEWSUB(ESBACT) TO MEMNUM OF MDTMAS-REC.
           MOVE GRPPOL OF EEWSUB(ESBACT) TO GRPPOL OF MDTMAS-REC.
           MOVE OINNUM OF EEWSUB(ESBACT) TO OINNUM OF MDTMAS-REC.
           MOVE OINNAM OF EEWSUB(ESBACT) TO OINNAM OF MDTMAS-REC.
           IF MEDCOV OF EEWSUB(ESBACT) = SPACES
              MOVE 'N'                   TO MEDCOV OF MDTMAS-REC
           ELSE
              MOVE MEDCOV OF EEWSUB(ESBACT) TO MEDCOV OF MDTMAS-REC.
           IF DENCOV OF EEWSUB(ESBACT) = SPACES
              MOVE 'N'                   TO DENCOV OF MDTMAS-REC
           ELSE
              MOVE DENCOV OF EEWSUB(ESBACT) TO DENCOV OF MDTMAS-REC.

           MOVE COVEFF OF EEWSUB(ESBACT) TO COVEFF OF MDTMAS-REC.
           MOVE COVEXP OF EEWSUB(ESBACT) TO COVEXP OF MDTMAS-REC.
           MOVE EXTSUB OF EEWSUB(ESBACT) TO EXTSUB OF MDTMAS-REC.
           MOVE EXTGRP OF EEWSUB(ESBACT) TO EXTGRP OF MDTMAS-REC.
           MOVE EXTEFF OF EEWSUB(ESBACT) TO EXTEFF OF MDTMAS-REC.
           MOVE EXTEXP OF EEWSUB(ESBACT) TO EXTEXP OF MDTMAS-REC.
           MOVE EXTMEM OF EEWSUB(ESBACT) TO EXTMEM OF MDTMAS-REC.
           MOVE EXTCON OF EEWSUB(ESBACT) TO EXTCON OF MDTMAS-REC.
           MOVE HISSEQ OF EEWSUB(ESBACT) TO HISSEQ OF MDTMAS-REC.
           MOVE CTLPLN OF EEWSUB(ESBACT) TO CTLPLN OF MDTMAS-REC.
           MOVE EXTREL OF EEWSUB(ESBACT) TO EXTREL OF MDTMAS-REC.
           MOVE PRVPLN OF EEWSUB(ESBACT) TO PRVPLN OF MDTMAS-REC.
           MOVE PRVNET OF EEWSUB(ESBACT) TO PRVNET OF MDTMAS-REC.
           MOVE PROCOD OF EEWSUB(ESBACT) TO PROCOD OF MDTMAS-REC.
           MOVE SALAMT OF EEWSUB(ESBACT) TO SALAMT OF MDTMAS-REC.
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTMAS-REC.
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTMAS-REC.
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTMAS-REC.
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTMAS-REC.
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTMAS-REC.
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTMAS-REC.
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTMAS-REC.
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTMAS-REC.
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTMAS-REC.
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTMAS-REC.
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTMAS-REC.
           MOVE RENREA OF EEWSUB(ESBACT) TO ENRTYP OF MDTMAS-REC.
           MOVE HOLDCD OF EEWSUB(ESBACT) TO HOLDCD OF MDTMAS-REC.
           IF INDUPD OF EEWSUB(ESBACT) NOT  = SPACES
              MOVE INDUPD OF EEWSUB(ESBACT) TO INDUPD OF MDTMAS-REC
           ELSE
              MOVE 'N'                      TO INDUPD OF MDTMAS-REC.
           MOVE PRCDAT OF EEWHDR-WRK               TO TARDAT.
           PERFORM A930-CONVERT-DATE               THRU A939-EXIT.
           MOVE CNVDAT                   TO PRCDAT OF MDTMAS-REC.
           MOVE PRCTIM OF EEWHDR-WRK     TO PRCTIM OF MDTMAS-REC.
           ADD 1                         TO PRCSEQ OF WS-WORK.
           MOVE PRCSEQ OF WS-WORK        TO PRCSEQ OF MDTMAS-REC.
           MOVE EXCHNG OF EEWSB2(ESBACT) TO EXCHNG OF MDTMAS-REC.
           IF EXCHNG OF MDTMAS-REC = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTMAS-REC
           ELSE
              MOVE SPACES                TO EXCIND OF MDTMAS-REC.
           MOVE EXCSUB OF EEWSUB(ESBACT) TO EXCSUB OF MDTMAS-REC
           MOVE EXCMEM OF EEWSUB(ESBACT) TO EXCMEM OF MDTMAS-REC
      *
           IF MMDIND OF EEWSUB(ESBACT) = 'Y'
              MOVE BRANCD OF MDTMAS-REC  TO BRANCD OF MMDMAS-REC
              MOVE BATDAT OF MDTMAS-KEY  TO BATDAT OF MMDMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY  TO BATSEQ OF MMDMAS-REC
              MOVE SEQNUM OF MDTMAS-KEY  TO SEQNUM OF MMDMAS-REC
              MOVE LINENO OF MDTMAS-KEY  TO LINENO OF MMDMAS-REC
              MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MMDMAS-REC
              PERFORM A1000-WRITE-MMDMAS         THRU A1009-EXIT.
      *
           IF CPAIND OF EEWSUB(ESBACT) = 'M' OR 'S'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF CPDMAS-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF CPDMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF CPDMAS-REC
              MOVE SEQNUM OF MDTMAS-KEY TO SEQNUM OF CPDMAS-REC
              MOVE LINENO OF MDTMAS-KEY TO LINENO OF CPDMAS-REC
              IF CPAIND OF EEWSUB(ESBACT) = 'M'
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
              ELSE
                 MOVE ZERO              TO LINENO OF CPDMAS-REC
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
              END-IF
              PERFORM A980-WRITE-CPDMAS          THRU A989-EXIT.
      *
           IF OTHINS OF MDTMAS-REC NOT = SPACES
              PERFORM A670-OTHINS-CHK            THRU A679-EXIT.
      *
           IF RSPIND OF EEWSB2(ESBACT) = 'Y'
              INITIALIZE RSPDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF RSPDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF RSPDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF RSPDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF RSPDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY     TO LINENO OF RSPDOCBT-REC
              MOVE ZERO                     TO MEMSEQ OF RSPDOCBT-REC
              PERFORM A1320-WRITE-RSPDOCBT       THRU A1329-EXIT.
           IF BENIND OF EEWSB2(ESBACT) = 'Y'
              INITIALIZE EXTDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF EXTDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF EXTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF EXTDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY TO SEQNUM OF EXTDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY TO LINENO OF EXTDOCBT-REC
              MOVE ZERO                TO MEMSEQ OF EXTDOCBT-REC
              PERFORM B1320-WRITE-EXTDOCBT       THRU B1329-EXIT.
      *
           IF ALTIND OF EEWSB2(ESBACT) = 'Y'
              INITIALIZE ALTDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF ALTDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF ALTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF ALTDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF ALTDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY     TO LINENO OF ALTDOCBT-REC
              MOVE ZERO                     TO MEMSEQ OF ALTDOCBT-REC
              PERFORM A1360-WRITE-ALTDOCBT       THRU A1369-EXIT.
      *
           IF  WS-FULLUP NOT = 'A'
           AND WS-VERSID = '005010'
           AND ( EPCLS1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 EPCLS2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 EPCLS3 OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTNM OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTQL OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTID OF EEWSB2(ESBACT) NOT = SPACES OR
                 RDTFMT OF EEWSB2(ESBACT) NOT = SPACES OR
                 RCTDAT OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLLST OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLFST OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLMID OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLPRE OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSUF OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLAD1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLAD2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLCTY OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSTA OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLZIP OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLCCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 ICMRCQ OF EEWSB2(ESBACT) NOT = SPACES OR
                 ICMRCC OF EEWSB2(ESBACT) NOT = SPACES OR
                 MDRCCC OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBAD1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBAD2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCTY OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBSTA OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBZIP OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 CSPCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 CNTSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 SCHSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPTCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 MBMCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBPHN OF EEWSB2(ESBACT) NOT = SPACES    )
              INITIALIZE EDIDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF EDIDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF EDIDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF EDIDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF EDIDOCBT-REC
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF MDTMAS-KEY  TO LINENO OF EDIDOCBT-REC
              ELSE
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                     TO LINENO OF EDIDOCBT-REC
              END-IF
              END-IF
              PERFORM A1370-WRITE-EDIDOCBT       THRU A1379-EXIT.
      *
           IF EXTIND OF EEWSB2(ESBACT) = 'Y'
              INITIALIZE DEMDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF DEMDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF DEMDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF DEMDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF DEMDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY     TO LINENO OF DEMDOCBT-REC
              MOVE ZERO                     TO MEMSEQ OF DEMDOCBT-REC
              PERFORM A1340-WRITE-DEMDOCBT       THRU A1349-EXIT.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if there is no detail 3 record. ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
           IF (EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES')
           AND RELCOD OF EEWSB3(ESBACT) NOT = SPACES
              INITIALIZE EXCMDTBT-REC
              MOVE BRANCD OF MDTMAS-KEY          TO WS-EXC-BRANCD
              MOVE BATDAT OF MDTMAS-KEY          TO WS-EXC-BATDAT
              MOVE BATSEQ OF MDTMAS-KEY          TO WS-EXC-BATSEQ
              MOVE SEQNUM OF MDTMAS-KEY          TO WS-EXC-SEQNUM
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF MDTMAS-KEY       TO WS-EXC-LINENO
              END-IF
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                          TO WS-EXC-LINENO
              END-IF
              MOVE ZEROES                        TO WS-EXC-MEMSEQ
              MOVE 001                           TO WS-EXCSEQ
              PERFORM A1430-WRITE-EXCMDTBT       THRU A1439-EXIT.
      *
           IF MMCIND OF EEWSUB(ESBACT) NOT = 'Y'
              GO TO A635-CONT.
      *
           IF (ACCTNO OF EEWSUB(ESBACT) = SPACES
            OR ACCTNO OF EEWSUB(ESBACT) = 'INDBIL')
           AND MMCIND OF EEWSUB(ESBACT) = 'Y'
              MOVE SPACES                        TO GRPMAS-REC
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF GRPMAS-REC
              PERFORM GRPMAS-READ
              IF INDBIL OF GRPMAS-REC = 'Y'
                 If MCGIND OF GRPMAS-REC = 'Y'
      *‚            Write MDMMAS Record
                    MOVE BRANCD OF MDTMAS-REC
                                       TO BRANCD OF MDMMAS-REC
                    MOVE BATDAT OF MDTMAS-REC
                                       TO BATDAT OF MDMMAS-REC
                    MOVE BATSEQ OF MDTMAS-KEY
                                       TO BATSEQ OF MDMMAS-REC
                    MOVE SEQNUM OF MDTMAS-KEY
                                       TO SEQNUM OF MDMMAS-REC
                    MOVE LINENO OF MDTMAS-KEY
                                       TO LINENO OF MDMMAS-REC
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDMMAS-REC
                    PERFORM A1100-WRITE-MDMMAS
                                                 THRU A1109-EXIT
                    GO TO A635-CONT
                 ELSE
      *‚            Error "MEDICARE MEMBER CANNOT BE SPECIFIED
      *‚                     IF MEDICARE GROUP NOT SPECIFIED"
                    MOVE 'Y'                        TO PRCERR
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'MEDICARE MEMBER'          TO MI-PARM4
                    MOVE 'MEDICARE GROUP'           TO MI-PARM5
                    MOVE 'EI02485'                  TO MI-PRIMARY-ID
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    GO TO A639-EXIT
                 END-IF
              END-IF
           END-IF.
      *
           INITIALIZE FACMAS-REC.
           MOVE ACCTNO OF EEWSUB(ESBACT)     TO ACCTNO OF FACMAS-KEY.
           PERFORM FACMAS-READ               IF INVALID-KEY
              GO TO A635-CONT.
           IF MCGIND OF FACMAS-REC NOT = 'N'
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF MDMMAS-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF MDMMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF MDMMAS-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF MDMMAS-REC
              MOVE LINENO OF MDTMAS-KEY     TO LINENO OF MDMMAS-REC
              MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDMMAS-REC
              PERFORM A1100-WRITE-MDMMAS            THRU A1109-EXIT.
       A635-CONT.
           PERFORM E120-SUB-MEMEXDBT                 THRU E129-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Check for processing error.                           ****
      ****--------------------------------------------------------****
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A639-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Fill error line.                                      ****
      ****--------------------------------------------------------****
           PERFORM MDTMAS-WRITE                  IF INVALID-KEY
             MOVE 'Y'                            TO PRCERR
             MOVE GRPNUM OF MDTMAS-REC TO GRPNUM OF ERR-LINE
             MOVE MEMBNO OF MDTMAS-REC TO MEMBNO OF ERR-LINE
             MOVE SUBSNO OF MDTMAS-REC TO SUBSNO OF ERR-LINE
             MOVE RELCOD OF MDTMAS-REC TO RELCOD OF ERR-LINE
             MOVE CHGTYP OF MDTMAS-REC TO CHGTYP OF ERR-LINE
             MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
             MOVE 'MDTMAS'                       TO MI-PARM4
             MOVE MDTMAS-STATUS                  TO MI-PARM5
             MOVE 'EI06062'                      TO MI-PRIMARY-ID
             PERFORM X100-PRINT-ERROR            THRU X109-EXIT
‚            IF IN-DEBUG
‚               MOVE '@@ A635'                   TO LINE-E
‚               PERFORM 099-PRTERR
‚            END-IF
             GO TO A639-EXIT.
      *
           MOVE 'Y'                    TO SW-SEQ-USED.
           ADD 1                       TO TOTBAT OF WS-WORK.
           ADD 1                       TO NUMMDT OF WS-WORK.
           MOVE 'Y'                    TO REC-FLAG.
           IF DOCNUM OF EEWSUB(ESBACT) NOT = SPACES
              MOVE DOCNUM OF EEWSUB(ESBACT)      TO DOCNUM OF WS-WORK
              PERFORM A1300-CRT-DODMAS           THRU A1309-EXIT
              IF PRCERR OF PGM-WORK = 'Y'        GO TO A639-EXIT.
      *
           MOVE PRCSEQ OF MDTMAS-REC   TO PRCSEQ OF EETSUB(ESBACT).
           MOVE BRANCD OF MDTMAS-REC   TO BRANCD OF EETSUB(ESBACT).
           MOVE BATDAT OF MDTMAS-REC   TO BATDAT OF EETSUB(ESBACT).
           MOVE BATSEQ OF MDTMAS-REC   TO BATSEQ OF EETSUB(ESBACT).
           MOVE SEQNUM OF MDTMAS-REC   TO SEQNUM OF EETSUB(ESBACT).
           MOVE LINENO OF MDTMAS-REC   TO LINENO OF EETSUB(ESBACT).
      *
           IF GENRPT OF EDIENR-REC NOT = 'Y'
              GO TO A639-EXIT.
      *
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF DET-LINE.
           MOVE LINENO OF WS-WORK      TO LINENO OF DET-LINE.
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF DET-LINE.
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF DET-LINE.
           MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF DET-LINE.
           MOVE RELTYP OF EEWSUB(ESBACT) TO RELTYP OF DET-LINE.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF DET-LINE.
           MOVE BTHDAT OF EEWSUB(ESBACT)         TO DATYMDN.
           MOVE CORR DATYMD                      TO DATMDY.
           MOVE DATMDY                 TO BTHDAT OF DET-LINE.
           MOVE SEXCOD OF EEWSUB(ESBACT) TO SEXCOD OF DET-LINE.
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF NAME-AREA.
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF NAME-AREA.
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF NAME-AREA.
           MOVE TITLCD OF EEWSUB(ESBACT) TO TITLCD OF NAME-AREA.
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF NAME-AREA.
           PERFORM 099-NAMFMT.
           MOVE NAMKEY OF NAME-AREA    TO NAMKEY OF DET-LINE.
           IF CHGTYP OF EEWSUB(ESBACT) = 'A'
              MOVE 'ADD'               TO CHGTYP OF DET-LINE
              ADD 1                    TO BATADD OF WS-WORK
           ELSE
              MOVE 'CHANGE'            TO CHGTYP OF DET-LINE
              ADD 1                    TO BATCHG OF WS-WORK.
      *
           MOVE DET-LINE TO LINE-P               PERFORM 099-PRT.
       A639-EXIT.
           EXIT.
      *
       A640-ME1023-SUBCHG.
      **************************************************************
      * ADD ME1023 SUBSCIBER RECORD                                *
      **************************************************************
           PERFORM A900-INIT-MDTTAB              THRU A909-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           MOVE 'N'                              TO ACCT-FLAG.
           MOVE 'N'                              TO RSPPTY-FLAG.
           MOVE 'N'                              TO SW-SEQ-USED.
           MOVE SPACES                 TO DOCNUM OF WS-WORK.
      *
      *    GET CURRENT INFO FOR MEMBER
           PERFORM A540-CURSUB                   THRU A549-EXIT.

           IF PRCNAM OF EEWHDR-WRK = 'N'
           OR NAMCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-2.
      *
           IF LSTNAM OF EEWSUB(ESBACT) = SPACES
           AND FSTNAM OF EEWSUB(ESBACT) = SPACES
           AND MIDNAM OF EEWSUB(ESBACT) = SPACES
              GO TO A642-STEP-2.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C' AND SPACE
              GO TO A642-STEP-2.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES)
           OR ((LSTNAM OF EEWSUB(ESBACT) NOT =
                                   LSTNAM OF SUBMEM(TMPACT)
           OR FSTNAM OF EEWSUB(ESBACT) NOT =
                                   FSTNAM OF SUBMEM(TMPACT)
           OR MIDNAM OF EEWSUB(ESBACT) NOT =
                                   MIDNAM OF SUBMEM(TMPACT))
           AND CHGTYP OF EEWSUB(ESBACT) = 'C' OR SPACES)
              MOVE 3                   TO LINENO OF MDTTAB(LIN-0003)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0003)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0003)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0003)
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0003)
              MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0003)
              MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0003)
              MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0003)
              MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0003)
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0003)
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0003)
              MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0003)
              MOVE CHGEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0003)
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0003)
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0003)
              MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0003)
              MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0003)
              MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0003)
              MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0003)
              MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0003)
              MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0003)
              MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0003)
              MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0003)
              MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0003)
              MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0003)
              MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0003)
              MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0003)
              MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0003)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0003)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0003)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0003)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0003)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0003)
              END-IF
              IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0003)
              ELSE
                 MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0003).
       A642-STEP-2.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****--------------------------------------------------------****
           IF WS-DT3-TRMEFF IS NUMERIC
            IF WS-DT1-MEMEFF <= WS-DT3-TRMEFF
            AND WS-DT3-TRMEFF NOT = ZEROES
            AND (CHGTYP OF EEWSUB(ESBACT) = 'T'
            OR   CHGTYP OF EEWSUB(ESBACT) = ' ')
              MOVE 'Y'                           TO WS-TRMSUB
              IF  EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                 PERFORM A1510-EXCMEMBT-CHG      THRU A1519-EXIT
      ****       IF EXCMEM-FLAG = 'Y'
      ****       OR ADD-EXCMEM
                 IF   RELCOD OF EEWSB3(ESBACT) NOT = SPACES
                 AND (EXCMEM-FLAG = 'Y'
                 OR   ADD-EXCMEM)
                   MOVE 'Y'                      TO DEMCHG-FLAG
                   MOVE MEMSEQ OF MEMMAS-REC     TO WS-EXC-MEMSEQ
                   INITIALIZE EXCMDTBT-REC
                   MOVE BRANCD OF MBHMAS-REC     TO WS-EXC-BRANCD
                   MOVE BATDAT OF MBHMAS-REC     TO WS-EXC-BATDAT
                   MOVE BATSEQ OF MBHMAS-REC     TO WS-EXC-BATSEQ
                   MOVE SEQNUM OF WS-WORK        TO WS-EXC-SEQNUM
                   MOVE 2                        TO WS-EXC-LINENO
                   MOVE 1                        TO WS-EXCSEQ
                   PERFORM A1430-WRITE-EXCMDTBT  THRU A1439-EXIT.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND CHGTYP OF EEWSUB(ESBACT) = 'T'
           AND TMPACT = ZEROES)
           OR (CHGTYP OF EEWSUB(ESBACT) = 'T'
              AND MEMEFF OF SUBMEM(TMPACT) <=
                                       MEMEXP OF EEWSUB(ESBACT)
              AND MEMEXP OF SUBMEM(TMPACT) NOT =
                                       MEMEXP OF EEWSUB(ESBACT))
           OR WS-TRMSUB = 'Y'
                 MOVE 2                TO LINENO OF MDTTAB(LIN-0002)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
                 MOVE '1'              TO RELCOD OF MDTTAB(LIN-0002)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                 MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                 MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                 MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                 MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                 IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                    MOVE 'N'           TO PRTCOD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002)
                 END-IF
                 IF ACCTNO OF MDTTAB(LIN-0002) NOT = SPACES
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    END-IF
                 END-IF
                 MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                 MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                 IF EXPDAT OF MDTTAB(LIN-0002) = ZEROES
                    MOVE WS-DT3-TRMEFF TO EXPDAT OF MDTTAB(LIN-0002)
                 END-IF
                 IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                    MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0002)
                 MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0002)
                 MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0002)
                 MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0002)
                 MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0002)
                 MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0002)
                 MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0002)
                 MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0002)
                 MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0002)
                 MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0002)
                 MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0002)
                 MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0002)
                 MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0002)
                 MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0002)
                 MOVE EXCSUB OF EEWSUB(ESBACT)
                                       TO EXCSUB OF MDTTAB(LIN-0002)
                 MOVE EXCMEM OF EEWSUB(ESBACT)
                                       TO EXCMEM OF MDTTAB(LIN-0002)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0002)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0002)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0002)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0002)
                 END-IF
                 IF   WS-TRMSUB NOT = 'Y'
                 AND (EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES')
                    MOVE 'Y'                     TO WS-TRMSUB
                    PERFORM A1510-EXCMEMBT-CHG   THRU A1519-EXIT
      ****          IF EXCMEM-FLAG = 'Y'
      ****          OR ADD-EXCMEM
                    IF   RELCOD OF EEWSB3(ESBACT) NOT = SPACES
                    AND (EXCMEM-FLAG = 'Y'
                    OR   ADD-EXCMEM)
                      MOVE 'Y'                   TO DEMCHG-FLAG
                      MOVE MEMSEQ OF MEMMAS-REC  TO WS-EXC-MEMSEQ
                      INITIALIZE EXCMDTBT-REC
                      MOVE BRANCD OF MBHMAS-REC  TO WS-EXC-BRANCD
                      MOVE BATDAT OF MBHMAS-REC  TO WS-EXC-BATDAT
                      MOVE BATSEQ OF MBHMAS-REC  TO WS-EXC-BATSEQ
                      MOVE SEQNUM OF WS-WORK     TO WS-EXC-SEQNUM
                      MOVE 2                     TO WS-EXC-LINENO
                      MOVE 1                     TO WS-EXCSEQ
                      PERFORM A1430-WRITE-EXCMDTBT THRU A1439-EXIT.
      *
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0002)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0002)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0002)
           END-IF.
      *
           IF MEMCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-3.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO A642-STEP-3.
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES)
              GO TO A642-ADDMEM.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT =
                                       MEMEFF OF SUBMEM(TMPACT)
           OR  MEMEXP OF EEWSUB(ESBACT) NOT =
                                      MEMEXP OF SUBMEM(TMPACT))
              IF (MEMEFF OF EEWSUB(ESBACT) NOT <
                                       MEMEFF OF SUBMEM(TMPACT)
              AND MEMEFF OF EEWSUB(ESBACT) NOT >
                                      MEMEXP OF SUBMEM(TMPACT))
              OR (MEMEXP OF EEWSUB(ESBACT) NOT <
                                       MEMEFF OF SUBMEM(TMPACT)
              AND MEMEXP OF EEWSUB(ESBACT) NOT >
                                      MEMEXP OF SUBMEM(TMPACT))
              OR (MEMEFF OF EEWSUB(ESBACT)     <
                                       MEMEFF OF SUBMEM(TMPACT)
              AND MEMEXP OF EEWSUB(ESBACT)     >
                                      MEMEXP OF SUBMEM(TMPACT))
                 GO TO A642-ADDMEM
              END-IF.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF SUBMEM(TMPACT)
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF SUBMEM(TMPACT))
              IF MEMEFF OF SUBMEM(TMPACT) > MEMEXP OF EEWSUB(ESBACT)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF EEWSUB(ESBACT)   TO DATFR
                 MOVE MEMEFF OF SUBMEM(TMPACT)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO A642-ADDMEM.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF SUBMEM(TMPACT)
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF SUBMEM(TMPACT))
              IF MEMEFF OF EEWSUB(ESBACT) > MEMEXP OF SUBMEM(TMPACT)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF SUBMEM(TMPACT)   TO DATFR
                 MOVE MEMEFF OF EEWSUB(ESBACT)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO A642-ADDMEM.
      *
           GO TO A642-STEP-3.
      *
       A642-ADDMEM.
           MOVE 2                TO LINENO OF MDTTAB(LIN-0002)
           MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
           MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
           MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0002)
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0002)
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF MDTTAB(LIN-0002)
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF MDTTAB(LIN-0002)
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF MDTTAB(LIN-0002)
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTTAB(LIN-0002)
           IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF MDTTAB(LIN-0002)
           MOVE MEMEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0002)
           MOVE MEMEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0002)
           MOVE MEMTRM OF EEWSUB(ESBACT) TO TERMCD OF MDTTAB(LIN-0002)
           MOVE CRDCNT OF EEWSUB(ESBACT) TO CRDCNT OF MDTTAB(LIN-0002)
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTTAB(LIN-0002)
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTTAB(LIN-0002)
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTTAB(LIN-0002)
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTTAB(LIN-0002)
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTTAB(LIN-0002)
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTTAB(LIN-0002)
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTTAB(LIN-0002)
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTTAB(LIN-0002)
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTTAB(LIN-0002)
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTTAB(LIN-0002)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0002)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0002)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0002)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0002)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
       A642-STEP-3.
           PERFORM A860-SUBDEM                   THRU A869-EXIT.
      *
           MOVE 'N'                              TO DEMCHG-FLAG.
      *
           IF PRCDEM OF EEWHDR-WRK         = 'N'
           OR DEMCHG OF EEWSUB(ESBACT)     = 'N'
           OR CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO A642-STEP-5.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RELCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND RELCOD OF EEWSUB(ESBACT) NOT = RELCOD OF DEMMAS-REC)
              MOVE RELCOD OF EEWSUB(ESBACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
              MOVE 'Y'                           TO DEMCHG-FLAG.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES)
           OR (RELTYP OF EEWSUB(ESBACT) NOT = SPACES
           AND RELTYP OF EEWSUB(ESBACT) NOT = RELTYP OF SUBMEM(TMPACT))
              MOVE RELTYP OF EEWSUB(ESBACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
              MOVE 'Y'                           TO DEMCHG-FLAG.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SEXCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND SEXCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND SEXCOD OF EEWSUB(ESBACT) NOT =
                                       SEXCOD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SEXCOD OF EEWSUB(ESBACT)
                                       TO SEXCOD OF MDTTAB(LIN-0001).
      *
           MOVE 'N'                              TO MEEMAS-EXISTS.
           INITIALIZE MEEMAS-REC.
           MOVE MEMBNO OF MEMMAS-REC   TO MEMBNO OF MEEMAS-KEY.
           MOVE GRPNUM OF MEMMAS-REC   TO GRPNUM OF MEEMAS-KEY.
           MOVE TRNSEQ OF MEMMAS-REC   TO TRNSEQ OF MEEMAS-KEY.
           PERFORM MEEMAS-READ                   IF INVALID-KEY
              MOVE 'N'                           TO MEEMAS-EXISTS
           ELSE
              MOVE 'Y'                           TO MEEMAS-EXISTS.
      *
           IF MEEMAS-EXISTS = 'Y'
           AND COBDAT OF EEWSUB(ESBACT) NOT = ZEROS
           AND COBDAT OF EEWSUB(ESBACT) NOT = COBDAT OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBDAT OF EEWSUB(ESBACT)
                                       TO COBDAT OF MDTTAB(LIN-0001).
      *
           IF MEEMAS-EXISTS = 'Y'
           AND PAYLOC OF EEWSUB(ESBACT) NOT = SPACES
           AND PAYLOC OF EEWSUB(ESBACT) NOT = PAYLOC OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYLOC OF EEWSUB(ESBACT)
                                       TO PAYLOC OF MDTTAB(LIN-0001).
      *
           IF MEEMAS-EXISTS = 'Y'
           AND PAYNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND PAYNUM OF EEWSUB(ESBACT) NOT = PAYNUM OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYNUM OF EEWSUB(ESBACT)
                                       TO PAYNUM OF MDTTAB(LIN-0001).

           IF PRTCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND PRTCOD OF EEWSUB(ESBACT) NOT =
                                       PRTCOD OF MEMMAS-REC
             MOVE 'Y'                            TO DEMCHG-FLAG
             MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR ((ADRLN1 OF EEWSUB(ESBACT) NOT = SPACES
           AND (ADRLN1 OF EEWSUB(ESBACT) NOT = ADRLN1 OF DEMMAS-REC)
           OR   ADRLN2 OF EEWSUB(ESBACT) NOT = ADRLN2 OF DEMMAS-REC)
           OR (CITYCD OF EEWSUB(ESBACT)  NOT = SPACES
           AND CITYCD OF EEWSUB(ESBACT)  NOT = CITYCD OF DEMMAS-REC)
           OR (STACOD OF EEWSUB(ESBACT)  NOT = SPACES
           AND STACOD OF EEWSUB(ESBACT)  NOT = STACOD OF DEMMAS-REC)
           OR (ZIPCOD OF EEWSUB(ESBACT)  NOT = SPACES
           AND ZIPCOD OF EEWSUB(ESBACT)  NOT = ZIPCOD OF DEMMAS-REC)
           OR (CTRYCD OF EEWSUB(ESBACT)  NOT = SPACES
           AND CTRYCD OF EEWSUB(ESBACT)  NOT = CTRYCD OF DEMMAS-REC)
           OR (AREACD OF EEWSUB(ESBACT)  NOT = SPACES
           AND AREACD OF EEWSUB(ESBACT)  NOT = AREACD OF DEMMAS-REC)
           OR (LOCQLF OF EEWSUB(ESBACT)  NOT = SPACES
           AND LOCQLF OF EEWSUB(ESBACT)  NOT =
                                       LOCQLF OF DEMMAS-REC))
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ADRLN1 OF EEWSUB(ESBACT)
                                       TO ADRLN1 OF MDTTAB(LIN-0001)
              MOVE ADRLN2 OF EEWSUB(ESBACT)
                                       TO ADRLN2 OF MDTTAB(LIN-0001)
              MOVE CITYCD OF EEWSUB(ESBACT)
                                       TO CITYCD OF MDTTAB(LIN-0001)
              MOVE STACOD OF EEWSUB(ESBACT)
                                       TO STACOD OF MDTTAB(LIN-0001)
              MOVE ZIPCOD OF EEWSUB(ESBACT)
                                       TO ZIPCOD OF MDTTAB(LIN-0001)
              MOVE CTRYCD OF EEWSUB(ESBACT)
                                       TO CTRYCD OF MDTTAB(LIN-0001)
              MOVE AREACD OF EEWSUB(ESBACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
              MOVE LOCQLF OF EEWSUB(ESBACT)
                                       TO LOCQLF OF MDTTAB(LIN-0001)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0001)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0001)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0001)
                 MOVE CHGDAT OF EEWSB3(ESBACT)
                                       TO LSTCHG OF MDTTAB(LIN-0001)
              END-IF.
      *
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0001)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0001)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0001)
           END-IF.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH1 OF EEWSUB(ESBACT) NOT = HOMPH1 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH1 OF EEWSUB(ESBACT)
                                       TO HOMPH1 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH2 OF EEWSUB(ESBACT) NOT = HOMPH2 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH2 OF EEWSUB(ESBACT)
                                       TO HOMPH2 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH3 OF EEWSUB(ESBACT) NOT = HOMPH3 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH3 OF EEWSUB(ESBACT)
                                       TO HOMPH3 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH1 OF EEWSUB(ESBACT) NOT = WRKPH1 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH1 OF EEWSUB(ESBACT)
                                       TO WRKPH1 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH2 OF EEWSUB(ESBACT) NOT = WRKPH2 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH2 OF EEWSUB(ESBACT)
                                       TO WRKPH2 OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH3 OF EEWSUB(ESBACT) NOT = WRKPH3 OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH3 OF EEWSUB(ESBACT)
                                       TO WRKPH3 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKEXT OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKEXT OF EEWSUB(ESBACT) NOT = WRKEXT OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKEXT OF EEWSUB(ESBACT)
                                       TO WRKEXT OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SOCSEC OF EEWSUB(ESBACT) NOT = SPACES
           AND SOCSEC OF EEWSUB(ESBACT) NOT = SOCSEC OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SOCSEC OF EEWSUB(ESBACT)
                                       TO SOCSEC OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RACECD OF EEWSUB(ESBACT) NOT = SPACES
           AND RACECD OF EEWSUB(ESBACT) NOT = RACECD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE RACECD OF EEWSUB(ESBACT)
                                       TO RACECD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MEMSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND MEMSTA OF EEWSUB(ESBACT) NOT = MEMSTA OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MEMSTA OF EEWSUB(ESBACT)
                                       TO MEMSTA OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (AUTEXP OF EEWSUB(ESBACT) NOT = SPACES
           AND AUTEXP OF EEWSUB(ESBACT) NOT = AUTEXP OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE AUTEXP OF EEWSUB(ESBACT)
                                       TO AUTEXP OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (ALTNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND ALTNUM OF EEWSUB(ESBACT) NOT = ALTNUM OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ALTNUM OF EEWSUB(ESBACT)
                                       TO ALTNUM OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (INTKCD OF EEWSUB(ESBACT) NOT = SPACES
           AND INTKCD OF EEWSUB(ESBACT) NOT = INTKCD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE INTKCD OF EEWSUB(ESBACT)
                                       TO INTKCD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (BTHCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND BTHDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND BTHDAT OF EEWSUB(ESBACT) NOT = BTHDAT OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BTHDAT OF EEWSUB(ESBACT)
                                       TO BTHDAT OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (BTHSEQ OF EEWSUB(ESBACT) NOT = ZEROES
           AND BTHSEQ OF EEWSUB(ESBACT) NOT = BTHSEQ OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BTHSEQ OF EEWSUB(ESBACT)
                                       TO BTHSEQ OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HIRDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND HIRDAT OF EEWSUB(ESBACT) NOT =
                                       HIRDAT OF SUBMEM(TMPACT))
              MOVE HIRDAT OF EEWSUB(ESBACT)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
              MOVE 'Y'                        TO DEMCHG-FLAG
           ELSE
              IF DEMMAS-CHANGE
                 MOVE HIRDAT OF SUBMEM(TMPACT)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
              END-IF
           END-IF
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (TYPCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND TYPCOD OF EEWSUB(ESBACT) NOT = TYPCOD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE TYPCOD OF EEWSUB(ESBACT)
                                       TO TYPCOD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (AREACD OF EEWSUB(ESBACT) NOT = SPACES
           AND AREACD OF EEWSUB(ESBACT) NOT = AREACD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE AREACD OF EEWSUB(ESBACT)
                                       TO AREACD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (TRMDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND TRMDAT OF EEWSUB(ESBACT) NOT =
                                    TRMDAT OF SUBMEM(TMPACT))
              MOVE TRMDAT OF EEWSUB(ESBACT)
                                    TO TRMDAT OF MDTTAB(LIN-0001)
              MOVE 'Y'                        TO DEMCHG-FLAG
           ELSE
              IF DEMMAS-CHANGE
                 MOVE TRMDAT OF SUBMEM(TMPACT)
                                    TO TRMDAT OF MDTTAB(LIN-0001)
              END-IF
           END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR ((CPAIND OF EEWSUB(ESBACT) = 'M' OR 'S' OR 'N')
           AND CPAIND OF EEWSUB(ESBACT) NOT = CPAIND OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE CPAIND OF EEWSUB(ESBACT)
                                        TO CPAIND OF MDTTAB(LIN-0001)
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF CPDMAS-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF CPDMAS-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF CPDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
              MOVE 1                    TO LINENO OF CPDMAS-REC
              IF CPAIND OF EEWSUB(ESBACT) = 'M'
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
                 PERFORM A980-WRITE-CPDMAS        THRU A989-EXIT
              END-IF
              IF CPAIND OF EEWSUB(ESBACT) = 'S'
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
                 PERFORM A980-WRITE-CPDMAS        THRU A989-EXIT.

              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (CPAIND OF EEWSUB(ESBACT) = 'N'
              AND CPAIND OF EEWSUB(ESBACT) = CPAIND OF DEMMAS-REC)
                 MOVE SPACE             TO CPAIND OF MDTTAB(LIN-0001)
              END-IF
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR ((CPAIND OF EEWSUB(ESBACT) = 'M' OR 'S')
              AND CPAIND OF EEWSUB(ESBACT) = CPAIND OF DEMMAS-REC)
                 PERFORM A990-CPAMAS-CHG          THRU A999-EXIT
                 IF CPACHG-FLAG = 'Y'
                    MOVE CPAIND OF EEWSUB(ESBACT)
                                        TO CPAIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                      TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHMAS-REC TO BRANCD OF CPDMAS-REC
                    MOVE BATDAT OF MBHMAS-REC TO BATDAT OF CPDMAS-REC
                    MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF CPDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                    MOVE 1                    TO LINENO OF CPDMAS-REC
                    IF CPAIND OF EEWSUB(ESBACT) = 'M'
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A980-WRITE-CPDMAS THRU A989-EXIT
                    END-IF
                    IF CPAIND OF EEWSUB(ESBACT) = 'S'
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A980-WRITE-CPDMAS THRU A989-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKLOC OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKLOC OF EEWSUB(ESBACT) NOT = WRKLOC OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKLOC OF EEWSUB(ESBACT)
                                       TO WRKLOC OF MDTTAB(LIN-0001)
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SSNXRF OF EEWSUB(ESBACT) NOT = ZEROS
           AND SSNXRF OF EEWSUB(ESBACT) NOT = SSNXRF OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SSNXRF OF EEWSUB(ESBACT)
                                       TO SSNXRF OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HICNNO OF EEWSUB(ESBACT) NOT = SPACES
           AND HICNNO OF EEWSUB(ESBACT) NOT = HICNNO OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HICNNO OF EEWSUB(ESBACT)
                                       TO HICNNO OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (PEBTFS OF EEWSUB(ESBACT) NOT = SPACES
           AND PEBTFS OF EEWSUB(ESBACT) NOT = PEBTFS OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PEBTFS OF EEWSUB(ESBACT)
                                       TO PEBTFS OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (FAXNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND FAXNUM OF EEWSUB(ESBACT) NOT = FAXNUM OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE FAXNUM OF EEWSUB(ESBACT)
                                       TO FAXNUM OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (OTHPHN OF EEWSUB(ESBACT) NOT = SPACES
           AND OTHPHN OF EEWSUB(ESBACT) NOT = OTHPHN OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE OTHPHN OF EEWSUB(ESBACT)
                                       TO OTHPHN OF MDTTAB(LIN-0001).
      *
           IF  EMLIND OF EEWSUB(ESBACT) = 'N'
           AND EMLIND OF DEMMAS-REC = 'Y'
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMLIND OF EEWSUB(ESBACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
              MOVE SPACES              TO ELMAIL OF MDTTAB(LIN-0001).

           IF  EMLIND OF EEWSUB(ESBACT) = 'Y'
           AND EMLIND OF DEMMAS-REC = 'N'
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMLIND OF EEWSUB(ESBACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
                 MOVE ELMAIL OF EEWSUB(ESBACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001).

           IF  EMLIND OF EEWSUB(ESBACT) = 'Y'
           AND EMLIND OF DEMMAS-REC = 'Y'
              INITIALIZE EMLPTRBV-REC
              MOVE 'M'                 TO EMLTYP OF EMLPTRBV-REC
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO EMLEID OF EMLPTRBV-REC
              CALL 'EMLPTRBVM' USING IO-COMMUNICATION EMLPTRBV-LM-PARMS
              MOVE EMLTXT OF EMLPTRBV-REC        TO WS-EMLTXT
              IF WS-EMLTXT = ELMAIL OF EEWSUB(ESBACT)
                 CONTINUE
              ELSE
                MOVE 'Y'                         TO DEMCHG-FLAG
                MOVE EMLIND OF EEWSUB(ESBACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
                MOVE ELMAIL OF EEWSUB(ESBACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EMLIND OF EEWSUB(ESBACT) = 'N'
           AND EMLIND OF DEMMAS-REC     = 'N')
              MOVE SPACES              TO EMLIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (STUSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND STUSTA OF EEWSUB(ESBACT) NOT = STUSTA OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE STUSTA OF EEWSUB(ESBACT)
                                       TO STUSTA OF MDTTAB(LIN-0001).

           IF HNDIND OF EEWSUB(ESBACT) NOT = SPACES
           AND MEMSTA OF DEMMAS-REC NOT = MEMSTA OF EEWSUB(DEMTMP)
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (HNDIND OF EEWSUB(ESBACT) = 'Y'
              AND MEMSTA OF DEMMAS-REC     NOT = 'H')
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE HNDIND OF EEWSUB(ESBACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
              END-IF
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (HNDIND OF EEWSUB(ESBACT) = 'N'
              AND MEMSTA OF EEWSUB(DEMTMP) = 'H')
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE HNDIND OF EEWSUB(ESBACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
              END-IF.
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EDUBEG OF EEWSUB(ESBACT) NOT = SPACES
           AND EDUBEG OF EEWSUB(ESBACT) NOT = EDUBEG OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EDUBEG OF EEWSUB(ESBACT)
                                       TO EDUBEG OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EDUEND OF EEWSUB(ESBACT) NOT = SPACES
           AND EDUEND OF EEWSUB(ESBACT) NOT = EDUEND OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EDUEND OF EEWSUB(ESBACT)
                                       TO EDUEND OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (CQLECD OF EEWSUB(ESBACT) NOT = SPACES
           AND CQLECD OF EEWSUB(ESBACT) NOT = CQLECD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE CQLECD OF EEWSUB(ESBACT)
                                       TO CQLECD OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAQ OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAQ OF EEWSUB(ESBACT) NOT = COBRAQ OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAQ OF EEWSUB(ESBACT)
                                       TO COBRAQ OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAB OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAB OF EEWSUB(ESBACT) NOT = COBRAB OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAB OF EEWSUB(ESBACT)
                                       TO COBRAB OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAE OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAE OF EEWSUB(ESBACT) NOT = COBRAE OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAE OF EEWSUB(ESBACT)
                                       TO COBRAE OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EMSTCD OF EEWSUB(ESBACT) NOT = SPACES
           AND EMSTCD OF EEWSUB(ESBACT) NOT = EMSTCD OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMSTCD OF EEWSUB(ESBACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (DETDAT OF EEWSUB(ESBACT) NOT = SPACES
           AND DETDAT OF EEWSUB(ESBACT) NOT = DETDAT OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE DETDAT OF EEWSUB(ESBACT)
                                       TO DETDAT OF MDTTAB(LIN-0001).
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MARSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND MARSTA OF EEWSUB(ESBACT) NOT = MARSTA OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MARSTA OF EEWSUB(ESBACT)
                                       TO MARSTA OF MDTTAB(LIN-0001).
      *
           IF  EXTIND OF EEWSB2(ESBACT) NOT = SPACES
           AND EXTIND OF EEWSB2(ESBACT) NOT = EXTIND OF DEMMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EXTIND OF EEWSB2(ESBACT)
                                       TO EXTIND OF MDTTAB(LIN-0001).
      *
           IF  RSPIND OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPIND OF EEWSB2(ESBACT) NOT = RSPIND OF DEMMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE RSPIND OF EEWSB2(ESBACT)
                                       TO RSPIND OF MDTTAB(LIN-0001).
           IF  BENIND OF EEWSB2(ESBACT) NOT = SPACES
           AND BENIND OF EEWSB2(ESBACT) NOT = BENIND OF DEMMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BENIND OF EEWSB2(ESBACT)
                                       TO BENIND OF MDTTAB(LIN-0001)
           END-IF.
      *
           IF  BENIND OF EEWSB2(ESBACT) = 'N'
           AND BENIND OF EEWSB2(ESBACT) = BENIND OF DEMMAS-REC
              MOVE SPACE               TO BENIND OF MDTTAB(LIN-0001)
           END-IF.
      *
           IF  BENIND OF EEWSB2(ESBACT) = 'Y'
           AND BENIND OF EEWSB2(ESBACT) = BENIND OF DEMMAS-REC
               PERFORM B1420-EXTBENBT-CHG        THRU B1429-EXIT
               IF EXTBEN-FLAG = 'Y'
                  MOVE 'Y'                       TO DEMCHG-FLAG
                  MOVE BENIND OF EEWSB2(ESBACT)
                                       TO BENIND OF MDTTAB(LIN-0001)
                  INITIALIZE EXTDOCBT-REC
                  MOVE BRANCD OF MBHMAS-REC TO BRANCD OF EXTDOCBT-REC
                  MOVE BATDAT OF MBHMAS-REC TO BATDAT OF EXTDOCBT-REC
                  MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF EXTDOCBT-REC
                  MOVE SEQNUM OF WS-WORK    TO SEQNUM OF EXTDOCBT-REC
                  MOVE 1                    TO LINENO OF EXTDOCBT-REC
                  MOVE MEMSEQ OF DEMMAS-REC
                                            TO MEMSEQ OF EXTDOCBT-REC
                  PERFORM B1320-WRITE-EXTDOCBT   THRU B1329-EXIT
               END-IF
           END-IF.
      *
           IF  BENIND OF EEWSB2(ESBACT) = 'Y'
           AND BENIND OF DEMMAS-REC     = 'N'
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BENIND OF EEWSB2(ESBACT)
                                        TO BENIND OF MDTTAB(LIN-0001)
              INITIALIZE EXTDOCBT-REC
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF EXTDOCBT-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF EXTDOCBT-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF EXTDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF EXTDOCBT-REC
              MOVE 1                    TO LINENO OF EXTDOCBT-REC
              MOVE MEMSEQ OF DEMMAS-REC
                                        TO MEMSEQ OF EXTDOCBT-REC
              PERFORM B1320-WRITE-EXTDOCBT    THRU B1329-EXIT
              END-IF.
      *
           IF  WS-FULLUP NOT = 'A'
           AND WS-VERSID = '005010'
           AND ( EPCLS1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 EPCLS2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 EPCLS3 OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTNM OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTQL OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPCTID OF EEWSB2(ESBACT) NOT = SPACES OR
                 RDTFMT OF EEWSB2(ESBACT) NOT = SPACES OR
                 RCTDAT OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLLST OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLFST OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLMID OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLPRE OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSUF OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLAD1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLAD2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLCTY OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSTA OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLZIP OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLCCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 DOLSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 ICMRCQ OF EEWSB2(ESBACT) NOT = SPACES OR
                 ICMRCC OF EEWSB2(ESBACT) NOT = SPACES OR
                 MDRCCC OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBAD1 OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBAD2 OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCTY OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBSTA OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBZIP OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 CSPCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 CNTSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 SCHSCD OF EEWSB2(ESBACT) NOT = SPACES OR
                 RPTCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 MBMCSB OF EEWSB2(ESBACT) NOT = SPACES OR
                 COBPHN OF EEWSB2(ESBACT) NOT = SPACES    )
              INITIALIZE EDIDOCBT-REC
              MOVE BRANCD OF MBHMAS-REC     TO BRANCD OF EDIDOCBT-REC
              MOVE BATDAT OF MBHMAS-REC     TO BATDAT OF EDIDOCBT-REC
              MOVE BATSEQ OF MBHMAS-REC     TO BATSEQ OF EDIDOCBT-REC
              MOVE SEQNUM OF WS-WORK        TO SEQNUM OF EDIDOCBT-REC
              MOVE 1                        TO LINENO OF EDIDOCBT-REC
              PERFORM A1370-WRITE-EDIDOCBT       THRU A1379-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'Y'
           AND MMDIND OF EEWSUB(ESBACT) NOT = MMDIND OF DEMMAS-REC)
              MOVE MMDIND OF EEWSUB(ESBACT)
                                        TO MMDIND OF MDTTAB(LIN-0001)
              MOVE 'Y'                            TO DEMCHG-FLAG
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MMDMAS-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MMDMAS-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MMDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
              MOVE 1                    TO LINENO OF MMDMAS-REC
              MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MMDMAS-REC
              PERFORM A1000-WRITE-MMDMAS          THRU A1009-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'N'
           AND MMDIND OF EEWSUB(ESBACT) = MMDIND OF DEMMAS-REC)
              MOVE SPACE            TO MMDIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'Y'
           AND MMDIND OF EEWSUB(ESBACT) = MMDIND OF DEMMAS-REC)
              PERFORM A1010-MCDMAS-CHG        THRU A1019-EXIT
              IF MCDCHG-FLAG = 'Y'
                 MOVE 'Y'                     TO DEMCHG-FLAG
                 MOVE MMDIND OF EEWSUB(ESBACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MMDMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MMDMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MMDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                 MOVE 1                    TO LINENO OF MMDMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                           TO MEMBNO OF MMDMAS-REC
                 PERFORM A1000-WRITE-MMDMAS THRU A1009-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP NOT = ZEROES)
           OR (RSPIND OF EEWSB2(ESBACT) = 'Y'
           AND RSPIND OF DEMMAS-REC     = 'Y')
              PERFORM A1420-RSPPTYBT-CHG      THRU A1429-EXIT
              IF RSPPTY-FLAG = 'Y'
                 MOVE 'Y'                     TO DEMCHG-FLAG
                 MOVE RSPIND OF EEWSB2(ESBACT)
                                       TO RSPIND OF MDTTAB(LIN-0001)
                 INITIALIZE RSPDOCBT-REC
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF RSPDOCBT-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF RSPDOCBT-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF RSPDOCBT-REC
                 MOVE SEQNUM OF WS-WORK    TO SEQNUM OF RSPDOCBT-REC
                 MOVE 1                    TO LINENO OF RSPDOCBT-REC
                 MOVE MEMSEQ OF DEMMAS-REC
                                           TO MEMSEQ OF RSPDOCBT-REC
                 PERFORM A1320-WRITE-RSPDOCBT    THRU A1329-EXIT.
      *
           IF (RSPIND OF EEWSB2(ESBACT) = 'Y'
           AND RSPIND OF DEMMAS-REC     = 'N'
           AND RSPPTY-FLAG NOT          = 'Y')
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE RSPIND OF EEWSB2(ESBACT)
                                        TO RSPIND OF MDTTAB(LIN-0001)
              INITIALIZE RSPDOCBT-REC
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF RSPDOCBT-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF RSPDOCBT-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF RSPDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF RSPDOCBT-REC
              MOVE 1                    TO LINENO OF RSPDOCBT-REC
              MOVE MEMSEQ OF DEMMAS-REC
                                        TO MEMSEQ OF RSPDOCBT-REC
              PERFORM A1320-WRITE-RSPDOCBT       THRU A1329-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RSPIND OF EEWSB2(ESBACT) = 'N'
           AND RSPIND OF DEMMAS-REC     = 'N')
              MOVE SPACE            TO RSPIND OF MDTTAB(LIN-0001).
      *
           IF  ALTIND OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTIND OF EEWSB2(ESBACT) NOT = ALTIND OF DEMMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ALTIND OF EEWSB2(ESBACT)
                                       TO ALTIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP NOT = ZEROES)
           OR  ALTIND OF EEWSB2(ESBACT) = 'Y'
              PERFORM A1460-ALTADRBT-CHG      THRU A1469-EXIT
              IF ALTADR-FOUND = 'Y'
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ALTIND OF EEWSB2(ESBACT)
                                        TO ALTIND OF MDTTAB(LIN-0001)
              INITIALIZE ALTDOCBT-REC
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF ALTDOCBT-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF ALTDOCBT-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF ALTDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF ALTDOCBT-REC
              MOVE 1                    TO LINENO OF ALTDOCBT-REC
              MOVE MEMSEQ OF DEMMAS-REC TO MEMSEQ OF ALTDOCBT-REC
              PERFORM A1360-WRITE-ALTDOCBT       THRU A1369-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (ALTIND OF EEWSB2(ESBACT) = 'N'
           AND ALTIND OF DEMMAS-REC     = 'N')
              MOVE SPACES              TO ALTIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP NOT = ZEROES)
              IF EXTIND OF EEWSB2(ESBACT) = 'Y'
                 PERFORM A1390-DEMEXTBT-CHG         THRU A1399-EXIT
                 IF DEMEXT-FLAG = 'Y'
                    MOVE 'Y'                        TO DEMCHG-FLAG
                    MOVE EXTIND OF EEWSB2(ESBACT)
                                        TO EXTIND OF MDTTAB(LIN-0001)
                    INITIALIZE DEMDOCBT-REC
                    MOVE BRANCD OF MBHMAS-REC TO BRANCD OF DEMDOCBT-REC
                    MOVE BATDAT OF MBHMAS-REC TO BATDAT OF DEMDOCBT-REC
                    MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF DEMDOCBT-REC
                    MOVE SEQNUM OF WS-WORK    TO SEQNUM OF DEMDOCBT-REC
                    MOVE 1                    TO LINENO OF DEMDOCBT-REC
                    MOVE MEMSEQ OF DEMMAS-REC
                                        TO MEMSEQ OF DEMDOCBT-REC
                    PERFORM A1340-WRITE-DEMDOCBT       THRU A1349-EXIT
                 END-IF
              END-IF
           ELSE
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
                 IF EXTIND OF EEWSB2(ESBACT) = 'Y'
                    PERFORM A1390-DEMEXTBT-CHG   THRU A1399-EXIT
                    IF DEMEXT-FLAG = 'Y'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE EXTIND OF EEWSB2(ESBACT)
                                       TO EXTIND OF MDTTAB(LIN-0001)
                    INITIALIZE DEMDOCBT-REC
                    MOVE BRANCD OF MBHMAS-REC TO BRANCD OF DEMDOCBT-REC
                    MOVE BATDAT OF MBHMAS-REC TO BATDAT OF DEMDOCBT-REC
                    MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF DEMDOCBT-REC
                    MOVE SEQNUM OF WS-WORK    TO SEQNUM OF DEMDOCBT-REC
                    MOVE 1                    TO LINENO OF DEMDOCBT-REC
                    MOVE MEMSEQ OF DEMMAS-REC TO MEMSEQ OF DEMDOCBT-REC
                    PERFORM A1340-WRITE-DEMDOCBT       THRU A1349-EXIT.

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP NOT = ZEROES)
           OR  EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
              PERFORM A1510-EXCMEMBT-CHG         THRU A1519-EXIT
      ****    IF EXCMEM-FLAG = 'Y'
      ****    OR ADD-EXCMEM
              IF   RELCOD OF EEWSB3(ESBACT) NOT = SPACES
              AND (EXCMEM-FLAG = 'Y'
              OR   ADD-EXCMEM)
                MOVE 'Y'                         TO DEMCHG-FLAG
                MOVE MEMSEQ OF DEMMAS-REC        TO WS-EXC-MEMSEQ
                INITIALIZE EXCMDTBT-REC
                MOVE BRANCD OF MBHMAS-REC        TO WS-EXC-BRANCD
                MOVE BATDAT OF MBHMAS-REC        TO WS-EXC-BATDAT
                MOVE BATSEQ OF MBHMAS-REC        TO WS-EXC-BATSEQ
                MOVE SEQNUM OF WS-WORK           TO WS-EXC-SEQNUM
                MOVE 1                           TO WS-EXC-LINENO
                MOVE 1                           TO WS-EXCSEQ
                PERFORM A1430-WRITE-EXCMDTBT     THRU A1439-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EXTIND OF EEWSB2(ESBACT) = 'N'
           AND EXTIND OF DEMMAS-REC     = 'N')
              MOVE SPACES              TO EXTIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND SUBACT = ZEROES)
              GO TO A642-CONT.

           INITIALIZE FACMAS-REC.
           MOVE ACCTNO OF SUBTAB(SUBACT) TO ACCTNO OF FACMAS-KEY.
           PERFORM FACMAS-READ
           IF  MMCIND OF EEWSUB(ESBACT)     = 'Y'
           AND MMCIND OF EEWSUB(ESBACT) NOT = MMCIND OF SUBTAB(SUBACT)
              IF MCGIND OF FACMAS-REC        = 'Y'
              OR (MCGIND OF FACMAS-REC       = ' '
              AND MCGIND OF GRPMAS-REC       = 'Y')
                MOVE MMCIND OF EEWSUB(ESBACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                       TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MDMMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MDMMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MDMMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                 MOVE 1                    TO LINENO OF MDMMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDMMAS-REC
                 PERFORM A1100-WRITE-MDMMAS      THRU A1109-EXIT.
      *
       A642-CONT.
           IF  MMCIND OF EEWSUB(ESBACT) = 'N'
           AND MCGIND OF FACMAS-REC     = 'Y'
              MOVE MCGIND OF FACMAS-REC TO MMCIND OF EEWSUB(ESBACT).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT)     = 'N'
           AND MMCIND OF EEWSUB(ESBACT) NOT = MMCIND OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG.

           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT) = 'N'
           AND MMCIND OF EEWSUB(ESBACT) = MMCIND OF DEMMAS-REC)
              MOVE SPACE               TO MMCIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT) = 'Y'
           AND MMCIND OF EEWSUB(ESBACT) = MMCIND OF DEMMAS-REC)
              PERFORM A1110-MCMMAS-CHG           THRU A1119-EXIT
              IF MCRCHG-FLAG = 'Y'
                 MOVE MMCIND OF EEWSUB(ESBACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                     TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MDMMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MDMMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MDMMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                 MOVE 1                       TO LINENO OF MDMMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDMMAS-REC
                 PERFORM A1100-WRITE-MDMMAS      THRU A1109-EXIT.
           IF EMPSTA OF EEWSUB(ESBACT) NOT =
                                        EMPSTA OF SUBMEM(TMPACT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMPSTA OF EEWSUB(ESBACT)
                                     TO EMPSTA OF MDTTAB(LIN-0001)
           END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'N'
           AND MMDIND OF EEWSUB(ESBACT) NOT = MMDIND OF DEMMAS-REC)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MMDIND OF EEWSUB(ESBACT)
                                       TO MMDIND OF MDTTAB(LIN-0001).
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF DEMMAS-CHANGE
              MOVE 1                   TO LINENO OF MDTTAB(LIN-0001)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0001)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0001)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0001)
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
              MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
              MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
              MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
              MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
              MOVE RELCOD OF EEWSUB(ESBACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
              MOVE RELTYP OF EEWSUB(ESBACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
              MOVE TITLCD OF EEWSUB(ESBACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
              MOVE '1'                 TO STATCD OF MDTTAB(LIN-0001)
              MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
              MOVE MHCIND OF EEWSUB(ESBACT)
                                       TO MHCIND OF MDTMAS-REC
              IF INDUPD OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE INDUPD OF EEWSUB(ESBACT)
                                       TO INDUPD OF MDTMAS-REC
              ELSE
                 MOVE 'N'              TO INDUPD OF MDTMAS-REC
              END-IF
              MOVE OMEDAT OF EEWSUB(ESBACT)
                                       TO OMEDAT OF MDTTAB(LIN-0001)
              MOVE CRDMTH OF EEWSUB(ESBACT)
                                       TO CRDMTH OF MDTTAB(LIN-0001)
              MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
              MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
              MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
              MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
              MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
              MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
              MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
              MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
              MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
              MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
              IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0001)
              ELSE
                 MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001)
              END-IF
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0001)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0001)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0001)
                 MOVE EXCSUB OF EEWSUB(ESBACT)
                                       TO EXCSUB OF MDTTAB(LIN-0001)
                 MOVE EXCMEM OF EEWSUB(ESBACT)
                                       TO EXCMEM OF MDTTAB(LIN-0001)
              END-IF
              IF EXCMEM-FLAG = 'Y'
              OR ADD-EXCMEM
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
              ELSE
                 MOVE 'N'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE SPACES           TO EXCHNG OF MDTTAB(LIN-0001)
              END-IF
              MOVE EMPSTA OF EEWSUB(ESBACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              MOVE EMSTCD OF EEWSUB(ESBACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
              MOVE MARSTA OF EEWSUB(ESBACT)
                                       TO MARSTA OF MDTTAB(LIN-0001).
      *
           IF HOLDCD OF EEWSUB(ESBACT) NOT = SPACES
              MOVE MEMBNO OF EEWSUB(ESBACT)   TO HLDCOD-MEM
              MOVE HOLDCD OF EEWSUB(ESBACT)   TO HLDCOD-HLD
              PERFORM A750-HLDCOD-CHK         THRU A759-EXIT
              IF HLDCOD-FOUND
                 GO TO A642-STEP-5
              ELSE
                 MOVE 1                TO LINENO OF MDTTAB(LIN-0001)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0001)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0001)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0001)
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
                 MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
                 MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
                 MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
                 MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
                 MOVE HOLDCD OF EEWSUB(ESBACT)
                                       TO HOLDCD OF MDTTAB(LIN-0001)
                 MOVE '1'              TO STATCD OF MDTTAB(LIN-0001)
                 MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
              END-IF
           END-IF.

           IF  DEMMAS-CHANGE
           OR (TMPACT > 0
           AND MEMEFF OF EEWSUB(ESBACT) NOT = MEMEFF OF SUBMEM(TMPACT)
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = MEMEXP OF SUBMEM(TMPACT))
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0001)
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0001).
      *
       A642-STEP-5.
           IF PRCPCP OF EEWHDR-WRK = 'N'
           OR PCPCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-6.

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM A760-SUBPCP             THRU A769-EXIT
                 IF PPSTMP = 0
                 AND BYPEDT OF EDIENR-REC = 'N'
                    NEXT SENTENCE
                 ELSE
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND TMPACT = ZEROES)
                 OR (PCPCOD OF EEWSUB(ESBACT) NOT =
                               PROVNO OF SUBPCP(TMPACT, PPSTMP)
                 OR (PCPORG OF EEWSUB(ESBACT) NOT =
                              PRVORG OF SUBPCP(TMPACT, PPSTMP)
                 AND PCPORG OF EEWSUB(ESBACT) NOT = SPACES)
                 OR  PCPMCP OF EEWSUB(ESBACT) NOT =
                              MEMCAP OF SUBPCP(TMPACT, PPSTMP))
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                           SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    IF PCPREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE PCPREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE PCPEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE PCPEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE PCPCOD OF EEWSUB(ESBACT) TO
                                          PROVNO OF MDTTAB(LIN-0004)
                    END-IF
                       MOVE PCPORG OF EEWSUB(ESBACT) TO
                                          PRVORG OF MDTTAB(LIN-0004)
                       MOVE PCPMCP OF EEWSUB(ESBACT) TO
                                          PCPMCP OF MDTTAB(LIN-0004)
                    IF PCPOVR OF EEWSUB(ESBACT) = SPACES
                       MOVE 'N'        TO PCPOVR OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPOVR OF EEWSUB(ESBACT) TO
                                          PCPOVR OF MDTTAB(LIN-0004)
                    END-IF
                    IF PCPTRM OF EEWSUB(ESBACT) = SPACES
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                                       MOVE 'Y' TO PCPTRM-FLAG
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
                    MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
                    MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
                    MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
                    MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
                    MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
                    MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
                    MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
                    MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
                    MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
                    MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES' TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       A642-STEP-6.
           IF PRCSEC OF EEWHDR-WRK = 'N'
           OR SECCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-7.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO A642-STEP-7.
              IF SECCOD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM A770-SUBSEC             THRU A779-EXIT
              ELSE
                 GO TO A642-STEP-7.
      *
                 IF SPSTMP = ZEROES
                    GO TO A642-ADDSEC.
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES)
              GO TO A642-ADDSEC.

           IF SECCOD OF EEWSUB(ESBACT) NOT =
                                       PROVNO OF SUBSEC(TMPACT, SPSTMP)
           OR (SECORG OF EEWSUB(ESBACT) NOT =
                                       PRVORG OF SUBSEC(TMPACT, SPSTMP)
           AND SECORG OF EEWSUB(ESBACT) NOT = SPACES)
           OR SECMCP OF EEWSUB(ESBACT) NOT =
                                       MEMCAP OF SUBSEC(TMPACT, SPSTMP)
           OR SECEFF OF EEWSUB(ESBACT) NOT =
                                       SECEFF OF SUBSEC(TMPACT, SPSTMP)
           OR SECEXP OF EEWSUB(ESBACT) NOT =
                                       SECEXP OF SUBSEC(TMPACT, SPSTMP)
                                                 GO TO A642-ADDSEC.
      *
           GO TO A642-STEP-7.
       A642-ADDSEC.
           MOVE 5             TO LINENO OF MDTTAB(LIN-0005)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0005)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0005)
           MOVE '1'           TO STATCD OF MDTTAB(LIN-0005)
           MOVE SEQNUM OF WS-WORK TO     SEQNUM OF MDTTAB(LIN-0005)
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0005)
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0005)
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF MDTTAB(LIN-0005)
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF MDTTAB(LIN-0005)
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF MDTTAB(LIN-0005)
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTTAB(LIN-0005)
           IF SECREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE SECREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF MDTTAB(LIN-0005)
           MOVE SECEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0005)
           MOVE SECEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0005)
           IF SECCOD OF EEWSUB(ESBACT) NOT = SPACES
               MOVE SECCOD OF EEWSUB(ESBACT) TO
                                       SECPRV OF MDTTAB(LIN-0005)
           END-IF
           MOVE SECORG OF EEWSUB(ESBACT) TO SECORG OF MDTTAB(LIN-0005)
           MOVE SECMCP OF EEWSUB(ESBACT) TO SECMCP OF MDTTAB(LIN-0005)
           IF SECOVR OF EEWSUB(ESBACT) = SPACES
              MOVE 'N'        TO SECOVR OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECOVR OF EEWSUB(ESBACT) TO
                                          SECOVR OF MDTTAB(LIN-0005)
           END-IF
           IF SECTRM OF EEWSUB(ESBACT) = SPACES
              MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           END-IF
           IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0005)
           END-IF
           MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2 OF MDTTAB(LIN-0005)
           MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3 OF MDTTAB(LIN-0005)
           MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1 OF MDTTAB(LIN-0005)
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTTAB(LIN-0005)
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTTAB(LIN-0005)
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTTAB(LIN-0005)
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTTAB(LIN-0005)
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTTAB(LIN-0005)
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTTAB(LIN-0005)
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTTAB(LIN-0005)
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTTAB(LIN-0005)
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTTAB(LIN-0005)
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTTAB(LIN-0005)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0005)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0005)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0005)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0005)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0005)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0005)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0005).
       A642-STEP-7.
           IF PRCMCS OF EEWHDR-WRK = 'N'
           OR MEDCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-8.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO A642-STEP-8.
      *
           IF  (MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND  MEDSTS OF EEWSUB(ESBACT) NOT = SPACES)
              PERFORM A780-SUBMED                THRU A789-EXIT
           ELSE
              GO TO A642-STEP-8.
      *
           IF SMDTMP = ZEROES
              GO TO A642-ADDMED.
      *
           IF BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES
              GO TO A642-ADDMED.

           IF  MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND  MEDSTS OF EEWSUB(ESBACT) NOT = SPACES
            IF MEDCTY OF EEWSUB(ESBACT) NOT =
                              MEDCTY OF SUBMED(TMPACT, SMDTMP)
            OR (MEDSTS OF EEWSUB(ESBACT) NOT =
                              MEDSTS OF SUBMED(TMPACT, SMDTMP))
              GO TO A642-ADDMED.
      *
           GO TO A642-STEP-8.
       A642-ADDMED.
           MOVE 6                   TO LINENO OF MDTTAB(LIN-0006)
           MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0006)
           MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0006)
           MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0006)
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0006)
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0006)
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF MDTTAB(LIN-0006)
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF MDTTAB(LIN-0006)
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF MDTTAB(LIN-0006)
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTTAB(LIN-0006)
           IF MEDREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE MEDREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF MDTTAB(LIN-0006)
           MOVE MEDEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0006)
           MOVE MEDEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0006)
           MOVE MEDCTY OF EEWSUB(ESBACT) TO MEDCTY OF MDTTAB(LIN-0006)
           MOVE MEDSTS OF EEWSUB(ESBACT) TO MEDSTS OF MDTTAB(LIN-0006)
           IF MEDTRM OF EEWSUB(ESBACT) = SPACES
              MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEDTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           END-IF
           IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0006)
           END-IF
           MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2 OF MDTTAB(LIN-0006)
           MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3 OF MDTTAB(LIN-0006)
           MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1 OF MDTTAB(LIN-0006)
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTTAB(LIN-0006)
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTTAB(LIN-0006)
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTTAB(LIN-0006)
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTTAB(LIN-0006)
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTTAB(LIN-0006)
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTTAB(LIN-0006)
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTTAB(LIN-0006)
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTTAB(LIN-0006)
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTTAB(LIN-0006)
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTTAB(LIN-0006)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0006)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0006)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0006)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0006)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0006)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0006)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0006).
       A642-STEP-8.
           IF PRCFEE OF EEWHDR-WRK = 'N'
           OR FEECHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-9.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO A642-STEP-9.
      *
           IF FEECOD OF EEWSUB(ESBACT) NOT = SPACES
              PERFORM A790-SUBFEE                THRU A799-EXIT
           ELSE
              GO TO A642-STEP-9.
      *
           IF SFETMP = ZEROES
              GO TO A642-ADDFEE.
      *
           IF BYPEDT OF EDIENR-REC = 'Y'
           AND TMPACT = ZEROES
              GO TO A642-ADDFEE.

           IF FEECOD OF EEWSUB(ESBACT) NOT =
                               FEECOD OF SUBFEE(TMPACT, SFETMP)
              GO TO A642-ADDFEE.
      *
           GO TO A642-STEP-9.
       A642-ADDFEE.
           MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
           MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0004)
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0004)
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0004)
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF MDTTAB(LIN-0004)
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF MDTTAB(LIN-0004)
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF MDTTAB(LIN-0004)
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTTAB(LIN-0004)
           IF FEEREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE FEEREA OF EEWSUB(ESBACT)
                                   TO REASCD OF MDTTAB(LIN-0004)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                   TO REASCD OF MDTTAB(LIN-0004)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT) TO FORNAM OF MDTTAB(LIN-0004)
           MOVE FEEEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0004)
           MOVE FEEEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0004)
           MOVE FEECOD OF EEWSUB(ESBACT) TO FEECOD OF MDTTAB(LIN-0004)
           IF FEETRM OF EEWSUB(ESBACT) NOT = SPACES
              MOVE FEETRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              MOVE 'Y'                 TO FEETRM-FLAG
           ELSE
              IF PCPTRM-NOT-USED
                MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              END-IF
           END-IF
           IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
           END-IF
           MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2 OF MDTTAB(LIN-0004)
           MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3 OF MDTTAB(LIN-0004)
           MOVE PKGOVR OF EEWSUB(ESBACT) TO PKGOVR OF MDTTAB(LIN-0004)
           MOVE ACCTN2 OF EEWSUB(ESBACT) TO ACCTN2 OF MDTTAB(LIN-0004)
           MOVE BILMOD OF EEWSUB(ESBACT) TO BILMOD OF MDTTAB(LIN-0004)
           MOVE BEGMTH OF EEWSUB(ESBACT) TO BEGMTH OF MDTTAB(LIN-0004)
           MOVE IMDBIL OF EEWSUB(ESBACT) TO IMDBIL OF MDTTAB(LIN-0004)
           MOVE INTBIL OF EEWSUB(ESBACT) TO INTBIL OF MDTTAB(LIN-0004)
           MOVE BILCYC OF EEWSUB(ESBACT) TO BILCYC OF MDTTAB(LIN-0004)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0004)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0004)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0004)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0004)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
               MOVE 'D'                TO PRTCOD OF MDTTAB(LIN-0004)
           ELSE
               MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       A642-STEP-9.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCACT OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-10.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
             IF  ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL'
                 PERFORM A800-SUBENB             THRU A809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND TMPACT = ZEROES)
                 OR ACCTNO OF EEWSUB(ESBACT) NOT =
                               ACCTNO OF SUBENB(TMPACT, ENSTMP)
                    MOVE 2             TO LINENO OF MDTTAB(LIN-0002)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0002)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0002)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0002)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0002)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                    MOVE ACCTNO OF EEWSUB(ESBACT)
                                       TO ACCTNO OF MDTTAB(LIN-0002)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0002)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                    IF ENBTRM OF EEWSUB(ESBACT) = SPACES
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0002)
                    END-IF
                    IF OMEDAT OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE OMEDAT OF EEWSUB(ESBACT)
                                         TO OMEDAT OF MDTTAB(LIN-0002)
                    END-IF
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0002)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES' TO EXCHNG OF MDTTAB(LIN-0002)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0002)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0002)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0002)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0002)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
       A642-STEP-10.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCTIR OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-11.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TIERCD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM A800-SUBENB             THRU A809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND TMPACT = ZEROES)
                 OR TIERCD OF EEWSUB(ESBACT) NOT =
                               TIERCD OF SUBENB(TMPACT, ENSTMP 1)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE TIRFLG OF EEWSUB(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE MEMSTA OF EEWSUB(ESBACT)
                                       TO MEMSTA OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES' TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       A642-STEP-11.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCBPK OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-11A.
      *
      ****--------------------------------------------------------****
      ****  PMHS-374  KCT  Fix                                    ****
      ****  Also capture tier code to prevent error in ME102A.    ****
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF WS-WORK
              IF BENPKG OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM A800-SUBENB                 THRU A809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND TMPACT = ZEROES)
                 OR BENPKG OF EEWSUB(ESBACT) NOT =
                               BENPKG OF SUBENB(TMPACT, ENSTMP)
                    INITIALIZE GPHMAS-REC
                    MOVE ENBGRP OF WS-WORK       TO GRPNUM OF GPHMAS-KEY
                    MOVE +1                      TO CONSET OF GPHMAS-KEY
                    PERFORM B650-GPHMAS          THRU B659-EXIT
                    IF SW-OK = 'N'               GO TO A649-EXIT
                    END-IF
                    IF BENEQU = 'Y'
                       MOVE 'N'                  TO BENEQU
                                                 GO TO A649-EXIT
                    END-IF
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          MOVE TIRFLG OF EEWDEP(ESBACT)
      ****                             TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE TIRFLG OF EEWSUB(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       A642-STEP-11A.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO A642-STEP-12.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF (USRFL1 OF EEWSUB(ESBACT) NOT = SPACES
              OR USRFL2 OF EEWSUB(ESBACT) NOT = SPACES
              OR USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
                 PERFORM A800-SUBENB                 THRU A809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND TMPACT = ZEROES)
                 OR (USRFL1 OF EEWSUB(ESBACT) NOT =
                               USRFL1 OF SUBENB(TMPACT, ENSTMP)
                 OR USRFL2 OF EEWSUB(ESBACT) NOT =
                               USRFL2 OF SUBENB(TMPACT, ENSTMP)
                 OR USRFL3 OF EEWSUB(ESBACT) NOT =
                               USRFL3 OF SUBENB(TMPACT, ENSTMP))
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          MOVE TIRFLG OF EEWDEP(ESBACT)
                    MOVE TIRFLG OF EEWSUB(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                   IF EXCMEM-FLAG = 'Y'
                   OR ADD-EXCMEM
                      MOVE 'Y'         TO EXCIND OF MDTTAB(LIN-0004)
                   ELSE
                      MOVE 'N'         TO EXCIND OF MDTTAB(LIN-0004)
                      MOVE SPACES      TO EXCHNG OF MDTTAB(LIN-0004)
                   END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       A642-STEP-12.
           IF EXTMEM OF EEWSUB(ESBACT) = SPACES
           AND EXTGRP OF EEWSUB(ESBACT) = SPACES
           AND EXTSUB OF EEWSUB(ESBACT) = SPACES
                                                 GO TO A642-STEP-13.
      *
           MOVE 7                      TO LINENO OF MDTTAB(LIN-0007).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0007).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0007).
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                         TO SUBSNO OF MDTTAB(LIN-0007).
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                         TO MEMBNO OF MDTTAB(LIN-0007).
           MOVE MEMEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0007).
           MOVE MEMEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0007).
           MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF MDTTAB(LIN-0007).
           MOVE EXTMEM OF EEWSUB(ESBACT) TO EXTMEM OF MDTTAB(LIN-0007).
           MOVE EXTGRP OF EEWSUB(ESBACT) TO EXTGRP OF MDTTAB(LIN-0007).
           MOVE EXTCON OF EEWSUB(ESBACT) TO EXTCON OF MDTTAB(LIN-0007).
           MOVE EXTEFF OF EEWSUB(ESBACT) TO EXTEFF OF MDTTAB(LIN-0007).
           MOVE EXTEXP OF EEWSUB(ESBACT) TO EXTEXP OF MDTTAB(LIN-0007).
           MOVE EXTSUB OF EEWSUB(ESBACT) TO EXTSUB OF MDTTAB(LIN-0007).
           MOVE HISSEQ OF EEWSUB(ESBACT) TO HISSEQ OF MDTTAB(LIN-0007).
           MOVE CTLPLN OF EEWSUB(ESBACT) TO CTLPLN OF MDTTAB(LIN-0007).
           MOVE EXTREL OF EEWSUB(ESBACT) TO EXTREL OF MDTTAB(LIN-0007).
           MOVE PRVPLN OF EEWSUB(ESBACT) TO PRVPLN OF MDTTAB(LIN-0007).
           MOVE PRVNET OF EEWSUB(ESBACT) TO PRVNET OF MDTTAB(LIN-0007).
           MOVE PROCOD OF EEWSUB(ESBACT) TO PROCOD OF MDTTAB(LIN-0007).
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTTAB(LIN-0007).
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTTAB(LIN-0007).
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTTAB(LIN-0007).
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTTAB(LIN-0007).
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTTAB(LIN-0007).
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTTAB(LIN-0007).
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTTAB(LIN-0007).
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTTAB(LIN-0007).
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTTAB(LIN-0007).
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTTAB(LIN-0007).
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0007)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0007)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0007)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0007)
           END-IF.
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0007)
           END-IF.
       A642-STEP-13.
           IF  SALEFF OF EEWSUB(ESBACT) = ZEROS
           AND SALEXP OF EEWSUB(ESBACT) = ZEROS
           AND SALAMT OF EEWSUB(ESBACT) = ZEROS
              GO TO A642-STEP-14.
      *
           MOVE 8                      TO LINENO OF MDTTAB(LIN-0008).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0008).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0008).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0008).
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0008).
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0008).
           MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF MDTTAB(LIN-0008).
           MOVE CGAOVR OF EEWSUB(ESBACT) TO CGAOVR OF MDTTAB(LIN-0008).
           MOVE CGTOVR OF EEWSUB(ESBACT) TO CGTOVR OF MDTTAB(LIN-0008).
           MOVE DALOVR OF EEWSUB(ESBACT) TO DALOVR OF MDTTAB(LIN-0008).
           MOVE SALOVR OF EEWSUB(ESBACT) TO SALOVR OF MDTTAB(LIN-0008).
           MOVE CBXOVR OF EEWSUB(ESBACT) TO CBXOVR OF MDTTAB(LIN-0008).
           MOVE CBEOVR OF EEWSUB(ESBACT) TO CBEOVR OF MDTTAB(LIN-0008).
           MOVE APCOVR OF EEWSUB(ESBACT) TO APCOVR OF MDTTAB(LIN-0008).
           MOVE SSSOVR OF EEWSUB(ESBACT) TO SSSOVR OF MDTTAB(LIN-0008).
           MOVE VRCOVR OF EEWSUB(ESBACT) TO VRCOVR OF MDTTAB(LIN-0008).
           MOVE RMTOVR OF EEWSUB(ESBACT) TO RMTOVR OF MDTTAB(LIN-0008).
           IF  SALEFF OF EEWSUB(ESBACT) = 99999999
              MOVE 9999999             TO EFFDAT OF MDTTAB(LIN-0008)
           ELSE
           IF  SALEFF OF EEWSUB(ESBACT) = ZEROS
              MOVE ZEROS               TO EFFDAT OF MDTTAB(LIN-0008)
           ELSE
              COMPUTE EFFDAT OF MDTTAB(LIN-0008) =
                  SALEFF OF EEWSUB(ESBACT) - 18000000.
           IF  SALEXP OF EEWSUB(ESBACT) = 99999999
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0008)
           ELSE
           IF  SALEXP OF EEWSUB(ESBACT) = ZEROS
              MOVE ZEROS               TO EXPDAT OF MDTTAB(LIN-0008)
           ELSE
              COMPUTE EXPDAT OF MDTTAB(LIN-0008) =
                  SALEXP OF EEWSUB(ESBACT) - 18000000.
           MOVE SALAMT OF EEWSUB(ESBACT) TO SALAMT OF MDTTAB(LIN-0008).
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0008).
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'                 TO PRTCOD OF MDTTAB(LIN-0008)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0008).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0008)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0008)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0008)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0008)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0008)
           END-IF.
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0008)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0008)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0008)
           END-IF.
       A642-STEP-14.
              IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE ENBTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0002).
              IF PCPTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE PCPTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0004).
              IF SECTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE SECTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0005).
              IF MEDTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE MEDTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0006).
              IF ACCTNO OF MDTTAB(LIN-0002) NOT = SPACES
                 IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                    MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                 END-IF
              END-IF.
      ****--------------------------------------------------------****
      ****  CR141350  KCT  Fix                                    ****
      ****  Prevent Reason Code from being overlaid.              ****
      ****--------------------------------------------------------****
      ****    IF PCPREA OF EEWSUB(ESBACT) NOT = SPACES
      ****       MOVE PCPREA OF EEWSUB(ESBACT)
      ****                               TO REASCD OF MDTTAB(LIN-0004).
           IF  REASCD OF MDTTAB(LIN-0004) = SPACES
           AND PCPREA OF EEWSUB(ESBACT) > SPACES
              MOVE PCPREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004).
              IF SECREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE SECREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0005).
              IF MEDREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE MEDREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0006).
      *
           MOVE DOCNUM OF EEWSUB(ESBACT) TO DOCNUM OF WS-WORK.
      *
       A642-STEP-15.
           IF  REACAT OF EEWSB3(ESBACT)(1:6) = 'CANCEL'
           AND CANEFF OF EEWSB3(ESBACT) NOT= ZEROS
              CONTINUE
           ELSE
              GO TO A642-WRITE.

           MOVE 9                      TO LINENO OF MDTTAB(LIN-0009).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0009).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0009).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0009).
           MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF MDTTAB(LIN-0009).
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDTTAB(LIN-0009).
           MOVE RELTYP OF EEWSUB(ESBACT) TO RELTYP OF MDTTAB(LIN-0009).
           MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF MDTTAB(LIN-0009).
           MOVE LSTNAM OF EEWSUB(ESBACT) TO LSTNAM OF MDTTAB(LIN-0009)
           MOVE MIDNAM OF EEWSUB(ESBACT) TO MIDNAM OF MDTTAB(LIN-0009)
           MOVE FSTNAM OF EEWSUB(ESBACT) TO FSTNAM OF MDTTAB(LIN-0009)
           IF GRPNUM OF EEWSUB(ESBACT) = SPACES
              MOVE GRPNUM OF EEWHDR-WRK TO GRPNUM OF MDTTAB(LIN-0009)
           ELSE
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0009).
           MOVE MEMREA OF EEWSUB(ESBACT) TO REASCD OF MDTTAB(LIN-0009)
           MOVE ADRLN1 OF EEWSUB(ESBACT) TO ADRLN1 OF MDTTAB(LIN-0009)
           MOVE ADRLN2 OF EEWSUB(ESBACT) TO ADRLN2 OF MDTTAB(LIN-0009)
           MOVE CITYCD OF EEWSUB(ESBACT) TO CITYCD OF MDTTAB(LIN-0009)
           MOVE STACOD OF EEWSUB(ESBACT) TO STACOD OF MDTTAB(LIN-0009)
           MOVE ZIPCOD OF EEWSUB(ESBACT) TO ZIPCOD OF MDTTAB(LIN-0009)
           MOVE CTRYCD OF EEWSUB(ESBACT) TO CTRYCD OF MDTTAB(LIN-0009)
           MOVE PRTCOD OF EEWSUB(ESBACT) TO PRTCOD OF MDTTAB(LIN-0009)
           MOVE EXCHNG OF EEWSB2(ESBACT) TO EXCHNG OF MDTTAB(LIN-0009).
      *
           IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0009)
           ELSE
              MOVE ' '                 TO EXCIND OF MDTTAB(LIN-0009).
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    MOVE EXCHNG OF MEMMAS-REC TO EXCHNG OF MDTTAB(LIN-0009)
              MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0009)
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0009)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0009).
      *
           MOVE EXCSUB OF EEWSUB(ESBACT) TO EXCSUB OF MDTTAB(LIN-0009).
           MOVE EXCMEM OF EEWSUB(ESBACT) TO EXCMEM OF MDTTAB(LIN-0009).
           MOVE CANEFF OF EEWSB3(ESBACT) TO CANEFF OF MDTTAB(LIN-0009).
           MOVE REACAT OF EEWSB3(ESBACT) TO REACAT OF MDTTAB(LIN-0009).
      *
       A642-WRITE.
           MOVE 'SUB'                            TO MEMEXT-TYP.
           MOVE 'S'                              TO RECTYP-FLAG.
           MOVE 'N'                              TO MDT-FLAG.
           MOVE 'N'                              TO SEQ-FLAG.
           MOVE 'N'                              TO PRCSEQ-FLAG.
           MOVE 'Y'                              TO FIRST-LINE-FLAG.
           PERFORM A690-MDTMAS-WRITE             THRU A699-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.

           IF MDT-ADDED
              ADD 1                    TO TOTBAT OF WS-WORK
              ADD 1                    TO NUMMDT OF WS-WORK
              ADD 1                    TO BATCHG OF WS-WORK.
       A649-EXIT.
           EXIT.
      *
       A650-ME1022-DEP.
      ***************************************************************
      *‚                                                            *
      ***************************************************************
           PERFORM A740-INTMDT                   THRU A749-EXIT.
      *
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTMAS-REC.
           MOVE '2'                      TO RECTYP OF MDTMAS-REC.
           MOVE LINENO OF WS-WORK        TO LINENO OF MDTMAS-REC.
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTMAS-REC.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTMAS-REC.
           MOVE NAMKEY OF EEWDEP(EDPACT) TO NAMKEY OF MDTMAS-REC.
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTMAS-REC.
           MOVE ADRLN1 OF EEWDEP(EDPACT) TO ADRLN1 OF MDTMAS-REC.
           MOVE ADRLN2 OF EEWDEP(EDPACT) TO ADRLN2 OF MDTMAS-REC.
           MOVE CITYCD OF EEWDEP(EDPACT) TO CITYCD OF MDTMAS-REC.
           MOVE STACOD OF EEWDEP(EDPACT) TO STACOD OF MDTMAS-REC.
           MOVE ZIPCOD OF EEWDEP(EDPACT) TO ZIPCOD OF MDTMAS-REC.
           MOVE CTRYCD OF EEWDEP(EDPACT) TO CTRYCD OF MDTMAS-REC.
           MOVE LOCQLF OF EEWDEP(EDPACT) TO LOCQLF OF MDTMAS-REC.
           MOVE AREACD OF EEWDEP(EDPACT) TO AREACD OF MDTMAS-REC.
           MOVE HOMPH1 OF EEWDEP(EDPACT) TO HOMPH1 OF MDTMAS-REC.
           MOVE HOMPH2 OF EEWDEP(EDPACT) TO HOMPH2 OF MDTMAS-REC.
           MOVE HOMPH3 OF EEWDEP(EDPACT) TO HOMPH3 OF MDTMAS-REC.
           MOVE WRKPH1 OF EEWDEP(EDPACT) TO WRKPH1 OF MDTMAS-REC.
           MOVE WRKPH2 OF EEWDEP(EDPACT) TO WRKPH2 OF MDTMAS-REC.
           MOVE WRKPH3 OF EEWDEP(EDPACT) TO WRKPH3 OF MDTMAS-REC.
           MOVE WRKEXT OF EEWDEP(EDPACT) TO WRKEXT OF MDTMAS-REC.
           MOVE FAXNUM OF EEWDEP(EDPACT) TO FAXNUM OF MDTMAS-REC.
           MOVE OTHPHN OF EEWDEP(EDPACT) TO OTHPHN OF MDTMAS-REC.
           MOVE EMLIND OF EEWDEP(EDPACT) TO EMLIND OF MDTMAS-REC.
           MOVE ELMAIL OF EEWDEP(EDPACT) TO ELMAIL OF MDTMAS-REC.
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTMAS-REC.
           MOVE SOCSEC OF EEWDEP(EDPACT) TO SOCSEC OF MDTMAS-REC.
           MOVE BTHDAT OF EEWDEP(EDPACT) TO BTHDAT OF MDTMAS-REC.
           MOVE BTHSEQ OF EEWDEP(EDPACT) TO BTHSEQ OF MDTMAS-REC.
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF MDTMAS-REC.
           MOVE RACECD OF EEWDEP(EDPACT) TO RACECD OF MDTMAS-REC.
           MOVE TYPCOD OF EEWDEP(EDPACT) TO TYPCOD OF MDTMAS-REC.
           MOVE HOLDCD OF EEWDEP(EDPACT) TO HOLDCD OF MDTMAS-REC.
           MOVE PCPCOD OF EEWDEP(EDPACT) TO PROVNO OF MDTMAS-REC.
           MOVE SECCOD OF EEWDEP(EDPACT) TO SECPRV OF MDTMAS-REC.
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTMAS-REC.
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTMAS-REC.
           MOVE MEMSTA OF EEWDEP(EDPACT) TO MEMSTA OF MDTMAS-REC.
           MOVE STUSTA OF EEWDEP(EDPACT) TO STUSTA OF MDTMAS-REC.
           MOVE HNDIND OF EEWDEP(EDPACT) TO HNDIND OF MDTMAS-REC.
           MOVE EDUBEG OF EEWDEP(EDPACT) TO EDUBEG OF MDTMAS-REC.
           MOVE EDUEND OF EEWDEP(EDPACT) TO EDUEND OF MDTMAS-REC.
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTMAS-REC.
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTMAS-REC.
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTMAS-REC.
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTMAS-REC.
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTMAS-REC.
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTMAS-REC.
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTMAS-REC.
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTMAS-REC.
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTMAS-REC.
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTMAS-REC.
           MOVE AUTEXP OF EEWDEP(EDPACT) TO AUTEXP OF MDTMAS-REC.
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTMAS-REC.
           MOVE ACCTNO OF EEWDEP(EDPACT) TO ACCTNO OF MDTMAS-REC.
           MOVE TIERCD OF EEWDEP(EDPACT) TO TIERCD OF MDTMAS-REC(01).
           MOVE FEECOD OF EEWDEP(EDPACT) TO FEECOD OF MDTMAS-REC.
           MOVE 'A'                      TO CHGTYP OF MDTMAS-REC.
           MOVE MEMREA OF EEWDEP(EDPACT) TO REASCD OF MDTMAS-REC.
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTMAS-REC.
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTMAS-REC.
           MOVE '1'                      TO STATCD OF MDTMAS-REC.
           MOVE INTKCD OF EEWDEP(EDPACT) TO INTKCD OF MDTMAS-REC.
           MOVE PCPORG OF EEWDEP(EDPACT) TO PRVORG OF MDTMAS-REC.
           MOVE SECORG OF EEWDEP(EDPACT) TO SECORG OF MDTMAS-REC.
           MOVE BENPKG OF EEWDEP(EDPACT) TO BENPKG OF MDTMAS-REC.
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTMAS-REC.
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTMAS-REC.
           MOVE ALTNUM OF EEWDEP(EDPACT) TO ALTNUM OF MDTMAS-REC.
           MOVE EMPSTA OF EEWDEP(EDPACT) TO EMPSTA OF MDTMAS-REC.
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTMAS-REC
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTMAS-REC.
           MOVE MEDCOV OF EEWDEP(EDPACT)
                                       TO MEDCOV OF MDTMAS-REC.
           MOVE DENCOV OF EEWDEP(EDPACT)
                                       TO DENCOV OF MDTMAS-REC.
           MOVE PCPOVR OF EEWDEP(EDPACT) TO PCPOVR OF MDTMAS-REC.
           MOVE SECOVR OF EEWDEP(EDPACT) TO SECOVR OF MDTMAS-REC.
           MOVE BILEXC OF EEWDEP(EDPACT) TO BILEXC OF MDTMAS-REC.
           MOVE PCPMCP OF EEWDEP(EDPACT) TO PCPMCP OF MDTMAS-REC.
           MOVE SECMCP OF EEWDEP(EDPACT) TO SECMCP OF MDTMAS-REC.
           MOVE MEDCTY OF EEWDEP(EDPACT) TO MEDCTY OF MDTMAS-REC.
           MOVE MEDSTS OF EEWDEP(EDPACT) TO MEDSTS OF MDTMAS-REC.
           MOVE CPAIND OF EEWDEP(EDPACT) TO CPAIND OF MDTMAS-REC.
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTMAS-REC.
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTMAS-REC.
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTMAS-REC.
           MOVE PKGOVR OF EEWDEP(EDPACT) TO PKGOVR OF MDTMAS-REC.
           MOVE ACCTN2 OF EEWDEP(EDPACT) TO ACCTN2 OF MDTMAS-REC.
           MOVE BILMOD OF EEWDEP(EDPACT) TO BILMOD OF MDTMAS-REC.
           MOVE BEGMTH OF EEWDEP(EDPACT) TO BEGMTH OF MDTMAS-REC.
           MOVE IMDBIL OF EEWDEP(EDPACT) TO IMDBIL OF MDTMAS-REC.
           MOVE INTBIL OF EEWDEP(EDPACT) TO INTBIL OF MDTMAS-REC.
           MOVE BILCYC OF EEWDEP(EDPACT) TO BILCYC OF MDTMAS-REC.
           MOVE EXTGRP OF EEWDEP(EDPACT) TO EXTGRP OF MDTMAS-REC.
           MOVE EXTMEM OF EEWDEP(EDPACT) TO EXTMEM OF MDTMAS-REC.
           MOVE EXTCON OF EEWDEP(EDPACT) TO EXTCON OF MDTMAS-REC.
           MOVE EXTEFF OF EEWDEP(EDPACT) TO EXTEFF OF MDTMAS-REC.
           MOVE EXTEXP OF EEWDEP(EDPACT) TO EXTEXP OF MDTMAS-REC.
           MOVE EXTSUB OF EEWDEP(EDPACT) TO EXTSUB OF MDTMAS-REC.
           MOVE HISSEQ OF EEWDEP(EDPACT) TO HISSEQ OF MDTMAS-REC.
           MOVE CTLPLN OF EEWDEP(EDPACT) TO CTLPLN OF MDTMAS-REC.
           MOVE EXTREL OF EEWDEP(EDPACT) TO EXTREL OF MDTMAS-REC.
           MOVE PRVPLN OF EEWDEP(EDPACT) TO PRVPLN OF MDTMAS-REC.
           MOVE PRVNET OF EEWDEP(EDPACT) TO PRVNET OF MDTMAS-REC.
           MOVE PROCOD OF EEWDEP(EDPACT) TO PROCOD OF MDTMAS-REC.
           MOVE EECOVR OF EEWDEP(EDPACT) TO EECOVR OF MDTMAS-REC.
           MOVE MMCEXC OF EEWDEP(EDPACT) TO MMCEXC OF MDTMAS-REC.
           MOVE COBDAT OF EEWDEP(EDPACT) TO COBDAT OF MDTMAS-REC.
           MOVE PAYLOC OF EEWDEP(EDPACT) TO PAYLOC OF MDTMAS-REC.
           MOVE PAYNUM OF EEWDEP(EDPACT) TO PAYNUM OF MDTMAS-REC.
           MOVE WRKLOC OF EEWDEP(EDPACT) TO WRKLOC OF MDTMAS-REC.
           MOVE SSNXRF OF EEWDEP(EDPACT) TO SSNXRF OF MDTMAS-REC.
           MOVE HICNNO OF EEWDEP(EDPACT) TO HICNNO OF MDTMAS-REC.
           MOVE PEBTFS OF EEWDEP(EDPACT) TO PEBTFS OF MDTMAS-REC.
           MOVE OTHINS OF EEWDEP(EDPACT) TO OTHINS OF MDTMAS-REC.
           MOVE PRICOD OF EEWDEP(EDPACT)           TO DECWRK.
           PERFORM 099-INT                         IF DEC-ERROR
              NEXT SENTENCE
           ELSE
              MOVE DECINT                TO PRICOD OF MDTMAS-REC.
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTMAS-REC.
           MOVE MHCIND OF EEWDEP(EDPACT) TO MHCIND OF MDTMAS-REC.
           MOVE OMEDAT OF EEWDEP(EDPACT) TO OMEDAT OF MDTMAS-REC.
           MOVE CRDMTH OF EEWDEP(EDPACT) TO CRDMTH OF MDTMAS-REC.
           MOVE MMDIND OF EEWDEP(EDPACT) TO MMDIND OF MDTMAS-REC.
           MOVE MMCIND OF EEWDEP(EDPACT) TO MMCIND OF MDTMAS-REC.
           MOVE CQLECD OF EEWDEP(EDPACT) TO CQLECD OF MDTMAS-REC.
           MOVE COBRAQ OF EEWDEP(EDPACT) TO COBRAQ OF MDTMAS-REC.
           MOVE COBRAB OF EEWDEP(EDPACT) TO COBRAB OF MDTMAS-REC.
           MOVE COBRAE OF EEWDEP(EDPACT) TO COBRAE OF MDTMAS-REC.
           MOVE EMSTCD OF EEWDEP(EDPACT) TO EMSTCD OF MDTMAS-REC.
           MOVE DETDAT OF EEWDEP(EDPACT) TO DETDAT OF MDTMAS-REC.
           MOVE EXTIND OF EEWDP2(EDPACT) TO EXTIND OF MDTMAS-REC.
           MOVE RSPIND OF EEWDP2(EDPACT) TO RSPIND OF MDTMAS-REC.
           MOVE BENIND OF EEWDP2(EDPACT) TO BENIND OF MDTMAS-REC.
           MOVE ALTIND OF EEWDP2(EDPACT) TO ALTIND OF MDTMAS-REC.
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTMAS-REC.
           IF EXCHNG OF MDTMAS-REC = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTMAS-REC
           ELSE
              MOVE ' '                   TO EXCIND OF MDTMAS-REC.
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTMAS-REC
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTMAS-REC
           MOVE RENREA OF EEWDEP(EDPACT) TO ENRTYP OF MDTMAS-REC.
           MOVE HOLDCD OF EEWDEP(EDPACT) TO HOLDCD OF MDTMAS-REC.
           MOVE GRPPOL OF EEWDEP(EDPACT) TO GRPPOL OF MDTMAS-REC.
           MOVE MEMNUM OF EEWDEP(EDPACT) TO MEMNUM OF MDTMAS-REC.
           MOVE OINNUM OF EEWDEP(EDPACT) TO OINNUM OF MDTMAS-REC.
           MOVE OINNAM OF EEWDEP(EDPACT) TO OINNAM OF MDTMAS-REC.
           MOVE COVEFF OF EEWDEP(EDPACT) TO COVEFF OF MDTMAS-REC.
           MOVE COVEXP OF EEWDEP(EDPACT) TO COVEXP OF MDTMAS-REC.
      *
           IF INDUPD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE INDUPD OF EEWDEP(EDPACT) TO INDUPD OF MDTMAS-REC
           ELSE
              MOVE 'N'                   TO INDUPD OF MDTMAS-REC.
      *
           IF CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF CPDMAS-REC
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF CPDMAS-REC
              MOVE BATSEQ OF MDTMAS-REC TO BATSEQ OF CPDMAS-REC
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF CPDMAS-REC
              MOVE LINENO OF MDTMAS-REC TO LINENO OF CPDMAS-REC
              IF CPAIND OF EEWDEP(EDPACT) = 'M'
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                        TO CPNUMB OF CPDMAS-REC
              ELSE
                 MOVE ZERO              TO LINENO OF CPDMAS-REC
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                        TO CPNUMB OF CPDMAS-REC
              END-IF
              PERFORM A960-WRITE-CPDMAS          THRU A969-EXIT.
      *
           IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF MMDMAS-REC
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF MMDMAS-REC
              MOVE BATSEQ OF MDTMAS-REC TO BATSEQ OF MMDMAS-REC
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF MMDMAS-REC
              MOVE LINENO OF MDTMAS-REC TO LINENO OF MMDMAS-REC
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MMDMAS-REC
              PERFORM A1020-WRITE-MMDMAS         THRU A1029-EXIT.
      *
           IF OTHINS OF MDTMAS-REC NOT = SPACES
              PERFORM A670-OTHINS-CHK            THRU A679-EXIT.
      *
           IF RSPIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE RSPDOCBT-REC
              MOVE BRANCD OF MDTMAS-KEY  TO BRANCD OF RSPDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY  TO BATDAT OF RSPDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY  TO BATSEQ OF RSPDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY  TO SEQNUM OF RSPDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY  TO LINENO OF RSPDOCBT-REC
              PERFORM A1310-WRITE-RSPDOCBT       THRU A1319-EXIT.
           IF BENIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE EXTDOCBT-REC
              MOVE BRANCD OF MDTMAS-KEY  TO BRANCD OF EXTDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY  TO BATDAT OF EXTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY  TO BATSEQ OF EXTDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY  TO SEQNUM OF EXTDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY  TO LINENO OF EXTDOCBT-REC
              MOVE ZERO                  TO MEMSEQ OF EXTDOCBT-REC
              PERFORM B1310-WRITE-EXTDOCBT       THRU B1319-EXIT.
      *
           IF ALTIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE ALTDOCBT-REC
              MOVE BRANCD OF MDTMAS-KEY  TO BRANCD OF ALTDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY  TO BATDAT OF ALTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY  TO BATSEQ OF ALTDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY  TO SEQNUM OF ALTDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY  TO LINENO OF ALTDOCBT-REC
              MOVE ZERO                  TO MEMSEQ OF ALTDOCBT-REC
              PERFORM A1350-WRITE-ALTDOCBT       THRU A1359-EXIT.
      *
           IF  WS-FULLUP NOT = 'A'
           AND WS-VERSID = '005010'
           AND ( EPCLS1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS3 OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTNM OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTQL OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTID OF EEWDP2(EDPACT) NOT = SPACES OR
                 RDTFMT OF EEWDP2(EDPACT) NOT = SPACES OR
                 RCTDAT OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLLST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLFST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLMID OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLPRE OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSUF OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCQ OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 MDRCCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CSPCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CNTSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 SCHSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPTCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 MBMCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBPHN OF EEWDP2(EDPACT) NOT = SPACES    )
              INITIALIZE EDIDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF EDIDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF EDIDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF EDIDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF EDIDOCBT-REC
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF MDTMAS-KEY  TO LINENO OF EDIDOCBT-REC
              ELSE
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                     TO LINENO OF EDIDOCBT-REC
              END-IF
              END-IF
              PERFORM A1380-WRITE-EDIDOCBT       THRU A1389-EXIT.
      *
           IF EXTIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE DEMDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC  TO BRANCD OF DEMDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY  TO BATDAT OF DEMDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY  TO BATSEQ OF DEMDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY  TO SEQNUM OF DEMDOCBT-REC
              MOVE LINENO OF MDTMAS-KEY  TO LINENO OF DEMDOCBT-REC
              PERFORM A1330-WRITE-DEMDOCBT       THRU A1339-EXIT.

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if there is no detail 3 record. ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
           IF (EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES')
           AND RELCOD OF EEWDP3(EDPACT) NOT = SPACES
              INITIALIZE EXCMDTBT-REC
              MOVE BRANCD OF MDTMAS-KEY          TO WS-EXC-BRANCD
              MOVE BATDAT OF MDTMAS-KEY          TO WS-EXC-BATDAT
              MOVE BATSEQ OF MDTMAS-KEY          TO WS-EXC-BATSEQ
              MOVE SEQNUM OF WS-WORK             TO WS-EXC-SEQNUM
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF WS-WORK          TO WS-EXC-LINENO
              END-IF
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                          TO WS-EXC-LINENO
              END-IF
              MOVE ZEROES                        TO WS-EXC-MEMSEQ
              MOVE 001                           TO WS-EXCSEQ
              PERFORM A1440-WRITE-EXCMDTBT       THRU A1449-EXIT.
      *
           IF MMCIND OF EEWDEP(EDPACT) = 'Y'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF MDMMAS-REC
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF MDMMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF MDMMAS-REC
              MOVE SEQNUM OF MDTMAS-KEY TO SEQNUM OF MDMMAS-REC
              MOVE LINENO OF MDTMAS-KEY TO LINENO OF MDMMAS-REC
              MOVE MEMBNO OF EEWDEP(EDPACT)
                                        TO MEMBNO OF MDMMAS-REC
              PERFORM A1120-WRITE-MDMMAS          THRU A1129-EXIT.
      *
           MOVE PRCDAT OF EEWHDR-WRK              TO TARDAT.
           PERFORM A930-CONVERT-DATE              THRU A939-EXIT.
           MOVE CNVDAT                  TO PRCDAT OF MDTMAS-REC.
           MOVE PRCTIM OF EEWHDR-WRK    TO PRCTIM OF MDTMAS-REC.
           ADD 1                        TO PRCSEQ OF WS-WORK.
           MOVE PRCSEQ OF WS-WORK       TO PRCSEQ OF MDTMAS-REC.
           PERFORM E140-DEP-MEMEXDBT             THRU E149-EXIT.
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Exit if error is detected.                            ****
      ****--------------------------------------------------------****
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A659-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Fill error line.                                      ****
      ****--------------------------------------------------------****
           PERFORM MDTMAS-WRITE                   IF INVALID-KEY
             MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
             MOVE GRPNUM OF MDTMAS-REC TO GRPNUM OF ERR-LINE
             MOVE MEMBNO OF MDTMAS-REC TO MEMBNO OF ERR-LINE
             MOVE SUBSNO OF MDTMAS-REC TO SUBSNO OF ERR-LINE
             MOVE RELCOD OF MDTMAS-REC TO RELCOD OF ERR-LINE
             MOVE CHGTYP OF MDTMAS-REC TO CHGTYP OF ERR-LINE
             MOVE 'Y'                             TO PRCERR
             MOVE 'MDTMAS'                        TO MI-PARM4
             MOVE MDTMAS-STATUS                   TO MI-PARM5
             MOVE 'EI06062'                       TO MI-PRIMARY-ID
             PERFORM X100-PRINT-ERROR             THRU X109-EXIT
‚            IF IN-DEBUG
‚               MOVE '@@ A650'                   TO LINE-E
‚               PERFORM 099-PRTERR
‚            END-IF
             GO TO A659-EXIT.
      *
           MOVE 'Y'                    TO SW-SEQ-USED.
           ADD 1                        TO NUMMDT OF WS-WORK.
           MOVE 'Y'                               TO REC-FLAG.
           IF DOCNUM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE DOCNUM OF EEWDEP(EDPACT)     TO DOCNUM OF WS-WORK
              PERFORM A1300-CRT-DODMAS          THRU A1309-EXIT
              IF PRCERR OF PGM-WORK = 'Y'       GO TO A659-EXIT.
      *
           MOVE PRCSEQ OF WS-WORK     TO PRCSEQ OF EETDEP(EDPACT).
           MOVE BRANCD OF MDTMAS-REC  TO BRANCD OF EETDEP(EDPACT).
           MOVE BATDAT OF MDTMAS-REC  TO BATDAT OF EETDEP(EDPACT).
           MOVE BATSEQ OF MDTMAS-REC  TO BATSEQ OF EETDEP(EDPACT).
           MOVE SEQNUM OF MDTMAS-REC  TO SEQNUM OF EETDEP(EDPACT).
           MOVE LINENO OF MDTMAS-REC  TO LINENO OF EETDEP(EDPACT).
      *
           IF GENRPT OF EDIENR-REC NOT = 'Y'
              GO TO A659-EXIT.
      *
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF DET-LINE.
           MOVE LINENO OF WS-WORK        TO LINENO OF DET-LINE.
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF DET-LINE.
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF DET-LINE.
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF DET-LINE.
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF DET-LINE.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF DET-LINE.
           MOVE BTHDAT OF EEWDEP(EDPACT) TO DATYMDN.
           MOVE CORR DATYMD                        TO DATMDY.
           MOVE DATMDY                   TO BTHDAT OF DET-LINE.
      *
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF DET-LINE.
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF NAME-AREA.
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF NAME-AREA.
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF NAME-AREA.
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF NAME-AREA.
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF NAME-AREA.
           PERFORM 099-NAMFMT.
           MOVE NAMKEY OF NAME-AREA      TO NAMKEY OF DET-LINE.
           IF CHGTYP OF EEWDEP(EDPACT) = 'A'
              MOVE 'ADD'                 TO CHGTYP OF DET-LINE
              ADD 1                      TO BATADD OF WS-WORK
           ELSE
              MOVE 'CHANGE'              TO CHGTYP OF DET-LINE
              ADD 1                      TO BATCHG OF WS-WORK.
      *
           MOVE DET-LINE TO LINE-P                 PERFORM 099-PRT.
       A659-EXIT.
           EXIT.
      *
       A660-ME1023-DEPADD.
      ***************************************************************
      *‚                                                            *
      ***************************************************************
           PERFORM A740-INTMDT                   THRU A749-EXIT.
      *
           PERFORM A900-INIT-MDTTAB              THRU A909-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           MOVE SPACES                 TO DOCNUM OF WS-WORK.
      *
           MOVE 001                      TO LINENO OF MDTTAB(LIN-0001).
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTTAB(LIN-0001).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0001).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0001).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0001).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0001).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0001).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0001).
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTTAB(LIN-0001).
           MOVE ADRLN1 OF EEWDEP(EDPACT) TO ADRLN1 OF MDTTAB(LIN-0001).
           MOVE ADRLN2 OF EEWDEP(EDPACT) TO ADRLN2 OF MDTTAB(LIN-0001).
           MOVE CITYCD OF EEWDEP(EDPACT) TO CITYCD OF MDTTAB(LIN-0001).
           MOVE STACOD OF EEWDEP(EDPACT) TO STACOD OF MDTTAB(LIN-0001).
           MOVE ZIPCOD OF EEWDEP(EDPACT) TO ZIPCOD OF MDTTAB(LIN-0001).
           MOVE AREACD OF EEWDEP(EDPACT) TO AREACD OF MDTTAB(LIN-0001).
           MOVE CTRYCD OF EEWDEP(EDPACT) TO CTRYCD OF MDTTAB(LIN-0001).
           MOVE LOCQLF OF EEWDEP(EDPACT) TO LOCQLF OF MDTTAB(LIN-0001).
           MOVE HOMPH1 OF EEWDEP(EDPACT) TO HOMPH1 OF MDTTAB(LIN-0001).
           MOVE HOMPH2 OF EEWDEP(EDPACT) TO HOMPH2 OF MDTTAB(LIN-0001).
           MOVE HOMPH3 OF EEWDEP(EDPACT) TO HOMPH3 OF MDTTAB(LIN-0001).
           MOVE WRKPH1 OF EEWDEP(EDPACT) TO WRKPH1 OF MDTTAB(LIN-0001).
           MOVE WRKPH2 OF EEWDEP(EDPACT) TO WRKPH2 OF MDTTAB(LIN-0001).
           MOVE WRKPH3 OF EEWDEP(EDPACT) TO WRKPH3 OF MDTTAB(LIN-0001).
           MOVE WRKEXT OF EEWDEP(EDPACT) TO WRKEXT OF MDTTAB(LIN-0001).
           MOVE FAXNUM OF EEWDEP(EDPACT) TO FAXNUM OF MDTTAB(LIN-0001).
           MOVE OTHPHN OF EEWDEP(EDPACT) TO OTHPHN OF MDTTAB(LIN-0001).
           MOVE EMLIND OF EEWDEP(EDPACT) TO EMLIND OF MDTTAB(LIN-0001).
           MOVE ELMAIL OF EEWDEP(EDPACT) TO ELMAIL OF MDTTAB(LIN-0001).
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTTAB(LIN-0001).
           MOVE BTHDAT OF EEWDEP(EDPACT) TO BTHDAT OF MDTTAB(LIN-0001).
           MOVE BTHSEQ OF EEWDEP(EDPACT) TO BTHSEQ OF MDTTAB(LIN-0001).
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF MDTTAB(LIN-0001).
           MOVE RACECD OF EEWDEP(EDPACT) TO RACECD OF MDTTAB(LIN-0001).
           MOVE MEMREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0001).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0001).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0001).
           IF EXPDAT OF MDTTAB(LIN-0001) = ZEROES
              MOVE WS-DT3-TRMEFF         TO EXPDAT OF MDTTAB(LIN-0001)
           END-IF
           MOVE TYPCOD OF EEWDEP(EDPACT) TO TYPCOD OF MDTTAB(LIN-0001).
           MOVE HOLDCD OF EEWDEP(EDPACT) TO HOLDCD OF MDTTAB(LIN-0001).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0001).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0001).
           MOVE MEMSTA OF EEWDEP(EDPACT) TO MEMSTA OF MDTTAB(LIN-0001).
           MOVE STUSTA OF EEWDEP(EDPACT) TO STUSTA OF MDTTAB(LIN-0001).
           MOVE EDUBEG OF EEWDEP(EDPACT) TO EDUBEG OF MDTTAB(LIN-0001).
           MOVE EDUEND OF EEWDEP(EDPACT) TO EDUEND OF MDTTAB(LIN-0001).
           MOVE HNDIND OF EEWDEP(EDPACT) TO HNDIND OF MDTTAB(LIN-0001).
           MOVE MEMNUM OF EEWDEP(EDPACT) TO MEMNUM OF MDTTAB(LIN-0001).
           MOVE GRPPOL OF EEWDEP(EDPACT) TO GRPPOL OF MDTTAB(LIN-0001).
           MOVE OINNAM OF EEWDEP(EDPACT) TO OINNAM OF MDTTAB(LIN-0001).
           IF MEDCOV OF EEWDEP(EDPACT) = SPACES
              MOVE 'N'                   TO MEDCOV OF MDTTAB(LIN-0001)
           ELSE
              MOVE MEDCOV OF EEWDEP(EDPACT)
                                        TO MEDCOV OF MDTTAB(LIN-0001).
           IF DENCOV OF EEWDEP(EDPACT) = SPACES
              MOVE 'N'                   TO DENCOV OF MDTTAB(LIN-0001)
           ELSE
              MOVE DENCOV OF EEWDEP(EDPACT)
                                       TO DENCOV OF MDTTAB(LIN-0001).

           MOVE OINNUM OF EEWDEP(EDPACT) TO OINNUM OF MDTTAB(LIN-0001).
           MOVE COVEFF OF EEWDEP(EDPACT) TO COVEFF OF MDTTAB(LIN-0001).
           MOVE COVEXP OF EEWDEP(EDPACT) TO COVEXP OF MDTTAB(LIN-0001).
           MOVE CQLECD OF EEWDEP(EDPACT) TO CQLECD OF MDTTAB(LIN-0001).
           MOVE COBRAQ OF EEWDEP(EDPACT) TO COBRAQ OF MDTTAB(LIN-0001).
           MOVE COBRAB OF EEWDEP(EDPACT) TO COBRAB OF MDTTAB(LIN-0001).
           MOVE COBRAE OF EEWDEP(EDPACT) TO COBRAE OF MDTTAB(LIN-0001).
           MOVE EMSTCD OF EEWDEP(EDPACT) TO EMSTCD OF MDTTAB(LIN-0001).
           MOVE DETDAT OF EEWDEP(EDPACT) TO DETDAT OF MDTTAB(LIN-0001).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0001).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0001).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0001).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0001).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0001).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0001).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0001).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0001).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0001).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0001).
           MOVE TIRFLG OF EEWDEP(EDPACT) TO TIRFLG OF MDTTAB(LIN-0001).
           MOVE AUTEXP OF EEWDEP(EDPACT) TO AUTEXP OF MDTTAB(LIN-0001).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0001).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0001).
           MOVE '1'                      TO STATCD OF MDTTAB(LIN-0001).
           MOVE ALTNUM OF EEWDEP(EDPACT) TO ALTNUM OF MDTTAB(LIN-0001).
           MOVE INTKCD OF EEWDEP(EDPACT) TO INTKCD OF MDTTAB(LIN-0001).
           MOVE OTHINS OF EEWDEP(EDPACT) TO OTHINS OF MDTTAB(LIN-0001).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0001).
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTTAB(LIN-0001).
           MOVE SOCSEC OF EEWDEP(EDPACT) TO SOCSEC OF MDTTAB(LIN-0001).
           MOVE EMPSTA OF EEWDEP(EDPACT) TO EMPSTA OF MDTTAB(LIN-0001).
           MOVE BILEXC OF EEWDEP(EDPACT) TO BILEXC OF MDTTAB(LIN-0001).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0001).
           MOVE MHCIND OF EEWDEP(EDPACT) TO MHCIND OF MDTTAB(LIN-0001).
           IF INDUPD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE INDUPD OF EEWDEP(EDPACT)
                                         TO INDUPD OF MDTTAB(LIN-0001)
           ELSE
              MOVE 'N'                   TO INDUPD OF MDTTAB(LIN-0001).
           MOVE OMEDAT OF EEWDEP(EDPACT) TO OMEDAT OF MDTTAB(LIN-0001).
           MOVE CRDMTH OF EEWDEP(EDPACT) TO CRDMTH OF MDTTAB(LIN-0001).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0001).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0001).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0001).
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTTAB(LIN-0001)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTTAB(LIN-0001).
           MOVE MMCEXC OF EEWDEP(EDPACT) TO MMCEXC OF MDTTAB(LIN-0001).
           MOVE CPAIND OF EEWDEP(EDPACT) TO CPAIND OF MDTTAB(LIN-0001).
           MOVE EECOVR OF EEWDEP(EDPACT) TO EECOVR OF MDTTAB(LIN-0001).
           IF CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S'
              MOVE BRANCD OF MDTMAS-REC  TO BRANCD OF CPDMAS-REC
              MOVE BATDAT OF MDTMAS-REC  TO BATDAT OF CPDMAS-REC
              MOVE BATSEQ OF MDTMAS-REC  TO BATSEQ OF CPDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
              MOVE 1                     TO LINENO OF CPDMAS-REC
              IF CPAIND OF EEWDEP(EDPACT) = 'M'
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
              ELSE
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
              END-IF
              PERFORM A960-WRITE-CPDMAS          THRU A969-EXIT.
      *
           MOVE MMDIND OF EEWDEP(EDPACT) TO MMDIND OF MDTTAB(LIN-0001).
           MOVE WRKLOC OF EEWDEP(EDPACT) TO WRKLOC OF MDTTAB(LIN-0001).
           MOVE SSNXRF OF EEWDEP(EDPACT) TO SSNXRF OF MDTTAB(LIN-0001).
           MOVE HICNNO OF EEWDEP(EDPACT) TO HICNNO OF MDTTAB(LIN-0001).
           MOVE PEBTFS OF EEWDEP(EDPACT) TO PEBTFS OF MDTTAB(LIN-0001).
           MOVE COBDAT OF EEWDEP(EDPACT) TO COBDAT OF MDTTAB(LIN-0001).
           MOVE PAYLOC OF EEWDEP(EDPACT) TO PAYLOC OF MDTTAB(LIN-0001).
           MOVE PAYNUM OF EEWDEP(EDPACT) TO PAYNUM OF MDTTAB(LIN-0001).
      *
           IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF MMDMAS-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF MMDMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF MMDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
              MOVE 1                    TO LINENO OF MMDMAS-REC
              MOVE MEMBNO OF EEWDEP(EDPACT)
                                        TO MEMBNO OF MMDMAS-REC
              PERFORM A1020-WRITE-MMDMAS         THRU A1029-EXIT.
      *
           MOVE MMCIND OF EEWDEP(EDPACT) TO MMCIND OF MDTTAB(LIN-0001).

           IF MMCIND OF EEWDEP(EDPACT) = 'Y'
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF MDMMAS-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF MDMMAS-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF MDMMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
              MOVE 1                    TO LINENO OF MDMMAS-REC
              MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDMMAS-REC
              PERFORM A1120-WRITE-MDMMAS         THRU A1129-EXIT.
      *
           MOVE RSPIND OF EEWDP2(EDPACT) TO RSPIND OF MDTTAB(LIN-0001).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0001).
           IF EXCHNG OF MDTTAB(LIN-0001) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0001)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0001).
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0001)
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0001)
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0001).
           MOVE BENIND OF EEWDP2(EDPACT) TO BENIND OF MDTTAB(LIN-0001).
           MOVE EXTIND OF EEWDP2(EDPACT) TO EXTIND OF MDTTAB(LIN-0001).

           IF BENIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE EXTDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF EXTDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF EXTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF EXTDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF EXTDOCBT-REC
              MOVE 1                    TO LINENO OF EXTDOCBT-REC
              MOVE ZERO                 TO MEMSEQ OF EXTDOCBT-REC
              PERFORM B1310-WRITE-EXTDOCBT       THRU B1319-EXIT.
           IF  WS-FULLUP NOT = 'A'
           AND WS-VERSID = '005010'
           AND ( EPCLS1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS3 OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTNM OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTQL OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTID OF EEWDP2(EDPACT) NOT = SPACES OR
                 RDTFMT OF EEWDP2(EDPACT) NOT = SPACES OR
                 RCTDAT OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLLST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLFST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLMID OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLPRE OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSUF OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCQ OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 MDRCCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CSPCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CNTSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 SCHSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPTCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 MBMCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBPHN OF EEWDP2(EDPACT) NOT = SPACES    )
              INITIALIZE EDIDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC     TO BRANCD OF EDIDOCBT-REC
              MOVE BATDAT OF MDTMAS-REC     TO BATDAT OF EDIDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY     TO BATSEQ OF EDIDOCBT-REC
              MOVE SEQNUM OF MDTMAS-KEY     TO SEQNUM OF EDIDOCBT-REC
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF MDTMAS-KEY  TO LINENO OF EDIDOCBT-REC
              ELSE
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                     TO LINENO OF EDIDOCBT-REC
              END-IF
              END-IF
              PERFORM A1380-WRITE-EDIDOCBT       THRU A1389-EXIT.
      *
           IF RSPIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE RSPDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF RSPDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF RSPDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF RSPDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF RSPDOCBT-REC
              MOVE 1                    TO LINENO OF RSPDOCBT-REC
              MOVE ZERO                 TO MEMSEQ OF RSPDOCBT-REC
              PERFORM A1310-WRITE-RSPDOCBT       THRU A1319-EXIT.
           IF EXTIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE DEMDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF DEMDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF DEMDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF DEMDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF DEMDOCBT-REC
              MOVE 1                    TO LINENO OF DEMDOCBT-REC
              PERFORM A1330-WRITE-DEMDOCBT       THRU A1339-EXIT.
           MOVE ALTIND OF EEWDP2(EDPACT) TO ALTIND OF MDTTAB(LIN-0001).

           IF ALTIND OF EEWDP2(EDPACT) = 'Y'
              INITIALIZE ALTDOCBT-REC
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF ALTDOCBT-REC
              MOVE BATDAT OF MDTMAS-KEY TO BATDAT OF ALTDOCBT-REC
              MOVE BATSEQ OF MDTMAS-KEY TO BATSEQ OF ALTDOCBT-REC
              MOVE SEQNUM OF WS-WORK    TO SEQNUM OF ALTDOCBT-REC
              MOVE 1                    TO LINENO OF ALTDOCBT-REC
              MOVE ZERO                 TO MEMSEQ OF ALTDOCBT-REC
              PERFORM A1350-WRITE-ALTDOCBT       THRU A1359-EXIT.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if there is no detail 3 record. ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
           IF (EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES')
           AND RELCOD OF EEWDP3(EDPACT) NOT = SPACES
              INITIALIZE EXCMDTBT-REC
              MOVE BRANCD OF MDTMAS-KEY          TO WS-EXC-BRANCD
              MOVE BATDAT OF MDTMAS-KEY          TO WS-EXC-BATDAT
              MOVE BATSEQ OF MDTMAS-KEY          TO WS-EXC-BATSEQ
              MOVE SEQNUM OF WS-WORK             TO WS-EXC-SEQNUM
              IF RECTYP OF MDTMAS-REC = '2'
                 MOVE LINENO OF WS-WORK          TO WS-EXC-LINENO
              END-IF
              IF RECTYP OF MDTMAS-REC = '3'
                 MOVE 1                          TO WS-EXC-LINENO
              END-IF
              MOVE ZEROES                        TO WS-EXC-MEMSEQ
              MOVE 001                           TO WS-EXCSEQ
              PERFORM A1440-WRITE-EXCMDTBT       THRU A1449-EXIT.
      *
           MOVE 002                      TO LINENO OF MDTTAB(LIN-0002).
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTTAB(LIN-0002).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0002).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0002).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0002).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0002).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0002).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0002).
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTTAB(LIN-0002).
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTTAB(LIN-0002).
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF MDTTAB(LIN-0002).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0002).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0002).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0002).
           MOVE ACCTNO OF EEWDEP(EDPACT) TO ACCTNO OF MDTTAB(LIN-0002).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0002).
           MOVE ENBREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0002).
           MOVE ENBEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0002).
           MOVE ENBEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0002).
           MOVE '1'                      TO STATCD OF MDTTAB(LIN-0002).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0002).
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTTAB(LIN-0002).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0002).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0002).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0002).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0002).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0002).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0002).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0002).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0002).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0002).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0002).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0002).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0002).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0002).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0002).
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTTAB(LIN-0002)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTTAB(LIN-0002).
           IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE ENBTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0002).
           IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE ENBREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0002).
           MOVE MEMNUM OF EEWDEP(EDPACT) TO MEMNUM OF MDTTAB(LIN-0001).
           MOVE GRPPOL OF EEWDEP(EDPACT) TO GRPPOL OF MDTTAB(LIN-0001).
           MOVE OINNAM OF EEWDEP(EDPACT) TO OINNAM OF MDTTAB(LIN-0001).
           MOVE OINNUM OF EEWDEP(EDPACT) TO OINNUM OF MDTTAB(LIN-0001).
           MOVE COVEFF OF EEWDEP(EDPACT) TO COVEFF OF MDTTAB(LIN-0002).
           MOVE COVEXP OF EEWDEP(EDPACT) TO COVEXP OF MDTTAB(LIN-0002).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0002).
           IF EXCHNG OF MDTTAB(LIN-0002) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0002)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0002).
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0002).
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0002)
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0002)
           MOVE 004                      TO LINENO OF MDTTAB(LIN-0004).
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTTAB(LIN-0004).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0004).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0004).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0004).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0004).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0004).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0004).
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTTAB(LIN-0004).
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTTAB(LIN-0004).
           MOVE PKGOVR OF EEWDEP(EDPACT) TO PKGOVR OF MDTTAB(LIN-0004).
           MOVE ACCTN2 OF EEWDEP(EDPACT) TO ACCTN2 OF MDTTAB(LIN-0004).
           MOVE BILMOD OF EEWDEP(EDPACT) TO BILMOD OF MDTTAB(LIN-0004).
           MOVE BEGMTH OF EEWDEP(EDPACT) TO BEGMTH OF MDTTAB(LIN-0004).
           MOVE IMDBIL OF EEWDEP(EDPACT) TO IMDBIL OF MDTTAB(LIN-0004).
           MOVE INTBIL OF EEWDEP(EDPACT) TO INTBIL OF MDTTAB(LIN-0004).
           MOVE BILCYC OF EEWDEP(EDPACT) TO BILCYC OF MDTTAB(LIN-0004).
           MOVE PCPCOD OF EEWDEP(EDPACT) TO PROVNO OF MDTTAB(LIN-0004).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0004).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0004).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0004).
           MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1).
           MOVE MEMSTA OF EEWDEP(EDPACT) TO MEMSTA OF MDTTAB(LIN-0004).
           MOVE FEECOD OF EEWDEP(EDPACT) TO FEECOD OF MDTTAB(LIN-0004).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0004).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0004).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0004).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0004).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0004).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0004).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0004).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0004).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0004).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0004).
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF MDTTAB(LIN-0004).
           MOVE SPACE                    TO TIRFLG OF MDTTAB(LIN-0004).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0004).
           MOVE PCPREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0004).
           MOVE PCPEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0004).
           MOVE PCPEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0004).
           MOVE '1'                      TO STATCD OF MDTTAB(LIN-0004).
           MOVE PCPORG OF EEWDEP(EDPACT) TO PRVORG OF MDTTAB(LIN-0004).
           MOVE BENPKG OF EEWDEP(EDPACT) TO BENPKG OF MDTTAB(LIN-0004).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0004).
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTTAB(LIN-0004).
           MOVE BILEXC OF EEWDEP(EDPACT) TO BILEXC OF MDTTAB(LIN-0004).
           MOVE PCPOVR OF EEWDEP(EDPACT) TO PCPOVR OF MDTTAB(LIN-0004).
           MOVE PCPMCP OF EEWDEP(EDPACT) TO PCPMCP OF MDTTAB(LIN-0004).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0004).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0004).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0004).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0004).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0004).
           IF EXCHNG OF MDTTAB(LIN-0004) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0004)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0004).
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0004).
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTTAB(LIN-0004)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTTAB(LIN-0004).
           IF PCPTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE PCPTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0004).
           IF PCPREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE PCPREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0004).
           IF SECCOD OF EEWDEP(EDPACT) = SPACES
              GO TO A660-LINE6.
      *
           MOVE 005                      TO LINENO OF MDTTAB(LIN-0005).
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTTAB(LIN-0005).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0005).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0005).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0005).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0005).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0005).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0005).
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTTAB(LIN-0005).
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTTAB(LIN-0005).
           MOVE SECCOD OF EEWDEP(EDPACT) TO SECPRV OF MDTTAB(LIN-0005).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0005).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0005).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0005).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0005).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0005).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0005).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0005).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0005).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0005).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0005).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0005).
           MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF MDTTAB(LIN-0005).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0005).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0005).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0005).
           MOVE SECREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0005).
           MOVE SECEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0005).
           MOVE SECEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0005).
           MOVE '1'                      TO STATCD OF MDTTAB(LIN-0005).
           MOVE SECORG OF EEWDEP(EDPACT) TO SECORG OF MDTTAB(LIN-0005).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0005).
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTTAB(LIN-0005).
           MOVE SECOVR OF EEWDEP(EDPACT) TO SECOVR OF MDTTAB(LIN-0005).
           MOVE SECMCP OF EEWDEP(EDPACT) TO SECMCP OF MDTTAB(LIN-0005).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0005).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0005).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0005).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0005).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0005).
           IF EXCHNG OF MDTTAB(LIN-0005) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0005)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0005).
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0005).
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0005)
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0005)
      *
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTTAB(LIN-0005)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTTAB(LIN-0005).
           IF SECTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0005).
           IF SECREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0005).
       A660-LINE6.
           IF  MEDSTS OF EEWDEP(EDPACT) = SPACES
           AND MEDCTY OF EEWDEP(EDPACT) = SPACES
              GO TO A660-LINE7.
     *
           MOVE 006                      TO LINENO OF MDTTAB(LIN-0006).
           MOVE SEQNUM OF WS-WORK        TO SEQNUM OF MDTTAB(LIN-0006).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0006).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0006).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0006).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0006).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0006).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0006).
           MOVE TITLCD OF EEWDEP(EDPACT) TO TITLCD OF MDTTAB(LIN-0006).
           MOVE HIRDAT OF EEWDEP(EDPACT) TO HIRDAT OF MDTTAB(LIN-0006).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0006).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0006).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0006).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0006).
           MOVE MEDREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0006).
           MOVE MEDEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0006).
           MOVE MEDEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0006).
           MOVE '1'                      TO STATCD OF MDTTAB(LIN-0006).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0006).
           MOVE TRMDAT OF EEWDEP(EDPACT) TO TRMDAT OF MDTTAB(LIN-0006).
           MOVE MEDCTY OF EEWDEP(EDPACT) TO MEDCTY OF MDTTAB(LIN-0006).
           MOVE MEDSTS OF EEWDEP(EDPACT) TO MEDSTS OF MDTTAB(LIN-0006).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0006).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0006).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0006).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0006).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0006).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0006).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0006).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0006).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0006).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0006).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0006).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0006).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0006).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0006).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0006).
           IF EXCHNG OF MDTTAB(LIN-0006) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0006)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0006).
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0006).
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0006)
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0006)
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'                   TO PRTCOD OF MDTTAB(LIN-0006)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                         TO PRTCOD OF MDTTAB(LIN-0006).
           IF MEDTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0006).
           IF MEDREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0006).
      *
       A660-LINE7.
           IF  EXTMEM OF EEWDEP(EDPACT) = SPACES
           AND EXTGRP OF EEWDEP(EDPACT) = SPACES
           AND EXTSUB OF EEWDEP(EDPACT) = SPACES
              GO TO A668-END.
      *
           MOVE 7                        TO LINENO OF MDTTAB(LIN-0007).
           MOVE '3'                      TO RECTYP OF MDTTAB(LIN-0007).
           MOVE 'A'                      TO CHGTYP OF MDTTAB(LIN-0007).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0007).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0007).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0007).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0007).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0007).
           MOVE EXTMEM OF EEWDEP(EDPACT) TO EXTMEM OF MDTTAB(LIN-0007).
           MOVE EXTGRP OF EEWDEP(EDPACT) TO EXTGRP OF MDTTAB(LIN-0007).
           MOVE EXTCON OF EEWDEP(EDPACT) TO EXTCON OF MDTTAB(LIN-0007).
           MOVE EXTEFF OF EEWDEP(EDPACT) TO EXTEFF OF MDTTAB(LIN-0007).
           MOVE EXTEXP OF EEWDEP(EDPACT) TO EXTEXP OF MDTTAB(LIN-0007).
           MOVE EXTSUB OF EEWDEP(EDPACT) TO EXTSUB OF MDTTAB(LIN-0007).
           MOVE HISSEQ OF EEWDEP(EDPACT) TO HISSEQ OF MDTTAB(LIN-0007).
           MOVE CTLPLN OF EEWDEP(EDPACT) TO CTLPLN OF MDTTAB(LIN-0007).
           MOVE EXTREL OF EEWDEP(EDPACT) TO EXTREL OF MDTTAB(LIN-0007).
           MOVE PRVPLN OF EEWDEP(EDPACT) TO PRVPLN OF MDTTAB(LIN-0007).
           MOVE PRVNET OF EEWDEP(EDPACT) TO PRVNET OF MDTTAB(LIN-0007).
           MOVE PROCOD OF EEWDEP(EDPACT) TO PROCOD OF MDTTAB(LIN-0007).
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0007).
           IF EXCHNG OF MDTTAB(LIN-0007) = 'EI' OR 'ES'
              MOVE 'Y'                   TO EXCIND OF MDTTAB(LIN-0007)
           ELSE
              MOVE ' '                   TO EXCIND OF MDTTAB(LIN-0007).
           MOVE WS-ENRSTA                TO ENRSTA OF MDTTAB(LIN-0007).
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0007).
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0007).
      *
       A668-END.
           MOVE DOCNUM OF EEWDEP(EDPACT) TO DOCNUM OF WS-WORK.
      *
           MOVE 'D'                              TO RECTYP-FLAG.
           MOVE 'N'                              TO MDT-FLAG.
           MOVE 'N'                              TO SEQ-FLAG.
           MOVE 'N'                              TO PRCSEQ-FLAG.
           MOVE 'Y'                              TO FIRST-LINE-FLAG.
           MOVE 'DEP'                            TO MEMEXT-TYP.
      *
           PERFORM A690-MDTMAS-WRITE             THRU A699-EXIT
              VARYING INDX FROM 1 BY 1           UNTIL INDX > MDTMAX.
      *
           IF MDT-ADDED
              ADD 1                    TO TOTBAT OF WS-WORK
              ADD 1                    TO NUMMDT OF WS-WORK
              ADD 1                    TO BATADD OF WS-WORK.
       A669-EXIT.
           EXIT.
      *
       A670-OTHINS-CHK.
      **************************************************************
      *‚                                                           *
      **************************************************************
           MOVE SPACES                           TO COVMAS-KEY.
           MOVE MEMBNO OF MDTMAS-REC   TO MEMBNO OF COVMAS-KEY.
           MOVE OTHINS OF MDTMAS-REC   TO INSCOD OF COVMAS-KEY.
           MOVE ZEROES                 TO PRICOD OF COVMAS-KEY.
           MOVE COVEXP OF MDTMAS-REC   TO EXPDAT OF COVMAS-KEY.
           PERFORM COVMAS-STARTGE                 IF INVALID-KEY
              GO TO A679-EXIT.
       A672-NEXT.
           PERFORM COVMAS-READNX                 IF AT-END
              GO TO A679-EXIT.
      *
           IF MEMBNO OF COVMAS-REC NOT = MEMBNO OF MDTMAS-REC
              GO TO A679-EXIT.
      *
           IF INSCOD OF COVMAS-REC NOT = OTHINS OF MDTMAS-REC
              GO TO A672-NEXT.
      *
           IF COVEFF OF MDTMAS-REC NOT = ZERO
              MOVE COVEFF OF MDTMAS-REC          TO WS-EFFDAT
           ELSE
              MOVE EFFDAT OF MDTMAS-REC          TO WS-EFFDAT.
      *
           IF COVEXP OF MDTMAS-REC NOT = ZERO
              MOVE COVEXP OF MDTMAS-REC          TO WS-EXPDAT
           ELSE
              MOVE EXPDAT OF MDTMAS-REC          TO WS-EFFDAT.
      *
           IF  WS-EFFDAT NOT < EFFDAT OF COVMAS-REC
           AND WS-EXPDAT NOT > EXPDAT OF COVMAS-REC
              MOVE SPACES              TO OTHINS OF MDTMAS-REC
              GO TO A679-EXIT.
      *
           IF (WS-EFFDAT NOT < EFFDAT OF COVMAS-REC
           AND WS-EFFDAT NOT > EXPDAT OF COVMAS-REC)
           OR (WS-EXPDAT NOT < EFFDAT OF COVMAS-REC
           AND WS-EXPDAT NOT > EXPDAT OF COVMAS-REC)
           OR (WS-EFFDAT     < EFFDAT OF COVMAS-REC
           AND WS-EXPDAT     > EXPDAT OF COVMAS-REC)
              IF WS-EFFDAT < EFFDAT OF COVMAS-REC
              OR WS-EXPDAT > EXPDAT OF COVMAS-REC
                 MOVE SPACES           TO OTHINS OF MDTMAS-REC
                                          MEMNUM OF MDTMAS-REC
                                          GRPPOL OF MDTMAS-REC
                                          OINNAM OF MDTMAS-REC
                                          OINNUM OF MDTMAS-REC
                 MOVE ZERO             TO PRICOD OF MDTMAS-REC
                                          COVEFF OF MDTMAS-REC
                                          COVEXP OF MDTMAS-REC
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF MDTMAS-REC TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF MDTMAS-REC TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF MDTMAS-REC TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF MDTMAS-REC TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF MDTMAS-REC TO CHGTYP OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'EI02475'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT
                 GO TO A679-EXIT.

           GO TO A672-NEXT.
       A679-EXIT.
           EXIT.
      *
       A680-ME1023-DEPCHG.
      ****************************************************************
      *‚ ME1023 CHANGE RECORDS FOR DEPENDENTS                        *
      ****************************************************************
      *INITIALIZE THE MDTTAB EACH TIME THRU
           PERFORM A900-INIT-MDTTAB              THRU A909-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           MOVE 'N'                              TO SW-SEQ-USED.
           MOVE SPACES                 TO DOCNUM OF WS-WORK.
      *
      *    GET CURRENT INFO FOR MEMBER
           PERFORM A560-CURDEP                   THRU A569-EXIT.
           IF MEMTMP = ZERO                      GO TO A682-ADDMEM.

           IF PRCNAM OF EEWHDR-WRK = 'N'
           OR NAMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-2.
      *
           IF LSTNAM OF EEWDEP(EDPACT) = SPACES
           AND FSTNAM OF EEWDEP(EDPACT) = SPACES
           AND MIDNAM OF EEWDEP(EDPACT) = SPACES
              GO TO A682-STEP-2.

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (LSTNAM OF EEWDEP(EDPACT) NOT = LSTNAM OF MEMTAB(MEMTMP)
           OR  FSTNAM OF EEWDEP(EDPACT) NOT = FSTNAM OF MEMTAB(MEMTMP)
           OR  MIDNAM OF EEWDEP(EDPACT) NOT = MIDNAM OF MEMTAB(MEMTMP))
           AND CHGTYP OF EEWDEP(EDPACT) = 'C' OR SPACES
              MOVE 003                 TO LINENO OF MDTTAB(LIN-0003)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0003)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0003)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0003)
              MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0003)
              MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0003)
              MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0003)
              MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0003)
              MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0003)
              MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0003)
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0003)
              MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0003)
              MOVE CHGEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0003)
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0003)
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0003)
              MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0003)
              MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0003)
              MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0003)
              MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0003)
              MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0003)
              MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0003)
              MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0003)
              MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0003)
              MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0003)
              MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0003)
              MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0003)
              MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0003)
              MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0003)
              MOVE SPACE               TO TIRFLG OF MDTTAB(LIN-0003)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0003)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0003)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0003)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0003)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0003)
              END-IF
              IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0003)
              ELSE
                 MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0003).
       A682-STEP-2.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****--------------------------------------------------------****
           IF WS-DT3-TRMEFF IS NUMERIC
            IF WS-DT1-MEMEFF <= WS-DT3-TRMEFF
            AND WS-DT3-TRMEFF NOT = ZEROES
            AND (CHGTYP OF EEWDEP(EDPACT) = 'T'
            OR   CHGTYP OF EEWDEP(EDPACT) = ' ')
              IF CHGTYP OF EEWDEP(EDPACT) = ' '
                 MOVE 'T'              TO CHGTYP OF EEWDEP(EDPACT)
              END-IF
              MOVE 'Y'                           TO WS-TRMDEP
              IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                 PERFORM A1520-EXCMEMBT-CHG      THRU A1529-EXIT
      ****       IF EXCMEM-FLAG = 'Y'
      ****       OR ADD-EXCMEM
                 IF   RELCOD OF EEWDP3(EDPACT) NOT = SPACES
                 AND (EXCMEM-FLAG = 'Y'
                 OR   ADD-EXCMEM)
                   MOVE 'Y'                      TO DEMCHG-FLAG
                   MOVE MEMSEQ OF MEMMAS-REC     TO WS-EXC-MEMSEQ
                   INITIALIZE EXCMDTBT-REC
                   MOVE BRANCD OF MBHMAS-REC     TO WS-EXC-BRANCD
                   MOVE BATDAT OF MBHMAS-REC     TO WS-EXC-BATDAT
                   MOVE BATSEQ OF MBHMAS-REC     TO WS-EXC-BATSEQ
                   MOVE SEQNUM OF WS-WORK        TO WS-EXC-SEQNUM
                   MOVE 2                        TO WS-EXC-LINENO
                   MOVE 1                        TO WS-EXCSEQ
                   PERFORM A1440-WRITE-EXCMDTBT  THRU A1449-EXIT
                 END-IF
              END-IF.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
              IF  (MEMEFF OF MEMTAB(MEMTMP) <= MEMEXP OF EEWDEP(EDPACT)
              AND MEMEXP OF MEMTAB(MEMTMP) NOT =
                                       MEMEXP OF EEWDEP(EDPACT))
              OR WS-TRMDEP = 'Y'
                 MOVE 002              TO LINENO OF MDTTAB(LIN-0002)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                 MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                 MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                 MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                 MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                 IF ACCTNO OF MDTTAB(LIN-0002) NOT = SPACES
                    MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                 IF WS-DT3-TRMEFF = ZEROES
                 MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                 ELSE
                 MOVE WS-DT3-TRMEFF    TO EXPDAT OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 MOVE CRDCNT OF EEWDEP(EDPACT)
                                      TO CRDCNT OF MDTTAB(LIN-0002)
                 MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0002)
                 MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0002)
                 MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0002)
                 MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0002)
                 MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0002)
                 MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0002)
                 MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0002)
                 MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0002)
                 MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0002)
                 MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0002)
                 MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0002)
                 MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0002)
                 MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0002)
                 MOVE SPACE            TO TIRFLG OF MDTTAB(LIN-0002)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0002)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0002)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0002)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE EXCSUB OF EEWDEP(EDPACT)
                                       TO EXCSUB OF MDTTAB(LIN-0002)
                 MOVE EXCMEM OF EEWDEP(EDPACT)
                                       TO EXCMEM OF MDTTAB(LIN-0002)
                 IF   WS-TRMDEP NOT = 'Y'
                 AND (EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES')
                    MOVE 'Y'                     TO WS-TRMDEP
                    PERFORM A1520-EXCMEMBT-CHG   THRU A1529-EXIT
      ****          IF EXCMEM-FLAG = 'Y'
      ****          OR ADD-EXCMEM
                    IF   RELCOD OF EEWDP3(EDPACT) NOT = SPACES
                    AND (EXCMEM-FLAG = 'Y'
                    OR   ADD-EXCMEM)
                      MOVE 'Y'                   TO DEMCHG-FLAG
                      MOVE MEMSEQ OF MEMMAS-REC  TO WS-EXC-MEMSEQ
                      INITIALIZE EXCMDTBT-REC
                      MOVE BRANCD OF MBHMAS-REC  TO WS-EXC-BRANCD
                      MOVE BATDAT OF MBHMAS-REC  TO WS-EXC-BATDAT
                      MOVE BATSEQ OF MBHMAS-REC  TO WS-EXC-BATSEQ
                      MOVE SEQNUM OF WS-WORK     TO WS-EXC-SEQNUM
                      MOVE 2                     TO WS-EXC-LINENO
                      MOVE 1                     TO WS-EXCSEQ
                      PERFORM A1440-WRITE-EXCMDTBT THRU A1449-EXIT
                    END-IF
                 END-IF
                 IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                    MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
      *
           IF MEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-3.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO A682-STEP-3.
      *
           IF MEMTMP = ZERO                      GO TO A682-STEP-3.
      *
           IF (MEMEFF OF EEWDEP(EDPACT) NOT =
                                    MEMEFF OF MEMTAB(MEMTMP)
           OR  MEMEXP OF EEWDEP(EDPACT) NOT =
                                  MEMEXP OF MEMTAB(MEMTMP))
              IF (MEMEFF OF EEWDEP(EDPACT) NOT <
                                  MEMEFF OF MEMTAB(MEMTMP)
              AND MEMEFF OF EEWDEP(EDPACT) NOT >
                                  MEMEXP OF MEMTAB(MEMTMP))
              OR (MEMEXP OF EEWDEP(EDPACT) NOT <
                                   MEMEFF OF MEMTAB(MEMTMP)
              AND MEMEXP OF EEWDEP(EDPACT) NOT >
                                   MEMEXP OF MEMTAB(MEMTMP))
              OR (MEMEFF OF EEWDEP(EDPACT)     <
                                   MEMEFF OF MEMTAB(MEMTMP)
              AND MEMEXP OF EEWDEP(EDPACT)     >
                                   MEMEXP OF MEMTAB(MEMTMP))
                 GO TO A682-ADDMEM.
           IF (MEMEFF OF EEWDEP(EDPACT) NOT = MEMEXP OF MEMTAB(MEMTMP)
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF MEMTAB(MEMTMP))
              IF MEMEFF OF MEMTAB(MEMTMP) > MEMEXP OF EEWDEP(EDPACT)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF EEWDEP(EDPACT)   TO DATFR
                 MOVE MEMEFF OF MEMTAB(MEMTMP)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO A682-ADDMEM.
      *
           IF (MEMEFF OF EEWDEP(EDPACT) NOT = MEMEXP OF MEMTAB(MEMTMP)
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = MEMEXP OF MEMTAB(MEMTMP))
              IF MEMEFF OF EEWDEP(EDPACT) > MEMEXP OF MEMTAB(MEMTMP)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF MEMTAB(MEMTMP)   TO DATFR
                 MOVE MEMEFF OF EEWDEP(MEMTMP)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO A682-ADDMEM.
      *
           GO TO A682-STEP-3.
       A682-ADDMEM.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Correct alignment per standards.                      ****
      ****--------------------------------------------------------****
           MOVE 2                      TO LINENO OF MDTTAB(LIN-0002).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0002).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0002).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0002).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0002).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0002).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0002).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0002).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0002).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0002).
           MOVE MEMREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0002).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0002).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0002).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0002).
           MOVE MEMTRM OF EEWDEP(EDPACT) TO TERMCD OF MDTTAB(LIN-0002).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0002).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0002).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0002).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0002).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0002).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0002).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0002).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0002).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0002).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0002).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0002).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0002).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0002).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0002).
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0002)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0002)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                   END-IF
              END-IF
              MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0002)
              MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0002)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
      *
       A682-STEP-3.
           PERFORM A870-DEPDEM                   THRU A879-EXIT.
           IF DEPTMP = ZERO                      GO TO A682-STEP-4.
      *
           IF PRCDEM OF EEWHDR-WRK = 'N'
           OR DEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-4.
      *
           MOVE 'N'                              TO DEMCHG-FLAG.
      *
           MOVE 'N'                              TO MEEMAS-EXISTS.
           INITIALIZE MEEMAS-REC.
           MOVE MEMBNO OF MEMMAS-REC   TO MEMBNO OF MEEMAS-KEY.
           MOVE GRPNUM OF MEMMAS-REC   TO GRPNUM OF MEEMAS-KEY.
           MOVE TRNSEQ OF MEMMAS-REC   TO TRNSEQ OF MEEMAS-KEY.
           PERFORM MEEMAS-READ                   IF INVALID-KEY
              MOVE 'N'                           TO MEEMAS-EXISTS
           ELSE
              MOVE 'Y'                           TO MEEMAS-EXISTS.
      *
           IF MEEMAS-EXISTS = 'Y'
           AND COBDAT OF EEWDEP(EDPACT) NOT = ZEROS
           AND COBDAT OF EEWDEP(EDPACT) NOT = COBDAT OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBDAT OF EEWDEP(EDPACT)
                                       TO COBDAT OF MDTTAB(LIN-0001).
      *
           IF MEEMAS-EXISTS = 'Y'
           AND PAYLOC OF EEWDEP(EDPACT) NOT = SPACES
           AND PAYLOC OF EEWDEP(EDPACT) NOT = PAYLOC OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYLOC OF EEWDEP(EDPACT)
                                       TO PAYLOC OF MDTTAB(LIN-0001).
      *
           IF MEEMAS-EXISTS = 'Y'
           AND PAYNUM OF EEWDEP(EDPACT) NOT = SPACES
           AND PAYNUM OF EEWDEP(EDPACT) NOT = PAYNUM OF MEEMAS-REC
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYNUM OF EEWDEP(EDPACT)
                                       TO PAYNUM OF MDTTAB(LIN-0001).
      *
           IF PRTCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND PRTCOD OF EEWDEP(EDPACT) NOT =
                                       PRTCOD OF MEMTAB(MEMACT)
             MOVE 'Y'                            TO DEMCHG-FLAG
             MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001).
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Do not write EXCMDTBT if M3 record does not exist.    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF  RELCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND RELCOD OF EEWDEP(EDPACT) NOT =
                                       RELCOD OF DEPTAB(DEPTMP)
                 MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  RELTYP OF EEWDEP(EDPACT) NOT = SPACES
              AND RELTYP OF EEWDEP(EDPACT) NOT =
                                       RELTYP OF MEMTAB(MEMTMP)
                 MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF SEXCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND SEXCHG OF EEWDEP(EDPACT) NOT = 'N'
              AND SEXCOD OF EEWDEP(EDPACT) NOT =
                                       SEXCOD OF DEPTAB(DEPTMP)
                 MOVE SEXCOD OF EEWDEP(EDPACT)
                                       TO SEXCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF ADRLN1 OF EEWDEP(EDPACT) NOT = SPACES
              AND (ADRLN1 OF EEWDEP(EDPACT) NOT =
                                       ADRLN1 OF DEPTAB(DEPTMP)
              OR   ADRLN2 OF EEWDEP(EDPACT) NOT =
                                          ADRLN2 OF DEPTAB(DEPTMP))
              OR (CITYCD OF EEWDEP(EDPACT) NOT = SPACES
              AND CITYCD OF EEWDEP(EDPACT) NOT =
                                          CITYCD OF DEPTAB(DEPTMP))
              OR (STACOD OF EEWDEP(EDPACT) NOT = SPACES
              AND STACOD OF EEWDEP(EDPACT) NOT =
                                       STACOD OF DEPTAB(DEPTMP))
              OR (ZIPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND ZIPCOD OF EEWDEP(EDPACT) NOT =
                                       ZIPCOD OF DEPTAB(DEPTMP))
              OR (CTRYCD OF EEWDEP(EDPACT) NOT = SPACES
              AND CTRYCD OF EEWDEP(EDPACT) NOT =
                                       CTRYCD OF DEPTAB(DEPTMP))
              OR (AREACD OF EEWDEP(EDPACT) NOT = SPACES
              AND AREACD OF EEWDEP(EDPACT) NOT =
                                       AREACD OF DEPTAB(DEPTMP))
              OR (LOCQLF OF EEWDEP(EDPACT) NOT = SPACES
              AND LOCQLF OF EEWDEP(EDPACT) NOT =
                                       LOCQLF OF DEPTAB(DEPTMP))
                 MOVE ADRLN1 OF EEWDEP(EDPACT)
                                       TO ADRLN1 OF MDTTAB(LIN-0001)
                 MOVE ADRLN2 OF EEWDEP(EDPACT)
                                       TO ADRLN2 OF MDTTAB(LIN-0001)
                 MOVE CITYCD OF EEWDEP(EDPACT)
                                       TO CITYCD OF MDTTAB(LIN-0001)
                 MOVE STACOD OF EEWDEP(EDPACT)
                                       TO STACOD OF MDTTAB(LIN-0001)
                 MOVE ZIPCOD OF EEWDEP(EDPACT)
                                       TO ZIPCOD OF MDTTAB(LIN-0001)
                 MOVE CTRYCD OF EEWDEP(EDPACT)
                                       TO CTRYCD OF MDTTAB(LIN-0001)
                 MOVE AREACD OF EEWDEP(EDPACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
                 MOVE LOCQLF OF EEWDEP(EDPACT)
                                       TO LOCQLF OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH1 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH1 OF EEWDEP(EDPACT) NOT =
                                       HOMPH1 OF DEPTAB(DEPTMP)
                 MOVE HOMPH1 OF EEWDEP(EDPACT)
                                       TO HOMPH1 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH2 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH2 OF EEWDEP(EDPACT) NOT =
                                       HOMPH2 OF DEPTAB(DEPTMP)
                 MOVE HOMPH2 OF EEWDEP(EDPACT)
                                       TO HOMPH2 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH3 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH3 OF EEWDEP(EDPACT) NOT =
                                       HOMPH3 OF DEPTAB(DEPTMP)
                 MOVE HOMPH3 OF EEWDEP(EDPACT)
                                       TO HOMPH3 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH1 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH1 OF EEWDEP(EDPACT) NOT =
                                       WRKPH1 OF DEPTAB(DEPTMP)
                 MOVE WRKPH1 OF EEWDEP(EDPACT)
                                       TO WRKPH1 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH2 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH2 OF EEWDEP(EDPACT) NOT =
                                       WRKPH2 OF DEPTAB(DEPTMP)
                 MOVE WRKPH2 OF EEWDEP(EDPACT)
                                       TO WRKPH2 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH3 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH3 OF EEWDEP(EDPACT) NOT =
                                       WRKPH3 OF DEPTAB(DEPTMP)
                 MOVE WRKPH3 OF EEWDEP(EDPACT)
                                       TO WRKPH3 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKEXT OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKEXT OF EEWDEP(EDPACT) NOT =
                                       WRKEXT OF DEPTAB(DEPTMP)
                 MOVE WRKEXT OF EEWDEP(EDPACT)
                                       TO WRKEXT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF SOCSEC OF EEWDEP(EDPACT) NOT = SPACES
              AND SOCSEC OF EEWDEP(EDPACT) NOT =
                                       SOCSEC OF DEPTAB(DEPTMP)
                 MOVE SOCSEC OF EEWDEP(EDPACT)
                                       TO SOCSEC OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF RACECD OF EEWDEP(EDPACT) NOT = SPACES
              AND RACECD OF EEWDEP(EDPACT) NOT =
                                       RACECD OF DEPTAB(DEPTMP)
                 MOVE RACECD OF EEWDEP(EDPACT)
                                       TO RACECD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF MEMSTA OF EEWDEP(EDPACT) NOT = SPACES
              AND MEMSTA OF EEWDEP(EDPACT) NOT =
                                       MEMSTA OF DEPTAB(DEPTMP)
                 MOVE MEMSTA OF EEWDEP(EDPACT)
                                       TO MEMSTA OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF AUTEXP OF EEWDEP(EDPACT) NOT = SPACES
              AND AUTEXP OF EEWDEP(EDPACT) NOT =
                                       AUTEXP OF DEPTAB(DEPTMP)
                 MOVE AUTEXP OF EEWDEP(EDPACT)
                                       TO AUTEXP OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF ALTNUM OF EEWDEP(EDPACT) NOT = SPACES
              AND ALTNUM OF EEWDEP(EDPACT) NOT =
                                       ALTNUM OF DEPTAB(DEPTMP)
                 MOVE ALTNUM OF EEWDEP(EDPACT)
                                       TO ALTNUM OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF INTKCD OF EEWDEP(EDPACT) NOT = SPACES
              AND INTKCD OF EEWDEP(EDPACT) NOT =
                                       INTKCD OF DEPTAB(DEPTMP)
                 MOVE INTKCD OF EEWDEP(EDPACT)
                                       TO INTKCD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF BTHDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND BTHCHG OF EEWDEP(EDPACT) NOT = 'N'
              AND BTHDAT OF EEWDEP(EDPACT) NOT =
                                       BTHDAT OF DEPTAB(DEPTMP)
                 MOVE BTHDAT OF EEWDEP(EDPACT)
                                       TO BTHDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF BTHSEQ OF EEWDEP(EDPACT) NOT = ZEROES
              AND BTHSEQ OF EEWDEP(EDPACT) NOT =
                                       BTHSEQ OF DEPTAB(DEPTMP)
                MOVE BTHSEQ OF EEWDEP(EDPACT)
                                       TO BTHSEQ OF MDTTAB(LIN-0001)
                MOVE 'Y'               TO DEMCHG-FLAG
              END-IF
              IF HIRDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND HIRDAT OF EEWDEP(EDPACT) NOT =
                                       HIRDAT OF MEMTAB(DEPTMP)
                 MOVE HIRDAT OF EEWDEP(EDPACT)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              ELSE
                 IF DEMMAS-CHANGE
                    MOVE HIRDAT OF MEMTAB(DEPTMP)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF TYPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND TYPCOD OF EEWDEP(EDPACT) NOT =
                                       TYPCOD OF DEPTAB(DEPTMP)
                 MOVE TYPCOD OF EEWDEP(EDPACT)
                                       TO TYPCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF AREACD OF EEWDEP(EDPACT) NOT = SPACES
              AND AREACD OF EEWDEP(EDPACT) NOT =
                                       AREACD OF DEPTAB(DEPTMP)
                 MOVE AREACD OF EEWDEP(EDPACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF TRMDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND TRMDAT OF EEWDEP(EDPACT) NOT =
                                       TRMDAT OF MEMTAB(DEPTMP)
                 MOVE TRMDAT OF EEWDEP(EDPACT)
                                       TO TRMDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              ELSE
                 IF DEMMAS-CHANGE
                    MOVE TRMDAT OF MEMTAB(DEPTMP)
                                       TO TRMDAT OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF (CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S' OR 'N')
              AND CPAIND OF EEWDEP(EDPACT) NOT =
                                       CPAIND OF DEPTAB(DEPTMP)
                 MOVE CPAIND OF EEWDEP(EDPACT)
                                       TO CPAIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF CPDMAS-REC
                 MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF CPDMAS-REC
                 MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF CPDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                 MOVE 1                TO LINENO OF CPDMAS-REC
                 IF CPAIND OF EEWDEP(EDPACT) = 'M'
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                    PERFORM A960-WRITE-CPDMAS   THRU A969-EXIT
                 END-IF
                 IF CPAIND OF EEWDEP(EDPACT) = 'S'
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                    PERFORM A960-WRITE-CPDMAS   THRU A969-EXIT
                 END-IF
              END-IF
              IF CPAIND OF EEWDEP(EDPACT) = 'N'
              AND CPAIND OF EEWDEP(EDPACT) = CPAIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO CPAIND OF MDTTAB(LIN-0001)
              END-IF
              IF (CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S')
              AND CPAIND OF EEWDEP(EDPACT) = CPAIND OF DEPTAB(DEPTMP)
                 PERFORM A970-CPAMAS-CHG THRU A979-EXIT
                 IF CPACHG-FLAG = 'Y'
                    MOVE CPAIND OF EEWDEP(EDPACT)
                                       TO CPAIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF CPDMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF CPDMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF CPDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                    MOVE 1                TO LINENO OF CPDMAS-REC
                    IF CPAIND OF EEWDEP(EDPACT) = 'M'
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A960-WRITE-CPDMAS THRU A969-EXIT
                    END-IF
                    IF CPAIND OF EEWDEP(EDPACT) = 'S'
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A960-WRITE-CPDMAS THRU A969-EXIT
                    END-IF
                 END-IF
              END-IF
              IF WRKLOC OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKLOC OF EEWDEP(EDPACT) NOT =
                                       WRKLOC OF DEPTAB(DEPTMP)
                 MOVE WRKLOC OF EEWDEP(EDPACT)
                                       TO WRKLOC OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF SSNXRF OF EEWDEP(EDPACT) NOT = ZEROS
              AND SSNXRF OF EEWDEP(EDPACT) NOT =
                                       SSNXRF OF DEPTAB(DEPTMP)
                 MOVE SSNXRF OF EEWDEP(EDPACT)
                                       TO SSNXRF OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF HICNNO OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE HICNNO OF EEWDEP(EDPACT)
                                       TO HICNNO OF MDTTAB(LIN-0001)
                 IF HICNNO OF EEWDEP(EDPACT) NOT =
                                       HICNNO OF DEPTAB(DEPTMP)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                 END-IF
              END-IF
      *
              IF PEBTFS OF EEWDEP(EDPACT) NOT = SPACES
              AND PEBTFS OF EEWDEP(EDPACT) NOT =
                                       PEBTFS OF DEPTAB(DEPTMP)
                 MOVE PEBTFS OF EEWDEP(EDPACT)
                                       TO PEBTFS OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  FAXNUM OF EEWDEP(EDPACT) NOT = SPACES
              AND FAXNUM OF EEWDEP(EDPACT) NOT =
                                       FAXNUM OF DEPTAB(DEPTMP)
                 MOVE FAXNUM OF EEWDEP(EDPACT)
                                       TO FAXNUM OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  OTHPHN OF EEWDEP(EDPACT) NOT = SPACES
              AND OTHPHN OF EEWDEP(EDPACT) NOT =
                                       OTHPHN OF DEPTAB(DEPTMP)
                 MOVE OTHPHN OF EEWDEP(EDPACT)
                                       TO OTHPHN OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF EMLIND OF EEWDEP(EDPACT) NOT = SPACES
              AND EMLIND OF EEWDEP(EDPACT) NOT =
                                       EMLIND OF DEPTAB(DEPTMP)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE EMLIND OF EEWDEP(EDPACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
                 IF EMLIND OF EEWDEP(EDPACT) = 'Y'
                    MOVE ELMAIL OF EEWDEP(EDPACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
              IF EMLIND OF EEWDEP(EDPACT) = 'Y'
              AND EMLIND OF DEMMAS-REC = 'Y'
                 INITIALIZE EMLPTRBV-REC
                 MOVE 'M'                 TO EMLTYP OF EMLPTRBV-REC
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO EMLEID OF EMLPTRBV-REC
                 CALL 'EMLPTRBVM' USING IO-COMMUNICATION
                                                      EMLPTRBV-LM-PARMS
                 MOVE EMLTXT OF EMLPTRBV-REC        TO WS-EMLTXT
                 IF WS-EMLTXT = ELMAIL OF EEWDEP(EDPACT)
                    CONTINUE
                 ELSE
                   MOVE 'Y'                         TO DEMCHG-FLAG
                   MOVE EMLIND OF EEWDEP(EDPACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
                   MOVE ELMAIL OF EEWDEP(EDPACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001)
                  END-IF
              END-IF

              IF  STUSTA OF EEWDEP(EDPACT) NOT = SPACES
              AND STUSTA OF EEWDEP(EDPACT) NOT =
                                       STUSTA OF DEPTAB(DEPTMP)
                 MOVE STUSTA OF EEWDEP(EDPACT)
                                       TO STUSTA OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF HNDIND OF EEWDEP(EDPACT) NOT = SPACES
              AND MEMSTA OF DEPTAB(DEPTMP)
                                       NOT = MEMSTA OF EEWDEP(EDPACT)
                 IF HNDIND OF EEWDEP(EDPACT) = 'Y'
                 AND MEMSTA OF DEPTAB(DEPTMP) NOT = 'H'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE HNDIND OF EEWDEP(EDPACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
                 END-IF
                 IF HNDIND OF EEWDEP(EDPACT) = 'N'
                 AND MEMSTA OF DEPTAB(DEPTMP) = 'H'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE HNDIND OF EEWDEP(EDPACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
              IF  EDUBEG OF EEWDEP(EDPACT) NOT = SPACES
              AND EDUBEG OF EEWDEP(EDPACT) NOT =
                                       EDUBEG OF DEPTAB(DEPTMP)
                 MOVE EDUBEG OF EEWDEP(EDPACT)
                                       TO EDUBEG OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  EDUEND OF EEWDEP(EDPACT) NOT = SPACES
              AND EDUEND OF EEWDEP(EDPACT) NOT =
                                       EDUEND OF DEPTAB(DEPTMP)
                 MOVE EDUEND OF EEWDEP(EDPACT)
                                       TO EDUEND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  CQLECD OF EEWDEP(EDPACT) NOT = SPACES
              AND CQLECD OF EEWDEP(EDPACT) NOT =
                                       CQLECD OF DEPTAB(DEPTMP)
                 MOVE CQLECD OF EEWDEP(EDPACT)
                                       TO CQLECD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  COBRAQ OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAQ OF EEWDEP(EDPACT) NOT =
                                       COBRAQ OF DEPTAB(DEPTMP)
                 MOVE COBRAQ OF EEWDEP(EDPACT)
                                       TO COBRAQ OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  COBRAB OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAB OF EEWDEP(EDPACT) NOT =
                                       COBRAB OF DEPTAB(DEPTMP)
                 MOVE COBRAB OF EEWDEP(EDPACT)
                                       TO COBRAB OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  COBRAE OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAE OF EEWDEP(EDPACT) NOT =
                                       COBRAE OF DEPTAB(DEPTMP)
                 MOVE COBRAE OF EEWDEP(EDPACT)
                                       TO COBRAE OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  EMSTCD OF EEWDEP(EDPACT) NOT = SPACES
              AND EMSTCD OF EEWDEP(EDPACT) NOT =
                                       EMSTCD OF DEPTAB(DEPTMP)
                 MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  DETDAT OF EEWDEP(EDPACT) NOT = SPACES
              AND DETDAT OF EEWDEP(EDPACT) NOT =
                                       DETDAT OF DEPTAB(DEPTMP)
                 MOVE DETDAT OF EEWDEP(EDPACT)
                                       TO DETDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  EXTIND OF EEWDP2(EDPACT) NOT = SPACES
              AND EXTIND OF EEWDP2(EDPACT)
                                       NOT = EXTIND OF DEPTAB(DEPTMP)
                 MOVE EXTIND OF EEWDP2(EDPACT)
                                       TO EXTIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 IF EXTIND OF EEWDP2(EDPACT) = 'Y'
                    INITIALIZE DEMDOCBT-REC
                    MOVE BRANCD OF MBHKEY
                                       TO BRANCD OF DEMDOCBT-REC
                    MOVE BATDAT OF MBHKEY
                                       TO BATDAT OF DEMDOCBT-REC
                    MOVE BATSEQ OF MBHKEY
                                       TO BATSEQ OF DEMDOCBT-REC
                    MOVE SEQNUM OF WS-WORK
                                       TO SEQNUM OF DEMDOCBT-REC
                    MOVE 1             TO LINENO OF DEMDOCBT-REC
                    PERFORM A1330-WRITE-DEMDOCBT THRU A1339-EXIT
                 END-IF
              END-IF
              IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                 PERFORM A1520-EXCMEMBT-CHG      THRU A1529-EXIT
      ****       IF EXCMEM-FLAG = 'Y'
      ****       OR ADD-EXCMEM
                 IF   RELCOD OF EEWDP3(EDPACT) NOT = SPACES
                 AND (EXCMEM-FLAG = 'Y'
                 OR   ADD-EXCMEM)
                   MOVE 'Y'                      TO DEMCHG-FLAG
                   MOVE MEMSEQ OF DEPTAB(DEPTMP) TO WS-EXC-MEMSEQ
                   INITIALIZE EXCMDTBT-REC
                   MOVE BRANCD OF MBHMAS-REC     TO WS-EXC-BRANCD
                   MOVE BATDAT OF MBHMAS-REC     TO WS-EXC-BATDAT
                   MOVE BATSEQ OF MBHMAS-REC     TO WS-EXC-BATSEQ
                   MOVE SEQNUM OF WS-WORK        TO WS-EXC-SEQNUM
                   MOVE 1                        TO WS-EXC-LINENO
                   MOVE 1                        TO WS-EXCSEQ
                   PERFORM A1440-WRITE-EXCMDTBT  THRU A1449-EXIT
                 END-IF
              END-IF
              IF  RSPIND OF EEWDP2(EDPACT) NOT = SPACES
              AND RSPIND OF EEWDP2(EDPACT)
                                       NOT = RSPIND OF DEPTAB(DEPTMP)
                 MOVE RSPIND OF EEWDP2(EDPACT)
                                       TO RSPIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  BENIND OF EEWDP2(EDPACT) = 'N'
              AND BENIND OF EEWDP2(EDPACT) = BENIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO BENIND OF MDTTAB(LIN-0001)
              END-IF
      *
              IF  BENIND OF EEWDP2(EDPACT) NOT = SPACES
              AND BENIND OF EEWDP2(EDPACT) NOT =
                                       BENIND OF DEPTAB(DEPTMP)
                 MOVE BENIND OF EEWDP2(EDPACT)
                                       TO BENIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  BENIND OF EEWDP2(EDPACT) = 'Y'
              AND BENIND OF EEWDP2(EDPACT) = BENIND OF DEPTAB(DEPTMP)
                 PERFORM B1410-EXTBENBT-CHG      THRU B1419-EXIT
                 IF EXTBEN-FLAG = 'Y'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BENIND OF EEWDP2(EDPACT)
                                          TO BENIND OF MDTTAB(LIN-0001)
                    INITIALIZE EXTDOCBT-REC
                    MOVE BRANCD OF MBHKEY TO BRANCD OF EXTDOCBT-REC
                    MOVE BATDAT OF MBHKEY TO BATDAT OF EXTDOCBT-REC
                    MOVE BATSEQ OF MBHKEY TO BATSEQ OF EXTDOCBT-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF EXTDOCBT-REC
                    MOVE 1                TO LINENO OF EXTDOCBT-REC
                    MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                          TO MEMSEQ OF EXTDOCBT-REC
                    PERFORM B1310-WRITE-EXTDOCBT THRU B1319-EXIT
                 END-IF
              END-IF

           IF  BENIND OF EEWDP2(EDPACT) = 'Y'
           AND BENIND OF EEWDP2(EDPACT) NOT = BENIND OF DEPTAB(DEPTMP)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BENIND OF EEWDP2(EDPACT)
                                    TO BENIND OF MDTTAB(LIN-0001)
              INITIALIZE EXTDOCBT-REC
              MOVE BRANCD OF MBHKEY TO BRANCD OF EXTDOCBT-REC
              MOVE BATDAT OF MBHKEY TO BATDAT OF EXTDOCBT-REC
              MOVE BATSEQ OF MBHKEY TO BATSEQ OF EXTDOCBT-REC
              MOVE SEQNUM OF WS-WORK
                                    TO SEQNUM OF EXTDOCBT-REC
              MOVE 1                TO LINENO OF EXTDOCBT-REC
              MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                    TO MEMSEQ OF EXTDOCBT-REC
              PERFORM B1310-WRITE-EXTDOCBT THRU B1319-EXIT
           END-IF
              IF  WS-FULLUP NOT = 'A'     AND
                  WS-VERSID = '005010'    AND
               ( EPCLS1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 EPCLS3 OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTNM OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTQL OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPCTID OF EEWDP2(EDPACT) NOT = SPACES OR
                 RDTFMT OF EEWDP2(EDPACT) NOT = SPACES OR
                 RCTDAT OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLLST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLFST OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLMID OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLPRE OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSUF OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 DOLSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCQ OF EEWDP2(EDPACT) NOT = SPACES OR
                 ICMRCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 MDRCCC OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD1 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBAD2 OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCTY OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBSTA OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBZIP OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CSPCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 CNTSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 SCHSCD OF EEWDP2(EDPACT) NOT = SPACES OR
                 RPTCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 MBMCSB OF EEWDP2(EDPACT) NOT = SPACES OR
                 COBPHN OF EEWDP2(EDPACT) NOT = SPACES    )
                    INITIALIZE EDIDOCBT-REC
                    MOVE BRANCD OF MBHKEY
                                       TO BRANCD OF EDIDOCBT-REC
                    MOVE BATDAT OF MBHKEY
                                       TO BATDAT OF EDIDOCBT-REC
                    MOVE BATSEQ OF MBHKEY
                                       TO BATSEQ OF EDIDOCBT-REC
                    MOVE SEQNUM OF WS-WORK
                                       TO SEQNUM OF EDIDOCBT-REC
                    MOVE 1             TO LINENO OF EDIDOCBT-REC
                    PERFORM A1380-WRITE-EDIDOCBT THRU A1389-EXIT
              END-IF
      *
              IF  ALTIND OF EEWDP2(EDPACT) NOT = SPACES
              AND ALTIND OF EEWDP2(EDPACT)
                                       NOT = ALTIND OF DEPTAB(DEPTMP)
                 MOVE ALTIND OF EEWDP2(EDPACT)
                                       TO ALTIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              AND MMDIND OF EEWDEP(EDPACT) NOT =
                                       MMDIND OF DEPTAB(DEPTMP)
                 MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MMDMAS-REC
                 MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MMDMAS-REC
                 MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MMDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                 MOVE 1                TO LINENO OF MMDMAS-REC
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MMDMAS-REC
                 PERFORM A1020-WRITE-MMDMAS      THRU A1029-EXIT
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'N'
              AND MMDIND OF EEWDEP(EDPACT) = MMDIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO MMDIND OF MDTTAB(LIN-0001)
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              AND MMDIND OF EEWDEP(EDPACT) = MMDIND OF DEPTAB(DEPTMP)
                 PERFORM A1030-MCDMAS-CHG THRU A1039-EXIT
                 IF MCDCHG-FLAG = 'Y'
                    MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MMDMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MMDMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MMDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                    MOVE 1             TO LINENO OF MMDMAS-REC
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MMDMAS-REC
                    PERFORM A1020-WRITE-MMDMAS THRU A1029-EXIT
                 END-IF
              END-IF
              IF MMCIND OF EEWDEP(EDPACT) = 'N'
              AND MMCIND OF EEWDEP(EDPACT) = MMCIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO MMCIND OF MDTTAB(LIN-0001)
              END-IF
              IF MMCIND OF EEWDEP(EDPACT) = 'Y'
              AND MMCIND OF EEWDEP(EDPACT) = MMCIND OF DEPTAB(DEPTMP)
                 PERFORM A1130-MCMMAS-CHG THRU A1139-EXIT
                 IF MCRCHG-FLAG = 'Y'
                    MOVE MMCIND OF EEWDEP(EDPACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MDMMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MDMMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MDMMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                    MOVE 1             TO LINENO OF MDMMAS-REC
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDMMAS-REC
                    PERFORM A1120-WRITE-MDMMAS THRU A1129-EXIT
                 END-IF
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'N'
              AND MMDIND OF EEWDEP(EDPACT) NOT =
                                       MMDIND OF DEPTAB(DEPTMP)
                 MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  RSPIND OF EEWDP2(EDPACT) = 'N'
              AND RSPIND OF EEWDP2(EDPACT) = RSPIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO RSPIND OF MDTTAB(LIN-0001)
              END-IF
              IF  RSPIND OF EEWDP2(EDPACT) = 'Y'
              AND RSPIND OF EEWDP2(EDPACT) = RSPIND OF DEPTAB(DEPTMP)
                 PERFORM A1410-RSPPTYBT-CHG      THRU A1419-EXIT
                 IF RSPPTY-FLAG = 'Y'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE RSPIND OF EEWDP2(EDPACT)
                                       TO RSPIND OF MDTTAB(LIN-0001)
                    MOVE BRANCD OF MBHKEY
                                       TO BRANCD OF RSPDOCBT-REC
                    MOVE BATDAT OF MBHKEY
                                       TO BATDAT OF RSPDOCBT-REC
                    MOVE BATSEQ OF MBHKEY
                                       TO BATSEQ OF RSPDOCBT-REC
                    MOVE SEQNUM OF WS-WORK
                                       TO SEQNUM OF RSPDOCBT-REC
                    MOVE 1             TO LINENO OF RSPDOCBT-REC
                    MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                       TO MEMSEQ OF RSPDOCBT-REC
                    PERFORM A1310-WRITE-RSPDOCBT THRU A1319-EXIT
                 END-IF
              END-IF
      *
              IF  RSPIND OF EEWDP2(EDPACT) = 'Y'
              AND RSPIND OF EEWDP2(EDPACT) NOT =
                                                RSPIND OF DEPTAB(DEPTMP)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE RSPIND OF EEWDP2(EDPACT)
                                       TO RSPIND OF MDTTAB(LIN-0001)
                 MOVE BRANCD OF MBHKEY TO BRANCD OF RSPDOCBT-REC
                 MOVE BATDAT OF MBHKEY TO BATDAT OF RSPDOCBT-REC
                 MOVE BATSEQ OF MBHKEY TO BATSEQ OF RSPDOCBT-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF RSPDOCBT-REC
                 MOVE 1                TO LINENO OF RSPDOCBT-REC
                 MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                       TO MEMSEQ OF RSPDOCBT-REC
                 PERFORM A1310-WRITE-RSPDOCBT THRU A1319-EXIT
              END-IF
              IF  ALTIND OF EEWDP2(EDPACT) = 'N'
              AND ALTIND OF EEWDP2(EDPACT) = ALTIND OF DEPTAB(DEPTMP)
                 MOVE SPACE            TO ALTIND OF MDTTAB(LIN-0001)
              END-IF
      *
              IF  ALTIND OF EEWDP2(EDPACT) = 'Y'
              AND ALTIND OF EEWDP2(EDPACT) = ALTIND OF DEPTAB(DEPTMP)
                 PERFORM A1450-ALTADRBT-CHG      THRU A1459-EXIT
                 IF ALTADR-FLAG = 'Y'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE ALTIND OF EEWDP2(EDPACT)
                                       TO ALTIND OF MDTTAB(LIN-0001)
                    INITIALIZE ALTDOCBT-REC
                    MOVE BRANCD OF MBHKEY TO BRANCD OF ALTDOCBT-REC
                    MOVE BATDAT OF MBHKEY TO BATDAT OF ALTDOCBT-REC
                    MOVE BATSEQ OF MBHKEY TO BATSEQ OF ALTDOCBT-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF ALTDOCBT-REC
                    MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                       TO MEMSEQ OF ALTDOCBT-REC
                    MOVE 1             TO LINENO OF ALTDOCBT-REC
                    PERFORM A1350-WRITE-ALTDOCBT THRU A1359-EXIT
                 END-IF
              END-IF
              IF  ALTIND OF EEWDP2(EDPACT) = 'Y'
              AND ALTIND OF EEWDP2(EDPACT) NOT =
                                                ALTIND OF DEPTAB(DEPTMP)
                 MOVE 'Y'                           TO DEMCHG-FLAG
                 MOVE ALTIND OF EEWDP2(EDPACT)
                                       TO ALTIND OF MDTTAB(LIN-0001)
                 INITIALIZE ALTDOCBT-REC
                 MOVE BRANCD OF MBHKEY TO BRANCD OF ALTDOCBT-REC
                 MOVE BATDAT OF MBHKEY TO BATDAT OF ALTDOCBT-REC
                 MOVE BATSEQ OF MBHKEY TO BATSEQ OF ALTDOCBT-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF ALTDOCBT-REC
                 MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                       TO MEMSEQ OF ALTDOCBT-REC
                 MOVE 1                TO LINENO OF ALTDOCBT-REC
                 PERFORM A1350-WRITE-ALTDOCBT THRU A1359-EXIT
              END-IF
              IF  MEM-EXISTS
              AND EMPSTA OF EEWDEP(EDPACT) NOT =
                                         EMPSTA OF MEMTAB(MEMACT)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              END-IF
              IF DEMMAS-CHANGE
                 MOVE 001              TO LINENO OF MDTTAB(LIN-0001)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0001)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0001)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0001)
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
                 MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
                 MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
                 MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
                 MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                 MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                 MOVE TITLCD OF EEWDEP(EDPACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
                 MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
      ****-------------------------------------------------------------
      ****  CR140831  AHG  FIX
      ****-------------------------------------------------------------
      ****       MOVE ENBEFF OF EEWDEP(EDPACT)
      ****                             TO EFFDAT OF MDTTAB(LIN-0001)
      ****       MOVE ENBEXP OF EEWDEP(EDPACT)
      ****                             TO EXPDAT OF MDTTAB(LIN-0001)
                 MOVE MEMEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0001)
                 MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0001)
                 MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0001 1)
                 MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0001)
                 MOVE '1'              TO STATCD OF MDTTAB(LIN-0001)
                 MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
                 MOVE EECOVR OF EEWDEP(EDPACT)
                                       TO EECOVR OF MDTTAB(LIN-0001)
                 MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
                 MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0001)
                 MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0001)
                 MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0001)
           MOVE MHCIND OF EEWDEP(EDPACT)
                                       TO MHCIND OF MDTTAB(LIN-0001)
           IF INDUPD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE INDUPD OF EEWDEP(EDPACT)
                                       TO INDUPD OF MDTTAB(LIN-0001)
           ELSE
              MOVE 'N'                 TO INDUPD OF MDTTAB(LIN-0001)
           END-IF
           MOVE OMEDAT OF EEWDEP(EDPACT)
                                       TO OMEDAT OF MDTTAB(LIN-0001)
           MOVE CRDMTH OF EEWDEP(EDPACT)
                                       TO CRDMTH OF MDTTAB(LIN-0001)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
              MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
              MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
              MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
              MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
              MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
              MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
              MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
              MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
              MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
              MOVE SPACE               TO TIRFLG OF MDTTAB(LIN-0001)
              MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
              MOVE MARSTA OF EEWDEP(EDPACT)
                                       TO MARSTA OF MDTTAB(LIN-0001)
                 IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                    MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0001)
                 ELSE
                    MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001)
                 END-IF
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0001)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0001)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0001)
              END-IF
              END-IF
           END-IF.
      *
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0001)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0001)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0001)
           END-IF.
      *
       A682-STEP-4.
           IF PRCDEM OF EEWHDR-WRK = 'N'
           OR DEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-5.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF HOLDCD OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO HLDCOD-MEM
                 MOVE HOLDCD OF EEWDEP(EDPACT)   TO HLDCOD-HLD
                 PERFORM A750-HLDCOD-CHK         THRU A759-EXIT
                 IF HLDCOD-FOUND
                    GO TO A682-STEP-5
                 ELSE
                    MOVE 1             TO LINENO OF MDTTAB(LIN-0001)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0001)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0001)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0001)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
                    MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                    MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                    MOVE TITLCD OF EEWDEP(EDPACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
                    MOVE HOLDCD OF EEWDEP(EDPACT)
                                       TO HOLDCD OF MDTTAB(LIN-0001)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0001)
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
                    MOVE EECOVR OF EEWDEP(EDPACT)
                                       TO EECOVR OF MDTTAB(LIN-0001)
                    MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0001)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0001)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0001)
                    MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
                    MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
                    MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
                    MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
                    MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
                    MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
                    MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
                    MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
                    MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
                    MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
                    MOVE SPACE         TO TIRFLG OF MDTTAB(LIN-0001)
                    MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
                    MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
                    MOVE MARSTA OF EEWDEP(EDPACT)
                                       TO MARSTA OF MDTTAB(LIN-0001)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                    OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0001)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES' TO EXCHNG OF MDTTAB(LIN-0001)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0001)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0001)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0001)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0001)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0001)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0001)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001).
       A682-STEP-5.
           IF PRCPCP OF EEWHDR-WRK = 'N'
           OR PCPCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-6.
           IF MEMTMP = ZERO                      GO TO A682-STEP-12.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
                 PERFORM A810-DEPPCP             THRU A819-EXIT
                 IF (PCPTMP = ZERO
                 AND BYPEDT OF EDIENR-REC = 'N')
                                                 GO TO A682-STEP-6
                 END-IF
                 IF PCPCOD OF EEWDEP(EDPACT) NOT =
                               PROVNO OF PCPTAB(MEMTMP, PCPTMP)
                 OR (PCPORG OF EEWDEP(EDPACT) NOT =
                              PRVORG OF PCPTAB(MEMTMP, PCPTMP)
                 AND PCPORG OF EEWDEP(EDPACT) NOT = SPACES)
                 OR  PCPMCP OF EEWDEP(EDPACT) NOT =
                              MEMCAP OF PCPTAB(MEMTMP, PCPTMP)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    IF PCPREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE PCPREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE PCPEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE PCPEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE PCPCOD OF EEWDEP(EDPACT) TO
                                          PROVNO OF MDTTAB(LIN-0004)
                    END-IF
                       MOVE PCPORG OF EEWDEP(EDPACT) TO
                                          PRVORG OF MDTTAB(LIN-0004)
                       MOVE PCPMCP OF EEWDEP(EDPACT) TO
                                          PCPMCP OF MDTTAB(LIN-0004)
                    IF PCPOVR OF EEWDEP(EDPACT) = SPACES
                       MOVE 'N'        TO PCPOVR OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPOVR OF EEWDEP(EDPACT) TO
                                          PCPOVR OF MDTTAB(LIN-0004)
                    END-IF
                    IF PCPTRM OF EEWDEP(EDPACT) = SPACES
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       MOVE 'Y'        TO PCPTRM-FLAG
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
                    MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
                    MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
                    MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
                    MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
                    MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
                    MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
                    MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
                    MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
                    MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    MOVE SPACE         TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWDEP(EDPACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES' TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       A682-STEP-6.
           IF PRCSEC OF EEWHDR-WRK = 'N'
           OR SECCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-7.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO A682-STEP-7.
           IF SECCOD OF EEWDEP(EDPACT) NOT = SPACES
              PERFORM A820-DEPSEC                THRU A829-EXIT
           ELSE
              GO TO A682-STEP-7.
      *
           IF SECTMP = ZEROES
              GO TO A682-ADDSEC.
           IF SECCOD OF EEWDEP(EDPACT) NOT =
                               PROVNO OF SECTAB(MEMTMP, SECTMP)
           OR (SECORG OF EEWDEP(EDPACT) NOT =
                              PRVORG OF SECTAB(MEMTMP, SECTMP)
           AND SECORG OF EEWDEP(EDPACT) NOT = SPACES)
           OR SECMCP OF EEWDEP(EDPACT) NOT =
                              MEMCAP OF SECTAB(MEMTMP, SECTMP)
                                                 GO TO A682-ADDSEC.
      *
           GO TO A682-STEP-7.
      *
       A682-ADDSEC.
           MOVE 5             TO LINENO OF MDTTAB(LIN-0005)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0005)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0005)
           MOVE '1'           TO STATCD OF MDTTAB(LIN-0005)
           MOVE SEQNUM OF WS-WORK TO      SEQNUM OF MDTTAB(LIN-0005)
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0005)
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0005)
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0005)
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0005)
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0005)
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0005)
           IF SECREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0005)
           MOVE SECEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0005)
           MOVE SECEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0005)
           IF SECCOD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECCOD OF EEWDEP(EDPACT) TO
                                          SECPRV OF MDTTAB(LIN-0005)
           END-IF
              MOVE SECORG OF EEWDEP(EDPACT) TO
                                          SECORG OF MDTTAB(LIN-0005)
              MOVE SECMCP OF EEWDEP(EDPACT) TO
                                          SECMCP OF MDTTAB(LIN-0005)
           IF SECOVR OF EEWDEP(EDPACT) = SPACES
              MOVE 'N'        TO SECOVR OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECOVR OF EEWDEP(EDPACT) TO
                                          SECOVR OF MDTTAB(LIN-0005)
           END-IF
           IF SECTRM OF EEWDEP(EDPACT) = SPACES
              MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0005)
           END-IF
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0005)
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0005)
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0005)
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0005)
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0005)
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0005)
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0005)
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0005)
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0005)
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0005)
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0005)
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0005)
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0005)
           MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0005 1)
           MOVE BENPKG OF EEWDEP(EDPACT) TO BENPKG OF MDTTAB(LIN-0005)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0005)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0005)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0005)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0005)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0005)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0005)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0005)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0005).
       A682-STEP-7.
           IF PRCMCS OF EEWHDR-WRK = 'N'
           OR MEDCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-8.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO A682-STEP-8.
      *
           IF (MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEDSTS OF EEWDEP(EDPACT) NOT = SPACES)
              PERFORM A830-DEPMED                THRU A839-EXIT
           ELSE
              GO TO A682-STEP-8.
      *
           IF MEDTMP = ZEROES
              GO TO A682-ADDMED.
           IF MEMTMP = ZEROES
              GO TO A689-EXIT.
      *
           IF  MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEDSTS OF EEWDEP(EDPACT) NOT = SPACES
              IF MEDCTY OF EEWDEP(EDPACT) NOT =
                              MEDCTY OF MEDTAB(MEMTMP, MEDTMP)
              OR (MEDSTS OF EEWDEP(EDPACT) NOT =
                              MEDSTS OF MEDTAB(MEMTMP, MEDTMP))
                 GO TO A682-ADDMED.
      *
           GO TO A682-STEP-8.
      *
       A682-ADDMED.
           MOVE 6                   TO LINENO OF MDTTAB(LIN-0006)
           MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0006)
           MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0006)
           MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0006)
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0006)
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0006)
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0006)
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0006)
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0006)
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0006)
           IF MEDREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0006)
           MOVE MEDEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0006)
           MOVE MEDEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0006)
           MOVE MEDCTY OF EEWDEP(EDPACT) TO MEDCTY OF MDTTAB(LIN-0006)
           MOVE MEDSTS OF EEWDEP(EDPACT) TO MEDSTS OF MDTTAB(LIN-0006)
           IF MEDTRM OF EEWDEP(EDPACT) = SPACES
              MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEDTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0006)
           END-IF
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0006)
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0006)
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0006)
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0006)
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0006)
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0006)
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0006)
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0006)
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0006)
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0006)
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0006)
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0006)
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0006)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0006)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0006)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0006)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0006)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0006)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0006)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0006)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0006).
       A682-STEP-8.
           IF PRCFEE OF EEWHDR-WRK = 'N'
           OR FEECHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-9.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO A682-STEP-9.
      *
           IF FEECOD OF EEWDEP(EDPACT) NOT = SPACES
              PERFORM A840-DEPFEE                THRU A849-EXIT
           ELSE
              GO TO A682-STEP-9.
      *
           IF FEETMP = ZEROES
              GO TO A682-ADDFEE.
           IF MEMTMP = ZEROES
              GO TO A689-EXIT.
      *
           IF FEECOD OF EEWDEP(EDPACT) NOT =
                               FEECOD OF FEETAB(MEMTMP, FEETMP)
              GO TO A682-ADDFEE.
      *
           GO TO A682-STEP-9.
      *
       A682-ADDFEE.
           MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
           MOVE SEQNUM OF WS-WORK TO      SEQNUM OF MDTTAB(LIN-0004)
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0004)
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0004)
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0004)
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0004)
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0004)
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0004)
           IF FEEREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE FEEREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0004)
           MOVE FEEEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0004)
           MOVE FEEEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0004)
           MOVE FEECOD OF EEWDEP(EDPACT) TO FEECOD OF MDTTAB(LIN-0004)
           IF FEETRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE FEETRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              MOVE 'Y'                 TO FEETRM-FLAG
           ELSE
              IF PCPTRM-NOT-USED
                MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              END-IF
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
           END-IF
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0004)
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0004)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0004)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0004)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0004)
           END-IF
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0004)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       A682-STEP-9.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-11.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****  Correct alignment per standards.                      ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF (USRFL1 OF EEWDEP(EDPACT) NOT = SPACES
              OR  USRFL2 OF EEWDEP(EDPACT) NOT = SPACES
              OR  USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
                 PERFORM A850-DEPENB                 THRU A859-EXIT
                 IF ENBTMP = ZERO                    GO TO A682-STEP-12
                 END-IF
                 IF MEMTMP = ZERO                    GO TO A689-EXIT
                 END-IF
                 IF (USRFL1 OF EEWDEP(EDPACT) NOT =
                               USRFL1 OF ENBTAB(MEMTMP, ENBTMP)
                 OR USRFL2 OF EEWDEP(EDPACT) NOT =
                               USRFL2 OF ENBTAB(MEMTMP, ENBTMP)
                 OR USRFL3 OF EEWDEP(EDPACT) NOT =
                               USRFL3 OF ENBTAB(MEMTMP, ENBTMP))
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE TIRFLG OF EEWDEP(EDPACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       A682-STEP-11.

           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCBPK OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWDEP(EDPACT) = 'N'
              GO TO A682-STEP-12.

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****  Correct alignment per standards.                      ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              MOVE CHGTYP OF EEWDEP(EDPACT)      TO CHGTYP OF WS-WORK
              IF BENPKG OF EEWDEP(EDPACT) NOT = SPACES
                 PERFORM A850-DEPENB                 THRU A859-EXIT
                 IF ENBTMP = ZERO                    GO TO A682-STEP-12
                 END-IF
                 IF MEMTMP = ZERO                    GO TO A689-EXIT
                 END-IF
                 IF BENPKG OF EEWDEP(EDPACT) NOT =
                               BENPKG OF ENBTAB(MEMTMP, ENBTMP)
      *
                    INITIALIZE GPHMAS-REC
                    MOVE ENBGRP OF WS-WORK       TO GRPNUM OF GPHMAS-KEY
                    MOVE +1                      TO CONSET OF GPHMAS-KEY
                    PERFORM B650-GPHMAS          THRU B659-EXIT
                    IF SW-OK = 'N'               GO TO A689-EXIT
                    END-IF
                    IF BENEQU = 'Y'
                       MOVE 'N'                  TO BENEQU
                                                 GO TO A689-EXIT
                    END-IF
      *
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)

                    IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE TIRFLG OF EEWDEP(EDPACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF EXCMEM-FLAG = 'Y'
                    OR ADD-EXCMEM
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE 'N'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE SPACES     TO EXCHNG OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       A682-STEP-12.
           IF EXTMEM OF EEWDEP(EDPACT) = SPACES
           AND EXTGRP OF EEWDEP(EDPACT) = SPACES
           AND EXTSUB OF EEWDEP(EDPACT) = SPACES
                                                 GO TO A682-STEP-13.
      *
           MOVE 7                      TO LINENO OF MDTTAB(LIN-0007).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0007).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0007).
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0007).
           MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0007).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0007).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0007).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0007).
           MOVE EXTMEM OF EEWDEP(EDPACT) TO EXTMEM OF MDTTAB(LIN-0007).
           MOVE EXTGRP OF EEWDEP(EDPACT) TO EXTGRP OF MDTTAB(LIN-0007).
           MOVE EXTCON OF EEWDEP(EDPACT) TO EXTCON OF MDTTAB(LIN-0007).
           MOVE EXTEFF OF EEWDEP(EDPACT) TO EXTEFF OF MDTTAB(LIN-0007).
           MOVE EXTEXP OF EEWDEP(EDPACT) TO EXTEXP OF MDTTAB(LIN-0007).
           MOVE EXTSUB OF EEWDEP(EDPACT) TO EXTSUB OF MDTTAB(LIN-0007).
           MOVE HISSEQ OF EEWDEP(EDPACT) TO HISSEQ OF MDTTAB(LIN-0007).
           MOVE CTLPLN OF EEWDEP(EDPACT) TO CTLPLN OF MDTTAB(LIN-0007).
           MOVE EXTREL OF EEWDEP(EDPACT) TO EXTREL OF MDTTAB(LIN-0007).
           MOVE PRVPLN OF EEWDEP(EDPACT) TO PRVPLN OF MDTTAB(LIN-0007).
           MOVE PRVNET OF EEWDEP(EDPACT) TO PRVNET OF MDTTAB(LIN-0007).
           MOVE PROCOD OF EEWDEP(EDPACT) TO PROCOD OF MDTTAB(LIN-0007).
           IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF MEMMAS-REC = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0007)
              ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0007)
                   ELSE
                      MOVE EXCHNG OF MEMMAS-REC
                                       TO EXCHNG OF MDTTAB(LIN-0007)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0007)
           END-IF.
           IF EXCMEM-FLAG = 'Y'
           OR ADD-EXCMEM
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
           ELSE
              MOVE 'N'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE SPACES              TO EXCHNG OF MDTTAB(LIN-0007)
           END-IF.
      *
       A682-STEP-13.
           IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE ENBTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0002).
           IF PCPTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE PCPTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004).
           IF SECTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0005).
           IF MEDTRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0006).

           IF ACCTNO OF MDTTAB(LIN-0002) NOT = SPACES
              IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE ENBREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0002).
           IF PCPREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE PCPREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0004).
           IF SECREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0005).
           IF MEDREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0006).
       A682-STEP-14.
           IF  REACAT OF EEWDP3(EDPACT)(1:6) = 'CANCEL'
           AND CANEFF OF EEWDP3(EDPACT) NOT= ZEROS
              CONTINUE
           ELSE
              GO TO A682-WRITE.
      *
           MOVE 9                      TO LINENO OF MDTTAB(LIN-0009).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0009).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0009).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0009).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0009).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0009).
           MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF MDTTAB(LIN-0009).
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF MDTTAB(LIN-0009).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0009)
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0009)
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0009)
           IF GRPNUM OF EEWDEP(EDPACT) = SPACES
              MOVE GRPNUM OF EEWHDR-WRK
                                       TO GRPNUM OF MDTTAB(LIN-0009)
           ELSE
              MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0009).
           MOVE ADRLN1 OF EEWDEP(EDPACT) TO ADRLN1 OF MDTTAB(LIN-0009)
           MOVE ADRLN2 OF EEWDEP(EDPACT) TO ADRLN2 OF MDTTAB(LIN-0009)
           MOVE CITYCD OF EEWDEP(EDPACT) TO CITYCD OF MDTTAB(LIN-0009)
           MOVE STACOD OF EEWDEP(EDPACT) TO STACOD OF MDTTAB(LIN-0009)
           MOVE ZIPCOD OF EEWDEP(EDPACT) TO ZIPCOD OF MDTTAB(LIN-0009)
           MOVE CTRYCD OF EEWDEP(EDPACT) TO CTRYCD OF MDTTAB(LIN-0009)
           MOVE PRTCOD OF EEWDEP(EDPACT) TO PRTCOD OF MDTTAB(LIN-0009)
           MOVE EXCHNG OF EEWDP2(EDPACT) TO EXCHNG OF MDTTAB(LIN-0009)
      *
           IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0009)
           ELSE
              MOVE ' '                 TO EXCIND OF MDTTAB(LIN-0009).
      *
           IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              MOVE EXCHNG OF MEMMAS-REC TO EXCHNG OF MDTTAB(LIN-0009)
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0009)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0009).
      *
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF MDTTAB(LIN-0009).
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF MDTTAB(LIN-0009).
           MOVE CANEFF OF EEWDP3(EDPACT) TO CANEFF OF MDTTAB(LIN-0009).
           MOVE REACAT OF EEWDP3(EDPACT) TO REACAT OF MDTTAB(LIN-0009).
      *
       A682-WRITE.
           MOVE DOCNUM OF EEWDEP(EDPACT) TO DOCNUM OF WS-WORK.
      *
           MOVE 'D'                              TO RECTYP-FLAG.
           MOVE 'N'                              TO MDT-FLAG.
           MOVE 'N'                              TO SEQ-FLAG.
           MOVE 'N'                              TO PRCSEQ-FLAG.
           MOVE 'Y'                              TO FIRST-LINE-FLAG.
           MOVE 'DEP'                            TO MEMEXT-TYP.
      *
           PERFORM A690-MDTMAS-WRITE             THRU A699-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           IF MDT-ADDED
              ADD 1                    TO TOTBAT OF WS-WORK
              ADD 1                    TO NUMMDT OF WS-WORK
              ADD 1                    TO BATCHG OF WS-WORK.
       A689-EXIT.
           EXIT.
      *
       A690-MDTMAS-WRITE.
      ***************************************************************
      *‚ADD THE MDTMAS RECORD FOR ME1023 RECORDD                    *
      ***************************************************************
           IF SUBSNO OF MDTTAB(INDX) = SPACES
              GO TO A699-EXIT.
      *
           PERFORM A740-INTMDT                   THRU A749-EXIT.
      *
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTMAS-REC.
           MOVE LINENO OF MDTTAB(INDX) TO LINENO OF MDTMAS-REC.
           MOVE RECTYP OF MDTTAB(INDX) TO RECTYP OF MDTMAS-REC.
           MOVE SUBSNO OF MDTTAB(INDX) TO SUBSNO OF MDTMAS-REC.
           MOVE MEMBNO OF MDTTAB(INDX) TO MEMBNO OF MDTMAS-REC.
           MOVE NAMKEY OF MDTTAB(INDX) TO NAMKEY OF MDTMAS-REC.
           MOVE TITLCD OF MDTTAB(INDX) TO TITLCD OF MDTMAS-REC.
           MOVE ADRLN1 OF MDTTAB(INDX) TO ADRLN1 OF MDTMAS-REC.
           MOVE ADRLN2 OF MDTTAB(INDX) TO ADRLN2 OF MDTMAS-REC.
           MOVE CITYCD OF MDTTAB(INDX) TO CITYCD OF MDTMAS-REC.
           MOVE STACOD OF MDTTAB(INDX) TO STACOD OF MDTMAS-REC.
           MOVE ZIPCOD OF MDTTAB(INDX) TO ZIPCOD OF MDTMAS-REC.
           MOVE CTRYCD OF MDTTAB(INDX) TO CTRYCD OF MDTMAS-REC.
           MOVE AREACD OF MDTTAB(INDX) TO AREACD OF MDTMAS-REC.
           MOVE HOMPH1 OF MDTTAB(INDX) TO HOMPH1 OF MDTMAS-REC.
           MOVE HOMPH2 OF MDTTAB(INDX) TO HOMPH2 OF MDTMAS-REC.
           MOVE HOMPH3 OF MDTTAB(INDX) TO HOMPH3 OF MDTMAS-REC.
           MOVE WRKPH1 OF MDTTAB(INDX) TO WRKPH1 OF MDTMAS-REC.
           MOVE WRKPH2 OF MDTTAB(INDX) TO WRKPH2 OF MDTMAS-REC.
           MOVE WRKPH3 OF MDTTAB(INDX) TO WRKPH3 OF MDTMAS-REC.
           MOVE WRKEXT OF MDTTAB(INDX) TO WRKEXT OF MDTMAS-REC.
           MOVE HIRDAT OF MDTTAB(INDX) TO HIRDAT OF MDTMAS-REC.
           MOVE SOCSEC OF MDTTAB(INDX) TO SOCSEC OF MDTMAS-REC.
           MOVE BTHDAT OF MDTTAB(INDX) TO BTHDAT OF MDTMAS-REC.
           MOVE SEXCOD OF MDTTAB(INDX) TO SEXCOD OF MDTMAS-REC.
           MOVE RACECD OF MDTTAB(INDX) TO RACECD OF MDTMAS-REC.
           MOVE TYPCOD OF MDTTAB(INDX) TO TYPCOD OF MDTMAS-REC.
           MOVE HOLDCD OF MDTTAB(INDX) TO HOLDCD OF MDTMAS-REC.
           MOVE PROVNO OF MDTTAB(INDX) TO PROVNO OF MDTMAS-REC.
           MOVE SECPRV OF MDTTAB(INDX) TO SECPRV OF MDTMAS-REC.
           MOVE RELCOD OF MDTTAB(INDX) TO RELCOD OF MDTMAS-REC.
           MOVE MEMSTA OF MDTTAB(INDX) TO MEMSTA OF MDTMAS-REC.
           MOVE AUTEXP OF MDTTAB(INDX) TO AUTEXP OF MDTMAS-REC.
           MOVE GRPNUM OF MDTTAB(INDX) TO GRPNUM OF MDTMAS-REC.
           MOVE ACCTNO OF MDTTAB(INDX) TO ACCTNO OF MDTMAS-REC.
           MOVE TIERCD OF MDTTAB(INDX 1) TO TIERCD OF MDTMAS-REC(01).
           MOVE FEECOD OF MDTTAB(INDX) TO FEECOD OF MDTMAS-REC.
           MOVE BUDCOD OF MDTTAB(INDX) TO BUDCOD OF MDTMAS-REC.
           MOVE CHGTYP OF MDTTAB(INDX) TO CHGTYP OF MDTMAS-REC.
           MOVE REASCD OF MDTTAB(INDX) TO REASCD OF MDTMAS-REC.
           MOVE EFFDAT OF MDTTAB(INDX) TO EFFDAT OF MDTMAS-REC.
           MOVE EXPDAT OF MDTTAB(INDX) TO EXPDAT OF MDTMAS-REC.
           MOVE STATCD OF MDTTAB(INDX) TO STATCD OF MDTMAS-REC.
           MOVE OTHINS OF MDTTAB(INDX) TO OTHINS OF MDTMAS-REC.
           MOVE INTAKE OF MDTTAB(INDX) TO INTAKE OF MDTMAS-REC.
           MOVE INTKCD OF MDTTAB(INDX) TO INTKCD OF MDTMAS-REC.
           MOVE INTDAT OF MDTTAB(INDX) TO INTDAT OF MDTMAS-REC.
           MOVE MARSTA OF MDTTAB(INDX) TO MARSTA OF MDTMAS-REC.
           MOVE CHAREL OF MDTTAB(INDX) TO CHAREL OF MDTMAS-REC.
           MOVE SVCBRN OF MDTTAB(INDX) TO SVCBRN OF MDTMAS-REC.
           MOVE DERDPN OF MDTTAB(INDX) TO DERDPN OF MDTMAS-REC.
           MOVE DERELG OF MDTTAB(INDX) TO DERELG OF MDTMAS-REC.
           MOVE MILINF OF MDTTAB(INDX) TO MILINF OF MDTMAS-REC.
           MOVE PRIVDT OF MDTTAB(INDX) TO PRIVDT OF MDTMAS-REC.
           MOVE PRIVNM OF MDTTAB(INDX) TO PRIVNM OF MDTMAS-REC.
           MOVE PRIVRL OF MDTTAB(INDX) TO PRIVRL OF MDTMAS-REC.
           MOVE CHADIS OF MDTTAB(INDX) TO CHADIS OF MDTMAS-REC.
           MOVE PRVORG OF MDTTAB(INDX) TO PRVORG OF MDTMAS-REC.
           MOVE SECORG OF MDTTAB(INDX) TO SECORG OF MDTMAS-REC.
           MOVE BENPKG OF MDTTAB(INDX) TO BENPKG OF MDTMAS-REC.
           MOVE FORNAM OF MDTTAB(INDX) TO FORNAM OF MDTMAS-REC.
           MOVE TRMDAT OF MDTTAB(INDX) TO TRMDAT OF MDTMAS-REC.
           MOVE ALTNUM OF MDTTAB(INDX) TO ALTNUM OF MDTMAS-REC.
           MOVE EMPSTA OF MDTTAB(INDX) TO EMPSTA OF MDTMAS-REC.
           MOVE PCPOVR OF MDTTAB(INDX) TO PCPOVR OF MDTMAS-REC.
           MOVE SECOVR OF MDTTAB(INDX) TO SECOVR OF MDTMAS-REC.
           MOVE BILEXC OF MDTTAB(INDX) TO BILEXC OF MDTMAS-REC.
           MOVE PCPMCP OF MDTTAB(INDX) TO PCPMCP OF MDTMAS-REC.
           MOVE SECMCP OF MDTTAB(INDX) TO SECMCP OF MDTMAS-REC.
           MOVE MEDCTY OF MDTTAB(INDX) TO MEDCTY OF MDTMAS-REC.
           MOVE MEDSTS OF MDTTAB(INDX) TO MEDSTS OF MDTMAS-REC.
           MOVE PRTCOD OF MDTTAB(INDX) TO PRTCOD OF MDTMAS-REC.
           MOVE PCPSPC OF MDTTAB(INDX) TO PCPSPC OF MDTMAS-REC.
           MOVE SECSPC OF MDTTAB(INDX) TO SECSPC OF MDTMAS-REC.
           MOVE PRICOD OF MDTTAB(INDX) TO PRICOD OF MDTMAS-REC.
           MOVE MMCEXC OF MDTTAB(INDX) TO MMCEXC OF MDTMAS-REC.
           MOVE CINOVR OF MDTTAB(INDX) TO CINOVR OF MDTMAS-REC.
           MOVE CPAIND OF MDTTAB(INDX) TO CPAIND OF MDTMAS-REC.
           MOVE PEBTFS OF MDTTAB(INDX) TO PEBTFS OF MDTMAS-REC.
           MOVE SSNXRF OF MDTTAB(INDX) TO SSNXRF OF MDTMAS-REC.
           MOVE HICNNO OF MDTTAB(INDX) TO HICNNO OF MDTMAS-REC.
           MOVE MMDIND OF MDTTAB(INDX) TO MMDIND OF MDTMAS-REC.
           MOVE WRKLOC OF MDTTAB(INDX) TO WRKLOC OF MDTMAS-REC.
           MOVE TERMCD OF MDTTAB(INDX) TO TERMCD OF MDTMAS-REC.
           MOVE MEMHLD OF MDTTAB(INDX) TO MEMHLD OF MDTMAS-REC.
           MOVE OVRLTR OF MDTTAB(INDX) TO OVRLTR OF MDTMAS-REC.
           MOVE HLDEFF OF MDTTAB(INDX) TO HLDEFF OF MDTMAS-REC.
           MOVE HLDEXP OF MDTTAB(INDX) TO HLDEXP OF MDTMAS-REC.
           MOVE EECOVR OF MDTTAB(INDX) TO EECOVR OF MDTMAS-REC.
           MOVE MMCIND OF MDTTAB(INDX) TO MMCIND OF MDTMAS-REC.
           MOVE CRDCNT OF MDTTAB(INDX) TO CRDCNT OF MDTMAS-REC.
           MOVE MHCIND OF MDTTAB(INDX) TO MHCIND OF MDTMAS-REC.
           IF INDUPD OF MDTTAB(INDX) NOT = SPACES
              MOVE INDUPD OF MDTTAB(INDX) TO INDUPD OF MDTMAS-REC
           ELSE
              MOVE 'N'                 TO INDUPD OF MDTMAS-REC.
           MOVE MEDCOV OF MDTTAB(INDX)
                                       TO MEDCOV OF MDTMAS-REC.
           MOVE DENCOV OF MDTTAB(INDX)
                                       TO DENCOV OF MDTMAS-REC.
           MOVE OMEDAT OF MDTTAB(INDX) TO OMEDAT OF MDTMAS-REC.
           MOVE CRDMTH OF MDTTAB(INDX) TO CRDMTH OF MDTMAS-REC.
           MOVE LOBCOD OF MDTTAB(INDX) TO LOBCOD OF MDTMAS-REC.
           MOVE HSTOVR OF MDTTAB(INDX) TO HSTOVR OF MDTMAS-REC.
           MOVE PODIND OF MDTTAB(INDX) TO PODIND OF MDTMAS-REC.
           MOVE USRFL1 OF MDTTAB(INDX) TO USRFL1 OF MDTMAS-REC.
           MOVE USRFL2 OF MDTTAB(INDX) TO USRFL2 OF MDTMAS-REC.
           MOVE USRFL3 OF MDTTAB(INDX) TO USRFL3 OF MDTMAS-REC.
           MOVE RELTYP OF MDTTAB(INDX) TO RELTYP OF MDTMAS-REC.
           MOVE ACCTN2 OF MDTTAB(INDX) TO ACCTN2 OF MDTMAS-REC.
           MOVE SPLBIL OF MDTTAB(INDX) TO SPLBIL OF MDTMAS-REC.
           MOVE PKGOVR OF MDTTAB(INDX) TO PKGOVR OF MDTMAS-REC.
           MOVE MEMGIS OF MDTTAB(INDX) TO MEMGIS OF MDTMAS-REC.
           MOVE DALOVR OF MDTTAB(INDX) TO DALOVR OF MDTMAS-REC.
           MOVE CGAOVR OF MDTTAB(INDX) TO CGAOVR OF MDTMAS-REC.
           MOVE EXTMEM OF MDTTAB(INDX) TO EXTMEM OF MDTMAS-REC.
           MOVE EXTSUB OF MDTTAB(INDX) TO EXTSUB OF MDTMAS-REC.
           MOVE EXTGRP OF MDTTAB(INDX) TO EXTGRP OF MDTMAS-REC.
           MOVE EXTCON OF MDTTAB(INDX) TO EXTCON OF MDTMAS-REC.
           MOVE EXTEFF OF MDTTAB(INDX) TO EXTEFF OF MDTMAS-REC.
           MOVE EXTEXP OF MDTTAB(INDX) TO EXTEXP OF MDTMAS-REC.
           MOVE HISSEQ OF MDTTAB(INDX) TO HISSEQ OF MDTMAS-REC.
           MOVE CTLPLN OF MDTTAB(INDX) TO CTLPLN OF MDTMAS-REC.
           MOVE EXTREL OF MDTTAB(INDX) TO EXTREL OF MDTMAS-REC.
           MOVE PRVPLN OF MDTTAB(INDX) TO PRVPLN OF MDTMAS-REC.
           MOVE PRVNET OF MDTTAB(INDX) TO PRVNET OF MDTMAS-REC.
           MOVE PROCOD OF MDTTAB(INDX) TO PROCOD OF MDTMAS-REC.
           MOVE BILMOD OF MDTTAB(INDX) TO BILMOD OF MDTMAS-REC.
           IF BEGMTH OF MDTTAB(INDX) NOT NUMERIC
              MOVE ZERO                TO BEGMTH OF MDTTAB(INDX).
           MOVE BEGMTH OF MDTTAB(INDX) TO BEGMTH OF MDTMAS-REC.
           MOVE IMDBIL OF MDTTAB(INDX) TO IMDBIL OF MDTMAS-REC.
           MOVE INTBIL OF MDTTAB(INDX) TO INTBIL OF MDTMAS-REC.
           MOVE BILCYC OF MDTTAB(INDX) TO BILCYC OF MDTMAS-REC.
           MOVE PRTCNT OF MDTTAB(INDX) TO PRTCNT OF MDTMAS-REC.
           MOVE CRDDAT OF MDTTAB(INDX) TO CRDDAT OF MDTMAS-REC.
           MOVE CGAOVR OF MDTTAB(INDX) TO CGAOVR OF MDTMAS-REC.
           MOVE CGTOVR OF MDTTAB(INDX) TO CGTOVR OF MDTMAS-REC.
           MOVE SALOVR OF MDTTAB(INDX) TO SALOVR OF MDTMAS-REC.
           MOVE CBXOVR OF MDTTAB(INDX) TO CBXOVR OF MDTMAS-REC.
           MOVE CBEOVR OF MDTTAB(INDX) TO CBEOVR OF MDTMAS-REC.
           MOVE APCOVR OF MDTTAB(INDX) TO APCOVR OF MDTMAS-REC.
           MOVE SSSOVR OF MDTTAB(INDX) TO SSSOVR OF MDTMAS-REC.
           MOVE VRCOVR OF MDTTAB(INDX) TO VRCOVR OF MDTMAS-REC.
           MOVE RMTOVR OF MDTTAB(INDX) TO RMTOVR OF MDTMAS-REC.
           MOVE PGMNAM OF MDTTAB(INDX) TO PGMNAM OF MDTMAS-REC.
           MOVE MEMDFT OF MDTTAB(INDX) TO MEMDFT OF MDTMAS-REC.
           MOVE ENBDFT OF MDTTAB(INDX) TO ENBDFT OF MDTMAS-REC.
           MOVE PCPDFT OF MDTTAB(INDX) TO PCPDFT OF MDTMAS-REC.
           MOVE SECDFT OF MDTTAB(INDX) TO SECDFT OF MDTMAS-REC.
           MOVE PRGIND OF MDTTAB(INDX) TO PRGIND OF MDTMAS-REC.
           MOVE TIRFLG OF MDTTAB(INDX) TO TIRFLG OF MDTMAS-REC.
           IF TIRFLG OF MDTMAS-REC = 'Y'
              MOVE TIRFLG OF MDTMAS-REC  TO TIRHLD OF WS-WORK.
           MOVE DEFPRV OF MDTTAB(INDX) TO DEFPRV OF MDTMAS-REC.
           MOVE SALAMT OF MDTTAB(INDX) TO SALAMT OF MDTMAS-REC.
           MOVE COBDAT OF MDTTAB(INDX) TO COBDAT OF MDTMAS-REC.
           MOVE PAYLOC OF MDTTAB(INDX) TO PAYLOC OF MDTMAS-REC.
           MOVE PAYNUM OF MDTTAB(INDX) TO PAYNUM OF MDTMAS-REC.
           MOVE LOCQLF OF MDTTAB(INDX) TO LOCQLF OF MDTMAS-REC.
           MOVE FAXNUM OF MDTTAB(INDX) TO FAXNUM OF MDTMAS-REC.
           MOVE OTHPHN OF MDTTAB(INDX) TO OTHPHN OF MDTMAS-REC.
           MOVE EMLIND OF MDTTAB(INDX) TO EMLIND OF MDTMAS-REC.
           MOVE ELMAIL OF MDTTAB(INDX) TO ELMAIL OF MDTMAS-REC.
           MOVE BTHSEQ OF MDTTAB(INDX) TO BTHSEQ OF MDTMAS-REC.
           MOVE STUSTA OF MDTTAB(INDX) TO STUSTA OF MDTMAS-REC.
           MOVE HNDIND OF MDTTAB(INDX) TO HNDIND OF MDTMAS-REC.
           MOVE EDUBEG OF MDTTAB(INDX) TO EDUBEG OF MDTMAS-REC.
           MOVE EDUEND OF MDTTAB(INDX) TO EDUEND OF MDTMAS-REC.
           MOVE CQLECD OF MDTTAB(INDX) TO CQLECD OF MDTMAS-REC.
           MOVE COBRAQ OF MDTTAB(INDX) TO COBRAQ OF MDTMAS-REC.
           MOVE COBRAB OF MDTTAB(INDX) TO COBRAB OF MDTMAS-REC.
           MOVE COBRAE OF MDTTAB(INDX) TO COBRAE OF MDTMAS-REC.
           MOVE EMSTCD OF MDTTAB(INDX) TO EMSTCD OF MDTMAS-REC.
           MOVE DETDAT OF MDTTAB(INDX) TO DETDAT OF MDTMAS-REC.
           MOVE EXTIND OF MDTTAB(INDX) TO EXTIND OF MDTMAS-REC.
           MOVE RSPIND OF MDTTAB(INDX) TO RSPIND OF MDTMAS-REC.
           MOVE BENIND OF MDTTAB(INDX) TO BENIND OF MDTMAS-REC.
           MOVE ALTIND OF MDTTAB(INDX) TO ALTIND OF MDTMAS-REC.
           MOVE ENRSTA OF MDTTAB(INDX) TO ENRSTA OF MDTMAS-REC.
           MOVE EXCHNG OF MDTTAB(INDX) TO EXCHNG OF MDTMAS-REC.
           MOVE EXCIND OF MDTTAB(INDX) TO EXCIND OF MDTMAS-REC.
           MOVE EXCSUB OF MDTTAB(INDX) TO EXCSUB OF MDTMAS-REC.
           MOVE EXCMEM OF MDTTAB(INDX) TO EXCMEM OF MDTMAS-REC.
           MOVE CANEFF OF MDTTAB(INDX) TO CANEFF OF MDTMAS-REC.
           MOVE REACAT OF MDTTAB(INDX) TO REACAT OF MDTMAS-REC.

           IF PRTCOD OF MDTMAS-REC = SPACE
              MOVE 'D'                 TO PRTCOD OF MDTMAS-REC.
      *
           IF OTHINS OF MDTMAS-REC NOT = SPACES
              PERFORM A670-OTHINS-CHK            THRU A679-EXIT.
      *
           MOVE PRCDAT OF EEWHDR-WRK     TO TARDAT
           PERFORM A930-CONVERT-DATE     THRU A939-EXIT.
           MOVE CNVDAT                   TO PRCDAT OF MDTMAS-REC.
           MOVE PRCTIM OF EEWHDR-WRK     TO PRCTIM OF MDTMAS-REC.
           IF NOT PRCSEQ-UPDATED
              MOVE 'Y'                   TO PRCSEQ-FLAG
              ADD 1                      TO PRCSEQ OF WS-WORK.
           MOVE PRCSEQ OF WS-WORK        TO PRCSEQ OF MDTMAS-REC.
      *
           IF SUB-CHG
              PERFORM E120-SUB-MEMEXDBT          THRU E129-EXIT
           ELSE IF DEP-CHG
              PERFORM E140-DEP-MEMEXDBT          THRU E149-EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Exit if error detected.                               ****
      ****--------------------------------------------------------****
           IF PRCERR OF PGM-WORK = 'Y'           GO TO A699-EXIT.
      *
           MOVE SPACES                           TO MEMEXT-TYP.
      *
      ****--------------------------------------------------------****
      ****  CR138823  KCT  Fix                                    ****
      ****  Fill error line.                                      ****
      ****--------------------------------------------------------****
           PERFORM MDTMAS-WRITE                  IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              MOVE 'MDTMAS'                      TO MI-PARM4
              MOVE MDTMAS-STATUS                 TO MI-PARM5
              MOVE SPACES                        TO ERR-LINE
              MOVE GRPNUM OF MDTMAS-REC          TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF MDTMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MDTMAS-REC          TO RELCOD OF ERR-LINE
              MOVE MEMBNO OF MDTMAS-REC          TO MEMBNO OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              MOVE MI-PRIMARY-ID                 TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE MDTMAX                        TO INDX
‚             IF IN-DEBUG
‚               MOVE '@@ A690'                   TO LINE-E
‚               PERFORM 099-PRTERR
‚             END-IF
              GO TO A699-EXIT.
      *
           MOVE 'Y'                    TO SW-SEQ-USED.
           MOVE 'Y'                    TO MDT-FLAG.
           MOVE 'Y'                    TO REC-FLAG.
      *
           IF DOCNUM OF WS-WORK NOT = SPACES
              PERFORM A1300-CRT-DODMAS           THRU A1309-EXIT
              IF PRCERR OF PGM-WORK = 'Y'        GO TO A699-EXIT.
      *
           IF DEP-RECORD
              MOVE PRCSEQ OF WS-WORK    TO PRCSEQ OF EETDEP(EDPACT)
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF EETDEP(EDPACT)
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF EETDEP(EDPACT)
              MOVE BATSEQ OF MDTMAS-REC TO BATSEQ OF EETDEP(EDPACT)
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF EETDEP(EDPACT)
              MOVE LINENO OF MDTMAS-REC TO LINENO OF EETDEP(EDPACT)
           ELSE
           IF SUB-RECORD
              MOVE PRCSEQ OF WS-WORK    TO PRCSEQ OF EETSUB(ESBACT)
              MOVE BRANCD OF MDTMAS-REC TO BRANCD OF EETSUB(ESBACT)
              MOVE BATDAT OF MDTMAS-REC TO BATDAT OF EETSUB(ESBACT)
              MOVE BATSEQ OF MDTMAS-REC TO BATSEQ OF EETSUB(ESBACT)
              MOVE SEQNUM OF MDTMAS-REC TO SEQNUM OF EETSUB(ESBACT)
              MOVE LINENO OF MDTMAS-REC TO LINENO OF EETSUB(ESBACT).
      *
           IF NOT FIRST-LINE
           AND CHGTYP OF MDTTAB(INDX) = 'A'
              GO TO A699-EXIT.
      *
           IF GENRPT OF EDIENR-REC NOT = 'Y'
              GO TO A699-EXIT.
      *
           IF FIRST-LINE
              MOVE 'N'                           TO FIRST-LINE-FLAG.
      *
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF DET-LINE.
           MOVE LINENO OF MDTTAB(INDX) TO LINENO OF DET-LINE.
           MOVE GRPNUM OF MDTTAB(INDX) TO GRPNUM OF DET-LINE.
           MOVE SUBSNO OF MDTTAB(INDX) TO SUBSNO OF DET-LINE.
           IF RELCOD OF MDTTAB(INDX) = SPACES
              IF SUB-RECORD
                 MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF DET-LINE
                 MOVE RELTYP OF EEWSUB(ESBACT) TO RELTYP OF DET-LINE
              END-IF
              IF DEP-RECORD
                 MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF DET-LINE
                 MOVE RELTYP OF EEWDEP(EDPACT) TO RELTYP OF DET-LINE
              END-IF
           ELSE
              MOVE RELCOD OF MDTTAB(INDX) TO RELCOD OF DET-LINE
              MOVE RELTYP OF MDTTAB(INDX) TO RELTYP OF DET-LINE.
           MOVE MEMBNO OF MDTTAB(INDX) TO MEMBNO OF DET-LINE.
           IF BTHDAT OF MDTTAB(INDX) = ZEROES
              IF SUB-RECORD
                 MOVE BTHDAT OF EEWSUB(ESBACT)   TO DATYMDN
                 MOVE CORR DATYMD                TO DATMDY
                 MOVE DATMDY           TO BTHDAT OF DET-LINE
              END-IF
              IF DEP-RECORD
                 MOVE BTHDAT OF EEWDEP(EDPACT)   TO DATYMDN
                 MOVE CORR DATYMD                TO DATMDY
                 MOVE DATMDY           TO BTHDAT OF DET-LINE
              END-IF
           ELSE
              MOVE BTHDAT OF MDTTAB(INDX)        TO DATYMDN
              MOVE CORR DATYMD                   TO DATMDY
              MOVE DATMDY              TO BTHDAT OF DET-LINE.
           IF SEXCOD OF MDTTAB(INDX) = SPACES
              IF SUB-RECORD
                 MOVE SEXCOD OF EEWSUB(ESBACT) TO SEXCOD OF DET-LINE
              END-IF
              IF DEP-RECORD
                 MOVE SEXCOD OF EEWDEP(EDPACT) TO SEXCOD OF DET-LINE
              END-IF
           ELSE
              MOVE SEXCOD OF MDTTAB(INDX) TO SEXCOD OF DET-LINE.
           MOVE LSTNAM OF MDTTAB(INDX) TO LSTNAM OF NAME-AREA.
           MOVE FSTNAM OF MDTTAB(INDX) TO FSTNAM OF NAME-AREA.
           MOVE MIDNAM OF MDTTAB(INDX) TO MIDNAM OF NAME-AREA.
           MOVE TITLCD OF MDTTAB(INDX) TO TITLCD OF NAME-AREA.
           MOVE FORNAM OF MDTTAB(INDX) TO FORNAM OF NAME-AREA.
           PERFORM 099-NAMFMT.
           MOVE NAMKEY OF NAME-AREA    TO NAMKEY OF DET-LINE.
           IF CHGTYP OF MDTTAB(INDX) = 'A'
              MOVE 'ADD'               TO CHGTYP OF DET-LINE
           ELSE
              MOVE 'CHANGE'            TO CHGTYP OF DET-LINE.
      *
           MOVE DET-LINE TO LINE-P     PERFORM 099-PRT.
      *
       A699-EXIT.
           EXIT.
      *
       B650-GPHMAS.
      ***************************************************************
      *‚  Find effective contract for Member                        *
      ***************************************************************
           PERFORM GPHMAS-STARTGE                IF INVALID-KEY
              MOVE 'GPHMAS'                      TO MI-PARM4
              MOVE GRPNUM OF GPHMAS-KEY          TO GRPNUM OF ERR-LINE
              MOVE CONSET OF GPHMAS-KEY          TO FIELDV OF ERR-LINE
              MOVE 'EI02414'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE 'N'                           TO SW-OK
                                                 GO TO B659-EXIT.
       B651-NEXT.
           PERFORM GPHMAS-READNX                 IF AT-END
                                                 GO TO B659-EXIT.
           IF EFFDAT OF GPHMAS-REC >= ENBEFF OF WS-WORK
           AND EXPDAT OF GPHMAS-REC <= ENBEXP OF WS-WORK
              IF PRDDSG OF GPHMAS-REC = 'Y'
                 PERFORM B690-PCCOMINT           THRU B699-EXIT
                 IF SW-OK = 'N'                  GO TO B659-EXIT
                 END-IF
                 IF ENBBEN OF WS-WORK =
                                    OUTPUT-DATA1 OF PCCOMINT-OUTPUT(1:4)
                 MOVE 'Y'                        TO BENEQU
                                                 GO TO B659-EXIT
                 END-IF
              ELSE
                                                 GO TO B651-NEXT
              END-IF
           END-IF.
       B659-EXIT.
           EXIT.
      *
       B690-PCCOMINT.
      ***************************************************************
      *‚  Call to PCCOMINT Interface.                               *
      ***************************************************************
           INITIALIZE PCCOMINT-INPUT, PCCOMINT-OUTPUT,
                      PCGETCHC-INPUT, PCGETCHC-OUTPUT.
           MOVE 'GO'                   TO MTHTYP OF PCCOMINT-INPUT.
           MOVE ENBTRN OF WS-WORK      TO TRNSEQ OF PCGETCHC-INPUT.
           MOVE PCGETCHC-INPUT         TO INPUT-DATA OF PCCOMINT-INPUT.
      *
       B691-NEXT.
           CALL 'PCCOMINT' USING PCCOMINT-INPUT, PCCOMINT-OUTPUT.
      *
           IF PCERRMSG OF PCCOMINT-OUTPUT NOT = SPACES
              PERFORM VARYING INDX FROM 1 BY 1  UNTIL EINDX > 10
                 IF MESSAG-TABLE OF PCCOMINT-OUTPUT(EINDX) NOT = SPACES
                    MOVE MESSAG-TABLE OF PCCOMINT-OUTPUT(EINDX)
                                                 TO ERRMSG OF ERR-LINE
                    MOVE 12                      TO EINDX
                    MOVE 'N'                     TO SW-OK
                 END-IF
              END-PERFORM
              IF ERROVR OF PCCOMINT-OUTPUT = 'O'
                 MOVE 'PROBLEM OCCURRED IN POWERCHOICE'
                                                 TO ERRMSG OF ERR-LINE
                 MOVE 'N'                        TO SW-OK
              ELSE
                 MOVE PCERRMSG OF PCCOMINT-OUTPUT TO ERRMSG OF ERR-LINE
                 MOVE 'N'                        TO SW-OK
              END-IF
              MOVE ENBGRP OF WS-WORK    TO GRPNUM OF ERR-LINE
              MOVE ENBSUB OF WS-WORK    TO SUBSNO OF ERR-LINE
              MOVE ENBMEB OF WS-WORK    TO MEMBNO OF ERR-LINE
              MOVE CHGTYP OF WS-WORK    TO CHGTYP OF ERR-LINE
              MOVE ERR-LINE             TO LINE-E
              PERFORM 099-PRTERR                 GO TO B699-EXIT.
      *
           IF  STATCD OF PCCOMINT-OUTPUT NOT = 'Y'
           AND PCERRMSG OF PCCOMINT-OUTPUT = SPACES
               MOVE 'POWERCHOICE INTERFACE WAS NOT SUCCESSFUL'
                                                 TO ERRMSG OF ERR-LINE
               MOVE SPACES                       TO RESPID
               CALL 'SNDOPMSGCL' USING ERRMSG OF ERR-LINE, RESPID
               IF RESPID = 'N'
                  MOVE 'ED201C - ENDED BY USER DUE TO POWERCHOICE CONNEC
      -           'TIVITY PROBLEM'               TO ERR-LINE
                  MOVE 'Y'                       TO PRCERR OF PGM-WORK
                  MOVE 'N'                       TO SW-OK
                  MOVE ERR-LINE                  TO LINE-E
                  PERFORM 099-PRTERR             GO TO B699-EXIT
               END-IF
      *
               IF RESPID = 'R'                   GO TO B691-NEXT
               END-IF
      *
               IF RESPID = 'Y'
                  MOVE ENBGRP OF WS-WORK         TO GRPNUM OF ERR-LINE
                  MOVE ENBSUB OF WS-WORK         TO SUBSNO OF ERR-LINE
                  MOVE ENBMEB OF WS-WORK         TO MEMBNO OF ERR-LINE
                  MOVE CHGTYP OF WS-WORK         TO CHGTYP OF ERR-LINE
                  MOVE 'SKIPPED'                 TO ERRMSG OF ERR-LINE
                  MOVE ERR-LINE                  TO LINE-E
                  PERFORM 099-PRTERR             GO TO B699-EXIT.
      *
           IF  STATCD OF PCCOMINT-OUTPUT = 'Y'
           AND PCERRMSG OF PCCOMINT-OUTPUT = SPACES
               MOVE 'Y'                          TO SW-OK.
      *
       B699-EXIT.
           EXIT.
      /
       A700-MBHMAS.
      ***************************************************************
      *‚                                                            *
      ***************************************************************
           MOVE BRANCD OF EDIENR-REC   TO BRANCD OF MBHKEY.
           MOVE CURDAT-SAV OF WS-WORK  TO BATDAT OF MBHKEY.
           MOVE BATSEQ OF EDIENR-REC   TO BATSEQ OF MBHKEY.
      *
           PERFORM A710-BATSEQ                   THRU A719-EXIT.
           IF NOT OK                             GO TO A709-EXIT.
      *
           PERFORM A730-INTMBH                   THRU A739-EXIT.
      *
  ‚           IF IN-DEBUG
  ‚              DISPLAY '@@ MBHMAS WRITE (3)'
  ‚              DISPLAY '@@ MBHMAS-KEY - '
  ‚                      'BRANCD ('
   ‚                      BRANCD OF MBHMAS-REC
   ‚                     ') BATDAT ('
   ‚                      BATDAT OF MBHMAS-REC
   ‚                     ') BATSEQ ('
   ‚                      BATSEQ OF MBHMAS-REC
   ‚                     ') SEQNUM ('
   ‚                      SEQNUM OF MBHMAS-REC
   ‚                     ')'
   ‚          END-IF
           PERFORM MBHMAS-WRITE                  IF INVALID-KEY
     ‚           IF IN-DEBUG
     ‚              DISPLAY '@@ MBHMAS WRITE FAILURE '
     ‚              DISPLAY '@@ MBHMAS-STATUS ('
‚                            MBHMAS-STATUS
‚                END-IF
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                           TO PRCERR OF PGM-WORK
              GO TO A709-EXIT.
      *
           MOVE 'N'                              TO MBH-FLAG.
       A709-EXIT.
           EXIT.
      *
       A710-BATSEQ.
      ***************************************************************
      *‚   GET NEXT BATSEQ FOR DOCUMENT                             *
      ***************************************************************
           MOVE ZERO                   TO SEQNUM OF WS-WORK.
      *
           IF BATSEQ OF MBHKEY NOT = ZEROES
              SUBTRACT 1 FROM BATSEQ OF MBHKEY.
      *
       A711-NEXT.
      *‚THIS BATCH IS FULL, SO CREATE A NEW BATCH WITH THE NEXT DAY'S
      *‚DATE.  NOTE THAT THERE CAN BE UP TO 99 * 999 = 98,901 DIFFERENT
      *‚RECORDS IN EACH BATCH.  HOWEVER, THIS MAY NOT BE ENOUGH FOR
      *‚LARGE GROUPS.
           IF BATSEQ OF MBHKEY = 999
              MOVE BATSEQ OF EDIENR-REC TO BATSEQ OF MBHKEY
              INITIALIZE DAYS-AREA
              MOVE BATDAT OF MBHKEY              TO DATFR
              MOVE 1 TO DAYS OF DAYS-AREA        PERFORM 099-SCDAYS
              MOVE DATTO               TO BATDAT OF MBHKEY.
      *
           ADD  1                      TO BATSEQ OF MBHKEY.
           IF BATSEQ OF MBHKEY = ZEROES
              ADD 1                    TO BATSEQ OF MBHKEY.
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MBHMAS-KEY
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MBHMAS-KEY
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MBHMAS-KEY
      *
           PERFORM MBHMAS-START                  IF INVALID-KEY
                                                 GO TO A719-EXIT.
      *
           GO TO A711-NEXT.
       A719-EXIT.
           EXIT.
      *
       A720-OLDBAT.
      ****************************************************************
      *‚   PRINT BATCH TOTAL AND REINITIALIZE COUNTER                *
      ****************************************************************
           IF NUMMDT OF WS-WORK = 0
              GO TO A729-EXIT.
      *
           IF GENRPT OF EDIENR-REC NOT = 'Y'       GO TO A721-NEXT.
      *
           MOVE SPACES                           TO BATCH-LINE.
           MOVE 'BATCH TOTALS:'        TO TOTTYP OF BATCH-LINE.
           MOVE 'ADDS:'                TO TYPADD OF BATCH-LINE.
           MOVE 'CHANGES:'             TO TYPCHG OF BATCH-LINE.
           MOVE 'MEMBERS: '            TO TYPMEM OF BATCH-LINE.
           COMPUTE BATMEM OF WS-WORK = BATADD OF WS-WORK
                                     + BATCHG OF WS-WORK.
           MOVE BATADD OF WS-WORK      TO TOTADD OF BATCH-LINE.
           ADD BATADD OF WS-WORK       TO TOTADD OF WS-WORK.
           MOVE ZEROES                 TO BATADD OF WS-WORK.
           MOVE BATCHG OF WS-WORK      TO TOTCHG OF BATCH-LINE.
           ADD BATCHG OF WS-WORK       TO TOTCHG OF WS-WORK.
           MOVE ZEROES                 TO BATCHG OF WS-WORK.
           MOVE BATMEM OF WS-WORK      TO TOTMEM OF BATCH-LINE.
           MOVE 0                      TO BATMEM OF WS-WORK.
           MOVE 02                     TO PRINT-CODE.
           MOVE BATCH-LINE TO LINE-P               PERFORM 099-PRT.
           IF NOT RPT-END
              MOVE 40 TO PRINT-CODE.
      *
       A721-NEXT.
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MBHMAS-KEY
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MBHMAS-KEY
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MBHMAS-KEY
           PERFORM MBHMAS-READ                   IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06063'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
                                                 GO TO A729-EXIT.
      *
           MOVE TOTBAT OF WS-WORK      TO ACTDOC OF MBHMAS-REC
                                          CTLDOC OF MBHMAS-REC.
           MOVE '1'                    TO STATCD OF MBHMAS-REC.
      *
           PERFORM MBHMAS-REWRITE                IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'MBHMAS'                      TO MI-PARM4
              MOVE MBHMAS-STATUS                 TO MI-PARM5
              MOVE 'EI06064'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
                                                 GO TO A729-EXIT.
       A723-NEXT.
           MOVE ZERO                   TO TOTBAT OF WS-WORK.
       A729-EXIT.
           EXIT.
      *
       A730-INTMBH.
      ***************************************************************
      *‚   INITIALIZE MBHMAS-REC TO INITIAL VALUES                  *
      ***************************************************************
           INITIALIZE MBHMAS-REC.
      *
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MBHMAS-KEY
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MBHMAS-KEY
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MBHMAS-KEY
           MOVE 'I'                    TO STATCD OF MBHMAS-REC.
           MOVE 'Y'                    TO PRFEDT OF MBHMAS-REC.
           MOVE 'E'                    TO SRCIND OF MBHMAS-REC.
           MOVE PRCSTA OF EDIENR-REC   TO PRCSTA OF MBHMAS-REC
           MOVE ALWERR OF EDIENR-REC   TO ALWERR OF MBHMAS-REC
           MOVE ZERO                   TO CTLDOC OF MBHMAS-REC
           MOVE ZERO                   TO SEQNUM OF MBHMAS-REC
                                          PRTCNT OF MBHMAS-REC
                                          ACTDOC OF MBHMAS-REC
                                          ACTERR OF MBHMAS-REC.
      *
           MOVE DESCRP OF EDIENR-REC   TO DESCRP OF MBHMAS-REC.
           MOVE RESPCD OF EDIENR-REC   TO RESPCD OF MBHMAS-REC.
           MOVE 'ED201C  '             TO USERID OF MBHMAS-REC.
           MOVE CURDAT-SAV OF WS-WORK  TO SYSDAT OF MBHMAS-REC
                                          LSTCHG OF MBHMAS-REC.
           MOVE 'EDI'                  TO TERMID OF MBHMAS-REC.
      *
           IF WS-FULLUP = 'A'
              MOVE 'Y'                 TO AUDFLG OF MBHMAS-REC.
      *
           MOVE BRANCD OF MBHKEY       TO BRANCD OF HEAD3.
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF HEAD3.
           MOVE BATDAT OF MBHKEY                 TO DATYMDN.
           MOVE CORR DATYMD                      TO DATMDY.
           MOVE DATMDY                 TO BATDAT OF HEAD3.
      *
           MOVE ZEROES                 TO NUMMDT OF WS-WORK.
           ADD 1                       TO MBHCNT OF WS-WORK.
      *
           MOVE HEAD3  OF PRINT-DATA   TO PRNTH3 OF PRNTDATA.
       A739-EXIT.
           EXIT.
      *
       A740-INTMDT.
           INITIALIZE MDTMAS-REC.
      *
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MDTMAS-KEY.
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MDTMAS-KEY.
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MDTMAS-KEY.
           MOVE CURDAT-SAV OF WS-WORK  TO SYSDAT OF MDTMAS-REC
                                          LSTCHG OF MDTMAS-REC.
           MOVE 'EDI'                  TO TERMID OF MDTMAS-REC
           MOVE 'ED201C'               TO USERID OF MDTMAS-REC.
           MOVE '1'                    TO STATCD OF MDTMAS-REC.
           MOVE ZERO                   TO PRICOD OF MDTMAS-REC.
           MOVE WS-ENRSTA              TO ENRSTA OF MDTMAS-REC.
       A749-EXIT.
           EXIT.
      *
       A750-HLDCOD-CHK.
      ***************************************************************
      *‚CHECK FOR HOLD CODE ALREADY ATTACHED TO MEMBER            *
      ***************************************************************
           MOVE 'N'                              TO HLDCOD-FLAG.
           MOVE SPACES                           TO EXHMAS-REC.
           MOVE ZEROES                 TO SEQNUM OF EXHMAS-KEY
                                          TRNSEQ OF EXHMAS-KEY.
      *
           MOVE 'M'                    TO RECTYP OF EXHMAS-KEY.
           MOVE HLDCOD-MEM             TO RECVAL OF EXHMAS-KEY.
           PERFORM EXHMAS-STARTGE                IF INVALID-KEY
                                                 GO TO A759-EXIT.
       A752-NEXT.
           PERFORM EXHMAS-READNX                 IF AT-END
                                                 GO TO A759-EXIT.
      *
           IF RECTYP OF EXHMAS-KEY NOT = 'M'
           OR RECVAL OF EXHMAS-KEY NOT = HLDCOD-MEM
              GO TO A759-EXIT.
      *
           IF HOLDCD OF EXHMAS-REC = HLDCOD-HLD
              MOVE 'Y'                           TO HLDCOD-FLAG
              GO TO A759-EXIT.
      *
           GO TO A752-NEXT.
       A759-EXIT.
           EXIT.
      *
       A760-SUBPCP.
      ***************************************************************
      *‚GET CURRENT SUB PCP                                        *
      ***************************************************************
           MOVE ZEROES TO                        PPSACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF TMPACT = ZERO                      GO TO A769-EXIT.
      *
       A762-NEXT.
           IF PPSACT NOT < PPSMAX
           OR PPSACT NOT < PPSLST(TMPACT)
              GO TO A769-EXIT.
      *
           ADD 1                                 TO PPSACT.
      *
           IF PROVNO OF SUBPCP(TMPACT, PPSACT) = SPACES
                                                 GO TO A769-EXIT.
      *
           IF (PCPEFF OF SUBPCP(TMPACT, PPSACT) >
                                       ENPEFF OF WS-WORK
           AND PCPEXP OF SUBPCP(TMPACT, PPSACT) > ENPEXP OF WS-WORK)
           OR (PCPEFF OF SUBPCP(TMPACT, PPSACT) = ENPEFF OF WS-WORK
           AND PCPEXP OF SUBPCP(TMPACT, PPSACT) > ENPEXP OF WS-WORK)
           OR (PCPEFF OF SUBPCP(TMPACT, PPSACT) = ENPEFF OF WS-WORK
           AND PCPEXP OF SUBPCP(TMPACT, PPSACT) = ENPEXP OF WS-WORK)
              IF (PCPEFF OF SUBPCP(TMPACT, PPSACT) NOT =
                                     PCPEXP OF SUBPCP(TMPACT, PPSACT))
              MOVE PCPEFF OF SUBPCP(TMPACT, PPSACT)
                                       TO ENPEFF OF WS-WORK
              MOVE PCPEXP OF SUBPCP(TMPACT, PPSACT)
                                       TO ENPEXP OF WS-WORK
              MOVE PPSACT                        TO PPSTMP.
      *
           GO TO A762-NEXT.
       A769-EXIT.
           EXIT.
      *
       A770-SUBSEC.
      ***************************************************************
      *‚GET CURRENT SUBSCRIBER SEC                                  *
      ***************************************************************
           MOVE ZEROES TO                        SPSACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF TMPACT = ZERO                      GO TO A779-EXIT.
       A772-NEXT.
           IF SPSACT NOT < SPSMAX
           OR SPSACT NOT < SPSLST(TMPACT)
              GO TO A779-EXIT.
      *
           ADD 1                                 TO SPSACT.
      *
           IF PROVNO OF SUBSEC(TMPACT, SPSACT) = SPACES
                                                 GO TO A779-EXIT.
      *
           IF (SECEFF OF SUBSEC(TMPACT, SPSACT) >
                                       ENPEFF OF WS-WORK
           AND SECEXP OF SUBSEC(TMPACT, SPSACT) > ENPEXP OF WS-WORK)
           OR (SECEFF OF SUBSEC(TMPACT, SPSACT) = ENPEFF OF WS-WORK
           AND SECEXP OF SUBSEC(TMPACT, SPSACT) > ENPEXP OF WS-WORK)
           OR (SECEFF OF SUBSEC(TMPACT, SPSACT) = ENPEFF OF WS-WORK
           AND SECEXP OF SUBSEC(TMPACT, SPSACT) = ENPEXP OF WS-WORK)
              IF (SECEFF OF SUBSEC(TMPACT, SPSACT) NOT =
                                  SECEXP OF SUBSEC(TMPACT, SPSACT))
              MOVE SECEFF OF SUBSEC(TMPACT, SPSACT)
                                       TO ENPEFF OF WS-WORK
              MOVE SECEXP OF SUBSEC(TMPACT, SPSACT)
                                       TO ENPEXP OF WS-WORK
              MOVE SPSACT                        TO SPSTMP.
      *
           GO TO A772-NEXT.
       A779-EXIT.
           EXIT.
      *
       A780-SUBMED.
      ****************************************************************
      *‚GET CURRENT MEDICARE INFO                                    *
      ****************************************************************
           MOVE ZEROES TO                        SMDACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF TMPACT = ZERO                      GO TO A789-EXIT.
       A782-NEXT.
           IF SMDACT NOT < SMDMAX
           OR SMDACT NOT < SMDLST(TMPACT)
              GO TO A789-EXIT.
      *
           ADD 1                                 TO SMDACT.
      *
           IF MEDCTY OF SUBMED(TMPACT, SMDACT) = SPACES
                                                 GO TO A789-EXIT.
      *
           IF (MEDEFF OF SUBMED(TMPACT, SMDACT) >
                                       ENPEFF OF WS-WORK
           AND MEDEXP OF SUBMED(TMPACT, SMDACT) > ENPEXP OF WS-WORK)
           OR (MEDEFF OF SUBMED(TMPACT, SMDACT) = ENPEFF OF WS-WORK
           AND MEDEXP OF SUBMED(TMPACT, SMDACT) > ENPEXP OF WS-WORK)
           OR (MEDEFF OF SUBMED(TMPACT, SMDACT) = ENPEFF OF WS-WORK
           AND MEDEXP OF SUBMED(TMPACT, SMDACT) = ENPEXP OF WS-WORK)
              IF (MEDEFF OF SUBMED(TMPACT, SMDACT) NOT =
                                    MEDEXP OF SUBMED(TMPACT, SMDACT))
              MOVE MEDEFF OF SUBMED(TMPACT, SMDACT)
                                       TO ENPEFF OF WS-WORK
              MOVE MEDEXP OF SUBMED(TMPACT, SMDACT)
                                       TO ENPEXP OF WS-WORK
              MOVE SMDACT                        TO SMDTMP.
      *
           GO TO A782-NEXT.
       A789-EXIT.
           EXIT.
      *
       A790-SUBFEE.
      ***************************************************************
      *‚GET CURRENT FEE SCHEDULE                                  *
      ***************************************************************
           MOVE ZEROES TO                        SFEACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF TMPACT = ZERO                      GO TO A799-EXIT.
      *
       A792-NEXT.
      *
           IF SFEACT NOT < SFEMAX
           OR SFEACT NOT < SFELST(TMPACT)
              GO TO A799-EXIT.
      *
           ADD 1                                 TO SFEACT.
      *
           IF FEECOD OF SUBFEE(TMPACT, SFEACT) = SPACES
                                                 GO TO A799-EXIT.
      *
           IF (FEEEFF OF SUBFEE(TMPACT, SFEACT) >
                                       ENPEFF OF WS-WORK
           AND FEEEXP OF SUBFEE(TMPACT, SFEACT) > ENPEXP OF WS-WORK)
           OR (FEEEFF OF SUBFEE(TMPACT, SFEACT) = ENPEFF OF WS-WORK
           AND FEEEXP OF SUBFEE(TMPACT, SFEACT) > ENPEXP OF WS-WORK)
           OR (FEEEFF OF SUBFEE(TMPACT, SFEACT) = ENPEFF OF WS-WORK
           AND FEEEXP OF SUBFEE(TMPACT, SFEACT) = ENPEXP OF WS-WORK)
           AND (FEEEFF OF SUBFEE(TMPACT, SFEACT) NOT =
                                     FEEEXP OF SUBFEE(TMPACT, SFEACT))
              MOVE FEEEFF OF SUBFEE(TMPACT, SFEACT)
                                       TO ENPEFF OF WS-WORK
              MOVE FEEEXP OF SUBFEE(TMPACT, SFEACT)
                                       TO ENPEXP OF WS-WORK
              MOVE SFEACT                        TO SFETMP.
      *
           GO TO A792-NEXT.
       A799-EXIT.
           EXIT.
      *
       A800-SUBENB.
      ***************************************************************
      *‚GET CURRENT ENROLLMENT                                      *
      ***************************************************************
           MOVE ZEROES                           TO ENSACT.
           MOVE ZEROES                 TO ENBEFF OF WS-WORK
                                          ENBEXP OF WS-WORK.
      *
           IF TMPACT = ZERO                      GO TO A809-EXIT.
       A801-NEXT.
           IF ENSACT NOT < ENSMAX
           OR ENSACT NOT < ENSLST(TMPACT)
              GO TO A809-EXIT.
      *
           ADD 1                                 TO ENSACT.
      *
           IF ENBGRP OF SUBENB(TMPACT, ENSACT) = SPACES
                                                 GO TO A809-EXIT.
      *

           IF (ENBEFF OF SUBENB(TMPACT, ENSACT) >
                                       ENBEFF OF WS-WORK
           AND ENBEXP OF SUBENB(TMPACT, ENSACT) > ENBEXP OF WS-WORK)
           OR (ENBEFF OF SUBENB(TMPACT, ENSACT) = ENBEFF OF WS-WORK
           AND ENBEXP OF SUBENB(TMPACT, ENSACT) > ENBEXP OF WS-WORK)
           OR (ENBEFF OF SUBENB(TMPACT, ENSACT) = ENBEFF OF WS-WORK
           AND ENBEXP OF SUBENB(TMPACT, ENSACT) = ENBEXP OF WS-WORK)
              IF (ENBEFF OF SUBENB(TMPACT, ENSACT) NOT =
                                     ENBEXP OF SUBENB(TMPACT, ENSACT))
              MOVE ENBEFF OF SUBENB(TMPACT, ENSACT)
                                       TO ENBEFF OF WS-WORK
              MOVE ENBEXP OF SUBENB(TMPACT, ENSACT)
                                       TO ENBEXP OF WS-WORK
              MOVE ENBGRP OF SUBENB(TMPACT, ENSACT)
                                       TO ENBGRP OF WS-WORK
              MOVE ENBMEB OF SUBENB(TMPACT, ENSACT)
                                       TO ENBSUB OF WS-WORK
                                          ENBMEB OF WS-WORK
              MOVE BENPKG OF SUBENB(TMPACT, ENSACT)
                                       TO ENBBEN OF WS-WORK
              MOVE ENBTRN OF SUBENB(TMPACT, ENSACT)
                                       TO ENBTRN OF WS-WORK
              MOVE ENSACT                        TO ENSTMP.
      *
           GO TO A801-NEXT.
       A809-EXIT.
           EXIT.
      *
       A810-DEPPCP.
      ****************************************************************
      *‚GET CURRENT PCP                                              *
      ****************************************************************
           MOVE ZEROES TO                        PCPACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF MEMTMP = ZERO                      GO TO A819-EXIT.
       A812-NEXT.
      *
           ADD 1                                 TO PCPACT.
      *
           IF PROVNO OF PCPTAB(MEMTMP, PCPACT) = SPACES
                                                 GO TO A819-EXIT.
      *
      ****------------------------------------------------------------
      ****    CR140394    CBW    FIX
      ****------------------------------------------------------------
           IF (PCPEFF OF PCPTAB(MEMTMP, PCPACT) >
                                       ENPEFF OF WS-WORK
           AND PCPEXP OF PCPTAB(MEMTMP, PCPACT) > ENPEXP OF WS-WORK)
           OR (PCPEFF OF PCPTAB(MEMTMP, PCPACT) = ENPEFF OF WS-WORK
           AND PCPEXP OF PCPTAB(MEMTMP, PCPACT) > ENPEXP OF WS-WORK)
           OR (PCPEFF OF PCPTAB(MEMTMP, PCPACT) = ENPEFF OF WS-WORK
           AND PCPEXP OF PCPTAB(MEMTMP, PCPACT) = ENPEXP OF WS-WORK)
      ****    IF (PCPEFF OF PCPTAB(MEMTMP, PCPACT) NOT =
      ****                           PCPEXP OF PCPTAB(MEMTMP, PCPACT))
      ****    MOVE PCPEFF OF PCPTAB(MEMTMP, PCPACT)
      ****                             TO ENPEFF OF WS-WORK
      ****    MOVE PCPEXP OF PCPTAB(MEMTMP, PCPACT)
      ****                             TO ENPEXP OF WS-WORK
      ****    MOVE PCPACT                        TO PCPTMP.
              IF (PCPEFF OF PCPTAB(MEMTMP, PCPACT) NOT =
                                     PCPEXP OF PCPTAB(MEMTMP, PCPACT))
              OR
              (PCPEFF OF PCPTAB(MEMTMP, PCPACT) =
                                     PCPEXP OF PCPTAB(MEMTMP, PCPACT)
              AND PCPACT = 1)
                 MOVE PCPEFF OF PCPTAB(MEMTMP, PCPACT)
                                       TO ENPEFF OF WS-WORK
                 MOVE PCPEXP OF PCPTAB(MEMTMP, PCPACT)
                                       TO ENPEXP OF WS-WORK
                 MOVE PCPACT                     TO PCPTMP.
      *
           GO TO A812-NEXT.
       A819-EXIT.
           EXIT.
      *
       A820-DEPSEC.
      ****************************************************************
      *‚GET CURRENT SECONDARY PCP                                   *
      ****************************************************************
           MOVE ZEROES TO                        SECACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF MEMTMP = ZERO                      GO TO A829-EXIT.
       A822-NEXT.
      *
           ADD 1                                 TO SECACT.
      *
           IF PROVNO OF SECTAB(MEMTMP, SECACT) = SPACES
                                                 GO TO A829-EXIT.
      *
           IF (SECEFF OF SECTAB(MEMTMP, SECACT) >
                                       ENPEFF OF WS-WORK
           AND SECEXP OF SECTAB(MEMTMP, SECACT) > ENPEXP OF WS-WORK)
           OR (SECEFF OF SECTAB(MEMTMP, SECACT) = ENPEFF OF WS-WORK
           AND SECEXP OF SECTAB(MEMTMP, SECACT) > ENPEXP OF WS-WORK)
           OR (SECEFF OF SECTAB(MEMTMP, SECACT) = ENPEFF OF WS-WORK
           AND SECEXP OF SECTAB(MEMTMP, SECACT) = ENPEXP OF WS-WORK)
              IF (SECEFF OF SECTAB(MEMTMP, SECACT) NOT =
                                  SECEXP OF SECTAB(MEMTMP, SECACT))
              MOVE SECEFF OF SECTAB(MEMTMP, SECACT)
                                       TO ENPEFF OF WS-WORK
              MOVE SECEXP OF SECTAB(MEMTMP, SECACT)
                                       TO ENPEXP OF WS-WORK
              MOVE SECACT                        TO SECTMP.
      *
           GO TO A822-NEXT.
       A829-EXIT.
           EXIT.
      *
       A830-DEPMED.
      ***************************************************************
      *‚GET CURRENT MEDICARE                                        *
      ***************************************************************
           MOVE ZEROES TO                        MEDACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF MEMTMP = ZERO                      GO TO A839-EXIT.
       A832-NEXT.
           IF MEDACT NOT < MEDMAX
              GO TO A839-EXIT.
      *
           ADD 1                                 TO MEDACT.
      *
           IF MEDCTY OF MEDTAB(MEMTMP, MEDACT) = SPACES
                                                 GO TO A839-EXIT.
      *
           IF (MEDEFF OF MEDTAB(MEMTMP, MEDACT) >
                                       ENPEFF OF WS-WORK
           AND MEDEXP OF MEDTAB(MEMTMP, MEDACT) > ENPEXP OF WS-WORK)
           OR (MEDEFF OF MEDTAB(MEMTMP, MEDACT) = ENPEFF OF WS-WORK
           AND MEDEXP OF MEDTAB(MEMTMP, MEDACT) > ENPEXP OF WS-WORK)
           OR (MEDEFF OF MEDTAB(MEMTMP, MEDACT) = ENPEFF OF WS-WORK
           AND MEDEXP OF MEDTAB(MEMTMP, MEDACT) = ENPEXP OF WS-WORK)
              IF (MEDEFF OF MEDTAB(MEMTMP, MEDACT) NOT =
                                    MEDEXP OF MEDTAB(MEMTMP, MEDACT))
              MOVE MEDEFF OF MEDTAB(MEMTMP, MEDACT)
                                       TO ENPEFF OF WS-WORK
              MOVE MEDEXP OF MEDTAB(MEMTMP, MEDACT)
                                       TO ENPEXP OF WS-WORK
              MOVE MEDACT                        TO MEDTMP.
      *
           GO TO A832-NEXT.
       A839-EXIT.
           EXIT.
      *
       A840-DEPFEE.
      ***************************************************************
      *‚ GET CURRENT FEE SCHEDULE                                  *
      ***************************************************************
           MOVE ZEROES TO                        FEEACT.
           MOVE 'N'                              TO WS-FLG-FEETAB.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           IF MEMTMP = ZERO                      GO TO A849-EXIT.
      *
       A842-NEXT.
      *
           ADD 1                                 TO FEEACT.
      *
           IF FEECOD OF FEETAB(MEMTMP, FEEACT) = SPACES
                                                 GO TO A849-EXIT.
      *
           IF (FEEEFF OF FEETAB(MEMTMP, FEEACT) >
                                       ENPEFF OF WS-WORK
           AND FEEEXP OF FEETAB(MEMTMP, FEEACT) > ENPEXP OF WS-WORK)
           OR (FEEEFF OF FEETAB(MEMTMP, FEEACT) = ENPEFF OF WS-WORK
           AND FEEEXP OF FEETAB(MEMTMP, FEEACT) > ENPEXP OF WS-WORK)
           OR (FEEEFF OF FEETAB(MEMTMP, FEEACT) = ENPEFF OF WS-WORK
           AND FEEEXP OF FEETAB(MEMTMP, FEEACT) = ENPEXP OF WS-WORK)
           AND (FEEEFF OF FEETAB(MEMTMP, FEEACT) NOT =
                                     FEEEXP OF FEETAB(MEMTMP, FEEACT))
              MOVE FEEEFF OF FEETAB(MEMTMP, FEEACT)
                                       TO ENPEFF OF WS-WORK
              MOVE FEEEXP OF FEETAB(MEMTMP, FEEACT)
                                       TO ENPEXP OF WS-WORK
              MOVE FEEACT                        TO FEETMP.
      *
           GO TO A842-NEXT.
       A849-EXIT.
           EXIT.
      *
       A850-DEPENB.
      ***************************************************************
      *‚GET CURRENT ENROLLMENT INFO
      ***************************************************************
           MOVE ZEROES                           TO ENBACT.
           MOVE ZEROES                 TO ENBEFF OF WS-WORK
                                          ENBEXP OF WS-WORK.
      *
           IF MEMTMP = ZERO                      GO TO A859-EXIT.
      *
       A851-NEXT.
      *
           IF ENBACT NOT < ENBMAX
           OR ENBACT NOT < ENBLST(MEMTMP)
              GO TO A859-EXIT.
      *
           ADD 1                                 TO ENBACT.
           IF ENBGRP OF ENBTAB(MEMTMP, ENBACT) = SPACES
                                                 GO TO A859-EXIT.
      *
           IF (ENBEFF OF ENBTAB(MEMTMP, ENBACT) >
                                       ENBEFF OF WS-WORK
           AND ENBEXP OF ENBTAB(MEMTMP, ENBACT) > ENBEXP OF WS-WORK)
           OR (ENBEFF OF ENBTAB(MEMTMP, ENBACT) = ENBEFF OF WS-WORK
           AND ENBEXP OF ENBTAB(MEMTMP, ENBACT) > ENBEXP OF WS-WORK)
           OR (ENBEFF OF ENBTAB(MEMTMP, ENBACT) = ENBEFF OF WS-WORK
           AND ENBEXP OF ENBTAB(MEMTMP, ENBACT) = ENBEXP OF WS-WORK)
              IF (ENBEFF OF ENBTAB(MEMTMP, ENBACT) NOT =
                                     ENBEXP OF ENBTAB(MEMTMP, ENBACT))
              MOVE ENBEFF OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBEFF OF WS-WORK
              MOVE ENBEXP OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBEXP OF WS-WORK
              MOVE ENBGRP OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBGRP OF WS-WORK
              MOVE ENBSUB OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBSUB OF WS-WORK
              MOVE ENBMEB OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBMEB OF WS-WORK
              MOVE BENPKG OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBBEN OF WS-WORK
              MOVE ENBTRN OF ENBTAB(MEMTMP, ENBACT)
                                       TO ENBTRN OF WS-WORK
              MOVE ENBACT                        TO ENBTMP.
      *
           GO TO A851-NEXT.
       A859-EXIT.
           EXIT.
      *
       A860-SUBDEM.
      **********************************************************
      *‚GET SUBSCRIBER DEMMAS                                  *
      **********************************************************
           MOVE ZEROES                           TO SUBACT.
      *
       A861-NEXT.
           IF SUBACT NOT < SUBMAX
           OR SUBACT NOT < SUBLST
              GO TO A869-EXIT.
      *
           ADD 1                                 TO SUBACT.
      *
           IF MEMBNO OF SUBTAB(SUBACT) = SPACES  GO TO A869-EXIT.
      *
           IF MEMBNO OF SUBTAB(SUBACT) = MEMBNO OF EEWSUB(ESBACT)
           AND GRPNUM OF SUBTAB(SUBACT) = GRPNUM OF EEWSUB(ESBACT)
              MOVE SUBACT                        TO DEMTMP
           MOVE SPACES                           TO DEMMAS-REC.
           MOVE MEMSEQ OF SUBTAB(SUBACT)         TO MEMSEQ OF DEMMAS-KEY.
           PERFORM DEMMAS-READ                   IF INVALID-KEY
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE MEMBNO OF MEMMAS-REC          TO MI-PARM4
                                                    MEMBNO OF ERR-LINE
              MOVE GRPNUM OF MEMMAS-REC          TO MI-PARM5
                                                    GRPNUM OF ERR-LINE
              MOVE EFFDAT OF MEMMAS-REC          TO MI-PARM6
              MOVE SUBSNO OF MEMMAS-REC          TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF MEMMAS-REC          TO RELCOD OF ERR-LINE
              MOVE 'EI00301'           TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE DEMMAS-STATUS                 TO MI-PARM7
              MOVE 'EI00301'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              ELSE
                 CONTINUE
              END-IF
              GO TO A869-EXIT.
      *
           GO TO A861-NEXT.
       A869-EXIT.
           EXIT.
      *
       A870-DEPDEM.
      ***************************************************************
      *‚DEP DEMMAS
      ***************************************************************
           MOVE ZEROES                           TO DEPACT.
       A871-NEXT.
           IF DEPACT NOT < DEPLST
           OR DEPACT NOT < DEPMAX
              GO TO A879-EXIT.
      *
           ADD 1                                 TO DEPACT.
      *
           IF MEMBNO OF DEPTAB(DEPACT) = MEMBNO OF EEWDEP(EDPACT)
           AND GRPNUM OF DEPTAB(DEPACT) = GRPNUM OF EEWDEP(EDPACT)
              MOVE DEPACT                        TO DEPTMP
              GO TO A879-EXIT.
      *
           GO TO A871-NEXT.
       A879-EXIT.
           EXIT.
      *
       A880-SUBCHG-EDITS.
      ***************************************************************
      *‚EDIT SUBSCIBER CHANGE RECORD                                  *
      ***************************************************************
           MOVE SPACES                             TO PRV-FLAG
                                                      FEE-FLAG
                                                      ENB-FLAG.
           IF PRCNAM OF EEWHDR-WRK NOT = 'N'
           AND NAMCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND NAMCHG OF EEWSUB(ESBACT) NOT = ' '
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND NAMKEY OF EEWSUB(ESBACT) NOT = SPACES
              IF CHGEFF OF EEWSUB(ESBACT) = ZEROES
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'        TO MI-PARM4
                 MOVE 'NAME CHANGE'           TO MI-PARM5
                 MOVE 'EI02443'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A889-EXIT
                END-IF
              END-IF.
      *
           IF MEMCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND (MEMEFF OF EEWSUB(ESBACT) NOT = ZEROES
           OR   MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
              IF MEMEFF OF EEWSUB(ESBACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A889-EXIT
                 END-IF
              END-IF
              IF MEMEXP OF EEWSUB(ESBACT) = ZEROES
                 IF TMPACT NOT = ZEROES
                    MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       MEMEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEMBER MASTER'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
           IF CHGTYP OF EEWSUB(ESBACT) = 'T'
              IF MEMEXP OF EEWSUB(ESBACT) = ZEROES
              AND TRMEFF OF EEWSB3(ESBACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.

           IF CHGTYP OF EEWSUB(ESBACT) = 'T'
           AND TMPACT NOT = ZEROES
              IF  MEMEFF OF SUBMEM(TMPACT) <=
                                    MEMEXP OF EEWSUB(ESBACT)
              AND MEMEXP OF EEWSUB(ESBACT) <=
                                    MEMEXP OF SUBMEM(TMPACT)
                 NEXT SENTENCE
              ELSE
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI02469'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO A889-EXIT.

           IF (CHGTYP OF EEWSUB(ESBACT) = 'T' OR 'C')
           AND TMPACT = ZEROES
              IF BYPEDT OF EDIENR-REC = 'Y'
                 MOVE 'Y'                        TO SW-SET-ERROR
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI02469'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCACT OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
                 IF ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL'
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF ACCTNO OF EEWSUB(ESBACT) NOT =
                                  ACCTNO OF SUBENB(TMPACT, ENSTMP)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT
                       MOVE 'Y'                     TO ACCT-FLAG
                       MOVE ACCTNO OF EEWSUB(ESBACT) TO ACCTNO-HLD.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCTIR OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF TIERCD OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF TIERCD OF EEWSUB(ESBACT) NOT =
                             TIERCD OF SUBENB(TMPACT, ENSTMP 1)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT
                       MOVE 'Y'                     TO TIER-FLAG
                       MOVE TIERCD OF EEWSUB(ESBACT) TO TIERCD-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL1 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL1 OF EEWSUB(ESBACT) NOT =
                             USRFL1 OF SUBENB(TMPACT, ENSTMP)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT
                       MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL2 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL2 OF EEWSUB(ESBACT) NOT =
                             USRFL2 OF SUBENB(TMPACT, ENSTMP)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT
                       MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL3 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL3 OF EEWSUB(ESBACT) NOT =
                             USRFL3 OF SUBENB(TMPACT, ENSTMP)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT
                       MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCBPK OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TMPACT NOT = ZEROES
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF BENPKG OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM A800-SUBENB             THRU A809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF BENPKG OF EEWSUB(ESBACT) NOT =
                             BENPKG OF SUBENB(TMPACT, ENSTMP)
                       PERFORM A940-ENB-DATCHK      THRU A949-EXIT.
      *
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND TMPACT NOT = ZEROES
              PERFORM A760-SUBPCP                THRU A769-EXIT
              IF PPSTMP = ZEROES
                 GO TO A885-NEXT
              END-IF
              IF PCPEFF OF EEWSUB(ESBACT) = ZEROES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT =
                                      PROVNO OF SUBPCP(TMPACT, PPSTMP)
                OR PCPORG OF EEWSUB(ESBACT) NOT =
                                     PRVORG OF SUBPCP(TMPACT, PPSTMP)
                OR PCPMCP OF EEWSUB(ESBACT) NOT =
                                     MEMCAP OF SUBPCP(TMPACT, PPSTMP))
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       PCPEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF PCPEXP OF EEWSUB(ESBACT) = ZEROES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT =
                                      PROVNO OF SUBPCP(TMPACT, PPSTMP)
                OR PCPORG OF EEWSUB(ESBACT) NOT =
                                     PRVORG OF SUBPCP(TMPACT, PPSTMP)
                OR PCPMCP OF EEWSUB(ESBACT) NOT =
                                     MEMCAP OF SUBPCP(TMPACT, PPSTMP))
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       PCPEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF TMPACT NOT = ZEROES
                    MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       PCPEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
       A885-NEXT.
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND TMPACT NOT = ZEROES
              PERFORM A760-SUBPCP                THRU A769-EXIT
              IF PPSTMP = ZEROES
                 GO TO A886-NEXT
              END-IF
              IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT =
                                       PROVNO OF SUBPCP(TMPACT, PPSTMP)
                OR PCPORG OF EEWSUB(ESBACT) NOT =
                                     PRVORG OF SUBPCP(TMPACT, PPSTMP)
                OR PCPMCP OF EEWSUB(ESBACT) NOT =
                                     MEMCAP OF SUBPCP(TMPACT, PPSTMP))
                 MOVE 'Y'                        TO PRV-FLAG
                 IF (PCPEXP OF EEWSUB(ESBACT) NOT =
                                       MEMEXP OF EEWSUB(ESBACT)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A889-EXIT
                    END-IF
                 ELSE
                 IF PCPEXP OF EEWSUB(ESBACT) NOT =
                                       MEMEXP OF SUBMEM(TMPACT)
                 AND MEMEXP OF EEWSUB(ESBACT) = ZEROES
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO A889-EXIT.
      *
       A886-NEXT.
           IF   PRCSEC OF EEWHDR-WRK NOT = 'N'
           AND  SECCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND  CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND  SECCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND  TMPACT NOT = ZEROES
              PERFORM A770-SUBSEC                THRU A779-EXIT
              IF SPSTMP = ZEROES
                 IF SECEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       SECEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                  TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF SECEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                       GO TO A887-NEXT
                    END-IF
                    IF TMPACT NOT = ZEROES
                       MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A887-NEXT
              END-IF
              IF   SECEFF OF EEWSUB(ESBACT) = ZEROES
              AND (SECCOD OF EEWSUB(ESBACT) NOT =
                                     PROVNO OF SUBSEC(TMPACT, SPSTMP)
                OR SECORG OF EEWSUB(ESBACT) NOT =
                                     PRVORG OF SUBSEC(TMPACT, SPSTMP)
                OR SECMCP OF EEWSUB(ESBACT) NOT =
                                     MEMCAP OF SUBSEC(TMPACT, SPSTMP))
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       SECEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF   SECEXP OF EEWSUB(ESBACT) = ZEROES
              AND (SECCOD OF EEWSUB(ESBACT) NOT =
                                     PROVNO OF SUBSEC(TMPACT, SPSTMP)
                OR SECORG OF EEWSUB(ESBACT) NOT =
                                     PRVORG OF SUBSEC(TMPACT, SPSTMP)
                OR SECMCP OF EEWSUB(ESBACT) NOT =
                                     MEMCAP OF SUBSEC(TMPACT, SPSTMP))
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF TMPACT NOT = ZEROES
                    MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
       A887-NEXT.
           IF PRCMCS OF EEWHDR-WRK NOT = 'N'
           AND MEDCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND MEDSTS OF EEWSUB(ESBACT) NOT = SPACES
           AND MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND TMPACT NOT = ZEROES
              PERFORM A780-SUBMED                THRU A789-EXIT
              IF SMDTMP = ZEROES
                 IF MEDEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       MEDEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF MEDEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                       GO TO A887-FEECHK
                    END-IF
                    IF TMPACT NOT = ZEROES
                       MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A887-FEECHK
              END-IF
              IF MEDEFF OF EEWSUB(ESBACT) = ZEROES
              AND (MEDSTS OF EEWSUB(ESBACT) NOT =
                                       MEDSTS OF SUBMED(TMPACT, SMDTMP)
               OR MEDCTY OF EEWSUB(ESBACT) NOT =
                                      MEDCTY OF SUBMED(TMPACT, SMDTMP))
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       MEDEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF MEDEXP OF EEWSUB(ESBACT) = ZEROES
              AND (MEDSTS OF EEWSUB(ESBACT) NOT =
                                       MEDSTS OF SUBMED(TMPACT, SMDTMP)
               OR MEDCTY OF EEWSUB(ESBACT) NOT =
                                      MEDCTY OF SUBMED(TMPACT, SMDTMP))
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF TMPACT NOT = ZEROES
                    MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
       A887-FEECHK.
           IF PRCFEE OF EEWHDR-WRK NOT = 'N'
           AND FEECHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND FEECOD OF EEWSUB(ESBACT) NOT = SPACES
           AND TMPACT NOT = ZEROES
              PERFORM A790-SUBFEE                THRU A799-EXIT
              IF SFETMP = ZEROES
                 IF FEEEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                        FEEEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'FEE SCHEDULE'            TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF FEEEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                       GO TO A888-NEXT
                    END-IF
                    IF TMPACT NOT = ZEROES
                       MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                       GO TO A888-NEXT
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A888-NEXT
              END-IF
              IF FEECOD OF EEWSUB(ESBACT) NOT =
                                       FEECOD OF SUBFEE(TMPACT, SFETMP)
                 MOVE 'Y'                        TO FEE-FLAG
              END-IF
              IF FEEEFF OF EEWSUB(ESBACT) = ZEROES
              AND FEECOD OF EEWSUB(ESBACT) NOT =
                                       FEECOD OF SUBFEE(TMPACT, SFETMP)
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                        FEEEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'FEE SCHEDULE'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF FEEEXP OF EEWSUB(ESBACT) = ZEROES
              AND FEECOD OF EEWSUB(ESBACT) NOT =
                                       FEECOD OF SUBFEE(TMPACT, SFETMP)
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF TMPACT NOT = ZEROES
                    MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
       A888-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND TMPACT NOT = ZEROES
           AND ((ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
           OR   (TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
              PERFORM A800-SUBENB                THRU A809-EXIT
              IF ENSTMP = ZEROES
                 GO TO A889-EXIT
              END-IF
              IF  (TIERCD OF EEWSUB(ESBACT) NOT =
                                    TIERCD OF SUBENB(TMPACT, ENSTMP 1)
              AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT =
                                   BENPKG OF SUBENB(TMPACT, ENSTMP)
                   AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT =
                                   USRFL1 OF SUBENB(TMPACT, ENSTMP)
                   AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT =
                                   USRFL2 OF SUBENB(TMPACT, ENSTMP)
                   AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT =
                                   USRFL3 OF SUBENB(TMPACT, ENSTMP)
                   AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
                 MOVE 'Y'                        TO ENB-FLAG
              END-IF
              IF (ENBEXP OF EEWSUB(ESBACT) NOT =
                                    MEMEXP OF EEWSUB(ESBACT)
              AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
              AND ((ACCTNO OF EEWSUB(ESBACT) NOT =
                                    ACCTNO OF SUBENB(TMPACT, ENSTMP)
              AND ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWSUB(ESBACT) NOT =
                                    TIERCD OF SUBENB(TMPACT, ENSTMP 1)
                  AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT =
                                   USRFL1 OF SUBENB(TMPACT, ENSTMP)
                  AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT =
                                   USRFL2 OF SUBENB(TMPACT, ENSTMP)
                  AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT =
                                   USRFL3 OF SUBENB(TMPACT, ENSTMP)
                  AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT =
                                   BENPKG OF SUBENB(TMPACT, ENSTMP)
                  AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A889-EXIT
                 END-IF
              ELSE
              IF ENBEXP OF EEWSUB(ESBACT) NOT =
                                    MEMEXP OF SUBMEM(TMPACT)
              AND MEMEXP OF EEWSUB(ESBACT) = ZEROES
              AND ((ACCTNO OF EEWSUB(ESBACT) NOT =
                                    ACCTNO OF SUBENB(TMPACT, ENSTMP)
              AND ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWSUB(ESBACT) NOT =
                                    TIERCD OF SUBENB(TMPACT, ENSTMP 1)
              AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT =
                                   USRFL1 OF SUBENB(TMPACT, ENSTMP)
              AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT =
                                   USRFL2 OF SUBENB(TMPACT, ENSTMP)
              AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT =
                                   USRFL3 OF SUBENB(TMPACT, ENSTMP)
              AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT =
                                   BENPKG OF SUBENB(TMPACT, ENSTMP)
              AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A889-EXIT.
      *
           IF FEE-CHANGE AND PCP-CHANGE
              IF FEEEFF OF EEWSUB(ESBACT) NOT =
                                       PCPEFF OF EEWSUB(ESBACT)
              OR FEEEXP OF EEWSUB(ESBACT) NOT =
                                       PCPEXP OF EEWSUB(ESBACT)
                 MOVE FEEEFF OF EEWSUB(ESBACT)
                                       TO PCPEFF OF EEWSUB(ESBACT)
                 MOVE FEEEXP OF EEWSUB(ESBACT)
                                       TO PCPEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF FEE-CHANGE AND ENB-CHANGE
              IF FEEEFF OF EEWSUB(ESBACT) NOT =
                                       ENBEFF OF EEWSUB(ESBACT)
              OR FEEEXP OF EEWSUB(ESBACT) NOT =
                                       ENBEXP OF EEWSUB(ESBACT)
                 MOVE ENBEFF OF EEWSUB(ESBACT)
                                      TO FEEEFF OF EEWSUB(ESBACT)
                 MOVE ENBEXP OF EEWSUB(ESBACT)
                                      TO FEEEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF PCP-CHANGE AND ENB-CHANGE
              IF PCPEFF OF EEWSUB(ESBACT) NOT =
                                       ENBEFF OF EEWSUB(ESBACT)
              OR PCPEXP OF EEWSUB(ESBACT) NOT =
                                       ENBEXP OF EEWSUB(ESBACT)
                 MOVE ENBEFF OF EEWSUB(ESBACT)
                                      TO PCPEFF OF EEWSUB(ESBACT)
                 MOVE ENBEXP OF EEWSUB(ESBACT)
                                      TO PCPEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
       A889-EXIT.
           EXIT.
      *
       A890-DEPCHG-EDITS.
      **************************************************************
      *‚EDIT DEP CHANGE RECORD                              *
      **************************************************************
           MOVE SPACES                             TO PRV-FLAG
                                                      FEE-FLAG
                                                      ENB-FLAG.

           IF PRCNAM OF EEWHDR-WRK NOT = 'N'
           AND NAMCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND NAMCHG OF EEWDEP(EDPACT) NOT = ' '
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND NAMKEY OF EEWDEP(EDPACT) NOT = SPACES
              IF CHGEFF OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'NAME CHANGE'              TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A899-EXIT
                 END-IF
              END-IF.
      *
           IF MEMCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND (MEMEFF OF EEWDEP(EDPACT) NOT = ZEROES
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
              IF MEMEFF OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A899-EXIT
                 END-IF
              END-IF
              IF MEMEXP OF EEWDEP(EDPACT) = ZEROES
                 IF MEMTMP NOT = ZEROES
                    MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       MEMEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEMBER MASTER'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF WRN-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.
      *
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
              IF MEMEXP OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.
      *
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
           AND MEMTMP NOT = ZEROES
              IF  MEMEFF OF MEMTAB(MEMTMP) <=
                                    MEMEXP OF EEWDEP(EDPACT)
              AND MEMEXP OF EEWDEP(EDPACT) <=
                                    MEMEXP OF MEMTAB(MEMTMP)
                 NEXT SENTENCE
              ELSE
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI02469'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO A899-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCACT OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMTMP NOT = ZEROES
              PERFORM A850-DEPENB                THRU A859-EXIT
              IF ENBTMP = ZEROES
                 GO TO A892-NEXT
              END-IF
              IF ACCTNO OF EEWDEP(EDPACT) NOT =
                                       ACCTNO OF ENBTAB(MEMTMP, ENBTMP)
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
                 PERFORM A950-ENB-DATCHK   THRU A959-EXIT
              END-IF
              IF ACCTNO OF EEWDEP(EDPACT) NOT =
                                       ACCTNO OF ENBTAB(MEMTMP, ENBTMP)
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO-HLD
              OR NOT SUBACCT-CHG)
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ACCOUNT'                  TO MI-PARM4
                 MOVE 'EI02470'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.

       A892-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCTIR OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMTMP NOT = ZEROES
              PERFORM A850-DEPENB                THRU A859-EXIT
              IF ENBTMP = ZEROES
                 GO TO A893-NEXT
              END-IF
              IF  TIERCD OF EEWDEP(EDPACT) NOT = SPACES
              AND TIERCD OF EEWDEP(EDPACT) NOT =
                                    TIERCD OF ENBTAB(MEMTMP, ENBTMP 1)
                 PERFORM A950-ENB-DATCHK   THRU A959-EXIT
              END-IF
              IF  TIERCD OF EEWDEP(EDPACT) NOT = SPACES
              AND TIERCD OF EEWDEP(EDPACT) NOT =
                                    TIERCD OF ENBTAB(MEMTMP, ENBTMP 1)
                 IF NOT SUB-TIRCHG
                 OR (TIERCD OF EEWDEP(EDPACT) NOT = TIERCD-HLD)
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'TIER CODE'              TO MI-PARM4
                    MOVE 'EI02470'                TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO
                                               GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO
                                               SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO
                                               RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO
                                               MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO
                                               CHGTYP OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR      THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER       THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'   GO TO A899-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCBPK OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF MEMTMP NOT = ZEROES
                 IF BENPKG OF EEWDEP(EDPACT) NOT = SPACES
                    PERFORM A850-DEPENB          THRU A859-EXIT
                    IF ENBTMP = ZEROES
                       GO TO A893-NEXT
                    ELSE
                    IF BENPKG OF EEWDEP(EDPACT) NOT =
                                       BENPKG OF ENBTAB(MEMTMP, ENBTMP)
                       PERFORM A950-ENB-DATCHK   THRU A959-EXIT.
      *
       A893-NEXT.
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMTMP NOT = ZEROES
              PERFORM A810-DEPPCP                THRU A819-EXIT
              IF PCPTMP = ZEROES
                 GO TO A894-NEXT
              END-IF
              IF PCPEFF OF EEWDEP(EDPACT) = ZEROES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT =
                                       PROVNO OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPORG OF EEWDEP(EDPACT) NOT =
                                       PRVORG OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPMCP OF EEWDEP(EDPACT) NOT =
                                       MEMCAP OF PCPTAB(MEMTMP, PCPTMP))
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       PCPEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF PCPEXP OF EEWDEP(EDPACT) = ZEROES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT =
                                      PROVNO OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPORG OF EEWDEP(EDPACT) NOT =
                                       PRVORG OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPMCP OF EEWDEP(EDPACT) NOT =
                                       MEMCAP OF PCPTAB(MEMTMP, PCPTMP))
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       PCPEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMTMP NOT = ZEROES
                    MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       PCPEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.

           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMTMP NOT = ZEROES
              PERFORM A810-DEPPCP                THRU A819-EXIT
              IF PCPTMP = ZEROES
                 GO TO A894-NEXT
              END-IF
              IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT =
                                       PROVNO OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPORG OF EEWDEP(EDPACT) NOT =
                                       PRVORG OF PCPTAB(MEMTMP, PCPTMP)
                OR PCPMCP OF EEWDEP(EDPACT) NOT =
                                       MEMCAP OF PCPTAB(MEMTMP, PCPTMP))
                 MOVE 'Y'                        TO PRV-FLAG
                 IF (PCPEXP OF EEWDEP(EDPACT) NOT =
                                       MEMEXP OF EEWDEP(EDPACT)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A899-EXIT
                    END-IF
                 ELSE
                 IF PCPEXP OF EEWDEP(EDPACT) NOT =
                                       MEMEXP OF MEMTAB(MEMTMP)
                 AND MEMEXP OF EEWDEP(EDPACT) = ZEROES
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO A899-EXIT.
      *
       A894-NEXT.
           IF   PRCSEC OF EEWHDR-WRK NOT = 'N'
           AND  SECCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND  CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND  SECCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEMTMP NOT = ZEROES
              PERFORM A820-DEPSEC                THRU A829-EXIT
              IF SECTMP = ZEROES
                 IF SECEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       SECEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF SECEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       SECEXP OF EEWDEP(EDPACT)
                       GO TO A895-NEXT
                    END-IF
                    IF MEMTMP NOT = ZEROES
                       MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       SECEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A895-NEXT
              END-IF
              IF   SECEFF OF EEWDEP(EDPACT) = ZEROES
              AND (SECCOD OF EEWDEP(EDPACT) NOT =
                                       PROVNO OF SECTAB(MEMTMP, SECTMP)
                OR SECORG OF EEWDEP(EDPACT) NOT =
                                      PRVORG OF SECTAB(MEMTMP, SECTMP)
                OR SECMCP OF EEWDEP(EDPACT) NOT =
                                      MEMCAP OF SECTAB(MEMTMP, SECTMP))
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       SECEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF   SECEXP OF EEWDEP(EDPACT) = ZEROES
              AND (SECCOD OF EEWDEP(EDPACT) NOT =
                                       PROVNO OF SECTAB(MEMTMP, SECTMP)
                OR SECORG OF EEWDEP(EDPACT) NOT =
                                      PRVORG OF SECTAB(MEMTMP, SECTMP)
                OR SECMCP OF EEWDEP(EDPACT) NOT =
                                      MEMCAP OF SECTAB(MEMTMP, SECTMP))
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       SECEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMTMP NOT = ZEROES
                    MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       SECEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.
      *
       A895-NEXT.
           IF PRCMCS OF EEWHDR-WRK NOT = 'N'
           AND MEDCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEDSTS OF EEWDEP(EDPACT) NOT = SPACES
           AND MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMTMP NOT = ZEROES
              PERFORM A830-DEPMED                THRU A839-EXIT
              IF MEDTMP = ZEROES
                 IF MEDEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       MEDEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF MEDEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                       GO TO A896-NEXT
                    END-IF
                    IF MEMTMP NOT = ZEROES
                       MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                  TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A896-NEXT
              END-IF
              IF MEDEFF OF EEWDEP(EDPACT) = ZEROES
              AND (MEDSTS OF EEWDEP(EDPACT) NOT =
                                       MEDSTS OF MEDTAB(MEMTMP, MEDTMP)
               OR MEDCTY OF EEWDEP(EDPACT) NOT =
                                      MEDCTY OF MEDTAB(MEMTMP, MEDTMP))
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       MEDEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF MEDEXP OF EEWDEP(EDPACT) = ZEROES
              AND (MEDSTS OF EEWDEP(EDPACT) NOT =
                                       MEDSTS OF MEDTAB(MEMTMP, MEDTMP)
               OR MEDCTY OF EEWDEP(EDPACT) NOT =
                                      MEDCTY OF MEDTAB(MEMTMP, MEDTMP))
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMTMP NOT = ZEROES
                    MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.
      *
       A896-NEXT.
           IF PRCFEE OF EEWHDR-WRK NOT = 'N'
           AND FEECHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND FEECOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMTMP NOT = ZEROES
              PERFORM A840-DEPFEE                THRU A849-EXIT
              IF FEETMP = ZEROES
                 IF FEEEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       FEEEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID         TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF FEEEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                       GO TO A897-NEXT
                    END-IF
                    IF MEMTMP NOT = ZEROES
                       MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID         TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO A899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO A897-NEXT
              END-IF
              IF FEEEFF OF EEWDEP(EDPACT) = ZEROES
              AND FEECOD OF EEWDEP(EDPACT) NOT =
                                       FEECOD OF FEETAB(MEMTMP, FEETMP)
                 MOVE 'Y'                        TO FEE-FLAG
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       FEEEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF FEEEXP OF EEWDEP(EDPACT) = ZEROES
              AND FEECOD OF EEWDEP(EDPACT) NOT =
                                       FEECOD OF FEETAB(MEMTMP, FEETMP)
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMTMP NOT = ZEROES
                    MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO A899-EXIT.
      *
       A897-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMTMP NOT = ZEROES
           AND ((ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
           OR   TIERCD OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL1 OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL2 OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL3 OF EEWDEP(EDPACT) NOT = SPACES
           OR   BENPKG OF EEWDEP(EDPACT) NOT = SPACES)
              PERFORM A850-DEPENB                THRU A859-EXIT
              IF ENBTMP = ZEROES
                 GO TO A898-NEXT
              END-IF
              IF   (TIERCD OF EEWDEP(EDPACT) NOT =
                                    TIERCD OF ENBTAB(MEMTMP, ENBTMP 1)
              AND   TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (BENPKG OF EEWDEP(EDPACT) NOT =
                                   BENPKG OF ENBTAB(MEMTMP, ENBTMP)
              AND  BENPKG OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL1 OF EEWDEP(EDPACT) NOT =
                                   USRFL1 OF ENBTAB(MEMTMP, ENBTMP)
              AND  USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL2 OF EEWDEP(EDPACT) NOT =
                                   USRFL2 OF ENBTAB(MEMTMP, ENBTMP)
              AND  USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL3 OF EEWDEP(EDPACT) NOT =
                                   USRFL3 OF ENBTAB(MEMTMP, ENBTMP)
              AND  USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
                 MOVE 'Y'                        TO ENB-FLAG
              END-IF
              IF (ENBEXP OF EEWDEP(EDPACT) NOT =
                                    MEMEXP OF EEWDEP(EDPACT)
              AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
              AND ((ACCTNO OF EEWDEP(EDPACT) NOT =
                                    ACCTNO OF ENBTAB(MEMTMP, ENBTMP)
              AND ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWDEP(EDPACT) NOT =
                                    TIERCD OF ENBTAB(MEMTMP, ENBTMP 1)
                   AND TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL1 OF EEWDEP(EDPACT) NOT =
                                    USRFL1 OF ENBTAB(MEMTMP, ENBTMP)
                   AND USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL2 OF EEWDEP(EDPACT) NOT =
                                    USRFL2 OF ENBTAB(MEMTMP, ENBTMP)
                   AND USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL3 OF EEWDEP(EDPACT) NOT =
                                    USRFL3 OF ENBTAB(MEMTMP, ENBTMP)
                   AND USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (BENPKG OF EEWDEP(EDPACT) NOT =
                                      BENPKG OF ENBTAB(MEMTMP, ENBTMP)
                   AND BENPKG OF EEWDEP(EDPACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A899-EXIT
                 END-IF
              ELSE
              IF  ENBEXP OF EEWDEP(EDPACT) NOT =
                                    MEMEXP OF MEMTAB(MEMTMP)
              AND MEMEXP OF EEWDEP(EDPACT) = ZEROES
              AND ((ACCTNO OF EEWDEP(EDPACT) NOT =
                                    ACCTNO OF ENBTAB(MEMTMP, ENBTMP)
              AND   ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWDEP(EDPACT) NOT =
                                    TIERCD OF ENBTAB(MEMTMP, ENBTMP 1)
              AND   TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL1 OF EEWDEP(EDPACT) NOT =
                                    USRFL1 OF ENBTAB(MEMTMP, ENBTMP)
              AND   USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL2 OF EEWDEP(EDPACT) NOT =
                                    USRFL2 OF ENBTAB(MEMTMP, ENBTMP)
              AND   USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL3 OF EEWDEP(EDPACT) NOT =
                                    USRFL3 OF ENBTAB(MEMTMP, ENBTMP)
              AND   USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (BENPKG OF EEWDEP(EDPACT) NOT =
                                   BENPKG OF ENBTAB(MEMTMP, ENBTMP)
              AND BENPKG OF EEWDEP(EDPACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT.
      *
       A898-NEXT.
           IF FEE-CHANGE AND PCP-CHANGE
              IF FEEEFF OF EEWDEP(EDPACT) NOT =
                                       PCPEFF OF EEWDEP(EDPACT)
              OR FEEEXP OF EEWDEP(EDPACT) NOT =
                                       PCPEXP OF EEWDEP(EDPACT)
                 MOVE FEEEFF OF EEWDEP(EDPACT)
                                       TO PCPEFF OF EEWDEP(EDPACT)
                 MOVE FEEEXP OF EEWDEP(EDPACT)
                                       TO PCPEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF FEE-CHANGE AND ENB-CHANGE
              IF FEEEFF OF EEWDEP(EDPACT) NOT =
                                       ENBEFF OF EEWDEP(EDPACT)
              OR FEEEXP OF EEWDEP(EDPACT) NOT =
                                       ENBEXP OF EEWDEP(EDPACT)
                 MOVE ENBEFF OF EEWDEP(EDPACT)
                                      TO FEEEFF OF EEWDEP(EDPACT)
                 MOVE ENBEXP OF EEWDEP(EDPACT)
                                      TO FEEEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF PCP-CHANGE AND ENB-CHANGE
              IF PCPEFF OF EEWDEP(EDPACT) NOT =
                                       ENBEFF OF EEWDEP(EDPACT)
              OR PCPEXP OF EEWDEP(EDPACT) NOT =
                                       ENBEXP OF EEWDEP(EDPACT)
                 MOVE ENBEFF OF EEWDEP(EDPACT)
                                      TO PCPEFF OF EEWDEP(EDPACT)
                 MOVE ENBEXP OF EEWDEP(EDPACT)
                                      TO PCPEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
       A899-EXIT.
           EXIT.
      *
       A900-INIT-MDTTAB.
      **************************************************************
      *‚INITIALIZE MDTTAB                                          *
      **************************************************************
           INITIALIZE MDTTAB(INDX).
       A909-EXIT.
           EXIT.
      *
       A910-ERR-MEMBER.
      ****************************************************************
      *‚ADD ERRORED MEMBER TO EEEMAS                                 *
      ****************************************************************
           IF REC-WRITTEN
              GO TO A919-EXIT.
      *
           INITIALIZE EEEMAS-REC.
           MOVE RECTYP OF EETDEP(EDPACT) TO RECTYP OF EEEMAS-REC.
           MOVE GRPNUM OF EETDEP(EDPACT) TO GRPNUM OF EEEMAS-REC.
           MOVE SUBSNO OF EETDEP(EDPACT) TO SUBSNO OF EEEMAS-REC.
           MOVE RELCOD OF EETDEP(EDPACT) TO RELCOD OF EEEMAS-REC.
           MOVE RELTYP OF EETDEP(EDPACT) TO RELTYP OF EEEMAS-REC.
           MOVE MEMBNO OF EETDEP(EDPACT) TO MEMBNO OF EEEMAS-REC.
           MOVE BTHDAT OF EETDEP(EDPACT) TO BTHDAT OF EEEMAS-REC.
           MOVE BTHSEQ OF EETDEP(EDPACT) TO BTHSEQ OF EEEMAS-REC.
           MOVE BTHCHG OF EETDEP(EDPACT) TO BTHCHG OF EEEMAS-REC.
           MOVE SEXCOD OF EETDEP(EDPACT) TO SEXCOD OF EEEMAS-REC.
           MOVE SEXCHG OF EETDEP(EDPACT) TO SEXCHG OF EEEMAS-REC.
           MOVE CHGTYP OF EETDEP(EDPACT) TO CHGTYP OF EEEMAS-REC.
           MOVE CHGDAT OF EETDEP(EDPACT) TO CHGDAT OF EEEMAS-REC.
           MOVE CHGTIM OF EETDEP(EDPACT) TO CHGTIM OF EEEMAS-REC.
           MOVE CHGEFF OF EETDEP(EDPACT) TO CHGEFF OF EEEMAS-REC.
           MOVE NAMCHG OF EETDEP(EDPACT) TO NAMCHG OF EEEMAS-REC.
           MOVE FSTNAM OF EETDEP(EDPACT) TO FSTNAM OF EEEMAS-REC.
           MOVE LSTNAM OF EETDEP(EDPACT) TO LSTNAM OF EEEMAS-REC.
           MOVE MIDNAM OF EETDEP(EDPACT) TO MIDNAM OF EEEMAS-REC.
           MOVE TITLCD OF EETDEP(EDPACT) TO TITLCD OF EEEMAS-REC.
           MOVE FORNAM OF EETDEP(EDPACT) TO FORNAM OF EEEMAS-REC.
           MOVE MEMCHG OF EETDEP(EDPACT) TO MEMCHG OF EEEMAS-REC.
           MOVE EMPSTA OF EETDEP(EDPACT) TO EMPSTA OF EEEMAS-REC.
           MOVE PRTCOD OF EETDEP(EDPACT) TO PRTCOD OF EEEMAS-REC.
           MOVE MEMEFF OF EETDEP(EDPACT) TO MEMEFF OF EEEMAS-REC.
           MOVE MEMEXP OF EETDEP(EDPACT) TO MEMEXP OF EEEMAS-REC.
           MOVE MEMREA OF EETDEP(EDPACT) TO MEMREA OF EEEMAS-REC.
           MOVE MEMTRM OF EETDEP(EDPACT) TO MEMTRM OF EEEMAS-REC.
           MOVE DEMCHG OF EETDEP(EDPACT) TO DEMCHG OF EEEMAS-REC.
           MOVE ADRLN1 OF EETDEP(EDPACT) TO ADRLN1 OF EEEMAS-REC.
           MOVE ADRLN2 OF EETDEP(EDPACT) TO ADRLN2 OF EEEMAS-REC.
           MOVE CITYCD OF EETDEP(EDPACT) TO CITYCD OF EEEMAS-REC.
           MOVE STATCD OF EETDEP(EDPACT) TO STACOD OF EEEMAS-REC.
           MOVE ZIPCOD OF EETDEP(EDPACT) TO ZIPCOD OF EEEMAS-REC.
           MOVE CTRYCD OF EETDEP(EDPACT) TO CTRYCD OF EEEMAS-REC.
           MOVE LOCQLF OF EETDEP(EDPACT) TO LOCQLF OF EEEMAS-REC.
           MOVE AREACD OF EETDEP(EDPACT) TO AREACD OF EEEMAS-REC.
           MOVE HOMPH1 OF EETDEP(EDPACT) TO HOMPH1 OF EEEMAS-REC.
           MOVE HOMPH2 OF EETDEP(EDPACT) TO HOMPH2 OF EEEMAS-REC.
           MOVE HOMPH3 OF EETDEP(EDPACT) TO HOMPH3 OF EEEMAS-REC.
           MOVE WRKPH1 OF EETDEP(EDPACT) TO WRKPH1 OF EEEMAS-REC.
           MOVE WRKPH2 OF EETDEP(EDPACT) TO WRKPH2 OF EEEMAS-REC.
           MOVE WRKPH3 OF EETDEP(EDPACT) TO WRKPH3 OF EEEMAS-REC.
           MOVE WRKEXT OF EETDEP(EDPACT) TO WRKEXT OF EEEMAS-REC.
           MOVE FAXNUM OF EETDEP(EDPACT) TO FAXNUM OF EEEMAS-REC.
           MOVE OTHPHN OF EETDEP(EDPACT) TO OTHPHN OF EEEMAS-REC.
           MOVE EMLIND OF EETDEP(EDPACT) TO EMLIND OF EEEMAS-REC.
           MOVE ELMAIL OF EETDEP(EDPACT) TO ELMAIL OF EEEMAS-REC.
           MOVE HIRDAT OF EETDEP(EDPACT) TO HIRDAT OF EEEMAS-REC.
           MOVE TRMDAT OF EETDEP(EDPACT) TO TRMDAT OF EEEMAS-REC.
           MOVE SOCSEC OF EETDEP(EDPACT) TO SOCSEC OF EEEMAS-REC.
           MOVE OLDLST OF EETDEP(EDPACT) TO OLDLST OF EEEMAS-REC.
           MOVE OLDFST OF EETDEP(EDPACT) TO OLDFST OF EEEMAS-REC.
           MOVE OLDMID OF EETDEP(EDPACT) TO OLDMID OF EEEMAS-REC.
           MOVE OLDTLC OF EETDEP(EDPACT) TO OLDTLC OF EEEMAS-REC.
           MOVE OLDSSN OF EETDEP(EDPACT) TO OLDSSN OF EEEMAS-REC.
           MOVE OLDBTH OF EETDEP(EDPACT) TO OLDBTH OF EEEMAS-REC.
           MOVE OLDSEX OF EETDEP(EDPACT) TO OLDSEX OF EEEMAS-REC.
           MOVE RACECD OF EETDEP(EDPACT) TO RACECD OF EEEMAS-REC.
           MOVE TYPCOD OF EETDEP(EDPACT) TO TYPCOD OF EEEMAS-REC.
           MOVE HOLDCD OF EETDEP(EDPACT) TO HOLDCD OF EEEMAS-REC.
           MOVE MEMSTA OF EETDEP(EDPACT) TO MEMSTA OF EEEMAS-REC.
           MOVE STUSTA OF EETDEP(EDPACT) TO STUSTA OF EEEMAS-REC.
           MOVE EDUBEG OF EETDEP(EDPACT) TO EDUBEG OF EEEMAS-REC.
           MOVE EDUEND OF EETDEP(EDPACT) TO EDUEND OF EEEMAS-REC.
           MOVE HNDIND OF EETDEP(EDPACT) TO HNDIND OF EEEMAS-REC.
           MOVE AUTEXP OF EETDEP(EDPACT) TO AUTEXP OF EEEMAS-REC.
           MOVE ALTNUM OF EETDEP(EDPACT) TO ALTNUM OF EEEMAS-REC.
           MOVE INTKCD OF EETDEP(EDPACT) TO INTKCD OF EEEMAS-REC.
           MOVE PCPCHG OF EETDEP(EDPACT) TO PCPCHG OF EEEMAS-REC.
           MOVE PCPCOD OF EETDEP(EDPACT) TO PCPCOD OF EEEMAS-REC.
           MOVE PCPORG OF EETDEP(EDPACT) TO PCPORG OF EEEMAS-REC.
           MOVE PCPOVR OF EETDEP(EDPACT) TO PCPOVR OF EEEMAS-REC.
           MOVE PCPMCP OF EETDEP(EDPACT) TO PCPMCP OF EEEMAS-REC.
           MOVE PCPEFF OF EETDEP(EDPACT) TO PCPEFF OF EEEMAS-REC.
           MOVE PCPEXP OF EETDEP(EDPACT) TO PCPEXP OF EEEMAS-REC.
           MOVE PCPREA OF EETDEP(EDPACT) TO PCPREA OF EEEMAS-REC.
           MOVE PCPTRM OF EETDEP(EDPACT) TO PCPTRM OF EEEMAS-REC.
           MOVE SECCHG OF EETDEP(EDPACT) TO SECCHG OF EEEMAS-REC.
           MOVE SECCOD OF EETDEP(EDPACT) TO SECCOD OF EEEMAS-REC.
           MOVE SECORG OF EETDEP(EDPACT) TO SECORG OF EEEMAS-REC.
           MOVE SECOVR OF EETDEP(EDPACT) TO SECOVR OF EEEMAS-REC.
           MOVE SECMCP OF EETDEP(EDPACT) TO SECMCP OF EEEMAS-REC.
           MOVE SECEFF OF EETDEP(EDPACT) TO SECEFF OF EEEMAS-REC.
           MOVE SECEXP OF EETDEP(EDPACT) TO SECEXP OF EEEMAS-REC.
           MOVE SECREA OF EETDEP(EDPACT) TO SECREA OF EEEMAS-REC.
           MOVE SECTRM OF EETDEP(EDPACT) TO SECTRM OF EEEMAS-REC.
           MOVE MEDCHG OF EETDEP(EDPACT) TO MEDCHG OF EEEMAS-REC.
           MOVE MEDCTY OF EETDEP(EDPACT) TO MEDCTY OF EEEMAS-REC.
           MOVE MEDSTS OF EETDEP(EDPACT) TO MEDSTS OF EEEMAS-REC.
           MOVE MEDEFF OF EETDEP(EDPACT) TO MEDEFF OF EEEMAS-REC.
           MOVE MEDEXP OF EETDEP(EDPACT) TO MEDEXP OF EEEMAS-REC.
           MOVE MEDREA OF EETDEP(EDPACT) TO MEDREA OF EEEMAS-REC.
           MOVE MEDTRM OF EETDEP(EDPACT) TO MEDTRM OF EEEMAS-REC.
           MOVE FEECHG OF EETDEP(EDPACT) TO FEECHG OF EEEMAS-REC.
           MOVE FEECOD OF EETDEP(EDPACT) TO FEECOD OF EEEMAS-REC.
           MOVE FEEEFF OF EETDEP(EDPACT) TO FEEEFF OF EEEMAS-REC.
           MOVE FEEEXP OF EETDEP(EDPACT) TO FEEEXP OF EEEMAS-REC.
           MOVE FEEREA OF EETDEP(EDPACT) TO FEEREA OF EEEMAS-REC.
           MOVE FEETRM OF EETDEP(EDPACT) TO FEETRM OF EEEMAS-REC.
           MOVE ENBCHG OF EETDEP(EDPACT) TO ENBCHG OF EEEMAS-REC.
           MOVE ACCTNO OF EETDEP(EDPACT) TO ACCTNO OF EEEMAS-REC.
           MOVE TIRCAL OF EETDEP(EDPACT) TO TIRCAL OF EEEMAS-REC.
           MOVE TIERCD OF EETDEP(EDPACT) TO TIERCD OF EEEMAS-REC.
           MOVE TIRFLG OF EETDEP(EDPACT) TO TIRFLG OF EEEMAS-REC.
           MOVE BENPKG OF EETDEP(EDPACT) TO BENPKG OF EEEMAS-REC.
           MOVE BILEXC OF EETDEP(EDPACT) TO BILEXC OF EEEMAS-REC.
           MOVE ENBEFF OF EETDEP(EDPACT) TO ENBEFF OF EEEMAS-REC.
           MOVE ENBEXP OF EETDEP(EDPACT) TO ENBEXP OF EEEMAS-REC.
           MOVE ENBREA OF EETDEP(EDPACT) TO ENBREA OF EEEMAS-REC.
           MOVE ENBTRM OF EETDEP(EDPACT) TO ENBTRM OF EEEMAS-REC.
           MOVE CPAIND OF EETDEP(EDPACT) TO CPAIND OF EEEMAS-REC.
           MOVE CPLNAM OF EETDEP(EDPACT) TO CPLNAM OF EEEMAS-REC.
           MOVE CPFNAM OF EETDEP(EDPACT) TO CPFNAM OF EEEMAS-REC.
           MOVE CPMNAM OF EETDEP(EDPACT) TO CPMNAM OF EEEMAS-REC.
           MOVE CPTITL OF EETDEP(EDPACT) TO CPTITL OF EEEMAS-REC.
           MOVE CPFORM OF EETDEP(EDPACT) TO CPFORM OF EEEMAS-REC.
           MOVE CPARNT OF EETDEP(EDPACT) TO CPARNT OF EEEMAS-REC.
           MOVE CPCONT OF EETDEP(EDPACT) TO CPCONT OF EEEMAS-REC.
           MOVE CPHPH1 OF EETDEP(EDPACT) TO CPHPH1 OF EEEMAS-REC.
           MOVE CPHPH2 OF EETDEP(EDPACT) TO CPHPH2 OF EEEMAS-REC.
           MOVE CPHPH3 OF EETDEP(EDPACT) TO CPHPH3 OF EEEMAS-REC.
           MOVE CPWPH1 OF EETDEP(EDPACT) TO CPWPH1 OF EEEMAS-REC.
           MOVE CPWPH2 OF EETDEP(EDPACT) TO CPWPH2 OF EEEMAS-REC.
           MOVE CPWPH3 OF EETDEP(EDPACT) TO CPWPH3 OF EEEMAS-REC.
           MOVE CPWEXT OF EETDEP(EDPACT) TO CPWEXT OF EEEMAS-REC.
           MOVE CFAXNB OF EETDEP(EDPACT) TO CFAXNB OF EEEMAS-REC.
           MOVE COTHPH OF EETDEP(EDPACT) TO COTHPH OF EEEMAS-REC.
           MOVE CEMLIN OF EETDEP(EDPACT) TO CEMLIN OF EEEMAS-REC.
           MOVE CEMAIL OF EETDEP(EDPACT) TO CEMAIL OF EEEMAS-REC.
           MOVE CPADR1 OF EETDEP(EDPACT) TO CPADR1 OF EEEMAS-REC.
           MOVE CPADR2 OF EETDEP(EDPACT) TO CPADR2 OF EEEMAS-REC.
           MOVE CPCITY OF EETDEP(EDPACT) TO CPCITY OF EEEMAS-REC.
           MOVE CPSTAT OF EETDEP(EDPACT) TO CPSTAT OF EEEMAS-REC.
           MOVE CPZCOD OF EETDEP(EDPACT) TO CPZCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETDEP(EDPACT) TO CCNTRY OF EEEMAS-REC.
           MOVE WRKLOC OF EETDEP(EDPACT) TO WRKLOC OF EEEMAS-REC.
           MOVE SSNXRF OF EETDEP(EDPACT) TO SSNXRF OF EEEMAS-REC.
           MOVE HICNNO OF EETDEP(EDPACT) TO HICNNO OF EEEMAS-REC.
           MOVE PEBTFS OF EETDEP(EDPACT) TO PEBTFS OF EEEMAS-REC.
           MOVE MMDIND OF EETDEP(EDPACT) TO MMDIND OF EEEMAS-REC.
           MOVE MMANUM OF EETDEP(EDPACT) TO MMANUM OF EEEMAS-REC.
           MOVE MMAEFF OF EETDEP(EDPACT) TO MMAEFF OF EEEMAS-REC.
           MOVE MIDNUM OF EETDEP(EDPACT) TO MIDNUM OF EEEMAS-REC.
           MOVE MCTCOD OF EETDEP(EDPACT) TO MCTCOD OF EEEMAS-REC.
           MOVE MCTEFF OF EETDEP(EDPACT) TO MCTEFF OF EEEMAS-REC.
           MOVE MPSCOD OF EETDEP(EDPACT) TO MPSCOD OF EEEMAS-REC.
           MOVE MCASNO OF EETDEP(EDPACT) TO MCASNO OF EEEMAS-REC.
           MOVE MCAPCD OF EETDEP(EDPACT) TO MCAPCD OF EEEMAS-REC.
           MOVE MMCEXC OF EETDEP(EDPACT) TO MMCEXC OF EEEMAS-REC.
           MOVE MMCIND OF EETDEP(EDPACT) TO MMCIND OF EEEMAS-REC.
           MOVE MPLNCD OF EETDEP(EDPACT) TO MPLNCD OF EEEMAS-REC.
           MOVE MSPRCD OF EETDEP(EDPACT) TO MSPRCD OF EEEMAS-REC.
           MOVE MPAEDT OF EETDEP(EDPACT) TO MPAEDT OF EEEMAS-REC.
           MOVE MPAETD OF EETDEP(EDPACT) TO MPAETD OF EEEMAS-REC.
           MOVE MPAEFD OF EETDEP(EDPACT) TO MPAEFD OF EEEMAS-REC.
           MOVE MPATDT OF EETDEP(EDPACT) TO MPATDT OF EEEMAS-REC.
           MOVE MPBEDT OF EETDEP(EDPACT) TO MPBEDT OF EEEMAS-REC.
           MOVE MPBETD OF EETDEP(EDPACT) TO MPBETD OF EEEMAS-REC.
           MOVE MPBEFD OF EETDEP(EDPACT) TO MPBEFD OF EEEMAS-REC.
           MOVE MPBTDT OF EETDEP(EDPACT) TO MPBTDT OF EEEMAS-REC.
           MOVE CRDCNT OF EETDEP(EDPACT) TO CRDCNT OF EEEMAS-REC.
           MOVE MHCIND OF EETDEP(EDPACT) TO MHCIND OF EEEMAS-REC.
           MOVE INDUPD OF EETDEP(EDPACT) TO INDUPD OF EEEMAS-REC.
           MOVE OMEDAT OF EETDEP(EDPACT) TO OMEDAT OF EEEMAS-REC.
           MOVE CRDMTH OF EETDEP(EDPACT) TO CRDMTH OF EEEMAS-REC.
           MOVE USRFL1 OF EETDEP(EDPACT) TO USRFL1 OF EEEMAS-REC.
           MOVE USRFL2 OF EETDEP(EDPACT) TO USRFL2 OF EEEMAS-REC.
           MOVE USRFL3 OF EETDEP(EDPACT) TO USRFL3 OF EEEMAS-REC.
           MOVE ACCTN2 OF EETDEP(EDPACT) TO ACCTN2 OF EEEMAS-REC.
           MOVE EECOVR OF EETDEP(EDPACT) TO EECOVR OF EEEMAS-REC.
           MOVE PKGOVR OF EETDEP(EDPACT) TO PKGOVR OF EEEMAS-REC.
           MOVE CGAOVR OF EETDEP(EDPACT) TO CGAOVR OF EEEMAS-REC.
           MOVE CGTOVR OF EETDEP(EDPACT) TO CGTOVR OF EEEMAS-REC.
           MOVE DALOVR OF EETDEP(EDPACT) TO DALOVR OF EEEMAS-REC.
           MOVE SALOVR OF EETDEP(EDPACT) TO SALOVR OF EEEMAS-REC.
           MOVE CBXOVR OF EETDEP(EDPACT) TO CBXOVR OF EEEMAS-REC.
           MOVE CBEOVR OF EETDEP(EDPACT) TO CBEOVR OF EEEMAS-REC.
           MOVE APCOVR OF EETDEP(EDPACT) TO APCOVR OF EEEMAS-REC.
           MOVE SSSOVR OF EETDEP(EDPACT) TO SSSOVR OF EEEMAS-REC.
           MOVE VRCOVR OF EETDEP(EDPACT) TO VRCOVR OF EEEMAS-REC.
           MOVE RMTOVR OF EETDEP(EDPACT) TO RMTOVR OF EEEMAS-REC.
           MOVE EXTMEM OF EETDEP(EDPACT) TO EXTMEM OF EEEMAS-REC.
           MOVE EXTGRP OF EETDEP(EDPACT) TO EXTGRP OF EEEMAS-REC.
           MOVE EXTCON OF EETDEP(EDPACT) TO EXTCON OF EEEMAS-REC.
           MOVE EXTEFF OF EETDEP(EDPACT) TO EXTEFF OF EEEMAS-REC.
           MOVE EXTEXP OF EETDEP(EDPACT) TO EXTEXP OF EEEMAS-REC.
           MOVE EXTSUB OF EETDEP(EDPACT) TO EXTSUB OF EEEMAS-REC.
           MOVE EXTREL OF EETDEP(EDPACT) TO EXTREL OF EEEMAS-REC.
           MOVE HISSEQ OF EETDEP(EDPACT) TO HISSEQ OF EEEMAS-REC.
           MOVE CTLPLN OF EETDEP(EDPACT) TO CTLPLN OF EEEMAS-REC.
           MOVE PRVPLN OF EETDEP(EDPACT) TO PRVPLN OF EEEMAS-REC.
           MOVE PRVNET OF EETDEP(EDPACT) TO PRVNET OF EEEMAS-REC.
           MOVE PROCOD OF EETDEP(EDPACT) TO PROCOD OF EEEMAS-REC.
           MOVE BILMOD OF EETDEP(EDPACT) TO BILMOD OF EEEMAS-REC.
           MOVE BEGMTH OF EETDEP(EDPACT) TO BEGMTH OF EEEMAS-REC.
           MOVE IMDBIL OF EETDEP(EDPACT) TO IMDBIL OF EEEMAS-REC.
           MOVE INTBIL OF EETDEP(EDPACT) TO INTBIL OF EEEMAS-REC.
           MOVE BILCYC OF EETDEP(EDPACT) TO BILCYC OF EEEMAS-REC.
           MOVE SALAMT OF EETDEP(EDPACT) TO SALAMT OF EEEMAS-REC.
           MOVE PAYLOC OF EETDEP(EDPACT) TO PAYLOC OF EEEMAS-REC.
           MOVE PAYNUM OF EETDEP(EDPACT) TO PAYNUM OF EEEMAS-REC.
           MOVE DOCNUM OF EETDEP(EDPACT) TO DOCNUM OF EEEMAS-REC.
           MOVE SALEFF OF EETDEP(EDPACT) TO SALEFF OF EEEMAS-REC.
           MOVE SALEXP OF EETDEP(EDPACT) TO SALEXP OF EEEMAS-REC.
           MOVE OTHINS OF EETDEP(EDPACT) TO OTHINS OF EEEMAS-REC.
           MOVE COBDAT OF EETDEP(EDPACT) TO COBDAT OF EEEMAS-REC.
           MOVE PRICOD OF EETDEP(EDPACT) TO PRICOD OF EEEMAS-REC.
           MOVE MEMNUM OF EETDEP(EDPACT) TO MEMNUM OF EEEMAS-REC.
           MOVE GRPPOL OF EETDEP(EDPACT) TO GRPPOL OF EEEMAS-REC.
           MOVE OINNUM OF EETDEP(EDPACT) TO OINNUM OF EEEMAS-REC.
           MOVE OINNAM OF EETDEP(EDPACT) TO OINNAM OF EEEMAS-REC.
           IF MEDCOV OF EETDEP(EDPACT) = SPACES
              MOVE 'N'                   TO MEDCOV OF EEEMAS-REC
           ELSE
              MOVE MEDCOV OF EETDEP(EDPACT)
                                        TO MEDCOV OF EEEMAS-REC.
           IF DENCOV OF EETDEP(EDPACT) = SPACES
              MOVE 'N'                   TO DENCOV OF EEEMAS-REC
           ELSE
              MOVE DENCOV OF EETDEP(EDPACT)
                                       TO DENCOV OF EEEMAS-REC.
           MOVE COVEFF OF EETDEP(EDPACT) TO COVEFF OF EEEMAS-REC.
           MOVE COVEXP OF EETDEP(EDPACT) TO COVEXP OF EEEMAS-REC.
           MOVE CQLECD OF EETDEP(EDPACT) TO CQLECD OF EEEMAS-REC.
           MOVE COBRAQ OF EETDEP(EDPACT) TO COBRAQ OF EEEMAS-REC.
           MOVE COBRAB OF EETDEP(EDPACT) TO COBRAB OF EEEMAS-REC.
           MOVE COBRAE OF EETDEP(EDPACT) TO COBRAE OF EEEMAS-REC.
           MOVE EMSTCD OF EETDEP(EDPACT) TO EMSTCD OF EEEMAS-REC.
           MOVE DETDAT OF EETDEP(EDPACT) TO DETDAT OF EEEMAS-REC.
           MOVE MARSTA OF EETDEP(EDPACT) TO MARSTA OF EEEMAS-REC.
           MOVE DETTYP OF EETDEP(EDPACT) TO DETTYP OF EEEMAS-REC.
           MOVE EXTIND OF EETDEP(EDPACT) TO EXTIND OF EEEMAS-REC.
           MOVE CITZEN OF EETDEP(EDPACT) TO CITZEN OF EEEMAS-REC.
           MOVE FRQCOD OF EETDEP(EDPACT) TO FRQCOD OF EEEMAS-REC.
           MOVE WAGAMT OF EETDEP(EDPACT) TO WAGAMT OF EEEMAS-REC.
           MOVE WRKHRS OF EETDEP(EDPACT) TO WRKHRS OF EEEMAS-REC.
           MOVE WORKLC OF EETDEP(EDPACT) TO WORKLC OF EEEMAS-REC.
           MOVE SALGRD OF EETDEP(EDPACT) TO SALGRD OF EEEMAS-REC.
           MOVE HLTCOD OF EETDEP(EDPACT) TO HLTCOD OF EEEMAS-REC.
           MOVE HEIGHT OF EETDEP(EDPACT) TO HEIGHT OF EEEMAS-REC.
           MOVE WEIGHT OF EETDEP(EDPACT) TO WEIGHT OF EEEMAS-REC.
           MOVE LNGCD1 OF EETDEP(EDPACT) TO LNGCD1 OF EEEMAS-REC.
           MOVE LNGUS1 OF EETDEP(EDPACT) TO LNGUS1 OF EEEMAS-REC.
           MOVE LNGCD2 OF EETDEP(EDPACT) TO LNGCD2 OF EEEMAS-REC.
           MOVE LNGUS2 OF EETDEP(EDPACT) TO LNGUS2 OF EEEMAS-REC.
           MOVE LNGCD3 OF EETDEP(EDPACT) TO LNGCD3 OF EEEMAS-REC.
           MOVE LNGUS3 OF EETDEP(EDPACT) TO LNGUS3 OF EEEMAS-REC.
           MOVE LNGCD4 OF EETDEP(EDPACT) TO LNGCD4 OF EEEMAS-REC.
           MOVE LNGUS4 OF EETDEP(EDPACT) TO LNGUS4 OF EEEMAS-REC.
           MOVE LNGCD5 OF EETDEP(EDPACT) TO LNGCD5 OF EEEMAS-REC.
           MOVE LNGUS5 OF EETDEP(EDPACT) TO LNGUS5 OF EEEMAS-REC.
           MOVE SCHOOL OF EETDEP(EDPACT) TO SCHOOL OF EEEMAS-REC.
           MOVE SPHNUM OF EETDEP(EDPACT) TO SPHNUM OF EEEMAS-REC.
           MOVE SPHEXT OF EETDEP(EDPACT) TO SPHEXT OF EEEMAS-REC.
           MOVE SFAXNB OF EETDEP(EDPACT) TO SFAXNB OF EEEMAS-REC.
           MOVE SEMAIL OF EETDEP(EDPACT) TO SEMAIL OF EEEMAS-REC.
           MOVE SADRL1 OF EETDEP(EDPACT) TO SADRL1 OF EEEMAS-REC.
           MOVE SADRL2 OF EETDEP(EDPACT) TO SADRL2 OF EEEMAS-REC.
           MOVE SCTYCD OF EETDEP(EDPACT) TO SCTYCD OF EEEMAS-REC.
           MOVE SSTACD OF EETDEP(EDPACT) TO SSTACD OF EEEMAS-REC.
           MOVE SZIPCD OF EETDEP(EDPACT) TO SZIPCD OF EEEMAS-REC.
           MOVE SCNTRY OF EETDEP(EDPACT) TO SCNTRY OF EEEMAS-REC.
           MOVE RSPIND OF EETDEP(EDPACT) TO RSPIND OF EEEMAS-REC.
           MOVE RSPIDC OF EETDEP(EDPACT) TO RSPIDC OF EEEMAS-REC.
           MOVE RSPLST OF EETDEP(EDPACT) TO RSPLST OF EEEMAS-REC.
           MOVE RSPFST OF EETDEP(EDPACT) TO RSPFST OF EEEMAS-REC.
           MOVE RSPMID OF EETDEP(EDPACT) TO RSPMID OF EEEMAS-REC.
           MOVE RSPTTL OF EETDEP(EDPACT) TO RSPTTL OF EEEMAS-REC.
           MOVE RSPFRM OF EETDEP(EDPACT) TO RSPFRM OF EEEMAS-REC.
           MOVE RESPNB OF EETDEP(EDPACT) TO RESPNB OF EEEMAS-REC.
           MOVE RHOMPH OF EETDEP(EDPACT) TO RHOMPH OF EEEMAS-REC.
           MOVE RWRKPH OF EETDEP(EDPACT) TO RWRKPH OF EEEMAS-REC.
           MOVE RSPEXT OF EETDEP(EDPACT) TO RSPEXT OF EEEMAS-REC.
           MOVE RFAXNB OF EETDEP(EDPACT) TO RFAXNB OF EEEMAS-REC.
           MOVE ROTHPH OF EETDEP(EDPACT) TO ROTHPH OF EEEMAS-REC.
           MOVE REMLIN OF EETDEP(EDPACT) TO REMLIN OF EEEMAS-REC.
           MOVE REMAIL OF EETDEP(EDPACT) TO REMAIL OF EEEMAS-REC.
           MOVE RCNTCT OF EETDEP(EDPACT) TO RCNTCT OF EEEMAS-REC.
           MOVE RADLN1 OF EETDEP(EDPACT) TO RADLN1 OF EEEMAS-REC.
           MOVE RADLN2 OF EETDEP(EDPACT) TO RADLN2 OF EEEMAS-REC.
           MOVE RCTYCD OF EETDEP(EDPACT) TO RCTYCD OF EEEMAS-REC.
           MOVE RSTACD OF EETDEP(EDPACT) TO RSTACD OF EEEMAS-REC.
           MOVE RZIPCD OF EETDEP(EDPACT) TO RZIPCD OF EEEMAS-REC.
           MOVE RCNTRY OF EETDEP(EDPACT) TO RCNTRY OF EEEMAS-REC.
           MOVE BENIND OF EETDEP(EDPACT) TO BENIND OF EEEMAS-REC.
           MOVE HSAIND OF EETDEP(EDPACT) TO HSAIND OF EEEMAS-REC.
           MOVE HRAIND OF EETDEP(EDPACT) TO HRAIND OF EEEMAS-REC.
           MOVE FSAIND OF EETDEP(EDPACT) TO FSAIND OF EEEMAS-REC.
           MOVE OTHIND OF EETDEP(EDPACT) TO OTHIND OF EEEMAS-REC.
           MOVE MPDIND OF EETDEP(EDPACT) TO MPDIND OF EEEMAS-REC.
           MOVE PHAIND OF EETDEP(EDPACT) TO PHAIND OF EEEMAS-REC.
           MOVE DENIND OF EETDEP(EDPACT) TO DENIND OF EEEMAS-REC.
           MOVE VISIND OF EETDEP(EDPACT) TO VISIND OF EEEMAS-REC.
           MOVE MHTIND OF EETDEP(EDPACT) TO MHTIND OF EEEMAS-REC.
           MOVE OTHBEN OF EETDEP(EDPACT) TO OTHBEN OF EEEMAS-REC.
           MOVE ALTIND OF EETDEP(EDPACT) TO ALTIND OF EEEMAS-REC.
           MOVE ALTAD1 OF EETDEP(EDPACT) TO ALTAD1 OF EEEMAS-REC.
           MOVE ALTAD2 OF EETDEP(EDPACT) TO ALTAD2 OF EEEMAS-REC.
           MOVE ALTCTY OF EETDEP(EDPACT) TO ALTCTY OF EEEMAS-REC.
           MOVE ALTSTT OF EETDEP(EDPACT) TO ALTSTT OF EEEMAS-REC.
           MOVE ALTPST OF EETDEP(EDPACT) TO ALTPST OF EEEMAS-REC.
           MOVE ALTCNR OF EETDEP(EDPACT) TO ALTCNR OF EEEMAS-REC.
           MOVE OLDMAR OF EETDEP(EDPACT) TO OLDMAR OF EEEMAS-REC.
           MOVE OLDRCD OF EETDEP(EDPACT) TO OLDRCD OF EEEMAS-REC.
           MOVE OLDCTZ OF EETDEP(EDPACT) TO OLDCTZ OF EEEMAS-REC.
           MOVE SCHCLK OF EETDEP(EDPACT) TO SCHCLK OF EEEMAS-REC.
           MOVE CNFCOD OF EETDEP(EDPACT) TO CNFCOD OF EEEMAS-REC.
           MOVE CALTPH OF EETDEP(EDPACT) TO CALTPH OF EEEMAS-REC.
           MOVE CBEPNB OF EETDEP(EDPACT) TO CBEPNB OF EEEMAS-REC.
           MOVE CCELPH OF EETDEP(EDPACT) TO CCELPH OF EEEMAS-REC.
           MOVE RALTPH OF EETDEP(EDPACT) TO RALTPH OF EEEMAS-REC.
           MOVE RBEPNB OF EETDEP(EDPACT) TO RBEPNB OF EEEMAS-REC.
           MOVE RCELPH OF EETDEP(EDPACT) TO RCELPH OF EEEMAS-REC.
           MOVE ALTPHN OF EETDEP(EDPACT) TO ALTPHN OF EEEMAS-REC.
           MOVE BEPNBR OF EETDEP(EDPACT) TO BEPNBR OF EEEMAS-REC.
           MOVE CELPHN OF EETDEP(EDPACT) TO CELPHN OF EEEMAS-REC.
           MOVE EXCMEM OF EETDEP(EDPACT) TO EXCMEM OF EEEMAS-REC.
           MOVE EXCSUB OF EETDEP(EDPACT) TO EXCSUB OF EEEMAS-REC.
           MOVE PRVSUB OF EETDEP(EDPACT) TO PRVSUB OF EEEMAS-REC.
           MOVE SMKCES OF EETDEP(EDPACT) TO SMKCES OF EEEMAS-REC.
           MOVE REPNAM OF EETDEP(EDPACT) TO REPNAM OF EEEMAS-REC.
           MOVE REPRFQ OF EETDEP(EDPACT) TO REPRFQ OF EEEMAS-REC.
           MOVE REPREF OF EETDEP(EDPACT) TO REPREF OF EEEMAS-REC.
           MOVE REPEFQ OF EETDEP(EDPACT) TO REPEFQ OF EEEMAS-REC.
           MOVE REPEFF OF EETDEP(EDPACT) TO REPEFF OF EEEMAS-REC.
           MOVE OPYAMT OF EETDEP(EDPACT) TO OPYAMT OF EEEMAS-REC.
           MOVE OPYEFF OF EETDEP(EDPACT) TO OPYEFF OF EEEMAS-REC.
           MOVE OPYEXP OF EETDEP(EDPACT) TO OPYEXP OF EEEMAS-REC.
           MOVE OPYSRC OF EETDEP(EDPACT) TO OPYSRC OF EEEMAS-REC.
           MOVE APTAMT OF EETDEP(EDPACT) TO APTAMT OF EEEMAS-REC.
           MOVE APTEFF OF EETDEP(EDPACT) TO APTEFF OF EEEMAS-REC.
           MOVE APTEXP OF EETDEP(EDPACT) TO APTEXP OF EEEMAS-REC.
           MOVE CSRAMT OF EETDEP(EDPACT) TO CSRAMT OF EEEMAS-REC.
           MOVE CSREFF OF EETDEP(EDPACT) TO CSREFF OF EEEMAS-REC.
           MOVE CSREXP OF EETDEP(EDPACT) TO CSREXP OF EEEMAS-REC.
           MOVE PREAMT OF EETDEP(EDPACT) TO PREAMT OF EEEMAS-REC.
           MOVE PREEFF OF EETDEP(EDPACT) TO PREEFF OF EEEMAS-REC.
           MOVE PREEXP OF EETDEP(EDPACT) TO PREEXP OF EEEMAS-REC.
           MOVE RSPTOT OF EETDEP(EDPACT) TO RSPTOT OF EEEMAS-REC.
           MOVE RSPEFF OF EETDEP(EDPACT) TO RSPEFF OF EEEMAS-REC.
           MOVE RSPEXP OF EETDEP(EDPACT) TO RSPEXP OF EEEMAS-REC.
           MOVE PRETOT OF EETDEP(EDPACT) TO PRETOT OF EEEMAS-REC.
           MOVE PTOEFF OF EETDEP(EDPACT) TO PTOEFF OF EEEMAS-REC.
           MOVE PTOEXP OF EETDEP(EDPACT) TO PTOEXP OF EEEMAS-REC.
           MOVE EMPTOT OF EETDEP(EDPACT) TO EMPTOT OF EEEMAS-REC.
           MOVE EMPEFF OF EETDEP(EDPACT) TO EMPEFF OF EEEMAS-REC.
           MOVE EMPEXP OF EETDEP(EDPACT) TO EMPEXP OF EEEMAS-REC.
           MOVE EXCHNG OF EETDEP(EDPACT) TO EXCHNG OF EEEMAS-REC.
           MOVE COUNTY OF EETDEP(EDPACT) TO COUNTY OF EEEMAS-REC.
           MOVE ETHCD1 OF EETDEP(EDPACT) TO ETHCD1 OF EEEMAS-REC.
           MOVE ETHCD2 OF EETDEP(EDPACT) TO ETHCD2 OF EEEMAS-REC.
           MOVE ETHCD3 OF EETDEP(EDPACT) TO ETHCD3 OF EEEMAS-REC.
           MOVE ETHCD4 OF EETDEP(EDPACT) TO ETHCD4 OF EEEMAS-REC.
           MOVE ETHCD5 OF EETDEP(EDPACT) TO ETHCD5 OF EEEMAS-REC.
           MOVE ETHCD6 OF EETDEP(EDPACT) TO ETHCD6 OF EEEMAS-REC.
           MOVE ETHCD7 OF EETDEP(EDPACT) TO ETHCD7 OF EEEMAS-REC.
           MOVE ETHCD8 OF EETDEP(EDPACT) TO ETHCD8 OF EEEMAS-REC.
           MOVE ETHCD9 OF EETDEP(EDPACT) TO ETHCD9 OF EEEMAS-REC.
           MOVE REQTIM OF EETDEP(EDPACT) TO REQTIM OF EEEMAS-REC.
           MOVE REQEFF OF EETDEP(EDPACT) TO REQEFF OF EEEMAS-REC.
           MOVE REQEXP OF EETDEP(EDPACT) TO REQEXP OF EEEMAS-REC.
           MOVE TENTID OF EETDEP(EDPACT) TO TENTID OF EEEMAS-REC.
           MOVE TENEFF OF EETDEP(EDPACT) TO TENEFF OF EEEMAS-REC.
           MOVE TENEXP OF EETDEP(EDPACT) TO TENEXP OF EEEMAS-REC.
           MOVE SEPREA OF EETDEP(EDPACT) TO SEPREA OF EEEMAS-REC.
           MOVE SEPEFF OF EETDEP(EDPACT) TO SEPEFF OF EEEMAS-REC.
           MOVE SEPEXP OF EETDEP(EDPACT) TO SEPEXP OF EEEMAS-REC.
           MOVE REACAT OF EETDEP(EDPACT) TO REACAT OF EEEMAS-REC.
           MOVE REAEFF OF EETDEP(EDPACT) TO REAEFF OF EEEMAS-REC.
           MOVE REAEXP OF EETDEP(EDPACT) TO REAEXP OF EEEMAS-REC.
      *
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF EEEMAS-REC.
           MOVE CTLNUM OF EEWHDR-WRK   TO CTLNUM OF EEEMAS-REC.
           MOVE TRNDAT OF EEWHDR-WRK   TO TRNDAT OF EEEMAS-REC.
           MOVE TRNTIM OF EEWHDR-WRK   TO TRNTIM OF EEEMAS-REC.
           MOVE TRANID OF EEWHDR-WRK   TO TRANID OF EEEMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF EEEMAS-REC
                                          LSTCHG OF EEEMAS-REC.
           MOVE 'ED201C'               TO USERID OF EEEMAS-REC.
           MOVE 'EDI'                  TO TERMID OF EEEMAS-REC.
      *
           PERFORM A250-LOAD-MEMERR           THRU A259-EXIT.
      *
           MOVE 'Y'                              TO WRITTEN-FLAG.
      *
           PERFORM EEEMAS-WRITE                  IF INVALID-KEY
              IF EEEMAS-STATUS = '22'
                 GO TO A919-EXIT
              ELSE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                 TO PRCERR OF PGM-WORK
                 MOVE 'EEEMAS'                      TO MI-PARM4
                 MOVE EEEMAS-STATUS                 TO MI-PARM5
                 MOVE 'EI06062'                     TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
       A919-EXIT.
           EXIT.
      *
       A920-ERR-SUB.
      *********************************************************
      *‚ADD ERRORRED SUB TO EEEMAS
      *********************************************************
           IF REC-WRITTEN
              GO TO A929-EXIT.
      *
           MOVE SPACES                           TO EEEMAS-REC.
      *
           INITIALIZE EEEMAS-REC.
           MOVE RECTYP OF EETSUB(ESBACT) TO RECTYP OF EEEMAS-REC.
           MOVE GRPNUM OF EETSUB(ESBACT) TO GRPNUM OF EEEMAS-REC.
           MOVE SUBSNO OF EETSUB(ESBACT) TO SUBSNO OF EEEMAS-REC.
           MOVE RELCOD OF EETSUB(ESBACT) TO RELCOD OF EEEMAS-REC.
           MOVE RELTYP OF EETSUB(ESBACT) TO RELTYP OF EEEMAS-REC.
           MOVE MEMBNO OF EETSUB(ESBACT) TO MEMBNO OF EEEMAS-REC.
           MOVE BTHDAT OF EETSUB(ESBACT) TO BTHDAT OF EEEMAS-REC.
           MOVE BTHSEQ OF EETSUB(ESBACT) TO BTHSEQ OF EEEMAS-REC.
           MOVE BTHCHG OF EETSUB(ESBACT) TO BTHCHG OF EEEMAS-REC.
           MOVE SEXCOD OF EETSUB(ESBACT) TO SEXCOD OF EEEMAS-REC.
           MOVE SEXCHG OF EETSUB(ESBACT) TO SEXCHG OF EEEMAS-REC.
           MOVE CHGTYP OF EETSUB(ESBACT) TO CHGTYP OF EEEMAS-REC.
           MOVE CHGDAT OF EETSUB(ESBACT) TO CHGDAT OF EEEMAS-REC.
           MOVE CHGTIM OF EETSUB(ESBACT) TO CHGTIM OF EEEMAS-REC.
           MOVE CHGEFF OF EETSUB(ESBACT) TO CHGEFF OF EEEMAS-REC.
           MOVE NAMCHG OF EETSUB(ESBACT) TO NAMCHG OF EEEMAS-REC.
           MOVE FSTNAM OF EETSUB(ESBACT) TO FSTNAM OF EEEMAS-REC.
           MOVE LSTNAM OF EETSUB(ESBACT) TO LSTNAM OF EEEMAS-REC.
           MOVE MIDNAM OF EETSUB(ESBACT) TO MIDNAM OF EEEMAS-REC.
           MOVE TITLCD OF EETSUB(ESBACT) TO TITLCD OF EEEMAS-REC.
           MOVE FORNAM OF EETSUB(ESBACT) TO FORNAM OF EEEMAS-REC.
           MOVE MEMCHG OF EETSUB(ESBACT) TO MEMCHG OF EEEMAS-REC.
           MOVE EMPSTA OF EETSUB(ESBACT) TO EMPSTA OF EEEMAS-REC.
           MOVE PRTCOD OF EETSUB(ESBACT) TO PRTCOD OF EEEMAS-REC.
           MOVE MEMEFF OF EETSUB(ESBACT) TO MEMEFF OF EEEMAS-REC.
           MOVE MEMEXP OF EETSUB(ESBACT) TO MEMEXP OF EEEMAS-REC.
           MOVE MEMREA OF EETSUB(ESBACT) TO MEMREA OF EEEMAS-REC.
           MOVE MEMTRM OF EETSUB(ESBACT) TO MEMTRM OF EEEMAS-REC.
           MOVE DEMCHG OF EETSUB(ESBACT) TO DEMCHG OF EEEMAS-REC.
           MOVE ADRLN1 OF EETSUB(ESBACT) TO ADRLN1 OF EEEMAS-REC.
           MOVE ADRLN2 OF EETSUB(ESBACT) TO ADRLN2 OF EEEMAS-REC.
           MOVE CITYCD OF EETSUB(ESBACT) TO CITYCD OF EEEMAS-REC.
           MOVE STATCD OF EETSUB(ESBACT) TO STACOD OF EEEMAS-REC.
           MOVE ZIPCOD OF EETSUB(ESBACT) TO ZIPCOD OF EEEMAS-REC.
           MOVE CTRYCD OF EETSUB(ESBACT) TO CTRYCD OF EEEMAS-REC.
           MOVE LOCQLF OF EETSUB(ESBACT) TO LOCQLF OF EEEMAS-REC.
           MOVE AREACD OF EETSUB(ESBACT) TO AREACD OF EEEMAS-REC.
           MOVE HOMPH1 OF EETSUB(ESBACT) TO HOMPH1 OF EEEMAS-REC.
           MOVE HOMPH2 OF EETSUB(ESBACT) TO HOMPH2 OF EEEMAS-REC.
           MOVE HOMPH3 OF EETSUB(ESBACT) TO HOMPH3 OF EEEMAS-REC.
           MOVE WRKPH1 OF EETSUB(ESBACT) TO WRKPH1 OF EEEMAS-REC.
           MOVE WRKPH2 OF EETSUB(ESBACT) TO WRKPH2 OF EEEMAS-REC.
           MOVE WRKPH3 OF EETSUB(ESBACT) TO WRKPH3 OF EEEMAS-REC.
           MOVE WRKEXT OF EETSUB(ESBACT) TO WRKEXT OF EEEMAS-REC.
           MOVE FAXNUM OF EETSUB(ESBACT) TO FAXNUM OF EEEMAS-REC.
           MOVE OTHPHN OF EETSUB(ESBACT) TO OTHPHN OF EEEMAS-REC.
           MOVE EMLIND OF EETSUB(ESBACT) TO EMLIND OF EEEMAS-REC.
           MOVE ELMAIL OF EETSUB(ESBACT) TO ELMAIL OF EEEMAS-REC.
           MOVE HIRDAT OF EETSUB(ESBACT) TO HIRDAT OF EEEMAS-REC.
           MOVE TRMDAT OF EETSUB(ESBACT) TO TRMDAT OF EEEMAS-REC.
           MOVE SOCSEC OF EETSUB(ESBACT) TO SOCSEC OF EEEMAS-REC.
           MOVE OLDLST OF EETSUB(ESBACT) TO OLDLST OF EEEMAS-REC.
           MOVE OLDFST OF EETSUB(ESBACT) TO OLDFST OF EEEMAS-REC.
           MOVE OLDMID OF EETSUB(ESBACT) TO OLDMID OF EEEMAS-REC.
           MOVE OLDTLC OF EETSUB(ESBACT) TO OLDTLC OF EEEMAS-REC.
           MOVE OLDSSN OF EETSUB(ESBACT) TO OLDSSN OF EEEMAS-REC.
           MOVE OLDBTH OF EETSUB(ESBACT) TO OLDBTH OF EEEMAS-REC.
           MOVE OLDSEX OF EETSUB(ESBACT) TO OLDSEX OF EEEMAS-REC.
           MOVE RACECD OF EETSUB(ESBACT) TO RACECD OF EEEMAS-REC.
           MOVE TYPCOD OF EETSUB(ESBACT) TO TYPCOD OF EEEMAS-REC.
           MOVE HOLDCD OF EETSUB(ESBACT) TO HOLDCD OF EEEMAS-REC.
           MOVE MEMSTA OF EETSUB(ESBACT) TO MEMSTA OF EEEMAS-REC.
           MOVE STUSTA OF EETSUB(ESBACT) TO STUSTA OF EEEMAS-REC.
           MOVE EDUBEG OF EETSUB(ESBACT) TO EDUBEG OF EEEMAS-REC.
           MOVE EDUEND OF EETSUB(ESBACT) TO EDUEND OF EEEMAS-REC.
           MOVE HNDIND OF EETSUB(ESBACT) TO HNDIND OF EEEMAS-REC.
           MOVE AUTEXP OF EETSUB(ESBACT) TO AUTEXP OF EEEMAS-REC.
           MOVE ALTNUM OF EETSUB(ESBACT) TO ALTNUM OF EEEMAS-REC.
           MOVE INTKCD OF EETSUB(ESBACT) TO INTKCD OF EEEMAS-REC.
           MOVE PCPCHG OF EETSUB(ESBACT) TO PCPCHG OF EEEMAS-REC.
           MOVE PCPCOD OF EETSUB(ESBACT) TO PCPCOD OF EEEMAS-REC.
           MOVE PCPORG OF EETSUB(ESBACT) TO PCPORG OF EEEMAS-REC.
           MOVE PCPOVR OF EETSUB(ESBACT) TO PCPOVR OF EEEMAS-REC.
           MOVE PCPMCP OF EETSUB(ESBACT) TO PCPMCP OF EEEMAS-REC.
           MOVE PCPEFF OF EETSUB(ESBACT) TO PCPEFF OF EEEMAS-REC.
           MOVE PCPEXP OF EETSUB(ESBACT) TO PCPEXP OF EEEMAS-REC.
           MOVE PCPREA OF EETSUB(ESBACT) TO PCPREA OF EEEMAS-REC.
           MOVE PCPTRM OF EETSUB(ESBACT) TO PCPTRM OF EEEMAS-REC.
           MOVE SECCHG OF EETSUB(ESBACT) TO SECCHG OF EEEMAS-REC.
           MOVE SECCOD OF EETSUB(ESBACT) TO SECCOD OF EEEMAS-REC.
           MOVE SECORG OF EETSUB(ESBACT) TO SECORG OF EEEMAS-REC.
           MOVE SECOVR OF EETSUB(ESBACT) TO SECOVR OF EEEMAS-REC.
           MOVE SECMCP OF EETSUB(ESBACT) TO SECMCP OF EEEMAS-REC.
           MOVE SECEFF OF EETSUB(ESBACT) TO SECEFF OF EEEMAS-REC.
           MOVE SECEXP OF EETSUB(ESBACT) TO SECEXP OF EEEMAS-REC.
           MOVE SECREA OF EETSUB(ESBACT) TO SECREA OF EEEMAS-REC.
           MOVE SECTRM OF EETSUB(ESBACT) TO SECTRM OF EEEMAS-REC.
           MOVE MEDCHG OF EETSUB(ESBACT) TO MEDCHG OF EEEMAS-REC.
           MOVE MEDCTY OF EETSUB(ESBACT) TO MEDCTY OF EEEMAS-REC.
           MOVE MEDSTS OF EETSUB(ESBACT) TO MEDSTS OF EEEMAS-REC.
           MOVE MEDEFF OF EETSUB(ESBACT) TO MEDEFF OF EEEMAS-REC.
           MOVE MEDEXP OF EETSUB(ESBACT) TO MEDEXP OF EEEMAS-REC.
           MOVE MEDREA OF EETSUB(ESBACT) TO MEDREA OF EEEMAS-REC.
           MOVE MEDTRM OF EETSUB(ESBACT) TO MEDTRM OF EEEMAS-REC.
           MOVE FEECHG OF EETSUB(ESBACT) TO FEECHG OF EEEMAS-REC.
           MOVE FEECOD OF EETSUB(ESBACT) TO FEECOD OF EEEMAS-REC.
           MOVE FEEEFF OF EETSUB(ESBACT) TO FEEEFF OF EEEMAS-REC.
           MOVE FEEEXP OF EETSUB(ESBACT) TO FEEEXP OF EEEMAS-REC.
           MOVE FEEREA OF EETSUB(ESBACT) TO FEEREA OF EEEMAS-REC.
           MOVE FEETRM OF EETSUB(ESBACT) TO FEETRM OF EEEMAS-REC.
           MOVE ENBCHG OF EETSUB(ESBACT) TO ENBCHG OF EEEMAS-REC.
           MOVE ACCTNO OF EETSUB(ESBACT) TO ACCTNO OF EEEMAS-REC.
           MOVE TIRCAL OF EETSUB(ESBACT) TO TIRCAL OF EEEMAS-REC.
           MOVE TIERCD OF EETSUB(ESBACT) TO TIERCD OF EEEMAS-REC.
           MOVE TIRFLG OF EETSUB(ESBACT) TO TIRFLG OF EEEMAS-REC.
           MOVE BENPKG OF EETSUB(ESBACT) TO BENPKG OF EEEMAS-REC.
           MOVE BILEXC OF EETSUB(ESBACT) TO BILEXC OF EEEMAS-REC.
           MOVE ENBEFF OF EETSUB(ESBACT) TO ENBEFF OF EEEMAS-REC.
           MOVE ENBEXP OF EETSUB(ESBACT) TO ENBEXP OF EEEMAS-REC.
           MOVE ENBREA OF EETSUB(ESBACT) TO ENBREA OF EEEMAS-REC.
           MOVE ENBTRM OF EETSUB(ESBACT) TO ENBTRM OF EEEMAS-REC.
           MOVE CPAIND OF EETSUB(ESBACT) TO CPAIND OF EEEMAS-REC.
           MOVE CPLNAM OF EETSUB(ESBACT) TO CPLNAM OF EEEMAS-REC.
           MOVE CPFNAM OF EETSUB(ESBACT) TO CPFNAM OF EEEMAS-REC.
           MOVE CPMNAM OF EETSUB(ESBACT) TO CPMNAM OF EEEMAS-REC.
           MOVE CPTITL OF EETSUB(ESBACT) TO CPTITL OF EEEMAS-REC.
           MOVE CPFORM OF EETSUB(ESBACT) TO CPFORM OF EEEMAS-REC.
           MOVE CPARNT OF EETSUB(ESBACT) TO CPARNT OF EEEMAS-REC.
           MOVE CPCONT OF EETSUB(ESBACT) TO CPCONT OF EEEMAS-REC.
           MOVE CPHPH1 OF EETSUB(ESBACT) TO CPHPH1 OF EEEMAS-REC.
           MOVE CPHPH2 OF EETSUB(ESBACT) TO CPHPH2 OF EEEMAS-REC.
           MOVE CPHPH3 OF EETSUB(ESBACT) TO CPHPH3 OF EEEMAS-REC.
           MOVE CPWPH1 OF EETSUB(ESBACT) TO CPWPH1 OF EEEMAS-REC.
           MOVE CPWPH2 OF EETSUB(ESBACT) TO CPWPH2 OF EEEMAS-REC.
           MOVE CPWPH3 OF EETSUB(ESBACT) TO CPWPH3 OF EEEMAS-REC.
           MOVE CPWEXT OF EETSUB(ESBACT) TO CPWEXT OF EEEMAS-REC.
           MOVE CFAXNB OF EETSUB(ESBACT) TO CFAXNB OF EEEMAS-REC.
           MOVE COTHPH OF EETSUB(ESBACT) TO COTHPH OF EEEMAS-REC.
           MOVE CEMLIN OF EETSUB(ESBACT) TO CEMLIN OF EEEMAS-REC.
           MOVE CEMAIL OF EETSUB(ESBACT) TO CEMAIL OF EEEMAS-REC.
           MOVE CPADR1 OF EETSUB(ESBACT) TO CPADR1 OF EEEMAS-REC.
           MOVE CPADR2 OF EETSUB(ESBACT) TO CPADR2 OF EEEMAS-REC.
           MOVE CPCITY OF EETSUB(ESBACT) TO CPCITY OF EEEMAS-REC.
           MOVE CPSTAT OF EETSUB(ESBACT) TO CPSTAT OF EEEMAS-REC.
           MOVE CPZCOD OF EETSUB(ESBACT) TO CPZCOD OF EEEMAS-REC.
           MOVE CCNTRY OF EETSUB(ESBACT) TO CCNTRY OF EEEMAS-REC.
           MOVE WRKLOC OF EETSUB(ESBACT) TO WRKLOC OF EEEMAS-REC.
           MOVE SSNXRF OF EETSUB(ESBACT) TO SSNXRF OF EEEMAS-REC.
           MOVE HICNNO OF EETSUB(ESBACT) TO HICNNO OF EEEMAS-REC.
           MOVE PEBTFS OF EETSUB(ESBACT) TO PEBTFS OF EEEMAS-REC.
           MOVE MMDIND OF EETSUB(ESBACT) TO MMDIND OF EEEMAS-REC.
           MOVE MMANUM OF EETSUB(ESBACT) TO MMANUM OF EEEMAS-REC.
           MOVE MMAEFF OF EETSUB(ESBACT) TO MMAEFF OF EEEMAS-REC.
           MOVE MIDNUM OF EETSUB(ESBACT) TO MIDNUM OF EEEMAS-REC.
           MOVE MCTCOD OF EETSUB(ESBACT) TO MCTCOD OF EEEMAS-REC.
           MOVE MCTEFF OF EETSUB(ESBACT) TO MCTEFF OF EEEMAS-REC.
           MOVE MPSCOD OF EETSUB(ESBACT) TO MPSCOD OF EEEMAS-REC.
           MOVE MCASNO OF EETSUB(ESBACT) TO MCASNO OF EEEMAS-REC.
           MOVE MCAPCD OF EETSUB(ESBACT) TO MCAPCD OF EEEMAS-REC.
           MOVE MMCEXC OF EETSUB(ESBACT) TO MMCEXC OF EEEMAS-REC.
           MOVE MMCIND OF EETSUB(ESBACT) TO MMCIND OF EEEMAS-REC.
           MOVE MPLNCD OF EETSUB(ESBACT) TO MPLNCD OF EEEMAS-REC.
           MOVE MSPRCD OF EETSUB(ESBACT) TO MSPRCD OF EEEMAS-REC.
           MOVE MPAEDT OF EETSUB(ESBACT) TO MPAEDT OF EEEMAS-REC.
           MOVE MPAETD OF EETSUB(ESBACT) TO MPAETD OF EEEMAS-REC.
           MOVE MPAEFD OF EETSUB(ESBACT) TO MPAEFD OF EEEMAS-REC.
           MOVE MPATDT OF EETSUB(ESBACT) TO MPATDT OF EEEMAS-REC.
           MOVE MPBEDT OF EETSUB(ESBACT) TO MPBEDT OF EEEMAS-REC.
           MOVE MPBETD OF EETSUB(ESBACT) TO MPBETD OF EEEMAS-REC.
           MOVE MPBEFD OF EETSUB(ESBACT) TO MPBEFD OF EEEMAS-REC.
           MOVE MPBTDT OF EETSUB(ESBACT) TO MPBTDT OF EEEMAS-REC.
           MOVE CRDCNT OF EETSUB(ESBACT) TO CRDCNT OF EEEMAS-REC.
           MOVE MHCIND OF EETSUB(ESBACT) TO MHCIND OF EEEMAS-REC.
           MOVE INDUPD OF EETSUB(ESBACT) TO INDUPD OF EEEMAS-REC.
           MOVE OMEDAT OF EETSUB(ESBACT) TO OMEDAT OF EEEMAS-REC.
           MOVE CRDMTH OF EETSUB(ESBACT) TO CRDMTH OF EEEMAS-REC.
           MOVE USRFL1 OF EETSUB(ESBACT) TO USRFL1 OF EEEMAS-REC.
           MOVE USRFL2 OF EETSUB(ESBACT) TO USRFL2 OF EEEMAS-REC.
           MOVE USRFL3 OF EETSUB(ESBACT) TO USRFL3 OF EEEMAS-REC.
           MOVE ACCTN2 OF EETSUB(ESBACT) TO ACCTN2 OF EEEMAS-REC.
           MOVE EECOVR OF EETSUB(ESBACT) TO EECOVR OF EEEMAS-REC.
           MOVE PKGOVR OF EETSUB(ESBACT) TO PKGOVR OF EEEMAS-REC.
           MOVE CGAOVR OF EETSUB(ESBACT) TO CGAOVR OF EEEMAS-REC.
           MOVE CGTOVR OF EETSUB(ESBACT) TO CGTOVR OF EEEMAS-REC.
           MOVE DALOVR OF EETSUB(ESBACT) TO DALOVR OF EEEMAS-REC.
           MOVE SALOVR OF EETSUB(ESBACT) TO SALOVR OF EEEMAS-REC.
           MOVE CBXOVR OF EETSUB(ESBACT) TO CBXOVR OF EEEMAS-REC.
           MOVE CBEOVR OF EETSUB(ESBACT) TO CBEOVR OF EEEMAS-REC.
           MOVE APCOVR OF EETSUB(ESBACT) TO APCOVR OF EEEMAS-REC.
           MOVE SSSOVR OF EETSUB(ESBACT) TO SSSOVR OF EEEMAS-REC.
           MOVE VRCOVR OF EETSUB(ESBACT) TO VRCOVR OF EEEMAS-REC.
           MOVE RMTOVR OF EETSUB(ESBACT) TO RMTOVR OF EEEMAS-REC.
           MOVE EXTMEM OF EETSUB(ESBACT) TO EXTMEM OF EEEMAS-REC.
           MOVE EXTGRP OF EETSUB(ESBACT) TO EXTGRP OF EEEMAS-REC.
           MOVE EXTCON OF EETSUB(ESBACT) TO EXTCON OF EEEMAS-REC.
           MOVE EXTEFF OF EETSUB(ESBACT) TO EXTEFF OF EEEMAS-REC.
           MOVE EXTEXP OF EETSUB(ESBACT) TO EXTEXP OF EEEMAS-REC.
           MOVE EXTSUB OF EETSUB(ESBACT) TO EXTSUB OF EEEMAS-REC.
           MOVE EXTREL OF EETSUB(ESBACT) TO EXTREL OF EEEMAS-REC.
           MOVE HISSEQ OF EETSUB(ESBACT) TO HISSEQ OF EEEMAS-REC.
           MOVE CTLPLN OF EETSUB(ESBACT) TO CTLPLN OF EEEMAS-REC.
           MOVE PRVPLN OF EETSUB(ESBACT) TO PRVPLN OF EEEMAS-REC.
           MOVE PRVNET OF EETSUB(ESBACT) TO PRVNET OF EEEMAS-REC.
           MOVE PROCOD OF EETSUB(ESBACT) TO PROCOD OF EEEMAS-REC.
           MOVE BILMOD OF EETSUB(ESBACT) TO BILMOD OF EEEMAS-REC.
           MOVE BEGMTH OF EETSUB(ESBACT) TO BEGMTH OF EEEMAS-REC.
           MOVE IMDBIL OF EETSUB(ESBACT) TO IMDBIL OF EEEMAS-REC.
           MOVE INTBIL OF EETSUB(ESBACT) TO INTBIL OF EEEMAS-REC.
           MOVE BILCYC OF EETSUB(ESBACT) TO BILCYC OF EEEMAS-REC.
           MOVE SALAMT OF EETSUB(ESBACT) TO SALAMT OF EEEMAS-REC.
           MOVE PAYLOC OF EETSUB(ESBACT) TO PAYLOC OF EEEMAS-REC.
           MOVE PAYNUM OF EETSUB(ESBACT) TO PAYNUM OF EEEMAS-REC.
           MOVE DOCNUM OF EETSUB(ESBACT) TO DOCNUM OF EEEMAS-REC.
           MOVE SALEFF OF EETSUB(ESBACT) TO SALEFF OF EEEMAS-REC.
           MOVE SALEXP OF EETSUB(ESBACT) TO SALEXP OF EEEMAS-REC.
           MOVE OTHINS OF EETSUB(ESBACT) TO OTHINS OF EEEMAS-REC.
           MOVE COBDAT OF EETSUB(ESBACT) TO COBDAT OF EEEMAS-REC.
           MOVE PRICOD OF EETSUB(ESBACT) TO PRICOD OF EEEMAS-REC.
           MOVE MEMNUM OF EETSUB(ESBACT) TO MEMNUM OF EEEMAS-REC.
           MOVE GRPPOL OF EETSUB(ESBACT) TO GRPPOL OF EEEMAS-REC.
           MOVE OINNUM OF EETSUB(ESBACT) TO OINNUM OF EEEMAS-REC.
           MOVE OINNAM OF EETSUB(ESBACT) TO OINNAM OF EEEMAS-REC.
           IF MEDCOV OF EETSUB(ESBACT) = SPACES
              MOVE 'N'                   TO MEDCOV OF EEEMAS-REC
           ELSE
              MOVE MEDCOV OF EETSUB(ESBACT)
                                        TO MEDCOV OF EEEMAS-REC.
           IF DENCOV OF EETSUB(ESBACT) = SPACES
              MOVE 'N'                   TO DENCOV OF EEEMAS-REC
           ELSE
              MOVE DENCOV OF EETSUB(ESBACT)
                                       TO DENCOV OF EEEMAS-REC.
           MOVE COVEFF OF EETSUB(ESBACT) TO COVEFF OF EEEMAS-REC.
           MOVE COVEXP OF EETSUB(ESBACT) TO COVEXP OF EEEMAS-REC.
           MOVE CQLECD OF EETSUB(ESBACT) TO CQLECD OF EEEMAS-REC.
           MOVE COBRAQ OF EETSUB(ESBACT) TO COBRAQ OF EEEMAS-REC.
           MOVE COBRAB OF EETSUB(ESBACT) TO COBRAB OF EEEMAS-REC.
           MOVE COBRAE OF EETSUB(ESBACT) TO COBRAE OF EEEMAS-REC.
           MOVE EMSTCD OF EETSUB(ESBACT) TO EMSTCD OF EEEMAS-REC.
           MOVE DETDAT OF EETSUB(ESBACT) TO DETDAT OF EEEMAS-REC.
           MOVE MARSTA OF EETSUB(ESBACT) TO MARSTA OF EEEMAS-REC.
           MOVE DETTYP OF EETSUB(ESBACT) TO DETTYP OF EEEMAS-REC.
           MOVE EXTIND OF EETSUB(ESBACT) TO EXTIND OF EEEMAS-REC.
           MOVE CITZEN OF EETSUB(ESBACT) TO CITZEN OF EEEMAS-REC.
           MOVE FRQCOD OF EETSUB(ESBACT) TO FRQCOD OF EEEMAS-REC.
           MOVE WAGAMT OF EETSUB(ESBACT) TO WAGAMT OF EEEMAS-REC.
           MOVE WRKHRS OF EETSUB(ESBACT) TO WRKHRS OF EEEMAS-REC.
           MOVE WORKLC OF EETSUB(ESBACT) TO WORKLC OF EEEMAS-REC.
           MOVE SALGRD OF EETSUB(ESBACT) TO SALGRD OF EEEMAS-REC.
           MOVE HLTCOD OF EETSUB(ESBACT) TO HLTCOD OF EEEMAS-REC.
           MOVE HEIGHT OF EETSUB(ESBACT) TO HEIGHT OF EEEMAS-REC.
           MOVE WEIGHT OF EETSUB(ESBACT) TO WEIGHT OF EEEMAS-REC.
           MOVE LNGCD1 OF EETSUB(ESBACT) TO LNGCD1 OF EEEMAS-REC.
           MOVE LNGUS1 OF EETSUB(ESBACT) TO LNGUS1 OF EEEMAS-REC.
           MOVE LNGCD2 OF EETSUB(ESBACT) TO LNGCD2 OF EEEMAS-REC.
           MOVE LNGUS2 OF EETSUB(ESBACT) TO LNGUS2 OF EEEMAS-REC.
           MOVE LNGCD3 OF EETSUB(ESBACT) TO LNGCD3 OF EEEMAS-REC.
           MOVE LNGUS3 OF EETSUB(ESBACT) TO LNGUS3 OF EEEMAS-REC.
           MOVE LNGCD4 OF EETSUB(ESBACT) TO LNGCD4 OF EEEMAS-REC.
           MOVE LNGUS4 OF EETSUB(ESBACT) TO LNGUS4 OF EEEMAS-REC.
           MOVE LNGCD5 OF EETSUB(ESBACT) TO LNGCD5 OF EEEMAS-REC.
           MOVE LNGUS5 OF EETSUB(ESBACT) TO LNGUS5 OF EEEMAS-REC.
           MOVE SCHOOL OF EETSUB(ESBACT) TO SCHOOL OF EEEMAS-REC.
           MOVE SPHNUM OF EETSUB(ESBACT) TO SPHNUM OF EEEMAS-REC.
           MOVE SPHEXT OF EETSUB(ESBACT) TO SPHEXT OF EEEMAS-REC.
           MOVE SFAXNB OF EETSUB(ESBACT) TO SFAXNB OF EEEMAS-REC.
           MOVE SEMAIL OF EETSUB(ESBACT) TO SEMAIL OF EEEMAS-REC.
           MOVE SADRL1 OF EETSUB(ESBACT) TO SADRL1 OF EEEMAS-REC.
           MOVE SADRL2 OF EETSUB(ESBACT) TO SADRL2 OF EEEMAS-REC.
           MOVE SCTYCD OF EETSUB(ESBACT) TO SCTYCD OF EEEMAS-REC.
           MOVE SSTACD OF EETSUB(ESBACT) TO SSTACD OF EEEMAS-REC.
           MOVE SZIPCD OF EETSUB(ESBACT) TO SZIPCD OF EEEMAS-REC.
           MOVE SCNTRY OF EETSUB(ESBACT) TO SCNTRY OF EEEMAS-REC.
           MOVE RSPIND OF EETSUB(ESBACT) TO RSPIND OF EEEMAS-REC.
           MOVE RSPIDC OF EETSUB(ESBACT) TO RSPIDC OF EEEMAS-REC.
           MOVE RSPLST OF EETSUB(ESBACT) TO RSPLST OF EEEMAS-REC.
           MOVE RSPFST OF EETSUB(ESBACT) TO RSPFST OF EEEMAS-REC.
           MOVE RSPMID OF EETSUB(ESBACT) TO RSPMID OF EEEMAS-REC.
           MOVE RSPTTL OF EETSUB(ESBACT) TO RSPTTL OF EEEMAS-REC.
           MOVE RSPFRM OF EETSUB(ESBACT) TO RSPFRM OF EEEMAS-REC.
           MOVE RESPNB OF EETSUB(ESBACT) TO RESPNB OF EEEMAS-REC.
           MOVE RHOMPH OF EETSUB(ESBACT) TO RHOMPH OF EEEMAS-REC.
           MOVE RWRKPH OF EETSUB(ESBACT) TO RWRKPH OF EEEMAS-REC.
           MOVE RSPEXT OF EETSUB(ESBACT) TO RSPEXT OF EEEMAS-REC.
           MOVE RFAXNB OF EETSUB(ESBACT) TO RFAXNB OF EEEMAS-REC.
           MOVE ROTHPH OF EETSUB(ESBACT) TO ROTHPH OF EEEMAS-REC.
           MOVE REMLIN OF EETSUB(ESBACT) TO REMLIN OF EEEMAS-REC.
           MOVE REMAIL OF EETSUB(ESBACT) TO REMAIL OF EEEMAS-REC.
           MOVE RCNTCT OF EETSUB(ESBACT) TO RCNTCT OF EEEMAS-REC.
           MOVE RADLN1 OF EETSUB(ESBACT) TO RADLN1 OF EEEMAS-REC.
           MOVE RADLN2 OF EETSUB(ESBACT) TO RADLN2 OF EEEMAS-REC.
           MOVE RCTYCD OF EETSUB(ESBACT) TO RCTYCD OF EEEMAS-REC.
           MOVE RSTACD OF EETSUB(ESBACT) TO RSTACD OF EEEMAS-REC.
           MOVE RZIPCD OF EETSUB(ESBACT) TO RZIPCD OF EEEMAS-REC.
           MOVE RCNTRY OF EETSUB(ESBACT) TO RCNTRY OF EEEMAS-REC.
           MOVE BENIND OF EETSUB(ESBACT) TO BENIND OF EEEMAS-REC.
           MOVE HSAIND OF EETSUB(ESBACT) TO HSAIND OF EEEMAS-REC.
           MOVE HRAIND OF EETSUB(ESBACT) TO HRAIND OF EEEMAS-REC.
           MOVE FSAIND OF EETSUB(ESBACT) TO FSAIND OF EEEMAS-REC.
           MOVE OTHIND OF EETSUB(ESBACT) TO OTHIND OF EEEMAS-REC.
           MOVE MPDIND OF EETSUB(ESBACT) TO MPDIND OF EEEMAS-REC.
           MOVE PHAIND OF EETSUB(ESBACT) TO PHAIND OF EEEMAS-REC.
           MOVE DENIND OF EETSUB(ESBACT) TO DENIND OF EEEMAS-REC.
           MOVE VISIND OF EETSUB(ESBACT) TO VISIND OF EEEMAS-REC.
           MOVE MHTIND OF EETSUB(ESBACT) TO MHTIND OF EEEMAS-REC.
           MOVE OTHBEN OF EETSUB(ESBACT) TO OTHBEN OF EEEMAS-REC.
           MOVE ALTIND OF EETSUB(ESBACT) TO ALTIND OF EEEMAS-REC.
           MOVE ALTAD1 OF EETSUB(ESBACT) TO ALTAD1 OF EEEMAS-REC.
           MOVE ALTAD2 OF EETSUB(ESBACT) TO ALTAD2 OF EEEMAS-REC.
           MOVE ALTCTY OF EETSUB(ESBACT) TO ALTCTY OF EEEMAS-REC.
           MOVE ALTSTT OF EETSUB(ESBACT) TO ALTSTT OF EEEMAS-REC.
           MOVE ALTPST OF EETSUB(ESBACT) TO ALTPST OF EEEMAS-REC.
           MOVE ALTCNR OF EETSUB(ESBACT) TO ALTCNR OF EEEMAS-REC.
           MOVE OLDMAR OF EETSUB(ESBACT) TO OLDMAR OF EEEMAS-REC.
           MOVE OLDRCD OF EETSUB(ESBACT) TO OLDRCD OF EEEMAS-REC.
           MOVE OLDCTZ OF EETSUB(ESBACT) TO OLDCTZ OF EEEMAS-REC.
           MOVE SCHCLK OF EETSUB(ESBACT) TO SCHCLK OF EEEMAS-REC.
           MOVE CNFCOD OF EETSUB(ESBACT) TO CNFCOD OF EEEMAS-REC.
           MOVE CALTPH OF EETSUB(ESBACT) TO CALTPH OF EEEMAS-REC.
           MOVE CBEPNB OF EETSUB(ESBACT) TO CBEPNB OF EEEMAS-REC.
           MOVE CCELPH OF EETSUB(ESBACT) TO CCELPH OF EEEMAS-REC.
           MOVE RALTPH OF EETSUB(ESBACT) TO RALTPH OF EEEMAS-REC.
           MOVE RBEPNB OF EETSUB(ESBACT) TO RBEPNB OF EEEMAS-REC.
           MOVE RCELPH OF EETSUB(ESBACT) TO RCELPH OF EEEMAS-REC.
           MOVE ALTPHN OF EETSUB(ESBACT) TO ALTPHN OF EEEMAS-REC.
           MOVE BEPNBR OF EETSUB(ESBACT) TO BEPNBR OF EEEMAS-REC.
           MOVE CELPHN OF EETSUB(ESBACT) TO CELPHN OF EEEMAS-REC.
           MOVE EXCMEM OF EETSUB(ESBACT) TO EXCMEM OF EEEMAS-REC.
           MOVE EXCSUB OF EETSUB(ESBACT) TO EXCSUB OF EEEMAS-REC.
           MOVE PRVSUB OF EETSUB(ESBACT) TO PRVSUB OF EEEMAS-REC.
           MOVE SMKCES OF EETSUB(ESBACT) TO SMKCES OF EEEMAS-REC.
           MOVE REPNAM OF EETSUB(ESBACT) TO REPNAM OF EEEMAS-REC.
           MOVE REPRFQ OF EETSUB(ESBACT) TO REPRFQ OF EEEMAS-REC.
           MOVE REPREF OF EETSUB(ESBACT) TO REPREF OF EEEMAS-REC.
           MOVE REPEFQ OF EETSUB(ESBACT) TO REPEFQ OF EEEMAS-REC.
           MOVE REPEFF OF EETSUB(ESBACT) TO REPEFF OF EEEMAS-REC.
           MOVE OPYAMT OF EETSUB(ESBACT) TO OPYAMT OF EEEMAS-REC.
           MOVE OPYEFF OF EETSUB(ESBACT) TO OPYEFF OF EEEMAS-REC.
           MOVE OPYEXP OF EETSUB(ESBACT) TO OPYEXP OF EEEMAS-REC.
           MOVE OPYSRC OF EETSUB(ESBACT) TO OPYSRC OF EEEMAS-REC.
           MOVE APTAMT OF EETSUB(ESBACT) TO APTAMT OF EEEMAS-REC.
           MOVE APTEFF OF EETSUB(ESBACT) TO APTEFF OF EEEMAS-REC.
           MOVE APTEXP OF EETSUB(ESBACT) TO APTEXP OF EEEMAS-REC.
           MOVE CSRAMT OF EETSUB(ESBACT) TO CSRAMT OF EEEMAS-REC.
           MOVE CSREFF OF EETSUB(ESBACT) TO CSREFF OF EEEMAS-REC.
           MOVE CSREXP OF EETSUB(ESBACT) TO CSREXP OF EEEMAS-REC.
           MOVE PREAMT OF EETSUB(ESBACT) TO PREAMT OF EEEMAS-REC.
           MOVE PREEFF OF EETSUB(ESBACT) TO PREEFF OF EEEMAS-REC.
           MOVE PREEXP OF EETSUB(ESBACT) TO PREEXP OF EEEMAS-REC.
           MOVE RSPTOT OF EETSUB(ESBACT) TO RSPTOT OF EEEMAS-REC.
           MOVE RSPEFF OF EETSUB(ESBACT) TO RSPEFF OF EEEMAS-REC.
           MOVE RSPEXP OF EETSUB(ESBACT) TO RSPEXP OF EEEMAS-REC.
           MOVE PRETOT OF EETSUB(ESBACT) TO PRETOT OF EEEMAS-REC.
           MOVE PTOEFF OF EETSUB(ESBACT) TO PTOEFF OF EEEMAS-REC.
           MOVE PTOEXP OF EETSUB(ESBACT) TO PTOEXP OF EEEMAS-REC.
           MOVE EMPTOT OF EETSUB(ESBACT) TO EMPTOT OF EEEMAS-REC.
           MOVE EMPEFF OF EETSUB(ESBACT) TO EMPEFF OF EEEMAS-REC.
           MOVE EMPEXP OF EETSUB(ESBACT) TO EMPEXP OF EEEMAS-REC.
           MOVE EXCHNG OF EETSUB(ESBACT) TO EXCHNG OF EEEMAS-REC.
           MOVE COUNTY OF EETSUB(ESBACT) TO COUNTY OF EEEMAS-REC.
           MOVE ETHCD1 OF EETSUB(ESBACT) TO ETHCD1 OF EEEMAS-REC.
           MOVE ETHCD2 OF EETSUB(ESBACT) TO ETHCD2 OF EEEMAS-REC.
           MOVE ETHCD3 OF EETSUB(ESBACT) TO ETHCD3 OF EEEMAS-REC.
           MOVE ETHCD4 OF EETSUB(ESBACT) TO ETHCD4 OF EEEMAS-REC.
           MOVE ETHCD5 OF EETSUB(ESBACT) TO ETHCD5 OF EEEMAS-REC.
           MOVE ETHCD6 OF EETSUB(ESBACT) TO ETHCD6 OF EEEMAS-REC.
           MOVE ETHCD7 OF EETSUB(ESBACT) TO ETHCD7 OF EEEMAS-REC.
           MOVE ETHCD8 OF EETSUB(ESBACT) TO ETHCD8 OF EEEMAS-REC.
           MOVE ETHCD9 OF EETSUB(ESBACT) TO ETHCD9 OF EEEMAS-REC.
           MOVE REQTIM OF EETSUB(ESBACT) TO REQTIM OF EEEMAS-REC.
           MOVE REQEFF OF EETSUB(ESBACT) TO REQEFF OF EEEMAS-REC.
           MOVE REQEXP OF EETSUB(ESBACT) TO REQEXP OF EEEMAS-REC.
           MOVE TENTID OF EETSUB(ESBACT) TO TENTID OF EEEMAS-REC.
           MOVE TENEFF OF EETSUB(ESBACT) TO TENEFF OF EEEMAS-REC.
           MOVE TENEXP OF EETSUB(ESBACT) TO TENEXP OF EEEMAS-REC.
           MOVE SEPREA OF EETSUB(ESBACT) TO SEPREA OF EEEMAS-REC.
           MOVE SEPEFF OF EETSUB(ESBACT) TO SEPEFF OF EEEMAS-REC.
           MOVE SEPEXP OF EETSUB(ESBACT) TO SEPEXP OF EEEMAS-REC.
           MOVE REACAT OF EETSUB(ESBACT) TO REACAT OF EEEMAS-REC.
           MOVE REAEFF OF EETSUB(ESBACT) TO REAEFF OF EEEMAS-REC.
           MOVE REAEXP OF EETSUB(ESBACT) TO REAEXP OF EEEMAS-REC.
      *
           MOVE SNDRID OF EEWHDR-WRK   TO SNDRID OF EEEMAS-REC.
           MOVE CTLNUM OF EEWHDR-WRK   TO CTLNUM OF EEEMAS-REC.
           MOVE TRNDAT OF EEWHDR-WRK   TO TRNDAT OF EEEMAS-REC.
           MOVE TRNTIM OF EEWHDR-WRK   TO TRNTIM OF EEEMAS-REC.
           MOVE TRANID OF EEWHDR-WRK   TO TRANID OF EEEMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF EEEMAS-REC
                                          LSTCHG OF EEEMAS-REC.
           MOVE 'ED201C'               TO USERID OF EEEMAS-REC.
           MOVE 'EDI'                  TO TERMID OF EEEMAS-REC.
      *
           PERFORM A240-LOAD-SUBERR           THRU A249-EXIT.
      *
           MOVE 'Y'                              TO WRITTEN-FLAG.
      *
           PERFORM EEEMAS-WRITE                  IF INVALID-KEY
              IF EEEMAS-STATUS = '22'
                 GO TO A929-EXIT
              ELSE
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'Y'                 TO PRCERR OF PGM-WORK
                 MOVE 'EEEMAS'                      TO MI-PARM4
                 MOVE EEEMAS-STATUS                 TO MI-PARM5
                 MOVE 'EI06062'                     TO MI-PRIMARY-ID
                 PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
       A929-EXIT.
           EXIT.
      *
       A930-CONVERT-DATE.
      **************************************************************
      *‚CONVERT 8 BYTES DATE (CCYYMMDD) TO 7 BYTES DATE (CYMMDD)   *
      **************************************************************
           IF TARDAT = ZEROES
              MOVE ZEROES                        TO CNVDAT
              GO TO A939-EXIT.
      *
           IF TARDAT = 99999999
              MOVE 9999999                       TO CNVDAT
              GO TO A939-EXIT.
      *
           MOVE DATYY OF TARDAT        TO DATYY OF TARDAT-CONV.
           MOVE DATMM OF TARDAT        TO DATMM OF TARDAT-CONV.
           MOVE DATDD OF TARDAT        TO DATDD OF TARDAT-CONV.
           IF DATCC OF TARDAT = 18
              MOVE ZERO                TO DATCC OF TARDAT-CONV
           END-IF
           IF DATCC OF TARDAT = 19
              MOVE 1                   TO DATCC OF TARDAT-CONV
           END-IF
           IF DATCC OF TARDAT = 20
               MOVE 2                  TO DATCC OF TARDAT-CONV
           END-IF.
       A939-EXIT.
           EXIT.
      *
       A940-ENB-DATCHK.
      ****************************************************************
      *‚
      ****************************************************************
           IF ENBEFF OF EEWSUB(ESBACT) = ZEROES
              IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                 MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       ENBEFF OF EEWSUB(ESBACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'      TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                       GO TO A949-EXIT
                 END-IF
              END-IF
           END-IF
           IF ENBEXP OF EEWSUB(ESBACT) = ZEROES
              IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
              AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                 MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       ENBEXP OF EEWSUB(ESBACT)
              ELSE
              IF TMPACT NOT = ZEROES
                 MOVE MEMEXP OF SUBMEM(TMPACT) TO
                                       ENBEXP OF EEWSUB(ESBACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT.
       A949-EXIT.
           EXIT.
      *
       A950-ENB-DATCHK.
      ****************************************************************
      *‚                                                             *
      ****************************************************************
           IF ENBEFF OF EEWDEP(EDPACT) = ZEROES
              IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                 MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                    ENBEFF OF EEWDEP(EDPACT)
              ELSE
                MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO A959-EXIT
                 END-IF
              END-IF
           END-IF
           IF ENBEXP OF EEWDEP(EDPACT) = ZEROES
             IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
              AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                 MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                          ENBEXP OF EEWDEP(EDPACT)
              ELSE
              IF MEMTMP NOT = ZEROES
                 MOVE MEMEXP OF MEMTAB(MEMTMP) TO
                                       ENBEXP OF EEWDEP(EDPACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT.
       A959-EXIT.
           EXIT.
      *
       A960-WRITE-CPDMAS.
           MOVE CPLNAM OF EEWDEP(EDPACT) TO LSTNAM OF CPDMAS-REC.
           MOVE CPFNAM OF EEWDEP(EDPACT) TO FSTNAM OF CPDMAS-REC.
           MOVE CPMNAM OF EEWDEP(EDPACT) TO MIDNAM OF CPDMAS-REC.
           MOVE CPTITL OF EEWDEP(EDPACT) TO TITLCD OF CPDMAS-REC.
           MOVE CPFORM OF EEWDEP(EDPACT) TO FORNAM OF CPDMAS-REC.
           MOVE CPADR1 OF EEWDEP(EDPACT) TO ADRLN1 OF CPDMAS-REC.
           MOVE CPADR2 OF EEWDEP(EDPACT) TO ADRLN2 OF CPDMAS-REC.
           MOVE CPCITY OF EEWDEP(EDPACT) TO CITYCD OF CPDMAS-REC.
           MOVE CPSTAT OF EEWDEP(EDPACT) TO STACOD OF CPDMAS-REC.
           MOVE CPZCOD OF EEWDEP(EDPACT) TO ZIPCOD OF CPDMAS-REC.
           MOVE CPCONT OF EEWDEP(EDPACT) TO CONTCT OF CPDMAS-REC.
           MOVE CPHPH1 OF EEWDEP(EDPACT) TO HOMPH1 OF CPDMAS-REC.
           MOVE CPHPH2 OF EEWDEP(EDPACT) TO HOMPH2 OF CPDMAS-REC.
           MOVE CPHPH3 OF EEWDEP(EDPACT) TO HOMPH3 OF CPDMAS-REC.
           MOVE CPWPH1 OF EEWDEP(EDPACT) TO WRKPH1 OF CPDMAS-REC.
           MOVE CPWPH2 OF EEWDEP(EDPACT) TO WRKPH2 OF CPDMAS-REC.
           MOVE CPWPH3 OF EEWDEP(EDPACT) TO WRKPH3 OF CPDMAS-REC.
           MOVE CPWEXT OF EEWDEP(EDPACT) TO WRKEXT OF CPDMAS-REC.
           MOVE CCNTRY OF EEWDEP(EDPACT) TO CCNTRY OF CPDMAS-REC.
           MOVE CPARNT OF EEWDEP(EDPACT) TO CPARNT OF CPDMAS-REC.
           MOVE CFAXNB OF EEWDEP(EDPACT) TO CFAXNB OF CPDMAS-REC.
           MOVE COTHPH OF EEWDEP(EDPACT) TO COTHPH OF CPDMAS-REC.
           MOVE CEMLIN OF EEWDEP(EDPACT) TO CEMLIN OF CPDMAS-REC.
           MOVE CEMAIL OF EEWDEP(EDPACT) TO CEMAIL OF CPDMAS-REC.
           MOVE CALTPH OF EEWDP2(EDPACT) TO CALTPH OF CPDMAS-REC.
           MOVE CBEPNB OF EEWDP2(EDPACT) TO CBEPNB OF CPDMAS-REC.
           MOVE CCELPH OF EEWDP2(EDPACT) TO CCELPH OF CPDMAS-REC.
      *
           MOVE CURDAT                 TO SYSDAT OF CPDMAS-REC
                                          LSTCHG OF CPDMAS-REC.
           MOVE 'ED201C'               TO USERID OF CPDMAS-REC
           MOVE 'EDI'                  TO TERMID OF CPDMAS-REC
           PERFORM CPDMAS-WRITE                  IF INVALID-KEY
              NEXT SENTENCE.
       A969-EXIT.
           EXIT.
      *
       A970-CPAMAS-CHG.
           MOVE 'N'                              TO CPACHG-FLAG.
           INITIALIZE CPAMAS-REC.
           IF CPAIND OF EEWDEP(EDPACT) = 'M'
              MOVE MEMBNO OF EEWDEP(EDPACT) TO CPNUMB OF CPAMAS-REC
           ELSE
              MOVE SUBSNO OF EEWDEP(EDPACT) TO CPNUMB OF CPAMAS-REC.
           PERFORM CPAMAS-READ                   IF INVALID-KEY
              NEXT SENTENCE.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE EMLPTRBV-REC.
           MOVE 'C'                     TO EMLTYP OF EMLPTRBV-REC.
           MOVE CPNUMB OF CPAMAS-REC    TO EMLEID OF EMLPTRBV-REC.
           CALL 'EMLPTRBVM'   USING IO-COMMUNICATION EMLPTRBV-LM-PARMS.
      *
           IF (CPLNAM OF EEWDEP(EDPACT) NOT = SPACES
           AND CPLNAM OF EEWDEP(EDPACT) NOT = LSTNAM OF CPAMAS-REC)
           OR (CPFNAM OF EEWDEP(EDPACT) NOT = SPACES
           AND CPFNAM OF EEWDEP(EDPACT) NOT = FSTNAM OF CPAMAS-REC)
           OR (CPMNAM OF EEWDEP(EDPACT) NOT = SPACES
           AND CPMNAM OF EEWDEP(EDPACT) NOT = MIDNAM OF CPAMAS-REC)
           OR (CPTITL OF EEWDEP(EDPACT) NOT = SPACES
           AND CPTITL OF EEWDEP(EDPACT) NOT = TITLCD OF CPAMAS-REC)
           OR (CPFORM OF EEWDEP(EDPACT) NOT = SPACES
           AND CPFORM OF EEWDEP(EDPACT) NOT = FORNAM OF CPAMAS-REC)
           OR (CPADR1 OF EEWDEP(EDPACT) NOT = SPACES
           AND (CPADR1 OF EEWDEP(EDPACT) NOT = ADRLN1 OF CPAMAS-REC
           OR CPADR2 OF EEWDEP(EDPACT) NOT = ADRLN2 OF CPAMAS-REC))
           OR (CPCITY OF EEWDEP(EDPACT) NOT = SPACES
           AND CPCITY OF EEWDEP(EDPACT) NOT = CITYCD OF CPAMAS-REC)
           OR (CPSTAT OF EEWDEP(EDPACT) NOT = SPACES
           AND CPSTAT OF EEWDEP(EDPACT) NOT = STACOD OF CPAMAS-REC)
           OR (CPZCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND CPZCOD OF EEWDEP(EDPACT) NOT = ZIPCOD OF CPAMAS-REC)
           OR (CPCONT OF EEWDEP(EDPACT) NOT = SPACES
           AND CPCONT OF EEWDEP(EDPACT) NOT = CONTCT OF CPAMAS-REC)
           OR (CPHPH1 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPHPH1 OF EEWDEP(EDPACT) NOT = HOMPH1 OF CPAMAS-REC)
           OR (CPHPH2 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPHPH2 OF EEWDEP(EDPACT) NOT = HOMPH2 OF CPAMAS-REC)
           OR (CPHPH3 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPHPH3 OF EEWDEP(EDPACT) NOT = HOMPH3 OF CPAMAS-REC)
           OR (CPWPH1 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPWPH1 OF EEWDEP(EDPACT) NOT = WRKPH1 OF CPAMAS-REC)
           OR (CPWPH2 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPWPH2 OF EEWDEP(EDPACT) NOT = WRKPH2 OF CPAMAS-REC)
           OR (CPWPH3 OF EEWDEP(EDPACT) NOT = SPACES
           AND CPWPH3 OF EEWDEP(EDPACT) NOT = WRKPH3 OF CPAMAS-REC)
           OR (CPWEXT OF EEWDEP(EDPACT) NOT = SPACES
           AND CPWEXT OF EEWDEP(EDPACT) NOT = WRKEXT OF CPAMAS-REC)
           OR (CCNTRY OF EEWDEP(EDPACT) NOT = SPACES
           AND CCNTRY OF EEWDEP(EDPACT) NOT = CCNTRY OF CPAMAS-REC)
           OR (CPARNT OF EEWDEP(EDPACT) NOT = SPACES
           AND CPARNT OF EEWDEP(EDPACT) NOT = CPARNT OF CPAMAS-REC)
           OR (CFAXNB OF EEWDEP(EDPACT) NOT = SPACES
           AND CFAXNB OF EEWDEP(EDPACT) NOT = CFAXNB OF CPAMAS-REC)
           OR (COTHPH OF EEWDEP(EDPACT) NOT = SPACES
           AND COTHPH OF EEWDEP(EDPACT) NOT = COTHPH OF CPAMAS-REC)
           OR (CEMLIN OF EEWDEP(EDPACT) NOT = SPACES
           AND CEMLIN OF EEWDEP(EDPACT) NOT = CEMLIN OF CPAMAS-REC)
           OR (CEMAIL OF EEWDEP(EDPACT) NOT = SPACES
           AND CEMAIL OF EEWDEP(EDPACT) NOT = EMLTXT OF EMLPTRBV-REC)
           OR (CALTPH OF EEWDP2(EDPACT) NOT = SPACES
           AND CALTPH OF EEWDP2(EDPACT) NOT = CALTPH OF CPAMAS-REC)
           OR (CBEPNB OF EEWDP2(EDPACT) NOT = SPACES
           AND CBEPNB OF EEWDP2(EDPACT) NOT = CBEPNB OF CPAMAS-REC)
           OR (CCELPH OF EEWDP2(EDPACT) NOT = SPACES
           AND CCELPH OF EEWDP2(EDPACT) NOT = CCELPH OF CPAMAS-REC)
              MOVE 'Y'                           TO CPACHG-FLAG.
       A979-EXIT.
           EXIT.
      *
       A980-WRITE-CPDMAS.
           MOVE CPLNAM OF EEWSUB(ESBACT) TO LSTNAM OF CPDMAS-REC.
           MOVE CPFNAM OF EEWSUB(ESBACT) TO FSTNAM OF CPDMAS-REC.
           MOVE CPMNAM OF EEWSUB(ESBACT) TO MIDNAM OF CPDMAS-REC.
           MOVE CPTITL OF EEWSUB(ESBACT) TO TITLCD OF CPDMAS-REC.
           MOVE CPFORM OF EEWSUB(ESBACT) TO FORNAM OF CPDMAS-REC.
           MOVE CPADR1 OF EEWSUB(ESBACT) TO ADRLN1 OF CPDMAS-REC.
           MOVE CPADR2 OF EEWSUB(ESBACT) TO ADRLN2 OF CPDMAS-REC.
           MOVE CPCITY OF EEWSUB(ESBACT) TO CITYCD OF CPDMAS-REC.
           MOVE CPSTAT OF EEWSUB(ESBACT) TO STACOD OF CPDMAS-REC.
           MOVE CPZCOD OF EEWSUB(ESBACT) TO ZIPCOD OF CPDMAS-REC.
           MOVE CPCONT OF EEWSUB(ESBACT) TO CONTCT OF CPDMAS-REC.
           MOVE CPHPH1 OF EEWSUB(ESBACT) TO HOMPH1 OF CPDMAS-REC.
           MOVE CPHPH2 OF EEWSUB(ESBACT) TO HOMPH2 OF CPDMAS-REC.
           MOVE CPHPH3 OF EEWSUB(ESBACT) TO HOMPH3 OF CPDMAS-REC.
           MOVE CPWPH1 OF EEWSUB(ESBACT) TO WRKPH1 OF CPDMAS-REC.
           MOVE CPWPH2 OF EEWSUB(ESBACT) TO WRKPH2 OF CPDMAS-REC.
           MOVE CPWPH3 OF EEWSUB(ESBACT) TO WRKPH3 OF CPDMAS-REC.
           MOVE CPWEXT OF EEWSUB(ESBACT) TO WRKEXT OF CPDMAS-REC.
           MOVE CCNTRY OF EEWSUB(ESBACT) TO CCNTRY OF CPDMAS-REC.
           MOVE CPARNT OF EEWSUB(ESBACT) TO CPARNT OF CPDMAS-REC.
           MOVE CFAXNB OF EEWSUB(ESBACT) TO CFAXNB OF CPDMAS-REC.
           MOVE COTHPH OF EEWSUB(ESBACT) TO COTHPH OF CPDMAS-REC.
           MOVE CEMLIN OF EEWSUB(ESBACT) TO CEMLIN OF CPDMAS-REC.
           MOVE CEMAIL OF EEWSUB(ESBACT) TO CEMAIL OF CPDMAS-REC.
      *
           MOVE CALTPH OF EEWSB2(ESBACT) TO CALTPH OF CPDMAS-REC.
           MOVE CBEPNB OF EEWSB2(ESBACT) TO CBEPNB OF CPDMAS-REC.
           MOVE CCELPH OF EEWSB2(ESBACT) TO CCELPH OF CPDMAS-REC.
      *
           MOVE CURDAT                 TO SYSDAT OF CPDMAS-REC
                                          LSTCHG OF CPDMAS-REC.
           MOVE 'ED201C'               TO USERID OF CPDMAS-REC
           MOVE 'EDI'                  TO TERMID OF CPDMAS-REC
           PERFORM CPDMAS-WRITE                  IF INVALID-KEY
              NEXT SENTENCE.
       A989-EXIT.
           EXIT.
      *
       A990-CPAMAS-CHG.
           MOVE 'N'                              TO CPACHG-FLAG.
           INITIALIZE CPAMAS-REC.
           IF CPAIND OF EEWSUB(ESBACT) = 'M'
              MOVE MEMBNO OF EEWSUB(ESBACT) TO CPNUMB OF CPAMAS-REC
           ELSE
              MOVE SUBSNO OF EEWSUB(ESBACT) TO CPNUMB OF CPAMAS-REC.
           PERFORM CPAMAS-READ                   IF INVALID-KEY
              NEXT SENTENCE.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE EMLPTRBV-REC.
           MOVE 'C'                     TO EMLTYP OF EMLPTRBV-REC.
           MOVE CPNUMB OF CPAMAS-REC    TO EMLEID OF EMLPTRBV-REC.
           CALL 'EMLPTRBVM'   USING IO-COMMUNICATION EMLPTRBV-LM-PARMS.
      *
           IF (CPLNAM OF EEWSUB(ESBACT) NOT = SPACES
           AND CPLNAM OF EEWSUB(ESBACT) NOT = LSTNAM OF CPAMAS-REC)
           OR (CPFNAM OF EEWSUB(ESBACT) NOT = SPACES
           AND CPFNAM OF EEWSUB(ESBACT) NOT = FSTNAM OF CPAMAS-REC)
           OR (CPMNAM OF EEWSUB(ESBACT) NOT = SPACES
           AND CPMNAM OF EEWSUB(ESBACT) NOT = MIDNAM OF CPAMAS-REC)
           OR (CPTITL OF EEWSUB(ESBACT) NOT = SPACES
           AND CPTITL OF EEWSUB(ESBACT) NOT = TITLCD OF CPAMAS-REC)
           OR (CPFORM OF EEWSUB(ESBACT) NOT = SPACES
           AND CPFORM OF EEWSUB(ESBACT) NOT = FORNAM OF CPAMAS-REC)
           OR (CPADR1 OF EEWSUB(ESBACT) NOT = SPACES
           AND (CPADR1 OF EEWSUB(ESBACT) NOT = ADRLN1 OF CPAMAS-REC
           OR CPADR2 OF EEWSUB(ESBACT) NOT = ADRLN2 OF CPAMAS-REC))
           OR (CPCITY OF EEWSUB(ESBACT) NOT = SPACES
           AND CPCITY OF EEWSUB(ESBACT) NOT = CITYCD OF CPAMAS-REC)
           OR (CPSTAT OF EEWSUB(ESBACT) NOT = SPACES
           AND CPSTAT OF EEWSUB(ESBACT) NOT = STACOD OF CPAMAS-REC)
           OR (CPZCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND CPZCOD OF EEWSUB(ESBACT) NOT = ZIPCOD OF CPAMAS-REC)
           OR (CPCONT OF EEWSUB(ESBACT) NOT = SPACES
           AND CPCONT OF EEWSUB(ESBACT) NOT = CONTCT OF CPAMAS-REC)
           OR (CPHPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPHPH1 OF EEWSUB(ESBACT) NOT = HOMPH1 OF CPAMAS-REC)
           OR (CPHPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPHPH2 OF EEWSUB(ESBACT) NOT = HOMPH2 OF CPAMAS-REC)
           OR (CPHPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPHPH3 OF EEWSUB(ESBACT) NOT = HOMPH3 OF CPAMAS-REC)
           OR (CPWPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPWPH1 OF EEWSUB(ESBACT) NOT = WRKPH1 OF CPAMAS-REC)
           OR (CPWPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPWPH2 OF EEWSUB(ESBACT) NOT = WRKPH2 OF CPAMAS-REC)
           OR (CPWPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND CPWPH3 OF EEWSUB(ESBACT) NOT = WRKPH3 OF CPAMAS-REC)
           OR (CPWEXT OF EEWSUB(ESBACT) NOT = SPACES
           AND CPWEXT OF EEWSUB(ESBACT) NOT = WRKEXT OF CPAMAS-REC)
           OR (CCNTRY OF EEWSUB(ESBACT) NOT = SPACES
           AND CCNTRY OF EEWSUB(ESBACT) NOT = CCNTRY OF CPAMAS-REC)
           OR (CPARNT OF EEWSUB(ESBACT) NOT = SPACES
           AND CPARNT OF EEWSUB(ESBACT) NOT = CPARNT OF CPAMAS-REC)
           OR (CFAXNB OF EEWSUB(ESBACT) NOT = SPACES
           AND CFAXNB OF EEWSUB(ESBACT) NOT = CFAXNB OF CPAMAS-REC)
           OR (COTHPH OF EEWSUB(ESBACT) NOT = SPACES
           AND COTHPH OF EEWSUB(ESBACT) NOT = COTHPH OF CPAMAS-REC)
           OR (CEMLIN OF EEWSUB(ESBACT) NOT = SPACES
           AND CEMLIN OF EEWSUB(ESBACT) NOT = CEMLIN OF CPAMAS-REC)
           OR (CEMAIL OF EEWSUB(ESBACT) NOT = SPACES
           AND CEMAIL OF EEWSUB(ESBACT) NOT = EMLTXT OF EMLPTRBV-REC)
           OR (CALTPH OF EEWSB2(ESBACT) NOT = SPACES
           AND CALTPH OF EEWSB2(ESBACT) NOT = CALTPH OF CPAMAS-REC)
           OR (CBEPNB OF EEWSB2(ESBACT) NOT = SPACES
           AND CBEPNB OF EEWSB2(ESBACT) NOT = CBEPNB OF CPAMAS-REC)
           OR (CCELPH OF EEWSB2(ESBACT) NOT = SPACES
           AND CCELPH OF EEWSB2(ESBACT) NOT = CCELPH OF CPAMAS-REC)
              MOVE 'Y'                           TO CPACHG-FLAG.
       A999-EXIT.
           EXIT.
       A1000-WRITE-MMDMAS.
           MOVE MMANUM OF EEWSUB(ESBACT)
                                       TO MMANUM OF MMDMAS-REC.
           MOVE MMAEFF OF EEWSUB(ESBACT)
                                       TO MMAEFF OF MMDMAS-REC.
           MOVE MIDNUM OF EEWSUB(ESBACT)
                                       TO MIDNUM OF MMDMAS-REC.
           MOVE MCTCOD OF EEWSUB(ESBACT)
                                       TO MCTCOD OF MMDMAS-REC.
           MOVE MCTEFF OF EEWSUB(ESBACT)
                                       TO MCTEFF OF MMDMAS-REC.
           MOVE MPSCOD OF EEWSUB(ESBACT)
                                       TO MPSCOD OF MMDMAS-REC.
           MOVE MCASNO OF EEWSUB(ESBACT)
                                       TO MCASNO OF MMDMAS-REC.
           MOVE MCAPCD OF EEWSUB(ESBACT)
                                       TO MCAPCD OF MMDMAS-REC.
           PERFORM MMDMAS-WRITE                  IF INVALID-KEY
              NEXT SENTENCE.
       A1009-EXIT.
           EXIT.
      *
       A1010-MCDMAS-CHG.
      ****--------------------------------------------------------------
      ****  CR138494  RLW  FIX
      ****--------------------------------------------------------------
           PERFORM 099-INIT-MCDMAS.
           MOVE 'N'                              TO MCDCHG-FLAG.
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MCDMAS-REC.
           PERFORM MCDMAS-READ                   IF INVALID-KEY
      ****    MOVE SPACES                        TO MCDMAS-REC.
              CONTINUE.
           IF MMANUM OF EEWSUB(ESBACT) NOT = SPACES
           AND MMANUM OF EEWSUB(ESBACT) NOT = MMANUM OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MMAEFF OF EEWSUB(ESBACT) NOT = ZEROS
           AND MMAEFF OF EEWSUB(ESBACT) NOT = MMAEFF OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MIDNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND MIDNUM OF EEWSUB(ESBACT) NOT = MIDNUM OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCTCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND MCTCOD OF EEWSUB(ESBACT) NOT = MCTCOD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCTEFF OF EEWSUB(ESBACT) NOT = ZEROS
           AND MCTEFF OF EEWSUB(ESBACT) NOT = MCTEFF OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MPSCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND MPSCOD OF EEWSUB(ESBACT) NOT = MPSCOD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCASNO OF EEWSUB(ESBACT) NOT = SPACES
           AND MCASNO OF EEWSUB(ESBACT) NOT = MCASNO OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCAPCD OF EEWSUB(ESBACT) NOT = SPACES
           AND MCAPCD OF EEWSUB(ESBACT) NOT = MCAPCD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
       A1019-EXIT.
           EXIT.
      *
       A1020-WRITE-MMDMAS.
           MOVE MMANUM OF EEWDEP(EDPACT) TO MMANUM OF MMDMAS-REC.
           MOVE MMAEFF OF EEWDEP(EDPACT) TO MMAEFF OF MMDMAS-REC.
           MOVE MIDNUM OF EEWDEP(EDPACT) TO MIDNUM OF MMDMAS-REC.
           MOVE MCTCOD OF EEWDEP(EDPACT) TO MCTCOD OF MMDMAS-REC.
           MOVE MCTEFF OF EEWDEP(EDPACT) TO MCTEFF OF MMDMAS-REC.
           MOVE MPSCOD OF EEWDEP(EDPACT) TO MPSCOD OF MMDMAS-REC.
           MOVE MCASNO OF EEWDEP(EDPACT) TO MCASNO OF MMDMAS-REC.
           MOVE MCAPCD OF EEWDEP(EDPACT) TO MCAPCD OF MMDMAS-REC.
           PERFORM MMDMAS-WRITE                  IF INVALID-KEY
              NEXT SENTENCE.
       A1029-EXIT.
           EXIT.
      *
       A1030-MCDMAS-CHG.
      ****--------------------------------------------------------------
      ****  CR138494  RLW  FIX
      ****--------------------------------------------------------------
           PERFORM 099-INIT-MCDMAS.
           MOVE 'N'                              TO MCDCHG-FLAG.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MCDMAS-REC.
           PERFORM MCDMAS-READ                   IF INVALID-KEY
      ****    MOVE SPACES                        TO MCDMAS-REC.
              CONTINUE.
           IF MMANUM OF EEWDEP(EDPACT) NOT = SPACES
           AND MMANUM OF EEWDEP(EDPACT) NOT = MMANUM OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MMAEFF OF EEWDEP(EDPACT) NOT = ZEROS
           AND MMAEFF OF EEWDEP(EDPACT) NOT = MMAEFF OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MIDNUM OF EEWDEP(EDPACT) NOT = SPACES
           AND MIDNUM OF EEWDEP(EDPACT) NOT = MIDNUM OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCTCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MCTCOD OF EEWDEP(EDPACT) NOT = MCTCOD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCTEFF OF EEWDEP(EDPACT) NOT = ZEROS
           AND MCTEFF OF EEWDEP(EDPACT) NOT = MCTEFF OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MPSCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MPSCOD OF EEWDEP(EDPACT) NOT = MPSCOD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCASNO OF EEWDEP(EDPACT) NOT = SPACES
           AND MCASNO OF EEWDEP(EDPACT) NOT = MCASNO OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
           IF MCAPCD OF EEWDEP(EDPACT) NOT = SPACES
           AND MCAPCD OF EEWDEP(EDPACT) NOT = MCAPCD OF MCDMAS-REC
              MOVE 'Y'                           TO MCDCHG-FLAG.
       A1039-EXIT.
           EXIT.
      *
      *****************************************************************
      *‚    WRITE MEDICARE DOCUMENT MASTER FOR NEW SUBSCRIBER RECTYP 2*
      *****************************************************************
       A1100-WRITE-MDMMAS.
           MOVE MSPRCD OF EEWSUB(ESBACT) TO MSPRCD OF MDMMAS-REC.
           MOVE MPAEDT OF EEWSUB(ESBACT) TO MPAEDT OF MDMMAS-REC.
           MOVE MPAETD OF EEWSUB(ESBACT) TO MPAETD OF MDMMAS-REC.
           MOVE MPAEFD OF EEWSUB(ESBACT) TO MPAEFD OF MDMMAS-REC.
           MOVE MPATDT OF EEWSUB(ESBACT) TO MPATDT OF MDMMAS-REC.
           MOVE MPBEDT OF EEWSUB(ESBACT) TO MPBEDT OF MDMMAS-REC.
           MOVE MPBETD OF EEWSUB(ESBACT) TO MPBETD OF MDMMAS-REC.
           MOVE MPBEFD OF EEWSUB(ESBACT) TO MPBEFD OF MDMMAS-REC.
           MOVE MPBTDT OF EEWSUB(ESBACT) TO MPBTDT OF MDMMAS-REC.
           MOVE MPLNCD OF EEWSUB(ESBACT) TO MPLNCD OF MDMMAS-REC.
           MOVE CURDAT                   TO LSTCHG OF MDMMAS-REC.
           MOVE CURDAT                   TO SYSDAT OF MDMMAS-REC.
           MOVE 'EDI'                    TO TERMID OF MDMMAS-REC
           MOVE 'ED201C'                 TO USERID OF MDMMAS-REC.
           PERFORM MDMMAS-WRITE              IF INVALID-KEY
             MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
             MOVE 'Y'                            TO PRCERR
             MOVE 'MDMMAS'                       TO MI-PARM4
             MOVE MDMMAS-STATUS                  TO MI-PARM5
             MOVE 'EI06062'                      TO MI-PRIMARY-ID
             PERFORM X100-PRINT-ERROR            THRU X109-EXIT
             PERFORM X100-PRINT-ERROR            THRU X109-EXIT.
       A1109-EXIT.
           EXIT.
      *
       A1110-MCMMAS-CHG.
           MOVE 'N'                              TO MCRCHG-FLAG.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MCMMAS-REC.
           PERFORM MCMMAS-READ                   IF INVALID-KEY
              INITIALIZE                         MCMMAS-REC.
      *
           IF (MPAEDT OF EEWSUB(ESBACT) NOT = ZERO
           AND MPAEDT OF EEWSUB(ESBACT) NOT = MPAEDT OF MCMMAS-REC)
           OR (MPAETD OF EEWSUB(ESBACT) NOT = ZERO
           AND MPAETD OF EEWSUB(ESBACT) NOT = MPAETD OF MCMMAS-REC)
           OR (MPAEFD OF EEWSUB(ESBACT) NOT = ZERO
           AND MPAEFD OF EEWSUB(ESBACT) NOT = MPAEFD OF MCMMAS-REC)
           OR (MPATDT OF EEWSUB(ESBACT) NOT = ZERO
           AND MPATDT OF EEWSUB(ESBACT) NOT = MPATDT OF MCMMAS-REC)
           OR (MPBEDT OF EEWSUB(ESBACT) NOT = ZERO
           AND MPBEDT OF EEWSUB(ESBACT) NOT = MPBEDT OF MCMMAS-REC)
           OR (MPBETD OF EEWSUB(ESBACT) NOT = ZERO
           AND MPBETD OF EEWSUB(ESBACT) NOT = MPBETD OF MCMMAS-REC)
           OR (MPBEFD OF EEWSUB(ESBACT) NOT = ZERO
           AND MPBEFD OF EEWSUB(ESBACT) NOT = MPBEFD OF MCMMAS-REC)
           OR (MPBTDT OF EEWSUB(ESBACT) NOT = ZERO
           AND MPBTDT OF EEWSUB(ESBACT) NOT = MPBTDT OF MCMMAS-REC)
           OR (MPLNCD OF EEWSUB(ESBACT) NOT = SPACES
           AND MPLNCD OF EEWSUB(ESBACT) NOT = MPLNCD OF MCMMAS-REC)
              MOVE 'Y'                           TO MCRCHG-FLAG.
       A1119-EXIT.
           EXIT.
      *
      *
      *‚      WRITE THE MDMMAS RECORD FOR A DEPENDENT
      *
       A1120-WRITE-MDMMAS.
           MOVE MSPRCD OF EEWDEP(EDPACT) TO MSPRCD OF MDMMAS-REC.
           MOVE MPAEDT OF EEWDEP(EDPACT) TO MPAEDT OF MDMMAS-REC.
           MOVE MPAETD OF EEWDEP(EDPACT) TO MPAETD OF MDMMAS-REC.
           MOVE MPAEFD OF EEWDEP(EDPACT) TO MPAEFD OF MDMMAS-REC.
           MOVE MPATDT OF EEWDEP(EDPACT) TO MPATDT OF MDMMAS-REC.
           MOVE MPBEDT OF EEWDEP(EDPACT) TO MPBEDT OF MDMMAS-REC.
           MOVE MPBETD OF EEWDEP(EDPACT) TO MPBETD OF MDMMAS-REC.
           MOVE MPBEFD OF EEWDEP(EDPACT) TO MPBEFD OF MDMMAS-REC.
           MOVE MPBTDT OF EEWDEP(EDPACT) TO MPBTDT OF MDMMAS-REC.

           MOVE MPLNCD OF EEWDEP(EDPACT) TO MPLNCD OF MDMMAS-REC.
           MOVE CURDAT                   TO LSTCHG OF MDMMAS-REC.
           MOVE CURDAT                   TO SYSDAT OF MDMMAS-REC.
           MOVE 'EDI'                    TO TERMID OF MDMMAS-REC
           MOVE 'ED201C'                 TO USERID OF MDMMAS-REC.
           PERFORM MDMMAS-WRITE                    IF INVALID-KEY
             MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
             MOVE 'Y'                              TO PRCERR
             MOVE 'MDMMAS'                         TO MI-PARM4
             MOVE MDMMAS-STATUS                    TO MI-PARM5
             MOVE 'EI06062'                        TO MI-PRIMARY-ID
             PERFORM X100-PRINT-ERROR              THRU X109-EXIT.
       A1129-EXIT.
           EXIT.
      *
       A1130-MCMMAS-CHG.
      ****************************************************************
      *‚      CHECK FOR A DEPENDENT CHANGE WITH THE MCMMAS RECORD
      ****************************************************************
           MOVE 'N'                                TO MCRCHG-FLAG.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MCMMAS-REC.
           PERFORM MCMMAS-READ                     IF INVALID-KEY
              INITIALIZE MCMMAS-REC.
      *
           IF (MPAEDT OF EEWDEP(EDPACT) NOT = ZERO
           AND MPAEDT OF EEWDEP(EDPACT) NOT = MPAEDT OF MCMMAS-REC)
           OR (MPAETD OF EEWDEP(EDPACT) NOT = ZERO
           AND MPAETD OF EEWDEP(EDPACT) NOT = MPAETD OF MCMMAS-REC)
           OR (MPAEFD OF EEWDEP(EDPACT) NOT = ZERO
           AND MPAEFD OF EEWDEP(EDPACT) NOT = MPAEFD OF MCMMAS-REC)
           OR (MPATDT OF EEWDEP(EDPACT) NOT = ZERO
           AND MPATDT OF EEWDEP(EDPACT) NOT = MPATDT OF MCMMAS-REC)
           OR (MPBEDT OF EEWDEP(EDPACT) NOT = ZERO
           AND MPBEDT OF EEWDEP(EDPACT) NOT = MPBEDT OF MCMMAS-REC)
           OR (MPBETD OF EEWDEP(EDPACT) NOT = ZERO
           AND MPBETD OF EEWDEP(EDPACT) NOT = MPBETD OF MCMMAS-REC)
           OR (MPBEFD OF EEWDEP(EDPACT) NOT = ZERO
           AND MPBEFD OF EEWDEP(EDPACT) NOT = MPBEFD OF MCMMAS-REC)
           OR (MPBTDT OF EEWDEP(EDPACT) NOT = ZERO
           AND MPBTDT OF EEWDEP(EDPACT) NOT = MPBTDT OF MCMMAS-REC)
           OR (MPLNCD OF EEWDEP(EDPACT) NOT = SPACES
           AND MPLNCD OF EEWDEP(EDPACT) NOT = MPLNCD OF MCMMAS-REC)
               MOVE 'Y'                          TO MCRCHG-FLAG.
       A1139-EXIT.
           EXIT.
      *
       A1200-INIT-MDMMAS.
           INITIALIZE                        MDMMAS-REC.
           MOVE 'EDI'                        TO USERID OF MDMMAS-REC.
           MOVE 'EDI201C'                    TO TERMID OF MDMMAS-REC.
           MOVE CURDAT                       TO SYSDAT OF MDMMAS-REC.
           MOVE CURDAT                       TO LSTCHG OF MDMMAS-REC.
       A1209-EXIT.
           EXIT.
      *
       A1300-CRT-DODMAS.
           INITIALIZE DODMAS-REC.
           MOVE BRANCD OF MDTMAS-REC   TO BRANCD OF DODMAS-REC.
           MOVE BATDAT OF MDTMAS-REC   TO BATDAT OF DODMAS-REC.
           MOVE BATSEQ OF MDTMAS-REC   TO BATSEQ OF DODMAS-REC.
           MOVE SEQNUM OF MDTMAS-REC   TO SEQNUM OF DODMAS-REC.
           MOVE LINENO OF MDTMAS-REC   TO LINENO OF DODMAS-REC.
           MOVE MEMBNO OF MDTMAS-REC   TO MEMBNO OF DODMAS-REC.
           MOVE DOCNUM OF WS-WORK      TO DOCNUM OF DODMAS-REC.
           MOVE ZEROS                  TO DOCDAT OF DODMAS-REC.
           MOVE CURDAT                 TO SYSDAT OF DODMAS-REC
                                          LSTCHG OF DODMAS-REC.
           MOVE 'ED201C'               TO USERID OF DODMAS-REC.
           MOVE 'SYSTEM'               TO TERMID OF DODMAS-REC.
      *
           PERFORM DODMAS-WRITE                  IF INVALID-KEY
             MOVE 'Y'                            TO PRCERR
             MOVE SPACES               TO MESSAGE-INTERFACE-PARAMETERS
             MOVE 'DODMAS'                       TO MI-PARM4
             MOVE DODMAS-STATUS                  TO MI-PARM5
             MOVE 'EI06062'                      TO MI-PRIMARY-ID
             PERFORM X100-PRINT-ERROR            THRU X109-EXIT.
       A1309-EXIT.
           EXIT.
      *
       A1310-WRITE-RSPDOCBT.
      ****************************************************************
      *‚   Write the RSPDOCBT record for the subscriber              *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           SET IO-RESULT-OK     TO TRUE.
      *
           MOVE 'A'                  TO RSPDOCBTMI OF RSPDOCBT-REC.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO RSPNUM OF RSPDOCBT-REC.
           MOVE RSPIDC OF EEWDP2(EDPACT) TO RSPIDC OF RSPDOCBT-REC.
           MOVE RESPNB OF EEWDP2(EDPACT) TO RESPNB OF RSPDOCBT-REC.
           MOVE RSPLST OF EEWDP2(EDPACT) TO RSPLST OF RSPDOCBT-REC.
           MOVE RSPFST OF EEWDP2(EDPACT) TO RSPFST OF RSPDOCBT-REC.
           MOVE RSPMID OF EEWDP2(EDPACT) TO RSPMID OF RSPDOCBT-REC.
           MOVE RSPTTL OF EEWDP2(EDPACT) TO RSPTTL OF RSPDOCBT-REC.
           MOVE RSPFRM OF EEWDP2(EDPACT) TO RSPFRM OF RSPDOCBT-REC.
           MOVE RADLN1 OF EEWDP2(EDPACT) TO RADLN1 OF RSPDOCBT-REC.
           MOVE RADLN2 OF EEWDP2(EDPACT) TO RADLN2 OF RSPDOCBT-REC.
           MOVE RCTYCD OF EEWDP2(EDPACT) TO RCTYCD OF RSPDOCBT-REC.
           MOVE RSTACD OF EEWDP2(EDPACT) TO RSTACD OF RSPDOCBT-REC.
           MOVE RZIPCD OF EEWDP2(EDPACT) TO RZIPCD OF RSPDOCBT-REC.
           MOVE RCNTRY OF EEWDP2(EDPACT) TO RCNTRY OF RSPDOCBT-REC.
           MOVE RCNTCT OF EEWDP2(EDPACT) TO RCNTCT OF RSPDOCBT-REC.
           MOVE RHOMPH OF EEWDP2(EDPACT) TO RHOMPH OF RSPDOCBT-REC.
           MOVE RWRKPH OF EEWDP2(EDPACT) TO RWRKPH OF RSPDOCBT-REC.
           MOVE RWKEXT OF EEWDP2(EDPACT) TO RWKEXT OF RSPDOCBT-REC.
           MOVE RFAXNB OF EEWDP2(EDPACT) TO RFAXNB OF RSPDOCBT-REC.
           MOVE ROTHPH OF EEWDP2(EDPACT) TO ROTHPH OF RSPDOCBT-REC.
           MOVE REMLIN OF EEWDP2(EDPACT) TO REMLIN OF RSPDOCBT-REC.
           MOVE REMAIL OF EEWDP2(EDPACT) TO REMAIL OF RSPDOCBT-REC.
      *
           MOVE RALTPH OF EEWDP2(EDPACT) TO RALTPH OF RSPDOCBT-REC.
           MOVE RBEPNB OF EEWDP2(EDPACT) TO RBEPNB OF RSPDOCBT-REC.
           MOVE RCELPH OF EEWDP2(EDPACT) TO RCELPH OF RSPDOCBT-REC.
      *
           MOVE 'ED201C'              TO RSPDOCUSR OF RSPDOCBT-REC.
           MOVE 'EDI'                 TO RSPDOCTRM OF RSPDOCBT-REC.
           MOVE SPACES                TO PRPIND OF RSPDOCBT-REC
                                         PRDIND OF RSPDOCBT-REC
                                         CORREP OF RSPDOCBT-REC
                                         PRDRSN OF RSPDOCBT-REC.
      *
           CALL 'RSPDOCBTM' USING IO-COMMUNICATION, RSPDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE MEMBNO OF EEWDEP(ESBACT)      TO MEMBNO OF ERR-LINE
              MOVE GRPNUM OF EEWDEP(ESBACT)      TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWDEP(ESBACT)      TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWDEP(ESBACT)      TO RELCOD OF ERR-LINE
              MOVE CHGTYP OF EEWDEP(ESBACT)      TO CHGTYP OF ERR-LINE
              MOVE 'EI99954'                     TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'RSPDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWDEP(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI99955'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'RSPDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1319-EXIT.
           EXIT.
       B1310-WRITE-EXTDOCBT.
      ****************************************************************
      * ‚  Write the EXTDOCBT record for the subscriber              *
      ****************************************************************
           MOVE HSAIND OF EEWDP2(EDPACT) TO HSAIND OF EXTDOCBT-REC.
           MOVE HRAIND OF EEWDP2(EDPACT) TO HRAIND OF EXTDOCBT-REC.
           MOVE FSAIND OF EEWDP2(EDPACT) TO FSAIND OF EXTDOCBT-REC.
           MOVE OTHIND OF EEWDP2(EDPACT) TO OTHIND OF EXTDOCBT-REC.
           MOVE MPDIND OF EEWDP2(EDPACT) TO MPDIND OF EXTDOCBT-REC.
           MOVE PHAIND OF EEWDP2(EDPACT) TO PHAIND OF EXTDOCBT-REC.
           MOVE DENIND OF EEWDP2(EDPACT) TO DENIND OF EXTDOCBT-REC.
           MOVE VISIND OF EEWDP2(EDPACT) TO VISIND OF EXTDOCBT-REC.
           MOVE MHTIND OF EEWDP2(EDPACT) TO MHTIND OF EXTDOCBT-REC.
           MOVE OTHBEN OF EEWDP2(EDPACT) TO OTHBEN OF EXTDOCBT-REC.
           MOVE FSAAMT OF EEWDP2(EDPACT) TO FSAAMT OF EXTDOCBT-REC.
           MOVE 'EDI'                    TO USERID OF EXTDOCBT-REC.
           MOVE 'EDI201C'                TO TERMID OF EXTDOCBT-REC.
           MOVE CURDAT                   TO SYSDAT OF EXTDOCBT-REC.
           MOVE CURDAT                   TO LSTCHG OF EXTDOCBT-REC.
           PERFORM EXTDOCBT-WRITE                IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EXTDOCBT'                    TO MI-PARM4
              MOVE EXTDOCBT-STATUS               TO MI-PARM5
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO B1319-EXIT
              END-IF.
       B1319-EXIT.
           EXIT.
      /
       A1320-WRITE-RSPDOCBT.
      ****************************************************************
      *  ‚ Write the RSPDOCBT record for the dependent               *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           SET IO-RESULT-OK     TO TRUE.
      *
           MOVE 'A'                  TO RSPDOCBTMI OF RSPDOCBT-REC.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO RSPNUM OF RSPDOCBT-REC.
           MOVE RSPIDC OF EEWSB2(ESBACT) TO RSPIDC OF RSPDOCBT-REC.
           MOVE RESPNB OF EEWSB2(ESBACT) TO RESPNB OF RSPDOCBT-REC.
           MOVE RSPLST OF EEWSB2(ESBACT) TO RSPLST OF RSPDOCBT-REC.
           MOVE RSPFST OF EEWSB2(ESBACT) TO RSPFST OF RSPDOCBT-REC.
           MOVE RSPMID OF EEWSB2(ESBACT) TO RSPMID OF RSPDOCBT-REC.
           MOVE RSPTTL OF EEWSB2(ESBACT) TO RSPTTL OF RSPDOCBT-REC.
           MOVE RSPFRM OF EEWSB2(ESBACT) TO RSPFRM OF RSPDOCBT-REC.
           MOVE RADLN1 OF EEWSB2(ESBACT) TO RADLN1 OF RSPDOCBT-REC.
           MOVE RADLN2 OF EEWSB2(ESBACT) TO RADLN2 OF RSPDOCBT-REC.
           MOVE RCTYCD OF EEWSB2(ESBACT) TO RCTYCD OF RSPDOCBT-REC.
           MOVE RSTACD OF EEWSB2(ESBACT) TO RSTACD OF RSPDOCBT-REC.
           MOVE RZIPCD OF EEWSB2(ESBACT) TO RZIPCD OF RSPDOCBT-REC.
           MOVE RCNTRY OF EEWSB2(ESBACT) TO RCNTRY OF RSPDOCBT-REC.
           MOVE RCNTCT OF EEWSB2(ESBACT) TO RCNTCT OF RSPDOCBT-REC.
           MOVE RHOMPH OF EEWSB2(ESBACT) TO RHOMPH OF RSPDOCBT-REC.
           MOVE RWRKPH OF EEWSB2(ESBACT) TO RWRKPH OF RSPDOCBT-REC.
           MOVE RWKEXT OF EEWSB2(ESBACT) TO RWKEXT OF RSPDOCBT-REC.
           MOVE RFAXNB OF EEWSB2(ESBACT) TO RFAXNB OF RSPDOCBT-REC.
           MOVE ROTHPH OF EEWSB2(ESBACT) TO ROTHPH OF RSPDOCBT-REC.
           MOVE REMLIN OF EEWSB2(ESBACT) TO REMLIN OF RSPDOCBT-REC.
           MOVE REMAIL OF EEWSB2(ESBACT) TO REMAIL OF RSPDOCBT-REC.
      *
           MOVE RALTPH OF EEWSB2(ESBACT) TO RALTPH OF RSPDOCBT-REC.
           MOVE RBEPNB OF EEWSB2(ESBACT) TO RBEPNB OF RSPDOCBT-REC.
           MOVE RCELPH OF EEWSB2(ESBACT) TO RCELPH OF RSPDOCBT-REC.
      *
           MOVE 'ED201C'              TO RSPDOCUSR OF RSPDOCBT-REC.
           MOVE 'EDI'                 TO RSPDOCTRM OF RSPDOCBT-REC.
           MOVE SPACES                TO PRPIND OF RSPDOCBT-REC
                                         PRDIND OF RSPDOCBT-REC
                                         CORREP OF RSPDOCBT-REC
                                         PRDRSN OF RSPDOCBT-REC.
      *
           CALL 'RSPDOCBTM' USING IO-COMMUNICATION, RSPDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE MEMBNO OF EEWSUB(ESBACT)      TO MEMBNO OF ERR-LINE
              MOVE GRPNUM OF EEWSUB(ESBACT)      TO GRPNUM OF ERR-LINE
              MOVE SUBSNO OF EEWSUB(ESBACT)      TO SUBSNO OF ERR-LINE
              MOVE RELCOD OF EEWSUB(ESBACT)      TO RELCOD OF ERR-LINE
              MOVE CHGTYP OF EEWSUB(ESBACT)      TO CHGTYP OF ERR-LINE
              MOVE 'EI99954'                     TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'RSPDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI99955'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'RSPDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1329-EXIT.
           EXIT.
      *
       B1320-WRITE-EXTDOCBT.
      ****************************************************************
      *‚   Write the EXTDOCBT record for the dependent               *
      ****************************************************************
           MOVE HSAIND OF EEWSB2(ESBACT) TO HSAIND OF EXTDOCBT-REC.
           MOVE HRAIND OF EEWSB2(ESBACT) TO HRAIND OF EXTDOCBT-REC.
           MOVE FSAIND OF EEWSB2(ESBACT) TO FSAIND OF EXTDOCBT-REC.
           MOVE OTHIND OF EEWSB2(ESBACT) TO OTHIND OF EXTDOCBT-REC.
           MOVE MPDIND OF EEWSB2(ESBACT) TO MPDIND OF EXTDOCBT-REC.
           MOVE PHAIND OF EEWSB2(ESBACT) TO PHAIND OF EXTDOCBT-REC.
           MOVE DENIND OF EEWSB2(ESBACT) TO DENIND OF EXTDOCBT-REC.
           MOVE VISIND OF EEWSB2(ESBACT) TO VISIND OF EXTDOCBT-REC.
           MOVE MHTIND OF EEWSB2(ESBACT) TO MHTIND OF EXTDOCBT-REC.
           MOVE OTHBEN OF EEWSB2(ESBACT) TO OTHBEN OF EXTDOCBT-REC.
           MOVE FSAAMT OF EEWSB2(ESBACT) TO FSAAMT OF EXTDOCBT-REC.
           MOVE 'EDI'                    TO USERID OF EXTDOCBT-REC.
           MOVE 'EDI201C'                TO TERMID OF EXTDOCBT-REC.
           MOVE CURDAT                   TO SYSDAT OF EXTDOCBT-REC.
           MOVE CURDAT                   TO LSTCHG OF EXTDOCBT-REC.

           PERFORM EXTDOCBT-WRITE                IF INVALID-KEY
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EXTDOCBT'                    TO MI-PARM4
              MOVE EXTDOCBT-STATUS               TO MI-PARM5
              MOVE 'EI06062'                     TO MI-PRIMARY-ID
              MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
              MOVE ERR-LINE                      TO LINE-E
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
              MOVE 'Y'                 TO PRCERR OF PGM-WORK
              GO TO B1329-EXIT
              END-IF.
      *
       B1329-EXIT.
           EXIT.
      /
       A1330-WRITE-DEMDOCBT.
      ****************************************************************
      *‚   Write the DEMDOCBT record for the subscriber              *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           SET IO-RESULT-OK     TO TRUE.
      *
           MOVE 'A'                  TO DEMDOCBTMI OF DEMDOCBT-REC.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF DEMDOCBT-REC.
           MOVE ZEROES                   TO MEMSEQ OF DEMDOCBT-REC.
           MOVE CITZEN OF EEWDP2(EDPACT) TO CITZEN OF DEMDOCBT-REC.
           MOVE FRQCOD OF EEWDP2(EDPACT) TO FRQCOD OF DEMDOCBT-REC.
           MOVE WAGAMT OF EEWDP2(EDPACT) TO WAGAMT OF DEMDOCBT-REC.
           MOVE WRKHRS OF EEWDP2(EDPACT) TO WRKHRS OF DEMDOCBT-REC.
           MOVE WORKLC OF EEWDP2(EDPACT) TO WORKLC OF DEMDOCBT-REC.
           MOVE SALGRD OF EEWDP2(EDPACT) TO SALGRD OF DEMDOCBT-REC.
           MOVE HLTCOD OF EEWDP2(EDPACT) TO HLTCOD OF DEMDOCBT-REC.
           MOVE SMKCES OF EEWDP2(EDPACT) TO SMKCES OF DEMDOCBT-REC.
           MOVE HEIGHT OF EEWDP2(EDPACT) TO HEIGHT OF DEMDOCBT-REC.
           MOVE WEIGHT OF EEWDP2(EDPACT) TO WEIGHT OF DEMDOCBT-REC.
           MOVE LNGCD1 OF EEWDP2(EDPACT) TO LNGCD1 OF DEMDOCBT-REC.
           MOVE LNGUS1 OF EEWDP2(EDPACT) TO LNGUS1 OF DEMDOCBT-REC.
           MOVE LNGCD2 OF EEWDP2(EDPACT) TO LNGCD2 OF DEMDOCBT-REC.
           MOVE LNGUS2 OF EEWDP2(EDPACT) TO LNGUS2 OF DEMDOCBT-REC.
           MOVE LNGCD3 OF EEWDP2(EDPACT) TO LNGCD3 OF DEMDOCBT-REC.
           MOVE LNGUS3 OF EEWDP2(EDPACT) TO LNGUS3 OF DEMDOCBT-REC.
           MOVE LNGCD4 OF EEWDP2(EDPACT) TO LNGCD4 OF DEMDOCBT-REC.
           MOVE LNGUS4 OF EEWDP2(EDPACT) TO LNGUS4 OF DEMDOCBT-REC.
           MOVE LNGCD5 OF EEWDP2(EDPACT) TO LNGCD5 OF DEMDOCBT-REC.
           MOVE LNGUS5 OF EEWDP2(EDPACT) TO LNGUS5 OF DEMDOCBT-REC.
           MOVE SCHOOL OF EEWDP2(EDPACT) TO SCHOOL OF DEMDOCBT-REC.
           MOVE SPHNUM OF EEWDP2(EDPACT) TO SPHNUM OF DEMDOCBT-REC.
           MOVE SPHEXT OF EEWDP2(EDPACT) TO SPHEXT OF DEMDOCBT-REC.
           MOVE SFAXNB OF EEWDP2(EDPACT) TO SFAXNB OF DEMDOCBT-REC.
           MOVE SEMAIL OF EEWDP2(EDPACT) TO SEMAIL OF DEMDOCBT-REC.
           MOVE SADRL1 OF EEWDP2(EDPACT) TO SADRL1 OF DEMDOCBT-REC.
           MOVE SADRL2 OF EEWDP2(EDPACT) TO SADRL2 OF DEMDOCBT-REC.
           MOVE SCTYCD OF EEWDP2(EDPACT) TO SCTYCD OF DEMDOCBT-REC.
           MOVE SSTACD OF EEWDP2(EDPACT) TO SSTACD OF DEMDOCBT-REC.
           MOVE SZIPCD OF EEWDP2(EDPACT) TO SZIPCD OF DEMDOCBT-REC.
           MOVE SCNTRY OF EEWDP2(EDPACT) TO SCNTRY OF DEMDOCBT-REC.
           MOVE ALTPHN OF EEWDP2(EDPACT) TO ALTPHN OF DEMDOCBT-REC.
           MOVE BEPNBR OF EEWDP2(EDPACT) TO BEPNBR OF DEMDOCBT-REC.
           MOVE CELPHN OF EEWDP2(EDPACT) TO CELPHN OF DEMDOCBT-REC.
           MOVE SCHCLK OF EEWDP2(EDPACT) TO SCHCLK OF DEMDOCBT-REC.
           MOVE 'U'                      TO CNFCOD OF DEMDOCBT-REC.
           IF CNFCOD OF EEWDP2(EDPACT) NOT = SPACES
              MOVE CNFCOD OF EEWDP2(EDPACT)
                                       TO CNFCOD OF DEMDOCBT-REC.
      *
           MOVE 'ED201C'              TO DEMDOCUSR OF DEMDOCBT-REC.
           MOVE 'EDI'                 TO DEMDOCTRM OF DEMDOCBT-REC.
      *
           CALL 'DEMDOCBTM' USING IO-COMMUNICATION, DEMDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'DEMDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'DEMDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1339-EXIT.
           EXIT.
      /
       A1340-WRITE-DEMDOCBT.
      ****************************************************************
      *‚   Write the DEMDOCBT record for the dependent               *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           SET IO-RESULT-OK     TO TRUE.
      *
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF DEMDOCBT-REC.
           MOVE CITZEN OF EEWSB2(ESBACT) TO CITZEN OF DEMDOCBT-REC.
           MOVE FRQCOD OF EEWSB2(ESBACT) TO FRQCOD OF DEMDOCBT-REC.
           MOVE WAGAMT OF EEWSB2(ESBACT) TO WAGAMT OF DEMDOCBT-REC.
           MOVE WRKHRS OF EEWSB2(ESBACT) TO WRKHRS OF DEMDOCBT-REC.
           MOVE WORKLC OF EEWSB2(ESBACT) TO WORKLC OF DEMDOCBT-REC.
           MOVE SALGRD OF EEWSB2(ESBACT) TO SALGRD OF DEMDOCBT-REC.
           MOVE HLTCOD OF EEWSB2(ESBACT) TO HLTCOD OF DEMDOCBT-REC.
           MOVE SMKCES OF EEWSB2(ESBACT) TO SMKCES OF DEMDOCBT-REC.
           MOVE HEIGHT OF EEWSB2(ESBACT) TO HEIGHT OF DEMDOCBT-REC.
           MOVE WEIGHT OF EEWSB2(ESBACT) TO WEIGHT OF DEMDOCBT-REC.
           MOVE LNGCD1 OF EEWSB2(ESBACT) TO LNGCD1 OF DEMDOCBT-REC.
           MOVE LNGUS1 OF EEWSB2(ESBACT) TO LNGUS1 OF DEMDOCBT-REC.
           MOVE LNGCD2 OF EEWSB2(ESBACT) TO LNGCD2 OF DEMDOCBT-REC.
           MOVE LNGUS2 OF EEWSB2(ESBACT) TO LNGUS2 OF DEMDOCBT-REC.
           MOVE LNGCD3 OF EEWSB2(ESBACT) TO LNGCD3 OF DEMDOCBT-REC.
           MOVE LNGUS3 OF EEWSB2(ESBACT) TO LNGUS3 OF DEMDOCBT-REC.
           MOVE LNGCD4 OF EEWSB2(ESBACT) TO LNGCD4 OF DEMDOCBT-REC.
           MOVE LNGUS4 OF EEWSB2(ESBACT) TO LNGUS4 OF DEMDOCBT-REC.
           MOVE LNGCD5 OF EEWSB2(ESBACT) TO LNGCD5 OF DEMDOCBT-REC.
           MOVE LNGUS5 OF EEWSB2(ESBACT) TO LNGUS5 OF DEMDOCBT-REC.
           MOVE SCHOOL OF EEWSB2(ESBACT) TO SCHOOL OF DEMDOCBT-REC.
           MOVE SPHNUM OF EEWSB2(ESBACT) TO SPHNUM OF DEMDOCBT-REC.
           MOVE SPHEXT OF EEWSB2(ESBACT) TO SPHEXT OF DEMDOCBT-REC.
           MOVE SFAXNB OF EEWSB2(ESBACT) TO SFAXNB OF DEMDOCBT-REC.
           MOVE SEMAIL OF EEWSB2(ESBACT) TO SEMAIL OF DEMDOCBT-REC.
           MOVE SADRL1 OF EEWSB2(ESBACT) TO SADRL1 OF DEMDOCBT-REC.
           MOVE SADRL2 OF EEWSB2(ESBACT) TO SADRL2 OF DEMDOCBT-REC.
           MOVE SCTYCD OF EEWSB2(ESBACT) TO SCTYCD OF DEMDOCBT-REC.
           MOVE SSTACD OF EEWSB2(ESBACT) TO SSTACD OF DEMDOCBT-REC.
           MOVE SZIPCD OF EEWSB2(ESBACT) TO SZIPCD OF DEMDOCBT-REC.
           MOVE SCNTRY OF EEWSB2(ESBACT) TO SCNTRY OF DEMDOCBT-REC.
           MOVE ALTPHN OF EEWSB2(ESBACT) TO ALTPHN OF DEMDOCBT-REC.
           MOVE BEPNBR OF EEWSB2(ESBACT) TO BEPNBR OF DEMDOCBT-REC.
           MOVE CELPHN OF EEWSB2(ESBACT) TO CELPHN OF DEMDOCBT-REC.
           MOVE SCHCLK OF EEWSB2(ESBACT) TO SCHCLK OF DEMDOCBT-REC.
           MOVE 'U'                      TO CNFCOD OF DEMDOCBT-REC.
           IF WS-CNFCOD-FLG = 'A'
              IF CNFCOD OF EEWSB2(ESBACT) NOT = SPACES
                 MOVE CNFCOD OF EEWSB2(ESBACT)
                                         TO CNFCOD OF DEMDOCBT-REC
              END-IF
           ELSE
           IF WS-CNFCOD-FLG = 'C'
              IF CNFCOD OF EEWSB2(ESBACT) = SPACES
                 IF CNFCOD OF SUBEXT(DEMTMP) NOT = SPACES
                    MOVE CNFCOD OF SUBEXT(DEMTMP)
                                         TO CNFCOD OF DEMDOCBT-REC
                 END-IF
              ELSE
                 MOVE CNFCOD OF EEWSB2(ESBACT)
                                         TO CNFCOD OF DEMDOCBT-REC
              END-IF.
      *
           MOVE SPACES                           TO WS-CNFCOD-FLG.
      *
           MOVE 'ED201C'              TO DEMDOCUSR OF DEMDOCBT-REC.
           MOVE 'EDI'                 TO DEMDOCTRM OF DEMDOCBT-REC.
      *
           CALL 'DEMDOCBTM' USING IO-COMMUNICATION, DEMDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'DEMDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'DEMDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1349-EXIT.
           EXIT.
      /
       A1350-WRITE-ALTDOCBT.
      ****************************************************************
      *‚   Write the ALTDOCBT record for the dependent               *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ALTDOCBT-REC.
           MOVE ALTAD1 OF EEWDP2(EDPACT) TO ALTAD1 OF ALTDOCBT-REC.
           MOVE ALTAD2 OF EEWDP2(EDPACT) TO ALTAD2 OF ALTDOCBT-REC.
           MOVE ALTCTY OF EEWDP2(EDPACT) TO ALTCTY OF ALTDOCBT-REC.
           MOVE ALTSTT OF EEWDP2(EDPACT) TO ALTSTT OF ALTDOCBT-REC.
           MOVE ALTPST OF EEWDP2(EDPACT) TO ALTPST OF ALTDOCBT-REC.
           MOVE ALTCNR OF EEWDP2(EDPACT) TO ALTCNR OF ALTDOCBT-REC.
           MOVE SPACES                TO CORALT    OF ALTDOCBT-REC.
           MOVE 'ED201C'              TO ALTDOCUSR OF ALTDOCBT-REC.
           MOVE 'EDI'                 TO ALTDOCTRM OF ALTDOCBT-REC.
      *
           CALL 'ALTDOCBTM' USING IO-COMMUNICATION, ALTDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'ALTDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'ALTDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1359-EXIT.
           EXIT.
      /
       A1360-WRITE-ALTDOCBT.
      ****************************************************************
      *‚   Write the ALTDOCBT record for the surscriber              *
      ****************************************************************
           SET IO-INSERT-SINGLE TO TRUE.
           MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ALTDOCBT-REC.
           MOVE ALTAD1 OF EEWSB2(ESBACT) TO ALTAD1 OF ALTDOCBT-REC.
           MOVE ALTAD2 OF EEWSB2(ESBACT) TO ALTAD2 OF ALTDOCBT-REC.
           MOVE ALTCTY OF EEWSB2(ESBACT) TO ALTCTY OF ALTDOCBT-REC.
           MOVE ALTSTT OF EEWSB2(ESBACT) TO ALTSTT OF ALTDOCBT-REC.
           MOVE ALTPST OF EEWSB2(ESBACT) TO ALTPST OF ALTDOCBT-REC.
           MOVE ALTCNR OF EEWSB2(ESBACT) TO ALTCNR OF ALTDOCBT-REC.
           MOVE SPACES                 TO CORALT   OF ALTDOCBT-REC.
           MOVE 'ED201C'              TO ALTDOCUSR OF ALTDOCBT-REC.
           MOVE 'EDI'                 TO ALTDOCTRM OF ALTDOCBT-REC.
      *
           CALL 'ALTDOCBTM' USING IO-COMMUNICATION, ALTDOCBT-LM-PARMS.
           IF IO-DUPLICATE
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99954'                     TO MI-PRIMARY-ID
              MOVE 'ALTDOCBT'                    TO MI-PARM4
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
           ELSE
              IF NOT IO-RESULT-OK
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'WRITE'                    TO MI-PARM4
                 MOVE 'ALTDOCBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT.
       A1369-EXIT.
           EXIT.
      *
       A1370-WRITE-EDIDOCBT.
      ****************************************************************
      *‚   Write the EDIDOCBT record for the Subscriber              *
      ****************************************************************
           PERFORM EDIDOCBT-START                IF NOT INVALID-KEY
              GO TO A1379-EXIT
           END-IF.

           MOVE EPCLS1 OF EEWSB2(ESBACT) TO EPCLS1 OF EDIDOCBT-REC.
           MOVE EPCLS2 OF EEWSB2(ESBACT) TO EPCLS2 OF EDIDOCBT-REC.
           MOVE EPCLS3 OF EEWSB2(ESBACT) TO EPCLS3 OF EDIDOCBT-REC.
           MOVE RPCTNM OF EEWSB2(ESBACT) TO RPCTNM OF EDIDOCBT-REC.
           MOVE RPCTQL OF EEWSB2(ESBACT) TO RPCTQL OF EDIDOCBT-REC.
           MOVE RPCTID OF EEWSB2(ESBACT) TO RPCTID OF EDIDOCBT-REC.
           MOVE RDTFMT OF EEWSB2(ESBACT) TO RDTFMT OF EDIDOCBT-REC.
           MOVE RCTDAT OF EEWSB2(ESBACT) TO RCTDAT OF EDIDOCBT-REC.
           MOVE DOLLST OF EEWSB2(ESBACT) TO DOLLST OF EDIDOCBT-REC.
           MOVE DOLFST OF EEWSB2(ESBACT) TO DOLFST OF EDIDOCBT-REC.
           MOVE DOLMID OF EEWSB2(ESBACT) TO DOLMID OF EDIDOCBT-REC.
           MOVE DOLPRE OF EEWSB2(ESBACT) TO DOLPRE OF EDIDOCBT-REC.
           MOVE DOLSUF OF EEWSB2(ESBACT) TO DOLSUF OF EDIDOCBT-REC.
           MOVE DOLAD1 OF EEWSB2(ESBACT) TO DOLAD1 OF EDIDOCBT-REC.
           MOVE DOLAD2 OF EEWSB2(ESBACT) TO DOLAD2 OF EDIDOCBT-REC.
           MOVE DOLCTY OF EEWSB2(ESBACT) TO DOLCTY OF EDIDOCBT-REC.
           MOVE DOLSTA OF EEWSB2(ESBACT) TO DOLSTA OF EDIDOCBT-REC.
           MOVE DOLZIP OF EEWSB2(ESBACT) TO DOLZIP OF EDIDOCBT-REC.
           MOVE DOLCCD OF EEWSB2(ESBACT) TO DOLCCD OF EDIDOCBT-REC.
           MOVE DOLSCD OF EEWSB2(ESBACT) TO DOLSCD OF EDIDOCBT-REC.
           MOVE ICMRCQ OF EEWSB2(ESBACT) TO ICMRCQ OF EDIDOCBT-REC.
           MOVE ICMRCC OF EEWSB2(ESBACT) TO ICMRCC OF EDIDOCBT-REC.
           MOVE MDRCCC OF EEWSB2(ESBACT) TO MDRCCC OF EDIDOCBT-REC.
           MOVE COBAD1 OF EEWSB2(ESBACT) TO COBAD1 OF EDIDOCBT-REC.
           MOVE COBAD2 OF EEWSB2(ESBACT) TO COBAD2 OF EDIDOCBT-REC.
           MOVE COBCTY OF EEWSB2(ESBACT) TO COBCTY OF EDIDOCBT-REC.
           MOVE COBSTA OF EEWSB2(ESBACT) TO COBSTA OF EDIDOCBT-REC.
           MOVE COBZIP OF EEWSB2(ESBACT) TO COBZIP OF EDIDOCBT-REC.
           MOVE COBCCD OF EEWSB2(ESBACT) TO COBCCD OF EDIDOCBT-REC.
           MOVE COBCSB OF EEWSB2(ESBACT) TO COBCSB OF EDIDOCBT-REC.
           MOVE COBPHN OF EEWSB2(ESBACT) TO COBPHN OF EDIDOCBT-REC.
           MOVE CSPCSB OF EEWSB2(ESBACT) TO CSPCSB OF EDIDOCBT-REC.
           MOVE CNTSCD OF EEWSB2(ESBACT) TO CNTSCD OF EDIDOCBT-REC.
           MOVE SCHSCD OF EEWSB2(ESBACT) TO SCHSCD OF EDIDOCBT-REC.
           MOVE MBMCSB OF EEWSB2(ESBACT) TO MBMCSB OF EDIDOCBT-REC.
      *
           EVALUATE RSPIDC OF EEWSB2(ESBACT)
              WHEN 'E1'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP1CSB OF EDIDOCBT-REC
              WHEN 'EI'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP2CSB OF EDIDOCBT-REC
              WHEN 'EXS'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP3CSB OF EDIDOCBT-REC
              WHEN 'GD'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP4CSB OF EDIDOCBT-REC
              WHEN 'J6'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP5CSB OF EDIDOCBT-REC
              WHEN 'QD'
                 MOVE RPTCSB OF EEWSB2(ESBACT)
                                       TO RP6CSB OF EDIDOCBT-REC
           END-EVALUATE.
      *
           MOVE 'ED201C'               TO USERID OF EDIDOCBT-REC.
           MOVE 'EDI'                  TO TERMID OF EDIDOCBT-REC.
           MOVE CURDAT                 TO SYSDAT OF EDIDOCBT-REC
                                          LSTCHG OF EDIDOCBT-REC.
      *
           PERFORM EDIDOCBT-WRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99955'                     TO MI-PRIMARY-ID
              MOVE 'WRITE'                       TO MI-PARM4
              MOVE 'EDIDOCBT'                    TO MI-PARM5
              MOVE EDIDOCBT-STATUS               TO MI-PARM6
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
       A1379-EXIT.
           EXIT.
      *
       A1380-WRITE-EDIDOCBT.
      ****************************************************************
      *‚   Write the EDIDOCBT record for the member                  *
      ****************************************************************
           PERFORM EDIDOCBT-START                IF NOT INVALID-KEY
              GO TO A1389-EXIT
           END-IF.
      *
           MOVE EPCLS1 OF EEWDP2(EDPACT)
                                       TO EPCLS1 OF EDIDOCBT-REC.
           MOVE EPCLS2 OF EEWDP2(EDPACT)
                                       TO EPCLS2 OF EDIDOCBT-REC.
           MOVE EPCLS3 OF EEWDP2(EDPACT)
                                       TO EPCLS3 OF EDIDOCBT-REC.
           MOVE RPCTNM OF EEWDP2(EDPACT)
                                       TO RPCTNM OF EDIDOCBT-REC.
           MOVE RPCTQL OF EEWDP2(EDPACT)
                                       TO RPCTQL OF EDIDOCBT-REC.
           MOVE RPCTID OF EEWDP2(EDPACT)
                                       TO RPCTID OF EDIDOCBT-REC.
           MOVE RDTFMT OF EEWDP2(EDPACT)
                                       TO RDTFMT OF EDIDOCBT-REC.
           MOVE RCTDAT OF EEWDP2(EDPACT)
                                       TO RCTDAT OF EDIDOCBT-REC.
           MOVE DOLLST OF EEWDP2(EDPACT)
                                       TO DOLLST OF EDIDOCBT-REC.
           MOVE DOLFST OF EEWDP2(EDPACT)
                                       TO DOLFST OF EDIDOCBT-REC.
           MOVE DOLMID OF EEWDP2(EDPACT)
                                       TO DOLMID OF EDIDOCBT-REC.
           MOVE DOLPRE OF EEWDP2(EDPACT)
                                       TO DOLPRE OF EDIDOCBT-REC.
           MOVE DOLSUF OF EEWDP2(EDPACT)
                                       TO DOLSUF OF EDIDOCBT-REC.
           MOVE DOLAD1 OF EEWDP2(EDPACT)
                                       TO DOLAD1 OF EDIDOCBT-REC.
           MOVE DOLAD2 OF EEWDP2(EDPACT)
                                       TO DOLAD2 OF EDIDOCBT-REC.
           MOVE DOLCTY OF EEWDP2(EDPACT)
                                       TO DOLCTY OF EDIDOCBT-REC.
           MOVE DOLSTA OF EEWDP2(EDPACT)
                                       TO DOLSTA OF EDIDOCBT-REC.
           MOVE DOLZIP OF EEWDP2(EDPACT)
                                       TO DOLZIP OF EDIDOCBT-REC.
           MOVE DOLCCD OF EEWDP2(EDPACT)
                                       TO DOLCCD OF EDIDOCBT-REC.
           MOVE DOLSCD OF EEWDP2(EDPACT)
                                       TO DOLSCD OF EDIDOCBT-REC.
           MOVE ICMRCQ OF EEWDP2(EDPACT)
                                       TO ICMRCQ OF EDIDOCBT-REC.
           MOVE ICMRCC OF EEWDP2(EDPACT)
                                       TO ICMRCC OF EDIDOCBT-REC.
           MOVE MDRCCC OF EEWDP2(EDPACT)
                                       TO MDRCCC OF EDIDOCBT-REC.
           MOVE COBAD1 OF EEWDP2(EDPACT)
                                       TO COBAD1 OF EDIDOCBT-REC.
           MOVE COBAD2 OF EEWDP2(EDPACT)
                                       TO COBAD2 OF EDIDOCBT-REC.
           MOVE COBCTY OF EEWDP2(EDPACT)
                                       TO COBCTY OF EDIDOCBT-REC.
           MOVE COBSTA OF EEWDP2(EDPACT)
                                       TO COBSTA OF EDIDOCBT-REC.
           MOVE COBZIP OF EEWDP2(EDPACT)
                                       TO COBZIP OF EDIDOCBT-REC.
           MOVE COBCCD OF EEWDP2(EDPACT)
                                       TO COBCCD OF EDIDOCBT-REC.
           MOVE COBCSB OF EEWDP2(EDPACT)
                                       TO COBCSB OF EDIDOCBT-REC.
           MOVE COBPHN OF EEWDP2(EDPACT)
                                       TO COBPHN OF EDIDOCBT-REC.
           MOVE CSPCSB OF EEWDP2(EDPACT)
                                       TO CSPCSB OF EDIDOCBT-REC.
           MOVE CNTSCD OF EEWDP2(EDPACT)
                                       TO CNTSCD OF EDIDOCBT-REC.
           MOVE SCHSCD OF EEWDP2(EDPACT)
                                       TO SCHSCD OF EDIDOCBT-REC.
           MOVE MBMCSB OF EEWDP2(EDPACT)
                                       TO MBMCSB OF EDIDOCBT-REC.
      *
           EVALUATE RSPIDC OF EEWDP2(EDPACT)
              WHEN 'E1'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP1CSB OF EDIDOCBT-REC
              WHEN 'EI'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP2CSB OF EDIDOCBT-REC
              WHEN 'EXS'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP3CSB OF EDIDOCBT-REC
              WHEN 'GD'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP4CSB OF EDIDOCBT-REC
              WHEN 'J6'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP5CSB OF EDIDOCBT-REC
              WHEN 'QD'
                 MOVE RPTCSB OF EEWDP2(EDPACT)
                                       TO RP6CSB OF EDIDOCBT-REC
           END-EVALUATE.
      *
           MOVE 'ED201C'               TO USERID OF EDIDOCBT-REC.
           MOVE 'EDI'                  TO TERMID OF EDIDOCBT-REC.
           MOVE CURDAT                 TO SYSDAT OF EDIDOCBT-REC
                                          LSTCHG OF EDIDOCBT-REC.
      *
           PERFORM EDIDOCBT-WRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99955'                     TO MI-PRIMARY-ID
              MOVE 'WRITE'                       TO MI-PARM4
              MOVE 'EDIDOCBT'                    TO MI-PARM5
              MOVE EDIDOCBT-STATUS               TO MI-PARM6
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.
       A1389-EXIT.
           EXIT.
      /
       A1390-DEMEXTBT-CHG.
      ****************************************************************
      *‚   Check for a change in the Demogrphic Extension Fields     *
      ****************************************************************
           MOVE 'N'                              TO DEMEXT-FLAG.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE DEMEXTBT-REC.
           MOVE MEMSEQ OF DEMMAS-REC     TO MEMSEQ OF DEMEXTBT-REC.
           CALL 'DEMEXTBTM'   USING IO-COMMUNICATION DEMEXTBT-LM-PARMS.
           IF (CITZEN OF EEWSB2(ESBACT) NOT = SPACES
           AND CITZEN OF EEWSB2(ESBACT) NOT = CITZEN OF DEMEXTBT-REC)
           OR (FRQCOD OF EEWSB2(ESBACT) NOT = SPACES
           AND FRQCOD OF EEWSB2(ESBACT) NOT = FRQCOD OF DEMEXTBT-REC)
           OR (WAGAMT OF EEWSB2(ESBACT) NOT = ZEROES
           AND WAGAMT OF EEWSB2(ESBACT) NOT = WAGAMT OF DEMEXTBT-REC)
           OR (WRKHRS OF EEWSB2(ESBACT) NOT = ZEROES
           AND WRKHRS OF EEWSB2(ESBACT) NOT = WRKHRS OF DEMEXTBT-REC)
           OR (WORKLC OF EEWSB2(ESBACT) NOT = SPACES
           AND WORKLC OF EEWSB2(ESBACT) NOT = WORKLC OF DEMEXTBT-REC)
           OR (SALGRD OF EEWSB2(ESBACT) NOT = SPACES
           AND SALGRD OF EEWSB2(ESBACT) NOT = SALGRD OF DEMEXTBT-REC)
           OR (HLTCOD OF EEWSB2(ESBACT) NOT = SPACES
           AND HLTCOD OF EEWSB2(ESBACT) NOT = HLTCOD OF DEMEXTBT-REC)
           OR (HEIGHT OF EEWSB2(ESBACT) NOT = ZEROES
           AND HEIGHT OF EEWSB2(ESBACT) NOT = HEIGHT OF DEMEXTBT-REC)
           OR (WEIGHT OF EEWSB2(ESBACT) NOT = ZEROES
           AND WEIGHT OF EEWSB2(ESBACT) NOT = WEIGHT OF DEMEXTBT-REC)
           OR (LNGCD1 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGCD1 OF EEWSB2(ESBACT) NOT = LNGCD1 OF DEMEXTBT-REC)
           OR (LNGUS1 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGUS1 OF EEWSB2(ESBACT) NOT = LNGUS1 OF DEMEXTBT-REC)
           OR (LNGCD2 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGCD2 OF EEWSB2(ESBACT) NOT = LNGCD2 OF DEMEXTBT-REC)
           OR (LNGUS2 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGUS2 OF EEWSB2(ESBACT) NOT = LNGUS2 OF DEMEXTBT-REC)
           OR (LNGCD3 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGCD3 OF EEWSB2(ESBACT) NOT = LNGCD3 OF DEMEXTBT-REC)
           OR (LNGUS3 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGUS3 OF EEWSB2(ESBACT) NOT = LNGUS3 OF DEMEXTBT-REC)
           OR (LNGCD4 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGCD4 OF EEWSB2(ESBACT) NOT = LNGCD4 OF DEMEXTBT-REC)
           OR (LNGUS4 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGUS4 OF EEWSB2(ESBACT) NOT = LNGUS4 OF DEMEXTBT-REC)
           OR (LNGCD5 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGCD5 OF EEWSB2(ESBACT) NOT = LNGCD5 OF DEMEXTBT-REC)
           OR (LNGUS5 OF EEWSB2(ESBACT) NOT = SPACES
           AND LNGUS5 OF EEWSB2(ESBACT) NOT = LNGUS5 OF DEMEXTBT-REC)
           OR (SCHOOL OF EEWSB2(ESBACT) NOT = SPACES
           AND SCHOOL OF EEWSB2(ESBACT) NOT = SCHOOL OF DEMEXTBT-REC)
           OR (SPHNUM OF EEWSB2(ESBACT) NOT = SPACES
           AND SPHNUM OF EEWSB2(ESBACT) NOT = SPHNUM OF DEMEXTBT-REC)
           OR (SPHEXT OF EEWSB2(ESBACT) NOT = SPACES
           AND SPHEXT OF EEWSB2(ESBACT) NOT = SPHEXT OF DEMEXTBT-REC)
           OR (SFAXNB OF EEWSB2(ESBACT) NOT = SPACES
           AND SFAXNB OF EEWSB2(ESBACT) NOT = SFAXNB OF DEMEXTBT-REC)
           OR (SEMAIL OF EEWSB2(ESBACT) NOT = SPACES
           AND SEMAIL OF EEWSB2(ESBACT) NOT = SEMAIL OF DEMEXTBT-REC)
           OR (SADRL1 OF EEWSB2(ESBACT) NOT = SPACES
           AND SADRL1 OF EEWSB2(ESBACT) NOT = SADRL1 OF DEMEXTBT-REC)
           OR (SADRL2 OF EEWSB2(ESBACT) NOT = SPACES
           AND SADRL2 OF EEWSB2(ESBACT) NOT = SADRL2 OF DEMEXTBT-REC)
           OR (SCTYCD OF EEWSB2(ESBACT) NOT = SPACES
           AND SCTYCD OF EEWSB2(ESBACT) NOT = SCTYCD OF DEMEXTBT-REC)
           OR (SSTACD OF EEWSB2(ESBACT) NOT = SPACES
           AND SSTACD OF EEWSB2(ESBACT) NOT = SSTACD OF DEMEXTBT-REC)
           OR (SZIPCD OF EEWSB2(ESBACT) NOT = SPACES
           AND SZIPCD OF EEWSB2(ESBACT) NOT = SZIPCD OF DEMEXTBT-REC)
           OR (SCNTRY OF EEWSB2(ESBACT) NOT = SPACES
           AND SCNTRY OF EEWSB2(ESBACT) NOT = SCNTRY OF DEMEXTBT-REC)
           OR (ALTPHN OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTPHN OF EEWSB2(ESBACT) NOT = ALTPHN OF DEMEXTBT-REC)
           OR (SCHCLK OF EEWSB2(ESBACT) NOT = SPACES
           AND SCHCLK OF EEWSB2(ESBACT) NOT = SCHCLK OF DEMEXTBT-REC)
           OR (BEPNBR OF EEWSB2(ESBACT) NOT = SPACES
           AND BEPNBR OF EEWSB2(ESBACT) NOT = BEPNBR OF DEMEXTBT-REC)
           OR (CELPHN OF EEWSB2(ESBACT) NOT = SPACES
           AND CELPHN OF EEWSB2(ESBACT) NOT = CELPHN OF DEMEXTBT-REC)
           OR (SMKCES OF EEWSB2(ESBACT) NOT = SPACES
           AND SMKCES OF EEWSB2(ESBACT) NOT = SMKCES OF DEMEXTBT-REC)
              MOVE 'Y'                           TO DEMEXT-FLAG.
       A1399-EXIT.
           EXIT.
      /
       A1410-RSPPTYBT-CHG.
      ****************************************************************
      *‚   Check for a change in the responsible party fields        *
      ****************************************************************
           MOVE 'N'                              TO RSPPTY-FLAG.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE RSPPTYBT-REC.
           MOVE MEMSEQ OF DEPTAB(DEPTMP) TO MEMSEQ OF RSPPTYBT-REC.
           IF RSPIDC OF EEWDP2(EDPACT) = SPACES
              MOVE 'QD'                  TO RSPIDC OF RSPPTYBT-REC
           ELSE
              MOVE RSPIDC OF EEWDP2(EDPACT)
                                       TO RSPIDC OF RSPPTYBT-REC.
           CALL 'RSPPTYBTM'   USING IO-COMMUNICATION RSPPTYBT-LM-PARMS.
      *
           INITIALIZE EMLPTRBV-REC.
           MOVE 'R'                      TO EMLTYP OF EMLPTRBV-REC.
           MOVE RSPNUM OF RSPPTYBT-REC        TO WS-EMLEID(1:15)
           MOVE RSPIDC OF RSPPTYBT-REC        TO WS-EMLEID(16:5)
           MOVE WS-EMLEID                TO EMLEID OF EMLPTRBV-REC.
           CALL 'EMLPTRBVM'   USING IO-COMMUNICATION EMLPTRBV-LM-PARMS.
      *
           IF (RSPIDC OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPIDC OF EEWDP2(EDPACT) NOT = RSPIDC OF RSPPTYBT-REC)
           OR (RESPNB OF EEWDP2(EDPACT) NOT = SPACES
           AND RESPNB OF EEWDP2(EDPACT) NOT = RESPNB OF RSPPTYBT-REC)
           OR (RSPLST OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPLST OF EEWDP2(EDPACT) NOT = RSPLST OF RSPPTYBT-REC)
           OR (RSPFST OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPFST OF EEWDP2(EDPACT) NOT = RSPFST OF RSPPTYBT-REC)
           OR (RSPMID OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPMID OF EEWDP2(EDPACT) NOT = RSPMID OF RSPPTYBT-REC)
           OR (RSPTTL OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPTTL OF EEWDP2(EDPACT) NOT = RSPTTL OF RSPPTYBT-REC)
           OR (RSPFRM OF EEWDP2(EDPACT) NOT = SPACES
           AND RSPFRM OF EEWDP2(EDPACT) NOT = RSPFRM OF RSPPTYBT-REC)
           OR (RADLN1 OF EEWDP2(EDPACT) NOT = SPACES
           AND RADLN1 OF EEWDP2(EDPACT) NOT = RADLN1 OF RSPPTYBT-REC)
           OR (RADLN2 OF EEWDP2(EDPACT) NOT = SPACES
           AND RADLN2 OF EEWDP2(EDPACT) NOT = RADLN2 OF RSPPTYBT-REC)
           OR (RCTYCD OF EEWDP2(EDPACT) NOT = SPACES
           AND RCTYCD OF EEWDP2(EDPACT) NOT = RCTYCD OF RSPPTYBT-REC)
           OR (RSTACD OF EEWDP2(EDPACT) NOT = SPACES
           AND RSTACD OF EEWDP2(EDPACT) NOT = RSTACD OF RSPPTYBT-REC)
           OR (RZIPCD OF EEWDP2(EDPACT) NOT = SPACES
           AND RZIPCD OF EEWDP2(EDPACT) NOT = RZIPCD OF RSPPTYBT-REC)
           OR (RCNTRY OF EEWDP2(EDPACT) NOT = SPACES
           AND RCNTRY OF EEWDP2(EDPACT) NOT = RCNTRY OF RSPPTYBT-REC)
           OR (RCNTCT OF EEWDP2(EDPACT) NOT = SPACES
           AND RCNTCT OF EEWDP2(EDPACT) NOT = RCNTCT OF RSPPTYBT-REC)
           OR (RHOMPH OF EEWDP2(EDPACT) NOT = SPACES
           AND RHOMPH OF EEWDP2(EDPACT) NOT = RHOMPH OF RSPPTYBT-REC)
           OR (RWRKPH OF EEWDP2(EDPACT) NOT = SPACES
           AND RWRKPH OF EEWDP2(EDPACT) NOT = RWRKPH OF RSPPTYBT-REC)
           OR (RWKEXT OF EEWDP2(EDPACT) NOT = SPACES
           AND RWKEXT OF EEWDP2(EDPACT) NOT = RWKEXT OF RSPPTYBT-REC)
           OR (RFAXNB OF EEWDP2(EDPACT) NOT = SPACES
           AND RFAXNB OF EEWDP2(EDPACT) NOT = RFAXNB OF RSPPTYBT-REC)
           OR (ROTHPH OF EEWDP2(EDPACT) NOT = SPACES
           AND ROTHPH OF EEWDP2(EDPACT) NOT = ROTHPH OF RSPPTYBT-REC)
           OR (REMLIN OF EEWDP2(EDPACT) NOT = SPACES
           AND REMLIN OF EEWDP2(EDPACT) NOT = REMLIN OF RSPPTYBT-REC)
           OR (REMAIL OF EEWDP2(EDPACT) NOT = SPACES
           AND REMAIL OF EEWDP2(EDPACT) NOT = EMLTXT OF EMLPTRBV-REC)
           OR (RALTPH OF EEWDP2(EDPACT) NOT = SPACES
           AND RALTPH OF EEWDP2(EDPACT) NOT = RALTPH OF RSPPTYBT-REC)
           OR (RBEPNB OF EEWDP2(EDPACT) NOT = SPACES
           AND RBEPNB OF EEWDP2(EDPACT) NOT = RBEPNB OF RSPPTYBT-REC)
           OR (RCELPH OF EEWDP2(EDPACT) NOT = SPACES
           AND RCELPH OF EEWDP2(EDPACT) NOT = RCELPH OF RSPPTYBT-REC)
              MOVE 'Y'                           TO RSPPTY-FLAG.
       A1419-EXIT.
           EXIT.
      /
       A1420-RSPPTYBT-CHG.
      ****************************************************************
      *    Check for a change in the responsible party fields        *
      ****************************************************************
           MOVE 'N'                              TO RSPPTY-FLAG.
      *
           MOVE ZERO                             TO ROWRET.
           MOVE SPACES                           TO ERRFLG
                                                    ADLROW
                                                    ADLERR
                                                    OUT-MESSAGES.
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE RSPPTYBT-REC.
           MOVE MEMSEQ OF DEMMAS-REC     TO MEMSEQ OF RSPPTYBT-REC.
           IF RSPIDC OF EEWSB2(ESBACT) = SPACES
              MOVE 'QD'                  TO RSPIDC OF RSPPTYBT-REC
           ELSE
              MOVE RSPIDC OF EEWSB2(ESBACT)
                                       TO RSPIDC OF RSPPTYBT-REC.
           CALL 'RSPPTYBTM'   USING IO-COMMUNICATION RSPPTYBT-LM-PARMS.
      *
           INITIALIZE EMLPTRBV-REC.
           MOVE 'R'                      TO EMLTYP OF EMLPTRBV-REC.
           MOVE RSPNUM OF RSPPTYBT-REC        TO WS-EMLEID(1:15)
           MOVE RSPIDC OF RSPPTYBT-REC        TO WS-EMLEID(16:5)
           MOVE WS-EMLEID                TO EMLEID OF EMLPTRBV-REC.
           CALL 'EMLPTRBVM'   USING IO-COMMUNICATION EMLPTRBV-LM-PARMS.
      *
           IF (RSPIDC OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPIDC OF EEWSB2(ESBACT) NOT = RSPIDC OF RSPPTYBT-REC)
           OR (RESPNB OF EEWSB2(ESBACT) NOT = SPACES
           AND RESPNB OF EEWSB2(ESBACT) NOT = RESPNB OF RSPPTYBT-REC)
           OR (RSPLST OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPLST OF EEWSB2(ESBACT) NOT = RSPLST OF RSPPTYBT-REC)
           OR (RSPFST OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPFST OF EEWSB2(ESBACT) NOT = RSPFST OF RSPPTYBT-REC)
           OR (RSPMID OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPMID OF EEWSB2(ESBACT) NOT = RSPMID OF RSPPTYBT-REC)
           OR (RSPTTL OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPTTL OF EEWSB2(ESBACT) NOT = RSPTTL OF RSPPTYBT-REC)
           OR (RSPFRM OF EEWSB2(ESBACT) NOT = SPACES
           AND RSPFRM OF EEWSB2(ESBACT) NOT = RSPFRM OF RSPPTYBT-REC)
           OR (RADLN1 OF EEWSB2(ESBACT) NOT = SPACES
           AND RADLN1 OF EEWSB2(ESBACT) NOT = RADLN1 OF RSPPTYBT-REC)
           OR (RADLN2 OF EEWSB2(ESBACT) NOT = SPACES
           AND RADLN2 OF EEWSB2(ESBACT) NOT = RADLN2 OF RSPPTYBT-REC)
           OR (RCTYCD OF EEWSB2(ESBACT) NOT = SPACES
           AND RCTYCD OF EEWSB2(ESBACT) NOT = RCTYCD OF RSPPTYBT-REC)
           OR (RSTACD OF EEWSB2(ESBACT) NOT = SPACES
           AND RSTACD OF EEWSB2(ESBACT) NOT = RSTACD OF RSPPTYBT-REC)
           OR (RZIPCD OF EEWSB2(ESBACT) NOT = SPACES
           AND RZIPCD OF EEWSB2(ESBACT) NOT = RZIPCD OF RSPPTYBT-REC)
           OR (RCNTRY OF EEWSB2(ESBACT) NOT = SPACES
           AND RCNTRY OF EEWSB2(ESBACT) NOT = RCNTRY OF RSPPTYBT-REC)
           OR (RCNTCT OF EEWSB2(ESBACT) NOT = SPACES
           AND RCNTCT OF EEWSB2(ESBACT) NOT = RCNTCT OF RSPPTYBT-REC)
           OR (RHOMPH OF EEWSB2(ESBACT) NOT = SPACES
           AND RHOMPH OF EEWSB2(ESBACT) NOT = RHOMPH OF RSPPTYBT-REC)
           OR (RWRKPH OF EEWSB2(ESBACT) NOT = SPACES
           AND RWRKPH OF EEWSB2(ESBACT) NOT = RWRKPH OF RSPPTYBT-REC)
           OR (RWKEXT OF EEWSB2(ESBACT) NOT = SPACES
           AND RWKEXT OF EEWSB2(ESBACT) NOT = RWKEXT OF RSPPTYBT-REC)
           OR (RFAXNB OF EEWSB2(ESBACT) NOT = SPACES
           AND RFAXNB OF EEWSB2(ESBACT) NOT = RFAXNB OF RSPPTYBT-REC)
           OR (ROTHPH OF EEWSB2(ESBACT) NOT = SPACES
           AND ROTHPH OF EEWSB2(ESBACT) NOT = ROTHPH OF RSPPTYBT-REC)
           OR (REMLIN OF EEWSB2(ESBACT) NOT = SPACES
           AND REMLIN OF EEWSB2(ESBACT) NOT = REMLIN OF RSPPTYBT-REC)
           OR (REMAIL OF EEWSB2(ESBACT) NOT = SPACES
           AND REMAIL OF EEWSB2(ESBACT) NOT = EMLTXT OF EMLPTRBV-REC)
           OR (RALTPH OF EEWSB2(ESBACT) NOT = SPACES
           AND RALTPH OF EEWSB2(ESBACT) NOT = RALTPH OF RSPPTYBT-REC)
           OR (RBEPNB OF EEWSB2(ESBACT) NOT = SPACES
           AND RBEPNB OF EEWSB2(ESBACT) NOT = RBEPNB OF RSPPTYBT-REC)
           OR (RCELPH OF EEWSB2(ESBACT) NOT = SPACES
           AND RCELPH OF EEWSB2(ESBACT) NOT = RCELPH OF RSPPTYBT-REC)
              MOVE 'Y'                           TO RSPPTY-FLAG.
       A1429-EXIT.
           EXIT.
      *
       A1430-WRITE-EXCMDTBT.
      ****************************************************************
      *‚   Write the EXCMDTBT record for the Subscriber              *
      ****************************************************************
           MOVE ZEROES                           TO INDX.
           MOVE WS-EXC-BRANCD          TO BRANCD OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATDAT          TO BATDAT OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATSEQ          TO BATSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXC-SEQNUM          TO SEQNUM OF EXCMDTBT-KEY.
           MOVE WS-EXC-LINENO          TO LINENO OF EXCMDTBT-KEY.
           MOVE WS-EXC-MEMSEQ          TO MEMSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXCSEQ              TO EXCSEQ OF EXCMDTBT-KEY.
      *
           PERFORM EXCMDTBT-STARTGE              IF INVALID-KEY
              GO TO A1432-CONTINUE
           END-IF.
      *
       A1431-NEXT.
           PERFORM EXCMDTBT-READNX               IF AT-END
              GO TO A1432-CONTINUE
           END-IF.
      *
           IF WS-EXC-BRANCD NOT = BRANCD OF EXCMDTBT-KEY
           OR WS-EXC-BATDAT NOT = BATDAT OF EXCMDTBT-KEY
           OR WS-EXC-BATSEQ NOT = BATSEQ OF EXCMDTBT-KEY
           OR WS-EXC-SEQNUM NOT = SEQNUM OF EXCMDTBT-KEY
           OR WS-EXC-LINENO NOT = LINENO OF EXCMDTBT-KEY
              GO TO A1432-CONTINUE
           END-IF.
      *
           IF  WS-EXC-BRANCD = BRANCD OF EXCMDTBT-KEY
           AND WS-EXC-BATDAT = BATDAT OF EXCMDTBT-KEY
           AND WS-EXC-BATSEQ = BATSEQ OF EXCMDTBT-KEY
           AND WS-EXC-SEQNUM = SEQNUM OF EXCMDTBT-KEY
           AND WS-EXC-LINENO = LINENO OF EXCMDTBT-KEY
              ADD 1                    TO WS-EXCSEQ
              GO TO A1431-NEXT
           END-IF.
      *
       A1432-CONTINUE.
      *
           IF INDX > WS-TB3CNT
              GO TO A1439-EXIT.

           IF INDX > ZEROES
              ADD 1                    TO WS-EXCSEQ.
      *
           INITIALIZE EXCMDTBT-REC.
           MOVE WS-EXC-BRANCD            TO BRANCD OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATDAT            TO BATDAT OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATSEQ            TO BATSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXC-SEQNUM            TO SEQNUM OF EXCMDTBT-KEY.
           IF RECTYP OF MDTMAS-REC = '2'
              MOVE WS-EXC-LINENO         TO LINENO OF EXCMDTBT-KEY
           ELSE
           IF RECTYP OF MDTMAS-REC = '3'
              MOVE 1                     TO LINENO OF EXCMDTBT-KEY
           ELSE
              MOVE 1                     TO LINENO OF EXCMDTBT-KEY.
      *
           IF WS-TRMSUB = 'Y'
              MOVE 2                     TO LINENO OF EXCMDTBT-KEY.
      *
           MOVE WS-EXC-MEMSEQ            TO MEMSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXCSEQ                TO EXCSEQ OF EXCMDTBT-KEY.
           MOVE RELCOD OF EEWSB3(ESBACT) TO RELCOD OF EXCMDTBT-REC.
           MOVE EXCSUB OF EEWSUB(ESBACT) TO EXCSUB OF EXCMDTBT-REC.
           MOVE EXCMEM OF EEWSUB(ESBACT) TO EXCMEM OF EXCMDTBT-REC.
           MOVE SPNQLF OF EEWHDR-WRK     TO SPNQLF OF EXCMDTBT-REC.
           MOVE PRVSUB OF EEWSB2(ESBACT) TO PRVSUB OF EXCMDTBT-REC.
           IF INDX > ZEROES
              GO TO A1432-CONTINUE-TB3.
           MOVE OPYAMT OF EEWSB3(ESBACT) TO OPYAMT OF EXCMDTBT-REC.
           MOVE OPYAMT OF EEWSB3(ESBACT)           TO SAV-OPYAMT.
           MOVE OPYEFF OF EEWSB3(ESBACT) TO OPYEFF OF EXCMDTBT-REC.
           MOVE OPYEXP OF EEWSB3(ESBACT) TO OPYEXP OF EXCMDTBT-REC.
           MOVE OPYSRC OF EEWSB3(ESBACT) TO OPYSRC OF EXCMDTBT-REC.
           MOVE APTAMT OF EEWSB3(ESBACT) TO APTAMT OF EXCMDTBT-REC.
           MOVE APTAMT OF EEWSB3(ESBACT)           TO SAV-APTAMT.
           MOVE APTEFF OF EEWSB3(ESBACT) TO APTEFF OF EXCMDTBT-REC.
           MOVE APTEXP OF EEWSB3(ESBACT) TO APTEXP OF EXCMDTBT-REC.
           MOVE CSRAMT OF EEWSB3(ESBACT) TO CSRAMT OF EXCMDTBT-REC.
           MOVE CSREFF OF EEWSB3(ESBACT) TO CSREFF OF EXCMDTBT-REC.
           MOVE CSREXP OF EEWSB3(ESBACT) TO CSREXP OF EXCMDTBT-REC.
           MOVE PREAMT OF EEWSB3(ESBACT) TO PREAMT OF EXCMDTBT-REC.
           MOVE PREEFF OF EEWSB3(ESBACT) TO PREEFF OF EXCMDTBT-REC.
           MOVE PREEXP OF EEWSB3(ESBACT) TO PREEXP OF EXCMDTBT-REC.
           MOVE RSPTOT OF EEWSB3(ESBACT) TO RSPTOT OF EXCMDTBT-REC.
           MOVE RSPEFF OF EEWSB3(ESBACT) TO RSPEFF OF EXCMDTBT-REC.
           MOVE RSPEXP OF EEWSB3(ESBACT) TO RSPEXP OF EXCMDTBT-REC.
           MOVE PRETOT OF EEWSB3(ESBACT) TO PRETOT OF EXCMDTBT-REC.
           MOVE PRETOT OF EEWSB3(ESBACT)           TO SAV-PRETOT.
           MOVE PTOEFF OF EEWSB3(ESBACT) TO PTOEFF OF EXCMDTBT-REC.
           MOVE PTOEXP OF EEWSB3(ESBACT) TO PTOEXP OF EXCMDTBT-REC.
           MOVE EMPTOT OF EEWSB3(ESBACT) TO EMPTOT OF EXCMDTBT-REC.
           MOVE EMPEFF OF EEWSB3(ESBACT) TO EMPEFF OF EXCMDTBT-REC.
           MOVE EMPEXP OF EEWSB3(ESBACT) TO EMPEXP OF EXCMDTBT-REC.
       A1432-CONTINUE-TB3.
           IF INDX > ZEROES
              MOVE WS-TB3-OPYAMT(INDX)   TO OPYAMT OF EXCMDTBT-REC
              MOVE WS-TB3-OPYAMT(INDX)             TO SAV-OPYAMT
              MOVE WS-TB3-OPYEFF(INDX)   TO OPYEFF OF EXCMDTBT-REC
              MOVE WS-TB3-OPYEXP(INDX)   TO OPYEXP OF EXCMDTBT-REC
              MOVE WS-TB3-OPYSRC(INDX)   TO OPYSRC OF EXCMDTBT-REC
              MOVE WS-TB3-APTAMT(INDX)   TO APTAMT OF EXCMDTBT-REC
              MOVE WS-TB3-APTAMT(INDX)             TO SAV-APTAMT
              MOVE WS-TB3-APTEFF(INDX)   TO APTEFF OF EXCMDTBT-REC
              MOVE WS-TB3-APTEXP(INDX)   TO APTEXP OF EXCMDTBT-REC
              MOVE WS-TB3-CSRAMT(INDX)   TO CSRAMT OF EXCMDTBT-REC
              MOVE WS-TB3-CSREFF(INDX)   TO CSREFF OF EXCMDTBT-REC
              MOVE WS-TB3-CSREXP(INDX)   TO CSREXP OF EXCMDTBT-REC
              MOVE WS-TB3-PREAMT(INDX)   TO PREAMT OF EXCMDTBT-REC
              MOVE WS-TB3-PREEFF(INDX)   TO PREEFF OF EXCMDTBT-REC
              MOVE WS-TB3-PREEXP(INDX)   TO PREEXP OF EXCMDTBT-REC
              MOVE WS-TB3-RSPTOT(INDX)   TO RSPTOT OF EXCMDTBT-REC
              MOVE WS-TB3-RSPEFF(INDX)   TO RSPEFF OF EXCMDTBT-REC
              MOVE WS-TB3-RSPEXP(INDX)   TO RSPEXP OF EXCMDTBT-REC
              MOVE WS-TB3-PRETOT(INDX)   TO PRETOT OF EXCMDTBT-REC
              MOVE WS-TB3-PRETOT(INDX)             TO SAV-PRETOT
              MOVE WS-TB3-PTOEFF(INDX)   TO PTOEFF OF EXCMDTBT-REC
              MOVE WS-TB3-PTOEXP(INDX)   TO PTOEXP OF EXCMDTBT-REC
              MOVE WS-TB3-EMPTOT(INDX)   TO EMPTOT OF EXCMDTBT-REC
              MOVE WS-TB3-EMPEFF(INDX)   TO EMPEFF OF EXCMDTBT-REC
              MOVE WS-TB3-EMPEXP(INDX)   TO EMPEXP OF EXCMDTBT-REC.
      ****--------------------------------------------------------****
      ****  PMHS-269  KCT  Fix                                    ****
      ****  Capture proper Reason Category.                       ****
      ****--------------------------------------------------------****
      **** MOVE REACAT OF EEWSB3(ESBACT) TO REACAT OF EXCMDTBT-REC.
      **** MOVE WS-REACAT2               TO REACAT OF EXCMDTBT-REC.
           IF WS-REACAT2 = SPACES
              MOVE REACAT OF EEWSB3(ESBACT) TO REACAT OF EXCMDTBT-REC
           ELSE
              MOVE WS-REACAT2            TO REACAT OF EXCMDTBT-REC.
           MOVE TRMEFF OF EEWSB3(ESBACT) TO TRMEFF OF EXCMDTBT-REC.
           MOVE RATARA OF EEWSB3(ESBACT) TO RATARA OF EXCMDTBT-REC.
           MOVE RATEFF OF EEWSB3(ESBACT) TO RATEFF OF EXCMDTBT-REC.
           MOVE RATEXP OF EEWSB3(ESBACT) TO RATEXP OF EXCMDTBT-REC.
           MOVE SHPGRP OF EEWSB2(ESBACT) TO SHPGRP OF EXCMDTBT-REC.
           MOVE EXCPOL OF EEWSB2(ESBACT) TO EXCPOL OF EXCMDTBT-REC.
           MOVE ASSQHP OF EEWSB3(ESBACT) TO ASSQHP OF EXCMDTBT-REC.
           MOVE PYMTID OF EEWSUB(ESBACT) TO PYMTID OF EXCMDTBT-REC.
      ****--------------------------------------------------------****
      ****  PMHS-269  KCT  Fix                                    ****
      ****  Capture proper Term Reason Code.                      ****
      ****--------------------------------------------------------****
      **** MOVE SPACES                   TO TRMREA OF EXCMDTBT-REC.
           IF TRMEFF OF EEWSB3(ESBACT) = 0
              MOVE SPACES                TO TRMREA OF EXCMDTBT-REC
           ELSE
              MOVE MEMTRM OF EEWSUB(ESBACT) TO TRMREA OF EXCMDTBT-REC.
           MOVE 'ED201C'                 TO USERID OF EXCMDTBT-REC.
           MOVE 'EDI'                    TO TERMID OF EXCMDTBT-REC.
           MOVE CURDAT                   TO SYSDAT OF EXCMDTBT-REC
                                            LSTCHG OF EXCMDTBT-REC.
           IF EXCHNG OF EEWSB2(ESBACT) = 'EI'
           AND CHGTYP OF EEWSB3(ESBACT) = 'A'
              PERFORM A1600-ZERO-PREMIUM    THRU A1609-EXIT
           END-IF.
      *
           PERFORM EXCMDTBT-WRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99955'                     TO MI-PRIMARY-ID
              MOVE 'WRITE'                       TO MI-PARM4
              MOVE 'EXCMDTBT'                    TO MI-PARM5
              MOVE EXCMDTBT-STATUS               TO MI-PARM6
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.

           ADD +1                                TO INDX.
           GO TO A1432-CONTINUE.

       A1439-EXIT.
           EXIT.
      *
       A1440-WRITE-EXCMDTBT.
      ****************************************************************
      *    Write the EXCMEMBT record for the Dependant               *
      ****************************************************************
           MOVE ZEROES                           TO INDX.
           INITIALIZE EXCMDTBT-KEY.
           MOVE WS-EXC-BRANCD          TO BRANCD OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATDAT          TO BATDAT OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATSEQ          TO BATSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXC-SEQNUM          TO SEQNUM OF EXCMDTBT-KEY.
           MOVE WS-EXC-LINENO          TO LINENO OF EXCMDTBT-KEY.
           MOVE WS-EXC-MEMSEQ          TO MEMSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXCSEQ              TO EXCSEQ OF EXCMDTBT-KEY.
      *
           PERFORM EXCMDTBT-STARTGE              IF INVALID-KEY
              GO TO A1442-CONTINUE
           END-IF.
      *
       A1441-NEXT.
           PERFORM EXCMDTBT-READNX               IF AT-END
              GO TO A1442-CONTINUE
           END-IF.
      *
           IF WS-EXC-BRANCD NOT = BRANCD OF EXCMDTBT-KEY
           OR WS-EXC-BATDAT NOT = BATDAT OF EXCMDTBT-KEY
           OR WS-EXC-BATSEQ NOT = BATSEQ OF EXCMDTBT-KEY
           OR WS-EXC-SEQNUM NOT = SEQNUM OF EXCMDTBT-KEY
           OR WS-EXC-LINENO NOT = LINENO OF EXCMDTBT-KEY
              GO TO A1442-CONTINUE
           END-IF.

           IF  WS-EXC-BRANCD = BRANCD OF EXCMDTBT-KEY
           AND WS-EXC-BATDAT = BATDAT OF EXCMDTBT-KEY
           AND WS-EXC-BATSEQ = BATSEQ OF EXCMDTBT-KEY
           AND WS-EXC-SEQNUM = SEQNUM OF EXCMDTBT-KEY
           AND WS-EXC-LINENO = LINENO OF EXCMDTBT-KEY
              ADD 1                              TO WS-EXCSEQ
              GO TO A1441-NEXT
           END-IF.

       A1442-CONTINUE.
           IF INDX > WS-TB3CNT
              GO TO A1449-EXIT.
           IF INDX > ZEROES
              ADD 1                    TO WS-EXCSEQ.
      *

           MOVE WS-EXC-BRANCD            TO BRANCD OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATDAT            TO BATDAT OF EXCMDTBT-KEY.
           MOVE WS-EXC-BATSEQ            TO BATSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXC-SEQNUM            TO SEQNUM OF EXCMDTBT-KEY.
           IF RECTYP OF MDTMAS-REC = '2'
              MOVE WS-EXC-LINENO         TO LINENO OF EXCMDTBT-KEY
           ELSE
           IF RECTYP OF MDTMAS-REC = '3'
              MOVE 1                     TO LINENO OF EXCMDTBT-KEY
           ELSE
              MOVE 1                     TO LINENO OF EXCMDTBT-KEY.
      *
           IF WS-TRMDEP = 'Y'
              MOVE 2                     TO LINENO OF EXCMDTBT-KEY.
      *
           MOVE WS-EXC-MEMSEQ            TO MEMSEQ OF EXCMDTBT-KEY.
           MOVE WS-EXCSEQ                TO EXCSEQ OF EXCMDTBT-KEY
           MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF EXCMDTBT-REC.
           MOVE EXCSUB OF EEWDEP(EDPACT) TO EXCSUB OF EXCMDTBT-REC.
           MOVE EXCMEM OF EEWDEP(EDPACT) TO EXCMEM OF EXCMDTBT-REC.
           MOVE SPNQLF OF EEWHDR-WRK     TO SPNQLF OF EXCMDTBT-REC.
           MOVE PRVSUB OF EEWDP2(EDPACT) TO PRVSUB OF EXCMDTBT-REC.
           IF INDX > ZEROES
              GO TO A1442-CONTINUE-TB3.
           MOVE OPYAMT OF EEWDP3(EDPACT) TO OPYAMT OF EXCMDTBT-REC.
           MOVE OPYEFF OF EEWDP3(EDPACT) TO OPYEFF OF EXCMDTBT-REC.
           MOVE OPYEXP OF EEWDP3(EDPACT) TO OPYEXP OF EXCMDTBT-REC.
           MOVE OPYSRC OF EEWDP3(EDPACT) TO OPYSRC OF EXCMDTBT-REC.
           MOVE APTAMT OF EEWDP3(EDPACT) TO APTAMT OF EXCMDTBT-REC.
           MOVE APTEFF OF EEWDP3(EDPACT) TO APTEFF OF EXCMDTBT-REC.
           MOVE APTEXP OF EEWDP3(EDPACT) TO APTEXP OF EXCMDTBT-REC.
           MOVE CSRAMT OF EEWDP3(EDPACT) TO CSRAMT OF EXCMDTBT-REC.
           MOVE CSREFF OF EEWDP3(EDPACT) TO CSREFF OF EXCMDTBT-REC.
           MOVE CSREXP OF EEWDP3(EDPACT) TO CSREXP OF EXCMDTBT-REC.
           MOVE PREAMT OF EEWDP3(EDPACT) TO PREAMT OF EXCMDTBT-REC.
           MOVE PREEFF OF EEWDP3(EDPACT) TO PREEFF OF EXCMDTBT-REC.
           MOVE PREEXP OF EEWDP3(EDPACT) TO PREEXP OF EXCMDTBT-REC.
           MOVE RSPTOT OF EEWDP3(EDPACT) TO RSPTOT OF EXCMDTBT-REC.
           MOVE RSPEFF OF EEWDP3(EDPACT) TO RSPEFF OF EXCMDTBT-REC.
           MOVE RSPEXP OF EEWDP3(EDPACT) TO RSPEXP OF EXCMDTBT-REC.
           MOVE PRETOT OF EEWDP3(EDPACT) TO PRETOT OF EXCMDTBT-REC.
           MOVE PTOEFF OF EEWDP3(EDPACT) TO PTOEFF OF EXCMDTBT-REC.
           MOVE PTOEXP OF EEWDP3(EDPACT) TO PTOEXP OF EXCMDTBT-REC.
           MOVE EMPTOT OF EEWDP3(EDPACT) TO EMPTOT OF EXCMDTBT-REC.
           MOVE EMPEFF OF EEWDP3(EDPACT) TO EMPEFF OF EXCMDTBT-REC.
           MOVE EMPEXP OF EEWDP3(EDPACT) TO EMPEXP OF EXCMDTBT-REC.
       A1442-CONTINUE-TB3.
           IF INDX > ZEROES
              MOVE WS-TB3-OPYAMT(INDX)   TO OPYAMT OF EXCMDTBT-REC
              MOVE WS-TB3-OPYAMT(INDX)             TO SAV-OPYAMT
              MOVE WS-TB3-OPYEFF(INDX)   TO OPYEFF OF EXCMDTBT-REC
              MOVE WS-TB3-OPYEXP(INDX)   TO OPYEXP OF EXCMDTBT-REC
              MOVE WS-TB3-OPYSRC(INDX)   TO OPYSRC OF EXCMDTBT-REC
              MOVE WS-TB3-APTAMT(INDX)   TO APTAMT OF EXCMDTBT-REC
              MOVE WS-TB3-APTAMT(INDX)             TO SAV-APTAMT
              MOVE WS-TB3-APTEFF(INDX)   TO APTEFF OF EXCMDTBT-REC
              MOVE WS-TB3-APTEXP(INDX)   TO APTEXP OF EXCMDTBT-REC
              MOVE WS-TB3-CSRAMT(INDX)   TO CSRAMT OF EXCMDTBT-REC
              MOVE WS-TB3-CSREFF(INDX)   TO CSREFF OF EXCMDTBT-REC
              MOVE WS-TB3-CSREXP(INDX)   TO CSREXP OF EXCMDTBT-REC
              MOVE WS-TB3-PREAMT(INDX)   TO PREAMT OF EXCMDTBT-REC
              MOVE WS-TB3-PREEFF(INDX)   TO PREEFF OF EXCMDTBT-REC
              MOVE WS-TB3-PREEXP(INDX)   TO PREEXP OF EXCMDTBT-REC
              MOVE WS-TB3-RSPTOT(INDX)   TO RSPTOT OF EXCMDTBT-REC
              MOVE WS-TB3-RSPEFF(INDX)   TO RSPEFF OF EXCMDTBT-REC
              MOVE WS-TB3-RSPEXP(INDX)   TO RSPEXP OF EXCMDTBT-REC
              MOVE WS-TB3-PRETOT(INDX)   TO PRETOT OF EXCMDTBT-REC
              MOVE WS-TB3-PRETOT(INDX)             TO SAV-PRETOT
              MOVE WS-TB3-PTOEFF(INDX)   TO PTOEFF OF EXCMDTBT-REC
              MOVE WS-TB3-PTOEXP(INDX)   TO PTOEXP OF EXCMDTBT-REC
              MOVE WS-TB3-EMPTOT(INDX)   TO EMPTOT OF EXCMDTBT-REC
              MOVE WS-TB3-EMPEFF(INDX)   TO EMPEFF OF EXCMDTBT-REC
              MOVE WS-TB3-EMPEXP(INDX)   TO EMPEXP OF EXCMDTBT-REC.

      ****--------------------------------------------------------****
      ****  PMHS-269  KCT  Fix                                    ****
      ****  Capture proper Reason Category.                       ****
      ****--------------------------------------------------------****
      **** MOVE REACAT OF EEWDP3(EDPACT) TO REACAT OF EXCMDTBT-REC.
      **** MOVE WS-REACAT2               TO REACAT OF EXCMDTBT-REC.
           IF WS-REACAT2 = SPACES
              MOVE REACAT OF EEWDP3(ESBACT) TO REACAT OF EXCMDTBT-REC
           ELSE
              MOVE WS-REACAT2            TO REACAT OF EXCMDTBT-REC.
           MOVE TRMEFF OF EEWDP3(EDPACT) TO TRMEFF OF EXCMDTBT-REC.
           MOVE RATARA OF EEWDP3(EDPACT) TO RATARA OF EXCMDTBT-REC.
           MOVE RATEFF OF EEWDP3(EDPACT) TO RATEFF OF EXCMDTBT-REC.
           MOVE RATEXP OF EEWDP3(EDPACT) TO RATEXP OF EXCMDTBT-REC.
           MOVE SHPGRP OF EEWDP2(EDPACT) TO SHPGRP OF EXCMDTBT-REC.
           MOVE EXCPOL OF EEWDP2(EDPACT) TO EXCPOL OF EXCMDTBT-REC.
           MOVE ASSQHP OF EEWDP3(EDPACT) TO ASSQHP OF EXCMDTBT-REC.
           MOVE PYMTID OF EEWDEP(EDPACT) TO PYMTID OF EXCMDTBT-REC.
      ****--------------------------------------------------------****
      ****  PMHS-269  KCT  Fix                                    ****
      ****  Capture proper Term Reason Code.                      ****
      ****--------------------------------------------------------****
      **** MOVE SPACES                   TO TRMREA OF EXCMDTBT-REC.
           IF TRMEFF OF EEWDP3(EDPACT) = 0
              MOVE SPACES                TO TRMREA OF EXCMDTBT-REC
           ELSE
              MOVE MEMTRM OF EEWSUB(ESBACT) TO TRMREA OF EXCMDTBT-REC.
           MOVE 'ED201C'                 TO USERID OF EXCMDTBT-REC.
           MOVE 'EDI'                    TO TERMID OF EXCMDTBT-REC.
           MOVE CURDAT                   TO SYSDAT OF EXCMDTBT-REC
                                            LSTCHG OF EXCMDTBT-REC.

           PERFORM EXCMDTBT-WRITE                IF INVALID-KEY
              MOVE 'Y'                           TO PRCERR
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI99955'                     TO MI-PRIMARY-ID
              MOVE 'WRITE'                       TO MI-PARM4
              MOVE 'EXCMDTBT'                    TO MI-PARM5
              MOVE EXCMDTBT-STATUS               TO MI-PARM6
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT.

           ADD +1                                TO INDX.
           GO TO A1442-CONTINUE.

       A1449-EXIT.
           EXIT.
      *
       B1410-EXTBENBT-CHG.
      ****************************************************************
      *    Check for a change in the external benefits fields        *
      ****************************************************************
           MOVE 'N'                              TO EXTBEN-FLAG.
      *
           INITIALIZE EXTBENBT-REC.
           MOVE MEMSEQ OF DEPTAB(DEPTMP) TO MEMSEQ OF EXTBENBT-REC.
           PERFORM EXTBENBT-READ                 IF INVALID-KEY
              MOVE 'EXTBENBT'                    TO MI-PARM4
              MOVE EXTBENBT-STATUS               TO MI-PARM5
              MOVE 'EI06063'                     TO MI-PRIMARY-ID
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                                                 GO TO B1419-EXIT
              END-IF.
      *
           IF (HSAIND OF EEWDP2(EDPACT) NOT = SPACES
           AND HSAIND OF EEWDP2(EDPACT) NOT = HSAIND OF EXTBENBT-REC)
           OR (HRAIND OF EEWDP2(EDPACT) NOT = SPACES
           AND HRAIND OF EEWDP2(EDPACT) NOT = HRAIND OF EXTBENBT-REC)
           OR (FSAIND OF EEWDP2(EDPACT) NOT = SPACES
           AND FSAIND OF EEWDP2(EDPACT) NOT = FSAIND OF EXTBENBT-REC)
           OR (OTHIND OF EEWDP2(EDPACT) NOT = SPACES
           AND OTHIND OF EEWDP2(EDPACT) NOT = OTHIND OF EXTBENBT-REC)
           OR (MPDIND OF EEWDP2(EDPACT) NOT = SPACES
           AND MPDIND OF EEWDP2(EDPACT) NOT = MPDIND OF EXTBENBT-REC)
           OR (PHAIND OF EEWDP2(EDPACT) NOT = SPACES
           AND PHAIND OF EEWDP2(EDPACT) NOT = PHAIND OF EXTBENBT-REC)
           OR (DENIND OF EEWDP2(EDPACT) NOT = SPACES
           AND DENIND OF EEWDP2(EDPACT) NOT = DENIND OF EXTBENBT-REC)
           OR (VISIND OF EEWDP2(EDPACT) NOT = SPACES
           AND VISIND OF EEWDP2(EDPACT) NOT = VISIND OF EXTBENBT-REC)
           OR (MHTIND OF EEWDP2(EDPACT) NOT = SPACES
           AND MHTIND OF EEWDP2(EDPACT) NOT = MHTIND OF EXTBENBT-REC)
           OR (OTHBEN OF EEWDP2(EDPACT) NOT = SPACES
           AND OTHBEN OF EEWDP2(EDPACT) NOT = OTHBEN OF EXTBENBT-REC)
           OR  FSAAMT OF EEWDP2(EDPACT) NOT = FSAAMT OF EXTBENBT-REC
              MOVE 'Y'                           TO EXTBEN-FLAG
           END-IF.
       B1419-EXIT.
           EXIT.
      *
       B1420-EXTBENBT-CHG.
      ****************************************************************
      *    Check for a change in the external benefit fields         *
      ****************************************************************
           MOVE 'N'                              TO EXTBEN-FLAG.
      *
           INITIALIZE EXTBENBT-REC.
           MOVE MEMSEQ OF DEMMAS-REC     TO MEMSEQ OF EXTBENBT-REC.
      *
           PERFORM EXTBENBT-READ                 IF INVALID-KEY
              MOVE 'EXTBENBT'                    TO MI-PARM4
              MOVE 'EI06063'                     TO MI-PRIMARY-ID
              MOVE EXTBENBT-STATUS               TO MI-PARM5
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                                                 GO TO B1429-EXIT
              END-IF.
           IF (HSAIND OF EEWSB2(ESBACT) NOT = SPACES
           AND HSAIND OF EEWSB2(ESBACT) NOT = HSAIND OF EXTBENBT-REC)
           OR (HRAIND OF EEWSB2(ESBACT) NOT = SPACES
           AND HRAIND OF EEWSB2(ESBACT) NOT = HRAIND OF EXTBENBT-REC)
           OR (FSAIND OF EEWSB2(ESBACT) NOT = SPACES
           AND FSAIND OF EEWSB2(ESBACT) NOT = FSAIND OF EXTBENBT-REC)
           OR (OTHIND OF EEWSB2(ESBACT) NOT = SPACES
           AND OTHIND OF EEWSB2(ESBACT) NOT = OTHIND OF EXTBENBT-REC)
           OR (MPDIND OF EEWSB2(ESBACT) NOT = SPACES
           AND MPDIND OF EEWSB2(ESBACT) NOT = MPDIND OF EXTBENBT-REC)
           OR (PHAIND OF EEWSB2(ESBACT) NOT = SPACES
           AND PHAIND OF EEWSB2(ESBACT) NOT = PHAIND OF EXTBENBT-REC)
           OR (DENIND OF EEWSB2(ESBACT) NOT = SPACES
           AND DENIND OF EEWSB2(ESBACT) NOT = DENIND OF EXTBENBT-REC)
           OR (VISIND OF EEWSB2(ESBACT) NOT = SPACES
           AND VISIND OF EEWSB2(ESBACT) NOT = VISIND OF EXTBENBT-REC)
           OR (MHTIND OF EEWSB2(ESBACT) NOT = SPACES
           AND MHTIND OF EEWSB2(ESBACT) NOT = MHTIND OF EXTBENBT-REC)
           OR (OTHBEN OF EEWSB2(ESBACT) NOT = SPACES
           AND OTHBEN OF EEWSB2(ESBACT) NOT = OTHBEN OF EXTBENBT-REC)
           OR  FSAAMT OF EEWSB2(ESBACT) NOT = FSAAMT OF EXTBENBT-REC
              MOVE 'Y'                           TO EXTBEN-FLAG
           END-IF.
       B1429-EXIT.
           EXIT.
      /
       A1450-ALTADRBT-CHG.
      ****************************************************************
      *    Check for a change in the alternate address fields        *
      ****************************************************************
           MOVE 'N'                              TO ALTADR-FLAG.
      *
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.
      *
           INITIALIZE ALTADRBT-REC.
           MOVE MEMSEQ OF DEPTAB(DEPTMP) TO MEMSEQ OF ALTADRBT-REC.
           CALL 'ALTADRBTM'   USING IO-COMMUNICATION ALTADRBT-LM-PARMS.
      *
           IF NOT IO-RESULT-OK
              IF IO-NOT-FOUND
                 MOVE 'Y'                        TO ALTADR-FLAG
              ELSE
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'READ'                     TO MI-PARM4
                 MOVE 'ALTADRBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A1459-EXIT.
      *
           IF (ALTAD1 OF EEWDP2(EDPACT) NOT = SPACES
           AND (ALTAD1 OF EEWDP2(EDPACT) NOT = ALTAD1 OF ALTADRBT-REC
           OR ALTAD2 OF EEWDP2(EDPACT) NOT = ALTAD2 OF ALTADRBT-REC))
           OR (ALTCTY OF EEWDP2(EDPACT) NOT = SPACES
           AND ALTCTY OF EEWDP2(EDPACT) NOT = ALTCTY OF ALTADRBT-REC)
           OR (ALTSTT OF EEWDP2(EDPACT) NOT = SPACES
           AND ALTSTT OF EEWDP2(EDPACT) NOT = ALTSTT OF ALTADRBT-REC)
           OR (ALTPST OF EEWDP2(EDPACT) NOT = SPACES
           AND ALTPST OF EEWDP2(EDPACT) NOT = ALTPST OF ALTADRBT-REC)
           OR (ALTCNR OF EEWDP2(EDPACT) NOT = SPACES
           AND ALTCNR OF EEWDP2(EDPACT) NOT = ALTCNR OF ALTADRBT-REC)
              MOVE 'Y'                           TO ALTADR-FLAG.
       A1459-EXIT.
           EXIT.
      /
       A1460-ALTADRBT-CHG.
      ****************************************************************
      *    Check for a change in the responsible party fields        *
      ****************************************************************
           MOVE 'N'                              TO ALTADR-FLAG.
           MOVE 'N'                              TO ALTADR-FOUND.
      *
           MOVE 1                                TO IO-NBRREQ.
           MOVE ZERO                             TO IO-NBRRET.
           SET IO-RESULT-OK                      TO TRUE.
           SET IO-SELECT-KEY-EQ                  TO TRUE.

           INITIALIZE ALTADRBT-REC.
           MOVE MEMSEQ OF DEMMAS-REC     TO MEMSEQ OF ALTADRBT-REC.
           CALL 'ALTADRBTM'   USING IO-COMMUNICATION ALTADRBT-LM-PARMS.
      *
           IF NOT IO-RESULT-OK
              IF IO-NOT-FOUND
                 MOVE 'Y'                        TO ALTADR-FLAG
              ELSE
                 MOVE IO-RESULT                  TO WS-IO-RESULT
                 MOVE 'Y'                        TO PRCERR
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI99955'                  TO MI-PRIMARY-ID
                 MOVE 'READ'                     TO MI-PARM4
                 MOVE 'ALTADRBT'                 TO MI-PARM5
                 MOVE WS-IO-RESULT               TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                                                 GO TO A1459-EXIT.

           IF (ALTAD1 OF EEWSB2(ESBACT) NOT = SPACES
           AND (ALTAD1 OF EEWSB2(ESBACT) NOT = ALTAD1 OF ALTADRBT-REC
           OR ALTAD2 OF EEWSB2(ESBACT) NOT = ALTAD2 OF ALTADRBT-REC))
           OR (ALTCTY OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTCTY OF EEWSB2(ESBACT) NOT = ALTCTY OF ALTADRBT-REC)
           OR (ALTSTT OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTSTT OF EEWSB2(ESBACT) NOT = ALTSTT OF ALTADRBT-REC)
           OR (ALTPST OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTPST OF EEWSB2(ESBACT) NOT = ALTPST OF ALTADRBT-REC)
           OR (ALTCNR OF EEWSB2(ESBACT) NOT = SPACES
           AND ALTCNR OF EEWSB2(ESBACT) NOT = ALTCNR OF ALTADRBT-REC)
              MOVE 'Y'                           TO ALTADR-FOUND.
       A1469-EXIT.
           EXIT.
      *
       A1470-SEARCH-EEWDEP.
           SET EEWINX                            TO 1.
      *
       A1471-SEARCH-NEXT.
      *
           SEARCH EEWDEP                         AT END
              GO TO A1479-EXIT
           WHEN BTHDAT OF EEWDEP(EEWINX) = WS-BTHDAT
           AND MEMBNO OF EEWDEP(EEWINX) NOT = MEMBNO OF EEWDEP(EDPACT)
           AND (RELCOD OF EEWDEP(EEWINX) = '3' OR '4' OR '5')
              MOVE BTHSEQ OF EEWDEP(EEWINX)      TO WS-BTHSEQ1
              IF  CHGTYP OF EEWDEP(EEWINX) = 'C'
              AND BTHCHG OF EEWDEP(EEWINX) NOT = 'Y'
                 SET EEWINX UP BY 1
                 GO TO A1471-SEARCH-NEXT
              END-IF
              IF  CHGTYP OF EEWDEP(EEWINX) = 'C'
              AND BTHSEQ OF EEWDEP(EEWINX) = ZEROS
                 PERFORM A1490-DEPTAB            THRU A1499-EXIT
                 IF INDTMP > ZERO
                    MOVE BTHSEQ OF DEPTAB(INDTMP)   TO WS-BTHSEQ1
                 END-IF
              END-IF
              IF WS-BTHSEQ = ZEROS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE SPACES          TO FIELDV OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE 'EI02411'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02411'                  TO MI-PRIMARY-ID
                 MOVE 'BIRTH SEQ NUMBER'         TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 MOVE 'Y'                        TO SW-SEARCH-OK
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A1479-EXIT
              END-IF
              IF WS-BTHSEQ  = WS-BTHSEQ1
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE BTHSEQ OF EEWDEP(EDPACT)   TO FIELDV OF ERR-LINE
                 MOVE 'EI02495'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02495'                  TO MI-PRIMARY-ID
                 MOVE 'BIRTH SEQUENCE'           TO MI-PARM4
                 MOVE 'NUMBER MUST BE'           TO MI-PARM5
                 MOVE 'UNIQUE'                   TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 MOVE 'Y'                        TO SW-SEARCH-OK
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A1479-EXIT
              END-IF
           END-SEARCH.
           SET EEWINX UP BY 1
           GO TO A1471-SEARCH-NEXT.
      *
       A1479-EXIT.
           EXIT.
      *
       A1480-SEARCH-DEPTAB.
           MOVE ZEROES                           TO TINDX.
      *
       A1481-SEARCH-NEXT.
      *
           IF TINDX NOT < DEPLST
           OR TINDX NOT < DEPMAX
              GO TO A1489-EXIT.
      *
           ADD 1                                 TO TINDX.
      *
           IF  BTHDAT OF DEPTAB(TINDX) = WS-BTHDAT
           AND MEMBNO OF DEPTAB(TINDX) NOT = MEMBNO OF EEWDEP(EDPACT)
           AND (RELCOD OF DEPTAB(TINDX) = '3' OR '4' OR '5')
              MOVE BTHSEQ OF DEPTAB(TINDX)       TO WS-BTHSEQ1
              SET EEWINX                         TO 1
              SEARCH EEWDEP                      AT END
                 GO TO A1481-CONTINUE
              WHEN MEMBNO OF DEPTAB(TINDX) = MEMBNO OF EEWDEP(EEWINX)
                 IF  CHGTYP OF EEWDEP(EEWINX) = 'C'
                 AND BTHCHG OF EEWDEP(EEWINX) NOT = 'Y'
                    IF BTHSEQ OF EEWDEP(EEWINX) NOT = ZEROS
                       MOVE BTHSEQ OF EEWDEP(EEWINX)  TO WS-BTHSEQ1
                    END-IF
                    GO TO A1481-CONTINUE
                 ELSE
                    GO TO A1481-SEARCH-NEXT
                 END-IF
              END-SEARCH
           END-IF
           GO TO A1481-SEARCH-NEXT.
       A1481-CONTINUE.
              IF WS-BTHSEQ = ZEROS
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE SPACES                     TO FIELDV OF ERR-LINE
                 MOVE 'EI02411'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02411'                  TO MI-PRIMARY-ID
                 MOVE 'BIRTH SEQ NUMBER'         TO MI-PARM4
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 MOVE 'Y'                        TO SW-SEARCH-OK
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A1489-EXIT
              END-IF
              IF WS-BTHSEQ = WS-BTHSEQ1
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE BTHSEQ OF EEWDEP(EDPACT)   TO FIELDV OF ERR-LINE
                 MOVE 'EI02495'                  TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 MOVE 'EI02495'                  TO MI-PRIMARY-ID
                 MOVE 'BIRTH SEQUENCE'           TO MI-PARM4
                 MOVE 'NUMBER MUST BE'           TO MI-PARM5
                 MOVE 'UNIQUE'                   TO MI-PARM6
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 MOVE 'Y'                        TO SW-SEARCH-OK
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 GO TO A1489-EXIT
              END-IF
           GO TO A1481-SEARCH-NEXT.
      *
       A1489-EXIT.
           EXIT.
      *
       A1490-DEPTAB.
      ***************************************************************
      * DEP DEMMAS
      ***************************************************************
           MOVE ZEROES                           TO DEPACT.
       A1491-NEXT.
           IF DEPACT NOT < DEPLST
           OR DEPACT NOT < DEPMAX
              GO TO A1499-EXIT.
      *
           ADD 1                                 TO DEPACT.
      *
           IF MEMBNO OF DEPTAB(DEPACT) = MEMBNO OF EEWDEP(EEWINX)
              MOVE DEPACT                        TO INDTMP
              GO TO A1499-EXIT.
      *
           GO TO A1491-NEXT.
       A1499-EXIT.
           EXIT.
      *
       A1510-EXCMEMBT-CHG.
      ****************************************************************
      *    Check for a change in the Exchange member Information     *
      ****************************************************************
           MOVE 'N'                              TO EXCMEM-FLAG.
           MOVE 'N'                              TO WS-ADD-EXCMEM
           MOVE 'Y'                              TO SW-FST-REC
           MOVE ZEROES                           TO WS-SEQNUM
                                                    WS-TRNSEQ.
           INITIALIZE EXCMEMBT-REC.
           IF WS-TRMSUB = 'Y'
              MOVE MEMSEQ OF MEMMAS-REC  TO MEMSEQ OF EXCMEMBT-REC
           ELSE
           MOVE MEMSEQ OF DEMMAS-REC     TO MEMSEQ OF EXCMEMBT-REC.
      *
           MOVE ZEROES                   TO TRNSEQ OF EXCMEMBT-REC.
           MOVE ZEROES                   TO SEQNUM OF EXCMEMBT-REC.
      *
           PERFORM EXCMEMBT-STARTGE              IF INVALID-KEY
              MOVE 'Y'                           TO WS-ADD-EXCMEM
              GO TO A1519-EXIT.
      *
       A1511-NEXT.
           PERFORM EXCMEMBT-READNX               IF AT-END
              IF FST-REC
              MOVE 'Y'                           TO WS-ADD-EXCMEM
              GO TO A1519-EXIT
              ELSE
                 GO TO A1512-READ.
      *
           IF WS-TRMSUB NOT = 'Y'
              IF MEMSEQ OF DEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND FST-REC
                 MOVE 'Y'                           TO WS-ADD-EXCMEM
                 GO TO A1519-EXIT
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND FST-REC
                 MOVE 'Y'                           TO WS-ADD-EXCMEM
                 GO TO A1519-EXIT
              END-IF.
      *
           IF WS-TRMSUB NOT = 'Y'
              IF MEMSEQ OF DEMMAS-REC = MEMSEQ OF EXCMEMBT-REC
                 MOVE SEQNUM OF EXCMEMBT-REC        TO WS-SEQNUM
                 MOVE TRNSEQ OF EXCMEMBT-REC        TO WS-TRNSEQ
                 MOVE 'N'                           TO SW-FST-REC
                 GO TO A1511-NEXT
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC = MEMSEQ OF EXCMEMBT-REC
                 MOVE SEQNUM OF EXCMEMBT-REC        TO WS-SEQNUM
                 MOVE TRNSEQ OF EXCMEMBT-REC        TO WS-TRNSEQ
                 MOVE 'N'                           TO SW-FST-REC
                 GO TO A1511-NEXT
              END-IF.
      *
           IF WS-TRMSUB NOT = 'Y'
              IF MEMSEQ OF DEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND NOT FST-REC
                 GO TO A1512-READ
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND NOT FST-REC
                 GO TO A1512-READ
              END-IF.
      *
       A1512-READ.
           IF WS-TRMSUB = 'Y'
              MOVE MEMSEQ OF MEMMAS-REC TO MEMSEQ OF EXCMEMBT-REC
           ELSE
              MOVE MEMSEQ OF DEMMAS-REC TO MEMSEQ OF EXCMEMBT-REC.
           MOVE WS-SEQNUM              TO SEQNUM OF EXCMEMBT-REC.
           MOVE WS-TRNSEQ              TO TRNSEQ OF EXCMEMBT-REC.
           PERFORM EXCMEMBT-READ                 IF INVALID-KEY
              GO TO A1519-EXIT.
           IF (TRMEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND TRMEFF OF EEWSB3(ESBACT) NOT = TRMEFF OF EXCMEMBT-REC)
           OR (MEMTRM OF EEWSUB(ESBACT) NOT = SPACES
           AND MEMTRM OF EEWSUB(ESBACT) NOT = TRMREA OF EXCMEMBT-REC)
           OR (OPYAMT OF EEWSB3(ESBACT) NOT = OPYAMT OF EXCMEMBT-REC)
           OR (OPYEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND OPYEFF OF EEWSB3(ESBACT) NOT = OPYEFF OF EXCMEMBT-REC)
           OR (OPYEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND OPYEXP OF EEWSB3(ESBACT) NOT = OPYEXP OF EXCMEMBT-REC)
           OR (OPYSRC OF EEWSB3(ESBACT) NOT = OPYSRC OF EXCMEMBT-REC)
           OR (APTAMT OF EEWSB3(ESBACT) NOT = APTAMT OF EXCMEMBT-REC)
           OR (APTEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND APTEFF OF EEWSB3(ESBACT) NOT = APTEFF OF EXCMEMBT-REC)
           OR (APTEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND APTEXP OF EEWSB3(ESBACT) NOT = APTEXP OF EXCMEMBT-REC)
           OR (CSRAMT OF EEWSB3(ESBACT) NOT = CSRAMT OF EXCMEMBT-REC)
           OR (CSREFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND CSREFF OF EEWSB3(ESBACT) NOT = CSREFF OF EXCMEMBT-REC)
           OR (CSREXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND CSREXP OF EEWSB3(ESBACT) NOT = CSREXP OF EXCMEMBT-REC)
           OR (PREAMT OF EEWSB3(ESBACT) NOT = PREAMT OF EXCMEMBT-REC)
           OR (PREEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND PREEFF OF EEWSB3(ESBACT) NOT = PREEFF OF EXCMEMBT-REC)
           OR (PREEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND PREEXP OF EEWSB3(ESBACT) NOT = PREEXP OF EXCMEMBT-REC)
           OR (RSPTOT OF EEWSB3(ESBACT) NOT = RSPTOT OF EXCMEMBT-REC)
           OR (RSPEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND RSPEFF OF EEWSB3(ESBACT) NOT = RSPEFF OF EXCMEMBT-REC)
           OR (RSPEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND RSPEXP OF EEWSB3(ESBACT) NOT = RSPEXP OF EXCMEMBT-REC)
           OR (PRETOT OF EEWSB3(ESBACT) NOT = PRETOT OF EXCMEMBT-REC)
           OR (PTOEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND PTOEFF OF EEWSB3(ESBACT) NOT = PTOEFF OF EXCMEMBT-REC)
           OR (PTOEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND PTOEXP OF EEWSB3(ESBACT) NOT = PTOEXP OF EXCMEMBT-REC)
           OR (EMPTOT OF EEWSB3(ESBACT) NOT = EMPTOT OF EXCMEMBT-REC)
           OR (EMPEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND EMPEFF OF EEWSB3(ESBACT) NOT = EMPEFF OF EXCMEMBT-REC)
           OR (EMPEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND EMPEXP OF EEWSB3(ESBACT) NOT = EMPEXP OF EXCMEMBT-REC)
           OR (RATARA OF EEWSB3(ESBACT) NOT = SPACES
           AND RATARA OF EEWSB3(ESBACT) NOT = RATARA OF EXCMEMBT-REC)
           OR (RATEFF OF EEWSB3(ESBACT) NOT = ZEROES
           AND RATEFF OF EEWSB3(ESBACT) NOT = RATEFF OF EXCMEMBT-REC)
           OR (RATEXP OF EEWSB3(ESBACT) NOT = ZEROES
           AND RATEXP OF EEWSB3(ESBACT) NOT = RATEXP OF EXCMEMBT-REC)
           OR  REACAT OF EEWSB3(ESBACT)(1:6) = 'CANCEL'
           OR  REACAT OF EEWSB3(ESBACT)(1:4) = 'TERM'
           OR (EXCPOL OF EEWSB2(ESBACT) NOT = SPACES
           AND EXCPOL OF EEWSB2(ESBACT) NOT = EXCPOL OF EXCMEMBT-REC)
           OR (ASSQHP OF EEWSB3(ESBACT) NOT = SPACES
           AND ASSQHP OF EEWSB3(ESBACT) NOT = ASSQHP OF EXCMEMBT-REC)
           OR (SHPGRP OF EEWSB2(ESBACT) NOT = SPACES
           AND SHPGRP OF EEWSB2(ESBACT) NOT = SHPGRP OF EXCMEMBT-REC)
           OR (PYMTID OF EEWSUB(ESBACT) NOT = SPACES
           AND PYMTID OF EEWSUB(ESBACT) NOT = PYMTID OF EXCMEMBT-REC)
              MOVE 'Y'                           TO EXCMEM-FLAG.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT/GZK Fix                                 ****
      ****  Flag member as exchange for Change transaction when   ****
      ****  existing member is Exchange even if there is no M3.   ****
      ****--------------------------------------------------------****
           IF   EXCMEM-FLAG NOT = 'Y'
           AND  CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND  TMPACT > +0
           AND  TMPACT NOT > MESLST
           AND (EXCHNG OF SUBMEM(TMPACT) = 'EI' OR 'ES' OR 'MI' OR 'MS')
              MOVE 'Y'                           TO EXCMEM-FLAG.
      *
           IF SMKCES OF EEWSB2(ESBACT) = SPACES
           AND HLTCOD OF EEWSB2(ESBACT) NOT = 'N'
              MOVE 'N'                 TO SMKCES OF EEWSB2(ESBACT).
      *
       A1519-EXIT.
            EXIT.
      *
       A1520-EXCMEMBT-CHG.
      ****************************************************************
      *    Check for a change in the Exchange member Information     *
      ****************************************************************
           MOVE 'N'                              TO EXCMEM-FLAG.
           MOVE 'N'                              TO WS-ADD-EXCMEM
           MOVE 'Y'                              TO SW-FST-REC
           INITIALIZE EXCMEMBT-REC.
           IF WS-TRMDEP = 'Y'
              MOVE MEMSEQ OF DEMMAS      TO MEMSEQ OF EXCMEMBT-REC
           ELSE
           MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                         TO MEMSEQ OF EXCMEMBT-REC.
           MOVE ZEROES                   TO TRNSEQ OF EXCMEMBT-REC.
           MOVE ZEROES                   TO SEQNUM OF EXCMEMBT-REC.
      *
           PERFORM EXCMEMBT-STARTGE              IF INVALID-KEY
              MOVE 'Y'                           TO WS-ADD-EXCMEM
              GO TO A1529-EXIT.
      *
       A1521-NEXT.
           PERFORM EXCMEMBT-READNX               IF AT-END
              IF FST-REC
              MOVE 'Y'                           TO WS-ADD-EXCMEM
              GO TO A1529-EXIT
              ELSE
                 GO TO A1522-READ.
      *
           IF WS-TRMDEP NOT = 'Y'
              IF MEMSEQ OF DEPTAB(DEPTMP) NOT = MEMSEQ OF EXCMEMBT-REC
              AND FST-REC
                 MOVE 'Y'                           TO WS-ADD-EXCMEM
                 GO TO A1529-EXIT
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND FST-REC
                 MOVE 'Y'                           TO WS-ADD-EXCMEM
                 GO TO A1529-EXIT
              END-IF.
      *
           IF WS-TRMDEP NOT = 'Y'
              IF MEMSEQ OF DEPTAB(DEPTMP) = MEMSEQ OF EXCMEMBT-REC
                 MOVE SEQNUM OF EXCMEMBT-REC        TO WS-SEQNUM
                 MOVE TRNSEQ OF EXCMEMBT-REC        TO WS-TRNSEQ
                 MOVE 'N'                           TO SW-FST-REC
                 GO TO A1521-NEXT
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC = MEMSEQ OF EXCMEMBT-REC
                 MOVE SEQNUM OF EXCMEMBT-REC        TO WS-SEQNUM
                 MOVE TRNSEQ OF EXCMEMBT-REC        TO WS-TRNSEQ
                 MOVE 'N'                           TO SW-FST-REC
                 GO TO A1521-NEXT
              END-IF.
      *
           IF WS-TRMDEP NOT = 'Y'
              IF MEMSEQ OF DEPTAB(DEPTMP) NOT = MEMSEQ OF EXCMEMBT-REC
              AND NOT FST-REC
                 GO TO A1522-READ
              END-IF
           ELSE
              IF MEMSEQ OF MEMMAS-REC NOT = MEMSEQ OF EXCMEMBT-REC
              AND NOT FST-REC
                 GO TO A1522-READ.
      *
       A1522-READ.
           IF WS-TRMDEP = 'Y'
              MOVE MEMSEQ OF MEMMAS-REC TO MEMSEQ OF EXCMEMBT-REC
           ELSE
           MOVE MEMSEQ OF DEPTAB(DEPTMP)
                                       TO MEMSEQ OF EXCMEMBT-REC.
           MOVE WS-SEQNUM              TO SEQNUM OF EXCMEMBT-REC
           MOVE WS-TRNSEQ              TO TRNSEQ OF EXCMEMBT-REC
           PERFORM EXCMEMBT-READ                 IF INVALID-KEY
              GO TO A1529-EXIT.
      *
           IF (TRMEFF OF EEWDP3(EDPACT) NOT = ZEROES
           AND TRMEFF OF EEWDP3(EDPACT) NOT = TRMEFF OF EXCMEMBT-REC)
           OR (MEMTRM OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMTRM OF EEWDEP(EDPACT) NOT = TRMREA OF EXCMEMBT-REC)
           OR (PREAMT OF EEWDP3(EDPACT) NOT = ZEROES
           AND PREAMT OF EEWDP3(EDPACT) NOT = PREAMT OF EXCMEMBT-REC)
           OR (PREEFF OF EEWDP3(EDPACT) NOT = ZEROES
           AND PREEFF OF EEWDP3(EDPACT) NOT = PREEFF OF EXCMEMBT-REC)
           OR (PREEXP OF EEWDP3(EDPACT) NOT = ZEROES
           AND PREEXP OF EEWDP3(EDPACT) NOT = PREEXP OF EXCMEMBT-REC)
           OR  REACAT OF EEWDP3(EDPACT)(1:6) = 'CANCEL'
           OR  REACAT OF EEWDP3(EDPACT)(1:6) = 'TERM'
           OR (EXCPOL OF EEWDP2(EDPACT) NOT = SPACES
           AND EXCPOL OF EEWDP2(EDPACT) NOT = EXCPOL OF EXCMEMBT-REC)
           OR (ASSQHP OF EEWDP3(EDPACT) NOT = SPACES
           AND ASSQHP OF EEWDP3(EDPACT) NOT = ASSQHP OF EXCMEMBT-REC)
           OR (SHPGRP OF EEWDP2(EDPACT) NOT = SPACES
           AND SHPGRP OF EEWDP2(EDPACT) NOT = SHPGRP OF EXCMEMBT-REC)
              MOVE 'Y'                           TO EXCMEM-FLAG.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT/GZK Fix                                 ****
      ****  Flag member as exchange for Change transaction when   ****
      ****  existing member is Exchange even if there is no M3.   ****
      ****--------------------------------------------------------****
           IF   EXCMEM-FLAG NOT = 'Y'
           AND  CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND  MEMTMP > +0
           AND  MEMTMP NOT > MEMLST
           AND (EXCHNG OF MEMTAB(MEMTMP) = 'EI' OR 'ES' OR 'MI' OR 'MS')
              MOVE 'Y'                           TO EXCMEM-FLAG.
      *
           IF SMKCES OF EEWDP2(EDPACT) = SPACES
           AND HLTCOD OF EEWDP2(EDPACT) NOT = 'N'
              MOVE 'N'                 TO SMKCES OF EEWDP2(EDPACT).
      *
      *‚    We identify the CIC changes (exchange data oly) in ED201A
      *‚    by updating the DENCHG flag before passing the flag to this
      *‚    program. We'll check the flag along with change type so that
      *‚    MDTMAS (line 1) record can be writting for the CIC change.
           IF DEMCHG OF EEWDEP(EDPACT) = 'Y'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
             IF (OPYAMT OF EEWDP3(EDPACT) NOT = ZEROES
             AND OPYAMT OF EEWDP3(EDPACT) NOT = OPYAMT OF EXCMEMBT-REC)
             OR (OPYEFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND OPYEFF OF EEWDP3(EDPACT) NOT = OPYEFF OF EXCMEMBT-REC)
             OR (OPYEXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND OPYEXP OF EEWDP3(EDPACT) NOT = OPYEXP OF EXCMEMBT-REC)

             OR (APTAMT OF EEWDP3(EDPACT) NOT = ZEROES
             AND APTAMT OF EEWDP3(EDPACT) NOT = APTAMT OF EXCMEMBT-REC)
             OR (APTEFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND APTEFF OF EEWDP3(EDPACT) NOT = APTEFF OF EXCMEMBT-REC)
             OR (APTEXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND APTEXP OF EEWDP3(EDPACT) NOT = APTEXP OF EXCMEMBT-REC)

             OR (CSRAMT OF EEWDP3(EDPACT) NOT = ZEROES
             AND CSRAMT OF EEWDP3(EDPACT) NOT = CSRAMT OF EXCMEMBT-REC)
             OR (CSREFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND CSREFF OF EEWDP3(EDPACT) NOT = CSREFF OF EXCMEMBT-REC)
             OR (CSREXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND CSREXP OF EEWDP3(EDPACT) NOT = CSREXP OF EXCMEMBT-REC)

             OR (PREAMT OF EEWDP3(EDPACT) NOT = ZEROES
             AND PREAMT OF EEWDP3(EDPACT) NOT = PREAMT OF EXCMEMBT-REC)
             OR (PREEFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND PREEFF OF EEWDP3(EDPACT) NOT = PREEFF OF EXCMEMBT-REC)
             OR (PREEXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND PREEXP OF EEWDP3(EDPACT) NOT = PREEXP OF EXCMEMBT-REC)

             OR (RSPTOT OF EEWDP3(EDPACT) NOT = ZEROES
             AND RSPTOT OF EEWDP3(EDPACT) NOT = RSPTOT OF EXCMEMBT-REC)
             OR (RSPEFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND RSPEFF OF EEWDP3(EDPACT) NOT = RSPEFF OF EXCMEMBT-REC)
             OR (RSPEXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND RSPEXP OF EEWDP3(EDPACT) NOT = RSPEXP OF EXCMEMBT-REC)

             OR (PRETOT OF EEWDP3(EDPACT) NOT = ZEROES
             AND PRETOT OF EEWDP3(EDPACT) NOT = PRETOT OF EXCMEMBT-REC)
             OR (PTOEFF OF EEWDP3(EDPACT) NOT = ZEROES
             AND PTOEFF OF EEWDP3(EDPACT) NOT = PTOEFF OF EXCMEMBT-REC)
             OR (PTOEXP OF EEWDP3(EDPACT) NOT = ZEROES
             AND PTOEXP OF EEWDP3(EDPACT) NOT = PTOEXP OF EXCMEMBT-REC)

                MOVE 'Y'                           TO DEMCHG-FLAG.
      *
       A1529-EXIT.
            EXIT.
      /
      *
       B100-CHECK-FOR-SUB.
      *
      *‚Check MHS files for subscriber.
      *
           INITIALIZE SUBMDT.
      *
           MOVE ' '                              TO SUB-EXIST-FLAG.
      *
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MEMSBS-KEY.
           MOVE ZEROES                 TO EXPDAT OF MEMSBS-KEY
                                          TRNSEQ OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B105-NEXT.
      *
       B102-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B105-NEXT.
      *
           IF SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWSUB(ESBACT)
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B105-NEXT.
      *
           IF GRPNUM OF MEMMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
              GO TO B102-NEXT.
      *
           IF EXPDAT OF MEMMAS-REC = EFFDAT OF MEMMAS-REC
              GO TO B102-NEXT.
      *
           MOVE 'H' TO SUB-EXIST-FLAG            GO TO B109-EXIT.
      *
       B105-NEXT.
      *
      *‚ Subscriber not present in MHS files. Now to check MDTMAS.
      *
           INITIALIZE MDTMAS-REC.
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MDTMAS-KEY.
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MDTMAS-KEY.
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MDTMAS-KEY.
           MOVE ZEROES                 TO SEQNUM OF MDTMAS-KEY
                                          LINENO OF MDTMAS-KEY.
      *
           PERFORM MDTMAS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B109-EXIT.
      *
       B106-NEXT.
           PERFORM MDTMAS-READNX                 IF AT-END
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B109-EXIT.
      *
           IF CHGTYP OF MDTMAS-REC NOT = 'A'     GO TO B106-NEXT.
      *
           IF SUBSNO OF MDTMAS-REC NOT = SUBSNO OF EEWSUB(ESBACT)
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B109-EXIT.
      *
           IF GRPNUM OF MDTMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
              GO TO B106-NEXT.
      *
           IF EXPDAT OF MDTMAS-REC = EFFDAT OF MDTMAS-REC
              GO TO B106-NEXT.
      *
           IF SUBSNO OF MDTMAS-REC = SUBSNO OF EEWSUB(ESBACT)
           AND GRPNUM OF MDTMAS-REC = GRPNUM OF EEWSUB(ESBACT)
           AND BRANCD OF MDTMAS-REC = BRANCD OF MBHKEY
           AND BATDAT OF MDTMAS-REC = BATDAT OF MBHKEY
           AND BATSEQ OF MDTMAS-REC = BATSEQ OF MBHKEY
           AND CHGTYP OF MDTMAS-REC = 'A'
              MOVE 'M'                           TO SUB-EXIST-FLAG
           END-IF.
      *
           PERFORM B540-LOAD-SUB-INFO            THRU B549-EXIT.
       B109-EXIT.
           EXIT.
      *
       B110-CHECK-FOR-MEM.
      *
      *‚Check MHS files for dependent.
      *
           INITIALIZE MEMMDT.
      *
           MOVE ' '                              TO MEM-EXIST-FLAG.
      *
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MEMSBS-KEY.
           MOVE ZEROES                 TO EXPDAT OF MEMSBS-KEY
                                          TRNSEQ OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B115-NEXT.
      *
       B112-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B115-NEXT.
      *
           IF MEMBNO OF MEMMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
           AND MEMBNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
           AND SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B115-NEXT.
           IF SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
           OR MEMBNO OF MEMMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B112-NEXT.
      *
           IF GRPNUM OF MEMMAS-REC NOT = GRPNUM OF EEWDEP(EDPACT)
              GO TO B112-NEXT.
      *
           IF EXPDAT OF MEMMAS-REC = EFFDAT OF MEMMAS-REC
              GO TO B112-NEXT.
      *
           MOVE 'E' TO MEM-EXIST-FLAG            GO TO B119-EXIT.
      *
       B115-NEXT.
      *
      *‚ Dependent not present in MHS files. Now to check MDTMAS.
      *
           INITIALIZE MDTMAS-REC.
           MOVE BRANCD OF MBHKEY       TO BRANCD OF MDTMAS-KEY.
           MOVE BATDAT OF MBHKEY       TO BATDAT OF MDTMAS-KEY.
           MOVE BATSEQ OF MBHKEY       TO BATSEQ OF MDTMAS-KEY.
           MOVE ZEROES                 TO SEQNUM OF MDTMAS-KEY
                                          LINENO OF MDTMAS-KEY.
      *
           PERFORM MDTMAS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B119-EXIT.
      *
       B116-NEXT.
           PERFORM MDTMAS-READNX                 IF AT-END
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B119-EXIT.
      *
           IF CHGTYP OF MDTMAS-REC NOT = 'A'     GO TO B116-NEXT.
      *
           IF SUBSNO OF MDTMAS-REC = SUBSNO OF EEWDEP(EDPACT)
           AND MEMBNO OF MDTMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
              GO TO B116-NEXT.
      *
           IF SUBSNO OF MDTMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
           OR MEMBNO OF MDTMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B119-EXIT.
      *
           IF GRPNUM OF MDTMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
           OR RELCOD OF MDTMAS-REC NOT = RELCOD OF EEWDEP(EDPACT)
              GO TO B116-NEXT.
      *
           IF EXPDAT OF MDTMAS-REC = EFFDAT OF MDTMAS-REC
              GO TO B116-NEXT.
      *
           IF SUBSNO OF MDTMAS-REC = SUBSNO OF EEWDEP(EDPACT)
           AND MEMBNO OF MDTMAS-REC = MEMBNO OF EEWDEP(EDPACT)
           AND GRPNUM OF MDTMAS-REC = GRPNUM OF EEWDEP(EDPACT)
           AND BRANCD OF MDTMAS-REC = BRANCD OF MBHKEY
           AND BATDAT OF MDTMAS-REC = BATDAT OF MBHKEY
           AND BATSEQ OF MDTMAS-REC = BATSEQ OF MBHKEY
           AND RELCOD OF MDTMAS-REC = RELCOD OF EEWDEP(EDPACT)
           AND CHGTYP OF MDTMAS-REC = 'A'
              MOVE 'D'                           TO MEM-EXIST-FLAG
           END-IF.
      *
           PERFORM B560-LOAD-MEM-INFO            THRU B569-EXIT.
       B119-EXIT.
           EXIT.
      *
       B200-CHECK-FOR-SUB.
      *
      *‚Check MHS files for subscriber.
      *
           INITIALIZE SUBMDT.
      *
           MOVE ' '                              TO SUB-EXIST-FLAG.
      *
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MEMSBS-KEY.
           MOVE ZEROES                 TO EXPDAT OF MEMSBS-KEY
                                          TRNSEQ OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B205-NEXT.
      *
       B202-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B205-NEXT.
      *
           IF SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWSUB(ESBACT)
              MOVE ' '                           TO SUB-EXIST-FLAG
                                                 GO TO B205-NEXT.
      *
           IF GRPNUM OF MEMMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
              GO TO B202-NEXT.
      *
           IF EXPDAT OF MEMMAS-REC = EFFDAT OF MEMMAS-REC
              GO TO B202-NEXT.
      *
           MOVE 'H' TO SUB-EXIST-FLAG            GO TO B209-EXIT.
      *
       B205-NEXT.
      *
      *‚ Subscriber not present in MHS files. Now to check EEWSUB
      *‚ table.
      *
           MOVE ZEROES                           TO TBLIND.
           IF TBLIND NOT < ESBLST                GO TO B209-EXIT.
      *
       B206-NEXT.
           ADD 1                                 TO TBLIND.
           IF TBLIND > ESBLST                    GO TO B209-EXIT.
      *
           IF SUBSNO OF EEWSUB(TBLIND) = SPACES
              GO TO B209-EXIT.
      *
           IF SUBSNO OF EEWSUB(TBLIND) = SUBSNO OF EEWSUB(ESBACT)
           AND CHGTYP OF EEWSUB(TBLIND) = 'A'
           AND RELCOD OF EEWSUB(TBLIND) = '1'
              MOVE 'M'                           TO SUB-EXIST-FLAG
              PERFORM B570-LOAD-SUB-INFO         THRU B579-EXIT
              GO TO B209-EXIT.
      *
           GO TO B206-NEXT.
       B209-EXIT.
           EXIT.
      *
       B210-CHECK-FOR-MEM.
      *
      *‚Check MHS files for dependent.
      *
           INITIALIZE MEMMDT.
      *
           MOVE ' '                              TO MEM-EXIST-FLAG.
      *
           MOVE SPACES                           TO MEMSBS-KEY.
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MEMSBS-KEY.
           MOVE ZEROES                 TO EXPDAT OF MEMSBS-KEY
                                          TRNSEQ OF MEMSBS-KEY.
           PERFORM MEMSBS-STARTGE                IF INVALID-KEY
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B215-NEXT.
      *
       B212-NEXT.
           PERFORM MEMSBS-READNX                 IF AT-END
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B215-NEXT.
      *
           IF MEMBNO OF MEMMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
           AND MEMBNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
           AND SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B215-NEXT.
      *
           IF SUBSNO OF MEMMAS-REC NOT = SUBSNO OF EEWDEP(EDPACT)
           OR MEMBNO OF MEMMAS-REC NOT = MEMBNO OF EEWDEP(EDPACT)
              MOVE ' '                           TO MEM-EXIST-FLAG
                                                 GO TO B212-NEXT.
      *
           IF GRPNUM OF MEMMAS-REC NOT = GRPNUM OF EEWDEP(EDPACT)
              GO TO B212-NEXT.
      *
           IF EXPDAT OF MEMMAS-REC = EFFDAT OF MEMMAS-REC
              GO TO B212-NEXT.
      *
           MOVE 'E' TO MEM-EXIST-FLAG            GO TO B219-EXIT.
      *
       B215-NEXT.
      *
      *‚ Dependent not present in MHS files. Now to check EEWDEP
      *‚ table.
      *
           MOVE ZEROES                           TO TBLIND.
           IF TBLIND NOT < EDPLST                GO TO B219-EXIT.
      *
       B216-NEXT.
           ADD 1                                 TO TBLIND.
           IF TBLIND > EDPLST                    GO TO B219-EXIT.
      *
           IF SUBSNO OF EEWDEP(TBLIND) = SPACES
           AND MEMBNO OF EEWDEP(TBLIND) = SPACES
              GO TO B219-EXIT.
      *
           IF SUBSNO OF EEWDEP(TBLIND) = SUBSNO OF EEWDEP(EDPACT)
           AND MEMBNO OF EEWDEP(TBLIND) = MEMBNO OF EEWDEP(EDPACT)
           AND RELCOD OF EEWDEP(TBLIND) = RELCOD OF EEWDEP(EDPACT)
           AND CHGTYP OF EEWDEP(TBLIND) = 'A'
              MOVE 'D'                           TO MEM-EXIST-FLAG
              PERFORM B580-LOAD-MEM-INFO         THRU B589-EXIT
              GO TO B219-EXIT.
      *
           GO TO B216-NEXT.
       B219-EXIT.
           EXIT.
      *
       B540-LOAD-SUB-INFO.
      *****************************************************************
      *‚Load MDTMAS record into subscriber table for MDTMAS, SUBMDT.  *
      *****************************************************************
           INITIALIZE SUBMDT.
           MOVE RECTYP OF MDTMAS-REC             TO RECTYP OF SUBMDT.
           MOVE CHGTYP OF MDTMAS-REC             TO CHGTYP OF SUBMDT.
           MOVE PRCDAT OF MDTMAS-REC             TO PRCDAT OF SUBMDT.
           MOVE PRCTIM OF MDTMAS-REC             TO PRCTIM OF SUBMDT.
           MOVE PRCSEQ OF MDTMAS-REC             TO PRCSEQ OF SUBMDT.
           MOVE SUBSNO OF MDTMAS-REC             TO SUBSNO OF SUBMDT.
           MOVE RELTYP OF MDTMAS-REC             TO RELTYP OF SUBMDT.
           MOVE RELCOD OF MDTMAS-REC             TO RELCOD OF SUBMDT.
           MOVE MEMBNO OF MDTMAS-REC             TO MEMBNO OF SUBMDT.
           MOVE LSTNAM OF MDTMAS-REC             TO LSTNAM OF SUBMDT.
           MOVE FSTNAM OF MDTMAS-REC             TO FSTNAM OF SUBMDT.
           MOVE MIDNAM OF MDTMAS-REC             TO MIDNAM OF SUBMDT.
           MOVE TITLCD OF MDTMAS-REC             TO TITLCD OF SUBMDT.
           MOVE FORNAM OF MDTMAS-REC             TO FORNAM OF SUBMDT.
           MOVE GRPNUM OF MDTMAS-REC             TO GRPNUM OF SUBMDT.
           MOVE EFFDAT OF MDTMAS-REC             TO EFFDAT OF SUBMDT.
           MOVE EXPDAT OF MDTMAS-REC             TO EXPDAT OF SUBMDT.
           MOVE REASCD OF MDTMAS-REC             TO REASCD OF SUBMDT.
           MOVE TERMCD OF MDTMAS-REC             TO TERMCD OF SUBMDT.
           MOVE EMPSTA OF MDTMAS-REC             TO EMPSTA OF SUBMDT.
           MOVE PRTCOD OF MDTMAS-REC             TO PRTCOD OF SUBMDT.
           MOVE PRTCNT OF MDTMAS-REC             TO PRTCNT OF SUBMDT.
           MOVE CRDCNT OF MDTMAS-REC             TO CRDCNT OF SUBMDT.
           MOVE CRDDAT OF MDTMAS-REC             TO CRDDAT OF SUBMDT.
           MOVE HIRDAT OF MDTMAS-REC             TO HIRDAT OF SUBMDT.
           MOVE TRMDAT OF MDTMAS-REC             TO TRMDAT OF SUBMDT.
           MOVE EECOVR OF MDTMAS-REC             TO EECOVR OF SUBMDT.
           MOVE MMCEXC OF MDTMAS-REC             TO MMCEXC OF SUBMDT.
           MOVE MHCIND OF MDTMAS-REC             TO MHCIND OF SUBMDT.
           MOVE OMEDAT OF MDTMAS-REC             TO OMEDAT OF SUBMDT.
           MOVE CRDMTH OF MDTMAS-REC             TO CRDMTH OF SUBMDT.
           MOVE MEMGIS OF MDTMAS-REC             TO MEMGIS OF SUBMDT.
           MOVE TYPCOD OF MDTMAS-REC             TO TYPCOD OF SUBMDT.
           MOVE ADRLN1 OF MDTMAS-REC             TO ADRLN1 OF SUBMDT.
           MOVE ADRLN2 OF MDTMAS-REC             TO ADRLN2 OF SUBMDT.
           MOVE CITYCD OF MDTMAS-REC             TO CITYCD OF SUBMDT.
           MOVE STACOD OF MDTMAS-REC             TO STACOD OF SUBMDT.
           MOVE ZIPCOD OF MDTMAS-REC             TO ZIPCOD OF SUBMDT.
           MOVE CTRYCD OF MDTMAS-REC             TO CTRYCD OF SUBMDT.
           MOVE LOCQLF OF MDTMAS-REC             TO LOCQLF OF SUBMDT.
           MOVE AREACD OF MDTMAS-REC             TO AREACD OF SUBMDT.
           MOVE HOMPH1 OF MDTMAS-REC             TO HOMPH1 OF SUBMDT.
           MOVE HOMPH2 OF MDTMAS-REC             TO HOMPH2 OF SUBMDT.
           MOVE HOMPH3 OF MDTMAS-REC             TO HOMPH3 OF SUBMDT.
           MOVE WRKPH1 OF MDTMAS-REC             TO WRKPH1 OF SUBMDT.
           MOVE WRKPH2 OF MDTMAS-REC             TO WRKPH2 OF SUBMDT.
           MOVE WRKPH3 OF MDTMAS-REC             TO WRKPH3 OF SUBMDT.
           MOVE WRKEXT OF MDTMAS-REC             TO WRKEXT OF SUBMDT.
           MOVE FAXNUM OF MDTMAS-REC             TO FAXNUM OF SUBMDT.
           MOVE OTHPHN OF MDTMAS-REC             TO OTHPHN OF SUBMDT.
           MOVE EMLIND OF MDTMAS-REC             TO EMLIND OF SUBMDT.
           MOVE ELMAIL OF MDTMAS-REC             TO ELMAIL OF SUBMDT.
           MOVE SOCSEC OF MDTMAS-REC             TO SOCSEC OF SUBMDT.
           MOVE BTHDAT OF MDTMAS-REC             TO BTHDAT OF SUBMDT.
           MOVE BTHSEQ OF MDTMAS-REC             TO BTHSEQ OF SUBMDT.
           MOVE SEXCOD OF MDTMAS-REC             TO SEXCOD OF SUBMDT.
           MOVE RACECD OF MDTMAS-REC             TO RACECD OF SUBMDT.
           MOVE MEMSTA OF MDTMAS-REC             TO MEMSTA OF SUBMDT.
           MOVE STUSTA OF MDTMAS-REC             TO STUSTA OF SUBMDT.
           MOVE HNDIND OF MDTMAS-REC             TO HNDIND OF SUBMDT.
           MOVE EDUBEG OF MDTMAS-REC             TO EDUBEG OF SUBMDT.
           MOVE EDUEND OF MDTMAS-REC             TO EDUEND OF SUBMDT.
           MOVE MARSTA OF MDTMAS-REC             TO MARSTA OF SUBMDT.
           MOVE ALTNUM OF MDTMAS-REC             TO ALTNUM OF SUBMDT.
           MOVE COBDAT OF MDTMAS-REC             TO COBDAT OF SUBMDT.
           MOVE AUTEXP OF MDTMAS-REC             TO AUTEXP OF SUBMDT.
           MOVE PEBTFS OF MDTMAS-REC             TO PEBTFS OF SUBMDT.
           MOVE ACCTNO OF MDTMAS-REC             TO ACCTNO OF SUBMDT.
           MOVE STATCD OF MDTMAS-REC             TO STATCD OF SUBMDT.
           MOVE INTAKE OF MDTMAS-REC             TO INTAKE OF SUBMDT.
           MOVE INTKCD OF MDTMAS-REC             TO INTKCD OF SUBMDT.
           MOVE INTDAT OF MDTMAS-REC             TO INTDAT OF SUBMDT.
           MOVE PAYGRD OF MDTMAS-REC             TO PAYGRD OF SUBMDT.
           MOVE CHAREL OF MDTMAS-REC             TO CHAREL OF SUBMDT.
           MOVE SVCBRN OF MDTMAS-REC             TO SVCBRN OF SUBMDT.
           MOVE DERDPN OF MDTMAS-REC             TO DERDPN OF SUBMDT.
           MOVE DERELG OF MDTMAS-REC             TO DERELG OF SUBMDT.
           MOVE MILINF OF MDTMAS-REC             TO MILINF OF SUBMDT.
           MOVE PRIVDT OF MDTMAS-REC             TO PRIVDT OF SUBMDT.
           MOVE PRIVNM OF MDTMAS-REC             TO PRIVNM OF SUBMDT.
           MOVE PRIVRL OF MDTMAS-REC             TO PRIVRL OF SUBMDT.
           MOVE CHADIS OF MDTMAS-REC             TO CHADIS OF SUBMDT.
           MOVE SSNXRF OF MDTMAS-REC             TO SSNXRF OF SUBMDT.
           MOVE HICNNO OF MDTMAS-REC             TO HICNNO OF SUBMDT.
           MOVE WRKLOC OF MDTMAS-REC             TO WRKLOC OF SUBMDT.
           MOVE PAYLOC OF MDTMAS-REC             TO PAYLOC OF SUBMDT.
           MOVE PAYNUM OF MDTMAS-REC             TO PAYNUM OF SUBMDT.
           MOVE CPAIND OF MDTMAS-REC             TO CPAIND OF SUBMDT.
           MOVE MMDIND OF MDTMAS-REC             TO MMDIND OF SUBMDT.
           MOVE MMCIND OF MDTMAS-REC             TO MMCIND OF SUBMDT.
           MOVE CQLECD OF MDTMAS-REC             TO CQLECD OF SUBMDT.
           MOVE COBRAQ OF MDTMAS-REC             TO COBRAQ OF SUBMDT.
           MOVE COBRAB OF MDTMAS-REC             TO COBRAB OF SUBMDT.
           MOVE COBRAE OF MDTMAS-REC             TO COBRAE OF SUBMDT.
           MOVE EMSTCD OF MDTMAS-REC             TO EMSTCD OF SUBMDT.
           MOVE DETDAT OF MDTMAS-REC             TO DETDAT OF SUBMDT.
           MOVE EXTIND OF MDTMAS-REC             TO EXTIND OF SUBMDT.
           MOVE RSPIND OF MDTMAS-REC             TO RSPIND OF SUBMDT.
           MOVE TIRTBL OF MDTMAS-REC             TO TIRTBL OF SUBMDT.
           MOVE TIRFLG OF MDTMAS-REC             TO TIRFLG OF SUBMDT.
           MOVE BENPKG OF MDTMAS-REC             TO BENPKG OF SUBMDT.
           MOVE BILEXC OF MDTMAS-REC             TO BILEXC OF SUBMDT.
           MOVE LOBCOD OF MDTMAS-REC             TO LOBCOD OF SUBMDT.
           MOVE HSTOVR OF MDTMAS-REC             TO HSTOVR OF SUBMDT.
           MOVE USRFL1 OF MDTMAS-REC             TO USRFL1 OF SUBMDT.
           MOVE USRFL2 OF MDTMAS-REC             TO USRFL2 OF SUBMDT.
           MOVE USRFL3 OF MDTMAS-REC             TO USRFL3 OF SUBMDT.
           MOVE ACCTN2 OF MDTMAS-REC             TO ACCTN2 OF SUBMDT.
           MOVE PKGOVR OF MDTMAS-REC             TO PKGOVR OF SUBMDT.
           MOVE BILMOD OF MDTMAS-REC             TO BILMOD OF SUBMDT.
           MOVE BEGMTH OF MDTMAS-REC             TO BEGMTH OF SUBMDT.
           MOVE IMDBIL OF MDTMAS-REC             TO IMDBIL OF SUBMDT.
           MOVE INTBIL OF MDTMAS-REC             TO INTBIL OF SUBMDT.
           MOVE BILCYC OF MDTMAS-REC             TO BILCYC OF SUBMDT.
           MOVE PRVORG OF MDTMAS-REC             TO PRVORG OF SUBMDT.
           MOVE PROVNO OF MDTMAS-REC             TO PROVNO OF SUBMDT.
           MOVE PCPOVR OF MDTMAS-REC             TO PCPOVR OF SUBMDT.
           MOVE PCPMCP OF MDTMAS-REC             TO PCPMCP OF SUBMDT.
           MOVE DEFPRV OF MDTMAS-REC             TO DEFPRV OF SUBMDT.
           MOVE SECORG OF MDTMAS-REC             TO SECORG OF SUBMDT.
           MOVE SECPRV OF MDTMAS-REC             TO SECPRV OF SUBMDT.
           MOVE SECOVR OF MDTMAS-REC             TO SECOVR OF SUBMDT.
           MOVE SECMCP OF MDTMAS-REC             TO SECMCP OF SUBMDT.
           MOVE PODIND OF MDTMAS-REC             TO PODIND OF SUBMDT.
           MOVE FEECOD OF MDTMAS-REC             TO FEECOD OF SUBMDT.
           MOVE MEDCTY OF MDTMAS-REC             TO MEDCTY OF SUBMDT.
           MOVE MEDSTS OF MDTMAS-REC             TO MEDSTS OF SUBMDT.
           MOVE HOLDCD OF MDTMAS-REC             TO HOLDCD OF SUBMDT.
           MOVE HLDEFF OF MDTMAS-REC             TO HLDEFF OF SUBMDT.
           MOVE HLDEXP OF MDTMAS-REC             TO HLDEXP OF SUBMDT.
           MOVE PRICOD OF MDTMAS-REC             TO PRICOD OF SUBMDT.
           MOVE OTHINS OF MDTMAS-REC             TO OTHINS OF SUBMDT.
           MOVE MEMNUM OF MDTMAS-REC             TO MEMNUM OF SUBMDT.
           MOVE GRPPOL OF MDTMAS-REC             TO GRPPOL OF SUBMDT.
           MOVE OINNAM OF MDTMAS-REC             TO OINNAM OF SUBMDT.
           MOVE OINNUM OF MDTMAS-REC             TO OINNUM OF SUBMDT.
           MOVE COVEFF OF MDTMAS-REC             TO COVEFF OF SUBMDT.
           MOVE COVEXP OF MDTMAS-REC             TO COVEXP OF SUBMDT.
           MOVE EXTSUB OF MDTMAS-REC             TO EXTSUB OF SUBMDT.
           MOVE EXTGRP OF MDTMAS-REC             TO EXTGRP OF SUBMDT.
           MOVE EXTEFF OF MDTMAS-REC             TO EXTEFF OF SUBMDT.
           MOVE EXTEXP OF MDTMAS-REC             TO EXTEXP OF SUBMDT.
           MOVE EXTMEM OF MDTMAS-REC             TO EXTMEM OF SUBMDT.
           MOVE EXTCON OF MDTMAS-REC             TO EXTCON OF SUBMDT.
           MOVE HISSEQ OF MDTMAS-REC             TO HISSEQ OF SUBMDT.
           MOVE CTLPLN OF MDTMAS-REC             TO CTLPLN OF SUBMDT.
           MOVE EXTREL OF MDTMAS-REC             TO EXTREL OF SUBMDT.
           MOVE PRVPLN OF MDTMAS-REC             TO PRVPLN OF SUBMDT.
           MOVE PRVNET OF MDTMAS-REC             TO PRVNET OF SUBMDT.
           MOVE PROCOD OF MDTMAS-REC             TO PROCOD OF SUBMDT.
           MOVE SALAMT OF MDTMAS-REC             TO SALAMT OF SUBMDT.
           MOVE CGAOVR OF MDTMAS-REC             TO CGAOVR OF SUBMDT.
           MOVE CGTOVR OF MDTMAS-REC             TO CGTOVR OF SUBMDT.
           MOVE DALOVR OF MDTMAS-REC             TO DALOVR OF SUBMDT.
           MOVE SALOVR OF MDTMAS-REC             TO SALOVR OF SUBMDT.
           MOVE CBXOVR OF MDTMAS-REC             TO CBXOVR OF SUBMDT.
           MOVE CBEOVR OF MDTMAS-REC             TO CBEOVR OF SUBMDT.
           MOVE APCOVR OF MDTMAS-REC             TO APCOVR OF SUBMDT.
           MOVE SSSOVR OF MDTMAS-REC             TO SSSOVR OF SUBMDT.
           MOVE VRCOVR OF MDTMAS-REC             TO VRCOVR OF SUBMDT.
           MOVE RMTOVR OF MDTMAS-REC             TO RMTOVR OF SUBMDT.
           MOVE BUDCOD OF MDTMAS-REC             TO BUDCOD OF SUBMDT.
           MOVE PCPSPC OF MDTMAS-REC             TO PCPSPC OF SUBMDT.
           MOVE SECSPC OF MDTMAS-REC             TO SECSPC OF SUBMDT.
           MOVE CINOVR OF MDTMAS-REC             TO CINOVR OF SUBMDT.
           MOVE MEMHLD OF MDTMAS-REC             TO MEMHLD OF SUBMDT.
           MOVE OVRLTR OF MDTMAS-REC             TO OVRLTR OF SUBMDT.
           MOVE INDUPD OF MDTMAS-REC             TO INDUPD OF SUBMDT.
           MOVE SPLBIL OF MDTMAS-REC             TO SPLBIL OF SUBMDT.
           MOVE MEMDFT OF MDTMAS-REC             TO MEMDFT OF SUBMDT.
           MOVE ENBDFT OF MDTMAS-REC             TO ENBDFT OF SUBMDT.
           MOVE PCPDFT OF MDTMAS-REC             TO PCPDFT OF SUBMDT.
           MOVE SECDFT OF MDTMAS-REC             TO SECDFT OF SUBMDT.
           MOVE PRGIND OF MDTMAS-REC             TO PRGIND OF SUBMDT.
           MOVE PGMNAM OF MDTMAS-REC             TO PGMNAM OF SUBMDT.
           MOVE ALTIND OF MDTMAS-REC             TO ALTIND OF SUBMDT.
           MOVE MEDCOV OF MDTMAS-REC             TO MEDCOV OF SUBMDT.
           MOVE DENCOV OF MDTMAS-REC             TO DENCOV OF SUBMDT.
           MOVE SYSDAT OF MDTMAS-REC             TO SYSDAT OF SUBMDT.
           MOVE LSTCHG OF MDTMAS-REC             TO LSTCHG OF SUBMDT.
           MOVE TERMID OF MDTMAS-REC             TO TERMID OF SUBMDT.
           MOVE USERID OF MDTMAS-REC             TO USERID OF SUBMDT.
           MOVE ENRSTA OF MDTMAS-REC             TO ENRSTA OF SUBMDT.
           MOVE EXCHNG OF MDTMAS-REC             TO EXCHNG OF SUBMDT.
           MOVE EXCIND OF MDTMAS-REC             TO EXCIND OF SUBMDT.
           MOVE MDTMAS-UNQ OF MDTMAS-REC
                                       TO FILLR1 OF SUBMDT.
           MOVE MDTMAS-SQR OF MDTMAS-REC
                                       TO FILLR2 OF SUBMDT.
      *
       B549-EXIT.
           EXIT.
      *
       B560-LOAD-MEM-INFO.
      *****************************************************************
      *‚Load MDTMAS record into dependent table for MDTMAS, MEMMDT.   *
      *****************************************************************
           INITIALIZE MEMMDT.
           MOVE RECTYP OF MDTMAS-REC             TO RECTYP OF MEMMDT.
           MOVE CHGTYP OF MDTMAS-REC             TO CHGTYP OF MEMMDT.
           MOVE PRCDAT OF MDTMAS-REC             TO PRCDAT OF MEMMDT.
           MOVE PRCTIM OF MDTMAS-REC             TO PRCTIM OF MEMMDT.
           MOVE PRCSEQ OF MDTMAS-REC             TO PRCSEQ OF MEMMDT.
           MOVE SUBSNO OF MDTMAS-REC             TO SUBSNO OF MEMMDT.
           MOVE RELTYP OF MDTMAS-REC             TO RELTYP OF MEMMDT.
           MOVE RELCOD OF MDTMAS-REC             TO RELCOD OF MEMMDT.
           MOVE MEMBNO OF MDTMAS-REC             TO MEMBNO OF MEMMDT.
           MOVE LSTNAM OF MDTMAS-REC             TO LSTNAM OF MEMMDT.
           MOVE FSTNAM OF MDTMAS-REC             TO FSTNAM OF MEMMDT.
           MOVE MIDNAM OF MDTMAS-REC             TO MIDNAM OF MEMMDT.
           MOVE TITLCD OF MDTMAS-REC             TO TITLCD OF MEMMDT.
           MOVE FORNAM OF MDTMAS-REC             TO FORNAM OF MEMMDT.
           MOVE GRPNUM OF MDTMAS-REC             TO GRPNUM OF MEMMDT.
           MOVE EFFDAT OF MDTMAS-REC             TO EFFDAT OF MEMMDT.
           MOVE EXPDAT OF MDTMAS-REC             TO EXPDAT OF MEMMDT.
           MOVE REASCD OF MDTMAS-REC             TO REASCD OF MEMMDT.
           MOVE TERMCD OF MDTMAS-REC             TO TERMCD OF MEMMDT.
           MOVE EMPSTA OF MDTMAS-REC             TO EMPSTA OF MEMMDT.
           MOVE PRTCOD OF MDTMAS-REC             TO PRTCOD OF MEMMDT.
           MOVE PRTCNT OF MDTMAS-REC             TO PRTCNT OF MEMMDT.
           MOVE CRDCNT OF MDTMAS-REC             TO CRDCNT OF MEMMDT.
           MOVE CRDDAT OF MDTMAS-REC             TO CRDDAT OF MEMMDT.
           MOVE HIRDAT OF MDTMAS-REC             TO HIRDAT OF MEMMDT.
           MOVE TRMDAT OF MDTMAS-REC             TO TRMDAT OF MEMMDT.
           MOVE EECOVR OF MDTMAS-REC             TO EECOVR OF MEMMDT.
           MOVE MMCEXC OF MDTMAS-REC             TO MMCEXC OF MEMMDT.
           MOVE MHCIND OF MDTMAS-REC             TO MHCIND OF MEMMDT.
           MOVE OMEDAT OF MDTMAS-REC             TO OMEDAT OF MEMMDT.
           MOVE CRDMTH OF MDTMAS-REC             TO CRDMTH OF MEMMDT.
           MOVE MEMGIS OF MDTMAS-REC             TO MEMGIS OF MEMMDT.
           MOVE TYPCOD OF MDTMAS-REC             TO TYPCOD OF MEMMDT.
           MOVE ADRLN1 OF MDTMAS-REC             TO ADRLN1 OF MEMMDT.
           MOVE ADRLN2 OF MDTMAS-REC             TO ADRLN2 OF MEMMDT.
           MOVE CITYCD OF MDTMAS-REC             TO CITYCD OF MEMMDT.
           MOVE STACOD OF MDTMAS-REC             TO STACOD OF MEMMDT.
           MOVE ZIPCOD OF MDTMAS-REC             TO ZIPCOD OF MEMMDT.
           MOVE CTRYCD OF MDTMAS-REC             TO CTRYCD OF MEMMDT.
           MOVE LOCQLF OF MDTMAS-REC             TO LOCQLF OF MEMMDT.
           MOVE AREACD OF MDTMAS-REC             TO AREACD OF MEMMDT.
           MOVE HOMPH1 OF MDTMAS-REC             TO HOMPH1 OF MEMMDT.
           MOVE HOMPH2 OF MDTMAS-REC             TO HOMPH2 OF MEMMDT.
           MOVE HOMPH3 OF MDTMAS-REC             TO HOMPH3 OF MEMMDT.
           MOVE WRKPH1 OF MDTMAS-REC             TO WRKPH1 OF MEMMDT.
           MOVE WRKPH2 OF MDTMAS-REC             TO WRKPH2 OF MEMMDT.
           MOVE WRKPH3 OF MDTMAS-REC             TO WRKPH3 OF MEMMDT.
           MOVE WRKEXT OF MDTMAS-REC             TO WRKEXT OF MEMMDT.
           MOVE FAXNUM OF MDTMAS-REC             TO FAXNUM OF MEMMDT.
           MOVE OTHPHN OF MDTMAS-REC             TO OTHPHN OF MEMMDT.
           MOVE EMLIND OF MDTMAS-REC             TO EMLIND OF MEMMDT.
           MOVE ELMAIL OF MDTMAS-REC             TO ELMAIL OF MEMMDT.
           MOVE SOCSEC OF MDTMAS-REC             TO SOCSEC OF MEMMDT.
           MOVE BTHDAT OF MDTMAS-REC             TO BTHDAT OF MEMMDT.
           MOVE BTHSEQ OF MDTMAS-REC             TO BTHSEQ OF MEMMDT.
           MOVE SEXCOD OF MDTMAS-REC             TO SEXCOD OF MEMMDT.
           MOVE RACECD OF MDTMAS-REC             TO RACECD OF MEMMDT.
           MOVE MEMSTA OF MDTMAS-REC             TO MEMSTA OF MEMMDT.
           MOVE STUSTA OF MDTMAS-REC             TO STUSTA OF MEMMDT.
           MOVE HNDIND OF MDTMAS-REC             TO HNDIND OF MEMMDT.
           MOVE EDUBEG OF MDTMAS-REC             TO EDUBEG OF MEMMDT.
           MOVE EDUEND OF MDTMAS-REC             TO EDUEND OF MEMMDT.
           MOVE MARSTA OF MDTMAS-REC             TO MARSTA OF MEMMDT.
           MOVE ALTNUM OF MDTMAS-REC             TO ALTNUM OF MEMMDT.
           MOVE COBDAT OF MDTMAS-REC             TO COBDAT OF MEMMDT.
           MOVE AUTEXP OF MDTMAS-REC             TO AUTEXP OF MEMMDT.
           MOVE PEBTFS OF MDTMAS-REC             TO PEBTFS OF MEMMDT.
           MOVE ACCTNO OF MDTMAS-REC             TO ACCTNO OF MEMMDT.
           MOVE STATCD OF MDTMAS-REC             TO STATCD OF MEMMDT.
           MOVE INTAKE OF MDTMAS-REC             TO INTAKE OF MEMMDT.
           MOVE INTKCD OF MDTMAS-REC             TO INTKCD OF MEMMDT.
           MOVE INTDAT OF MDTMAS-REC             TO INTDAT OF MEMMDT.
           MOVE PAYGRD OF MDTMAS-REC             TO PAYGRD OF MEMMDT.
           MOVE CHAREL OF MDTMAS-REC             TO CHAREL OF MEMMDT.
           MOVE SVCBRN OF MDTMAS-REC             TO SVCBRN OF MEMMDT.
           MOVE DERDPN OF MDTMAS-REC             TO DERDPN OF MEMMDT.
           MOVE DERELG OF MDTMAS-REC             TO DERELG OF MEMMDT.
           MOVE MILINF OF MDTMAS-REC             TO MILINF OF MEMMDT.
           MOVE PRIVDT OF MDTMAS-REC             TO PRIVDT OF MEMMDT.
           MOVE PRIVNM OF MDTMAS-REC             TO PRIVNM OF MEMMDT.
           MOVE PRIVRL OF MDTMAS-REC             TO PRIVRL OF MEMMDT.
           MOVE CHADIS OF MDTMAS-REC             TO CHADIS OF MEMMDT.
           MOVE SSNXRF OF MDTMAS-REC             TO SSNXRF OF MEMMDT.
           MOVE HICNNO OF MDTMAS-REC             TO HICNNO OF MEMMDT.
           MOVE WRKLOC OF MDTMAS-REC             TO WRKLOC OF MEMMDT.
           MOVE PAYLOC OF MDTMAS-REC             TO PAYLOC OF MEMMDT.
           MOVE PAYNUM OF MDTMAS-REC             TO PAYNUM OF MEMMDT.
           MOVE CPAIND OF MDTMAS-REC             TO CPAIND OF MEMMDT.
           MOVE MMDIND OF MDTMAS-REC             TO MMDIND OF MEMMDT.
           MOVE MMCIND OF MDTMAS-REC             TO MMCIND OF MEMMDT.
           MOVE CQLECD OF MDTMAS-REC             TO CQLECD OF MEMMDT.
           MOVE COBRAQ OF MDTMAS-REC             TO COBRAQ OF MEMMDT.
           MOVE COBRAB OF MDTMAS-REC             TO COBRAB OF MEMMDT.
           MOVE COBRAE OF MDTMAS-REC             TO COBRAE OF MEMMDT.
           MOVE EMSTCD OF MDTMAS-REC             TO EMSTCD OF MEMMDT.
           MOVE DETDAT OF MDTMAS-REC             TO DETDAT OF MEMMDT.
           MOVE EXTIND OF MDTMAS-REC             TO EXTIND OF MEMMDT.
           MOVE RSPIND OF MDTMAS-REC             TO RSPIND OF MEMMDT.
           MOVE TIRTBL OF MDTMAS-REC             TO TIRTBL OF MEMMDT.
           MOVE TIRFLG OF MDTMAS-REC             TO TIRFLG OF MEMMDT.
           MOVE BENPKG OF MDTMAS-REC             TO BENPKG OF MEMMDT.
           MOVE BILEXC OF MDTMAS-REC             TO BILEXC OF MEMMDT.
           MOVE LOBCOD OF MDTMAS-REC             TO LOBCOD OF MEMMDT.
           MOVE HSTOVR OF MDTMAS-REC             TO HSTOVR OF MEMMDT.
           MOVE USRFL1 OF MDTMAS-REC             TO USRFL1 OF MEMMDT.
           MOVE USRFL2 OF MDTMAS-REC             TO USRFL2 OF MEMMDT.
           MOVE USRFL3 OF MDTMAS-REC             TO USRFL3 OF MEMMDT.
           MOVE ACCTN2 OF MDTMAS-REC             TO ACCTN2 OF MEMMDT.
           MOVE PKGOVR OF MDTMAS-REC             TO PKGOVR OF MEMMDT.
           MOVE BILMOD OF MDTMAS-REC             TO BILMOD OF MEMMDT.
           MOVE BEGMTH OF MDTMAS-REC             TO BEGMTH OF MEMMDT.
           MOVE IMDBIL OF MDTMAS-REC             TO IMDBIL OF MEMMDT.
           MOVE INTBIL OF MDTMAS-REC             TO INTBIL OF MEMMDT.
           MOVE BILCYC OF MDTMAS-REC             TO BILCYC OF MEMMDT.
           MOVE PRVORG OF MDTMAS-REC             TO PRVORG OF MEMMDT.
           MOVE PROVNO OF MDTMAS-REC             TO PROVNO OF MEMMDT.
           MOVE PCPOVR OF MDTMAS-REC             TO PCPOVR OF MEMMDT.
           MOVE PCPMCP OF MDTMAS-REC             TO PCPMCP OF MEMMDT.
           MOVE DEFPRV OF MDTMAS-REC             TO DEFPRV OF MEMMDT.
           MOVE SECORG OF MDTMAS-REC             TO SECORG OF MEMMDT.
           MOVE SECPRV OF MDTMAS-REC             TO SECPRV OF MEMMDT.
           MOVE SECOVR OF MDTMAS-REC             TO SECOVR OF MEMMDT.
           MOVE SECMCP OF MDTMAS-REC             TO SECMCP OF MEMMDT.
           MOVE PODIND OF MDTMAS-REC             TO PODIND OF MEMMDT.
           MOVE FEECOD OF MDTMAS-REC             TO FEECOD OF MEMMDT.
           MOVE MEDCTY OF MDTMAS-REC             TO MEDCTY OF MEMMDT.
           MOVE MEDSTS OF MDTMAS-REC             TO MEDSTS OF MEMMDT.
           MOVE HOLDCD OF MDTMAS-REC             TO HOLDCD OF MEMMDT.
           MOVE HLDEFF OF MDTMAS-REC             TO HLDEFF OF MEMMDT.
           MOVE HLDEXP OF MDTMAS-REC             TO HLDEXP OF MEMMDT.
           MOVE PRICOD OF MDTMAS-REC             TO PRICOD OF MEMMDT.
           MOVE OTHINS OF MDTMAS-REC             TO OTHINS OF MEMMDT.
           MOVE MEMNUM OF MDTMAS-REC             TO MEMNUM OF MEMMDT.
           MOVE GRPPOL OF MDTMAS-REC             TO GRPPOL OF MEMMDT.
           MOVE OINNAM OF MDTMAS-REC             TO OINNAM OF MEMMDT.
           MOVE OINNUM OF MDTMAS-REC             TO OINNUM OF MEMMDT.
           MOVE COVEFF OF MDTMAS-REC             TO COVEFF OF MEMMDT.
           MOVE COVEXP OF MDTMAS-REC             TO COVEXP OF MEMMDT.
           MOVE EXTSUB OF MDTMAS-REC             TO EXTSUB OF MEMMDT.
           MOVE EXTGRP OF MDTMAS-REC             TO EXTGRP OF MEMMDT.
           MOVE EXTEFF OF MDTMAS-REC             TO EXTEFF OF MEMMDT.
           MOVE EXTEXP OF MDTMAS-REC             TO EXTEXP OF MEMMDT.
           MOVE EXTMEM OF MDTMAS-REC             TO EXTMEM OF MEMMDT.
           MOVE EXTCON OF MDTMAS-REC             TO EXTCON OF MEMMDT.
           MOVE HISSEQ OF MDTMAS-REC             TO HISSEQ OF MEMMDT.
           MOVE CTLPLN OF MDTMAS-REC             TO CTLPLN OF MEMMDT.
           MOVE EXTREL OF MDTMAS-REC             TO EXTREL OF MEMMDT.
           MOVE PRVPLN OF MDTMAS-REC             TO PRVPLN OF MEMMDT.
           MOVE PRVNET OF MDTMAS-REC             TO PRVNET OF MEMMDT.
           MOVE PROCOD OF MDTMAS-REC             TO PROCOD OF MEMMDT.
           MOVE SALAMT OF MDTMAS-REC             TO SALAMT OF MEMMDT.
           MOVE CGAOVR OF MDTMAS-REC             TO CGAOVR OF MEMMDT.
           MOVE CGTOVR OF MDTMAS-REC             TO CGTOVR OF MEMMDT.
           MOVE DALOVR OF MDTMAS-REC             TO DALOVR OF MEMMDT.
           MOVE SALOVR OF MDTMAS-REC             TO SALOVR OF MEMMDT.
           MOVE CBXOVR OF MDTMAS-REC             TO CBXOVR OF MEMMDT.
           MOVE CBEOVR OF MDTMAS-REC             TO CBEOVR OF MEMMDT.
           MOVE APCOVR OF MDTMAS-REC             TO APCOVR OF MEMMDT.
           MOVE SSSOVR OF MDTMAS-REC             TO SSSOVR OF MEMMDT.
           MOVE VRCOVR OF MDTMAS-REC             TO VRCOVR OF MEMMDT.
           MOVE RMTOVR OF MDTMAS-REC             TO RMTOVR OF MEMMDT.
           MOVE BUDCOD OF MDTMAS-REC             TO BUDCOD OF MEMMDT.
           MOVE PCPSPC OF MDTMAS-REC             TO PCPSPC OF MEMMDT.
           MOVE SECSPC OF MDTMAS-REC             TO SECSPC OF MEMMDT.
           MOVE CINOVR OF MDTMAS-REC             TO CINOVR OF MEMMDT.
           MOVE MEMHLD OF MDTMAS-REC             TO MEMHLD OF MEMMDT.
           MOVE OVRLTR OF MDTMAS-REC             TO OVRLTR OF MEMMDT.
           MOVE INDUPD OF MDTMAS-REC             TO INDUPD OF MEMMDT.
           MOVE SPLBIL OF MDTMAS-REC             TO SPLBIL OF MEMMDT.
           MOVE MEMDFT OF MDTMAS-REC             TO MEMDFT OF MEMMDT.
           MOVE ENBDFT OF MDTMAS-REC             TO ENBDFT OF MEMMDT.
           MOVE PCPDFT OF MDTMAS-REC             TO PCPDFT OF MEMMDT.
           MOVE SECDFT OF MDTMAS-REC             TO SECDFT OF MEMMDT.
           MOVE PRGIND OF MDTMAS-REC             TO PRGIND OF MEMMDT.
           MOVE PGMNAM OF MDTMAS-REC             TO PGMNAM OF MEMMDT.
           MOVE ALTIND OF MDTMAS-REC             TO ALTIND OF MEMMDT.
           MOVE MEDCOV OF MDTMAS-REC             TO MEDCOV OF MEMMDT.
           MOVE DENCOV OF MDTMAS-REC             TO DENCOV OF MEMMDT.
           MOVE SYSDAT OF MDTMAS-REC             TO SYSDAT OF MEMMDT.
           MOVE LSTCHG OF MDTMAS-REC             TO LSTCHG OF MEMMDT.
           MOVE TERMID OF MDTMAS-REC             TO TERMID OF MEMMDT.
           MOVE USERID OF MDTMAS-REC             TO USERID OF MEMMDT.
           MOVE ENRSTA OF MDTMAS-REC             TO ENRSTA OF MEMMDT.
           MOVE EXCHNG OF MDTMAS-REC             TO EXCHNG OF MEMMDT.
           MOVE EXCIND OF MDTMAS-REC             TO EXCIND OF MEMMDT.
           MOVE MDTMAS-UNQ OF MDTMAS-REC
                                       TO FILLR1 OF MEMMDT.
           MOVE MDTMAS-SQR OF MDTMAS-REC
                                       TO FILLR2 OF MEMMDT.
      *
       B569-EXIT.
           EXIT.
      *
       B570-LOAD-SUB-INFO.
           INITIALIZE SUBMDT.
           MOVE MEMEFF OF EEWSUB(TBLIND)         TO EFFDAT OF SUBMDT.
           MOVE MEMEXP OF EEWSUB(TBLIND)         TO EXPDAT OF SUBMDT.
           MOVE ACCTNO OF EEWSUB(TBLIND)         TO ACCTNO OF SUBMDT.
           MOVE TIERCD OF EEWSUB(TBLIND)         TO TIERCD OF SUBMDT(1).
           MOVE BENPKG OF EEWSUB(TBLIND)         TO BENPKG OF SUBMDT.
           MOVE USRFL1 OF EEWSUB(TBLIND)         TO USRFL1 OF SUBMDT.
           MOVE USRFL2 OF EEWSUB(TBLIND)         TO USRFL2 OF SUBMDT.
           MOVE USRFL3 OF EEWSUB(TBLIND)         TO USRFL3 OF SUBMDT.
           MOVE PCPORG OF EEWSUB(TBLIND)         TO PRVORG OF SUBMDT.
           MOVE PCPCOD OF EEWSUB(TBLIND)         TO PROVNO OF SUBMDT.
           MOVE PCPMCP OF EEWSUB(TBLIND)         TO PCPMCP OF SUBMDT.
           MOVE SECORG OF EEWSUB(TBLIND)         TO SECORG OF SUBMDT.
           MOVE SECCOD OF EEWSUB(TBLIND)         TO SECPRV OF SUBMDT.
           MOVE SECMCP OF EEWSUB(TBLIND)         TO SECMCP OF SUBMDT.
           MOVE FEECOD OF EEWSUB(TBLIND)         TO FEECOD OF SUBMDT.
       B579-EXIT.
           EXIT.
      *
       B580-LOAD-MEM-INFO.
           INITIALIZE MEMMDT.
           MOVE MEMEFF OF EEWDEP(TBLIND)         TO EFFDAT OF MEMMDT.
           MOVE MEMEXP OF EEWDEP(TBLIND)         TO EXPDAT OF MEMMDT.
           MOVE ACCTNO OF EEWDEP(TBLIND)         TO ACCTNO OF MEMMDT.
           MOVE TIERCD OF EEWDEP(TBLIND)         TO TIERCD OF MEMMDT(1).
           MOVE BENPKG OF EEWDEP(TBLIND)         TO BENPKG OF MEMMDT.
           MOVE USRFL1 OF EEWDEP(TBLIND)         TO USRFL1 OF MEMMDT.
           MOVE USRFL2 OF EEWDEP(TBLIND)         TO USRFL2 OF MEMMDT.
           MOVE USRFL3 OF EEWDEP(TBLIND)         TO USRFL3 OF MEMMDT.
           MOVE PCPORG OF EEWDEP(TBLIND)         TO PRVORG OF MEMMDT.
           MOVE PCPCOD OF EEWDEP(TBLIND)         TO PROVNO OF MEMMDT.
           MOVE PCPMCP OF EEWDEP(TBLIND)         TO PCPMCP OF MEMMDT.
           MOVE SECORG OF EEWDEP(TBLIND)         TO SECORG OF MEMMDT.
           MOVE SECCOD OF EEWDEP(TBLIND)         TO SECPRV OF MEMMDT.
           MOVE SECMCP OF EEWDEP(TBLIND)         TO SECMCP OF MEMMDT.
           MOVE FEECOD OF EEWDEP(TBLIND)         TO FEECOD OF MEMMDT.
       B589-EXIT.
           EXIT.
      *
       B590-EXT-SUFFIX.
      ***************************************************************
      *‚ Getting suffix for generated member for exchange           *
      ***************************************************************
           IF MEMBNO-TAB(INDX) = SPACES
              MOVE MEMBNO-TAB(INDX)              TO MEMSUF-X(1)
              COMPUTE GENSAV = INDX - 1
              IF INDX < 15
                 MOVE MEMBNO-TAB(INDX + 1)       TO MEMSUF-X(2)
              END-IF
              MOVE 15                            TO INDX.
      *
       B599-EXIT.
           EXIT.
      *
       B640-ME1023-SUBCHG.
      *****************************************************************
      *‚Add a change record for which the corresponding add record    *
      *****************************************************************
           PERFORM A900-INIT-MDTTAB              THRU A909-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           MOVE 'N'                              TO ACCT-FLAG.
           MOVE SPACES                 TO DOCNUM OF WS-WORK.
      *
           IF PRCNAM OF EEWHDR-WRK = 'N'
           OR NAMCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-2.
      *
           IF LSTNAM OF EEWSUB(ESBACT) = SPACES
           AND FSTNAM OF EEWSUB(ESBACT) = SPACES
           AND MIDNAM OF EEWSUB(ESBACT) = SPACES
              GO TO B642-STEP-2.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C' AND SPACES
              GO TO B642-STEP-2.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS)
           OR ((LSTNAM OF EEWSUB(ESBACT) NOT = LSTNAM OF SUBMDT
           OR FSTNAM OF EEWSUB(ESBACT) NOT = FSTNAM OF SUBMDT
           OR MIDNAM OF EEWSUB(ESBACT) NOT = MIDNAM OF SUBMDT)
           AND CHGTYP OF EEWSUB(ESBACT) = 'C' OR SPACES)
              MOVE 3                   TO LINENO OF MDTTAB(LIN-0003)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0003)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0003)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0003)
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0003)
              MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0003)
              MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0003)
              MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0003)
              MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0003)
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0003)
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0003)
              MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0003)
              MOVE CHGEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0003)
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0003)
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0003)
              MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0003)
              MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0003)
              MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0003)
              MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0003)
              MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0003)
              MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0003)
              MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0003)
              MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0003)
              MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0003)
              MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0003)
              MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0003)
              MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0003)
              MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0003)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0003)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0003)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0003)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0003)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0003)
              END-IF
              IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0003)
              ELSE
                 MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0003).
       B642-STEP-2.
           IF WS-DT3-TRMEFF IS NUMERIC
            IF WS-DT1-MEMEFF <= WS-DT3-TRMEFF
            AND WS-DT3-TRMEFF NOT = ZEROES
            AND (CHGTYP OF EEWSUB(ESBACT) = 'T'
            OR   CHGTYP OF EEWSUB(ESBACT) = ' ')
              MOVE 'Y'                           TO WS-TRMSUB.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND CHGTYP OF EEWSUB(ESBACT) = 'T')
           OR (CHGTYP OF EEWSUB(ESBACT) = 'T'
              AND EFFDAT OF SUBMDT <= MEMEXP OF EEWSUB(ESBACT)
              AND EXPDAT OF SUBMDT NOT = MEMEXP OF EEWSUB(ESBACT))
           OR WS-TRMSUB = 'Y'
                 MOVE 2                TO LINENO OF MDTTAB(LIN-0002)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                 MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                 MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                 MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                 MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                 IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                    MOVE 'N'           TO PRTCOD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002)
                 END-IF
                 IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                    MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                 IF WS-DT3-TRMEFF = ZEROES
                 MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                 ELSE
                 MOVE WS-DT3-TRMEFF    TO EXPDAT OF MDTTAB(LIN-0002)
                 END-IF
                 IF EXPDAT OF MDTTAB(LIN-0002) = ZEROES
                    MOVE WS-DT3-TRMEFF   TO EXPDAT OF MDTTAB(LIN-0002)
                 END-IF
                 IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                    MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0002)
                 MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0002)
                 MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0002)
                 MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0002)
                 MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0002)
                 MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0002)
                 MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0002)
                 MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0002)
                 MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0002)
                 MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0002)
                 MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0002)
                 MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0002)
                 MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0002)
                 MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0002)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0002)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0002)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0002)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0002)
                 END-IF
                 END-IF.
      *
           IF MEMCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-3.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO B642-STEP-3.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS)
              GO TO B642-ADDMEM.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT = EFFDAT OF SUBMDT
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT)
              IF (MEMEFF OF EEWSUB(ESBACT) NOT < EFFDAT OF SUBMDT
              AND MEMEFF OF EEWSUB(ESBACT) NOT > EXPDAT OF SUBMDT)
              OR (MEMEXP OF EEWSUB(ESBACT) NOT < EFFDAT OF SUBMDT
              AND MEMEXP OF EEWSUB(ESBACT) NOT > EXPDAT OF SUBMDT)
              OR (MEMEFF OF EEWSUB(ESBACT)     < EFFDAT OF SUBMDT
              AND MEMEXP OF EEWSUB(ESBACT)     > EXPDAT OF SUBMDT)
                 GO TO B642-ADDMEM
              END-IF.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT = EFFDAT OF SUBMDT
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT)
              IF EFFDAT OF SUBMDT > MEMEXP OF EEWSUB(ESBACT)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF EEWSUB(ESBACT)   TO DATFR
                 MOVE EFFDAT OF SUBMDT           TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO B642-ADDMEM.
      *
           IF (MEMEFF OF EEWSUB(ESBACT) NOT = EFFDAT OF SUBMDT
           OR  MEMEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT)
              IF MEMEFF OF EEWSUB(ESBACT) > EXPDAT OF SUBMDT
                 INITIALIZE DAYS-AREA
                 MOVE EXPDAT OF SUBMDT           TO DATFR
                 MOVE MEMEFF OF EEWSUB(ESBACT)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO B642-ADDMEM.
      *
           GO TO B642-STEP-3.
      *
       B642-ADDMEM.
           MOVE 2                TO LINENO OF MDTTAB(LIN-0002)
           MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
           MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
           MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
           MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
           MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
           MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
           IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
           MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0002)
           MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
           MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
           MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0002)
           MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0002)
           MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0002)
           MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0002)
           MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0002)
           MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0002)
           MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0002)
           MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0002)
           MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0002)
           MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0002)
           MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0002)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0002)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0002)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0002)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0002)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
      *
       B642-STEP-3.
           PERFORM B860-SUBDEM                   THRU B869-EXIT.
      *
           MOVE 'N'                              TO DEMCHG-FLAG.
      *
           IF PRCDEM OF EEWHDR-WRK         = 'N'
           OR DEMCHG OF EEWSUB(ESBACT)     = 'N'
           OR CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO B642-STEP-5.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RELCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND RELCOD OF EEWSUB(ESBACT) NOT = RELCOD OF SUBMDT)
              MOVE RELCOD OF EEWSUB(ESBACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
              MOVE 'Y'                           TO DEMCHG-FLAG.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS)
           OR (RELTYP OF EEWSUB(ESBACT) NOT = SPACES
           AND RELTYP OF EEWSUB(ESBACT) NOT = RELTYP OF SUBMDT)
              MOVE RELTYP OF EEWSUB(ESBACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
              MOVE 'Y'                           TO DEMCHG-FLAG.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SEXCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND SEXCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND SEXCOD OF EEWSUB(ESBACT) NOT = SEXCOD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SEXCOD OF EEWSUB(ESBACT)
                                       TO SEXCOD OF MDTTAB(LIN-0001).
      *
           IF COBDAT OF EEWSUB(ESBACT) NOT = ZEROS
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBDAT OF EEWSUB(ESBACT)
                                       TO COBDAT OF MDTTAB(LIN-0001).
      *
           IF PAYLOC OF EEWSUB(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYLOC OF EEWSUB(ESBACT)
                                       TO PAYLOC OF MDTTAB(LIN-0001).
      *
           IF PAYNUM OF EEWSUB(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PAYNUM OF EEWSUB(ESBACT)
                                       TO PAYNUM OF MDTTAB(LIN-0001).
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR ((ADRLN1 OF EEWSUB(ESBACT) NOT = SPACES
           AND (ADRLN1 OF EEWSUB(ESBACT) NOT = ADRLN1 OF SUBMDT
           OR ADRLN2 OF EEWSUB(ESBACT) NOT = ADRLN2 OF SUBMDT))
           OR (CITYCD OF EEWSUB(ESBACT) NOT = SPACES
           AND CITYCD OF EEWSUB(ESBACT) NOT = CITYCD OF SUBMDT)
           OR (STACOD OF EEWSUB(ESBACT) NOT = SPACES
           AND STACOD OF EEWSUB(ESBACT) NOT = STACOD OF SUBMDT)
           OR (ZIPCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND ZIPCOD OF EEWSUB(ESBACT) NOT = ZIPCOD OF SUBMDT)
           OR (CTRYCD OF EEWSUB(ESBACT) NOT = SPACES
           AND CTRYCD OF EEWSUB(ESBACT) NOT = CTRYCD OF SUBMDT)
           OR (AREACD OF EEWSUB(ESBACT) NOT = SPACES
           AND AREACD OF EEWSUB(ESBACT) NOT = AREACD OF SUBMDT)
           OR (LOCQLF OF EEWSUB(ESBACT) NOT = SPACES
           AND LOCQLF OF EEWSUB(ESBACT) NOT = LOCQLF OF SUBMDT))
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ADRLN1 OF EEWSUB(ESBACT)
                                       TO ADRLN1 OF MDTTAB(LIN-0001)
              MOVE ADRLN2 OF EEWSUB(ESBACT)
                                       TO ADRLN2 OF MDTTAB(LIN-0001)
              MOVE CITYCD OF EEWSUB(ESBACT)
                                       TO CITYCD OF MDTTAB(LIN-0001)
              MOVE STACOD OF EEWSUB(ESBACT)
                                       TO STACOD OF MDTTAB(LIN-0001)
              MOVE ZIPCOD OF EEWSUB(ESBACT)
                                       TO ZIPCOD OF MDTTAB(LIN-0001)
              MOVE CTRYCD OF EEWSUB(ESBACT)
                                       TO CTRYCD OF MDTTAB(LIN-0001)
              MOVE AREACD OF EEWSUB(ESBACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
              MOVE LOCQLF OF EEWSUB(ESBACT)
                                       TO LOCQLF OF MDTTAB(LIN-0001)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0001)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0001)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0001)
                 MOVE CHGDAT OF EEWSB3(ESBACT)
                                       TO LSTCHG OF MDTTAB(LIN-0001)
              END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH1 OF EEWSUB(ESBACT) NOT = HOMPH1 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH1 OF EEWSUB(ESBACT)
                                       TO HOMPH1 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH2 OF EEWSUB(ESBACT) NOT = HOMPH2 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH2 OF EEWSUB(ESBACT)
                                       TO HOMPH2 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HOMPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND HOMPH3 OF EEWSUB(ESBACT) NOT = HOMPH3 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HOMPH3 OF EEWSUB(ESBACT)
                                       TO HOMPH3 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH1 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH1 OF EEWSUB(ESBACT) NOT = WRKPH1 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH1 OF EEWSUB(ESBACT)
                                       TO WRKPH1 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH2 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH2 OF EEWSUB(ESBACT) NOT = WRKPH2 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH2 OF EEWSUB(ESBACT)
                                       TO WRKPH2 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKPH3 OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKPH3 OF EEWSUB(ESBACT) NOT = WRKPH3 OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKPH3 OF EEWSUB(ESBACT)
                                       TO WRKPH3 OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKEXT OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKEXT OF EEWSUB(ESBACT) NOT = WRKEXT OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKEXT OF EEWSUB(ESBACT)
                                       TO WRKEXT OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SOCSEC OF EEWSUB(ESBACT) NOT = SPACES
           AND SOCSEC OF EEWSUB(ESBACT) NOT = SOCSEC OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SOCSEC OF EEWSUB(ESBACT)
                                       TO SOCSEC OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RACECD OF EEWSUB(ESBACT) NOT = SPACES
           AND RACECD OF EEWSUB(ESBACT) NOT = RACECD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE RACECD OF EEWSUB(ESBACT)
                                       TO RACECD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MEMSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND MEMSTA OF EEWSUB(ESBACT) NOT = MEMSTA OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MEMSTA OF EEWSUB(ESBACT)
                                       TO MEMSTA OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (AUTEXP OF EEWSUB(ESBACT) NOT = SPACES
           AND AUTEXP OF EEWSUB(ESBACT) NOT = AUTEXP OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE AUTEXP OF EEWSUB(ESBACT)
                                       TO AUTEXP OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (ALTNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND ALTNUM OF EEWSUB(ESBACT) NOT = ALTNUM OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ALTNUM OF EEWSUB(ESBACT)
                                       TO ALTNUM OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (INTKCD OF EEWSUB(ESBACT) NOT = SPACES
           AND INTKCD OF EEWSUB(ESBACT) NOT = INTKCD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE INTKCD OF EEWSUB(ESBACT)
                                       TO INTKCD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (BTHCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND BTHDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND BTHDAT OF EEWSUB(ESBACT) NOT = BTHDAT OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE BTHDAT OF EEWSUB(ESBACT)
                                       TO BTHDAT OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HIRDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND HIRDAT OF EEWSUB(ESBACT) NOT =
                                       HIRDAT OF SUBMDT)
              MOVE HIRDAT OF EEWSUB(ESBACT)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
              MOVE 'Y'                        TO DEMCHG-FLAG
           ELSE
              IF DEMMAS-CHANGE
                 MOVE HIRDAT OF SUBMDT TO HIRDAT OF MDTTAB(LIN-0001)
              END-IF
           END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (TYPCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND TYPCOD OF EEWSUB(ESBACT) NOT = TYPCOD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE TYPCOD OF EEWSUB(ESBACT)
                                       TO TYPCOD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (AREACD OF EEWSUB(ESBACT) NOT = SPACES
           AND AREACD OF EEWSUB(ESBACT) NOT = AREACD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE AREACD OF EEWSUB(ESBACT)
                                       TO AREACD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (TRMDAT OF EEWSUB(ESBACT) NOT = ZEROES
           AND TRMDAT OF EEWSUB(ESBACT) NOT =
                                    TRMDAT OF SUBMDT)
              MOVE TRMDAT OF EEWSUB(ESBACT)
                                    TO TRMDAT OF MDTTAB(LIN-0001)
              MOVE 'Y'                        TO DEMCHG-FLAG
           ELSE
              IF DEMMAS-CHANGE
                 MOVE TRMDAT OF SUBMDT
                                    TO TRMDAT OF MDTTAB(LIN-0001)
              END-IF
           END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR ((CPAIND OF EEWSUB(ESBACT) = 'M' OR 'S' OR 'N')
           AND CPAIND OF EEWSUB(ESBACT) NOT = CPAIND OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE CPAIND OF EEWSUB(ESBACT)
                                        TO CPAIND OF MDTTAB(LIN-0001)
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF CPDMAS-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF CPDMAS-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF CPDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
              MOVE 1                    TO LINENO OF CPDMAS-REC
              IF CPAIND OF EEWSUB(ESBACT) = 'M'
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
                 PERFORM A980-WRITE-CPDMAS        THRU A989-EXIT
              END-IF
              IF CPAIND OF EEWSUB(ESBACT) = 'S'
                 MOVE SUBSNO OF EEWSUB(ESBACT)
                                        TO CPNUMB OF CPDMAS-REC
                 PERFORM A980-WRITE-CPDMAS        THRU A989-EXIT.

              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (CPAIND OF EEWSUB(ESBACT) = 'N'
              AND CPAIND OF EEWSUB(ESBACT) = CPAIND OF SUBMDT)
                 MOVE SPACE             TO CPAIND OF MDTTAB(LIN-0001)
              END-IF
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR ((CPAIND OF EEWSUB(ESBACT) = 'M' OR 'S')
              AND CPAIND OF EEWSUB(ESBACT) = CPAIND OF SUBMDT)
                 PERFORM A990-CPAMAS-CHG          THRU A999-EXIT
                 IF CPACHG-FLAG = 'Y'
                    MOVE CPAIND OF EEWSUB(ESBACT)
                                        TO CPAIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                      TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHMAS-REC TO BRANCD OF CPDMAS-REC
                    MOVE BATDAT OF MBHMAS-REC TO BATDAT OF CPDMAS-REC
                    MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF CPDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                    MOVE 1                    TO LINENO OF CPDMAS-REC
                    IF CPAIND OF EEWSUB(ESBACT) = 'M'
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A980-WRITE-CPDMAS THRU A989-EXIT
                    END-IF
                    IF CPAIND OF EEWSUB(ESBACT) = 'S'
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A980-WRITE-CPDMAS THRU A989-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (WRKLOC OF EEWSUB(ESBACT) NOT = SPACES
           AND WRKLOC OF EEWSUB(ESBACT) NOT = WRKLOC OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE WRKLOC OF EEWSUB(ESBACT)
                                       TO WRKLOC OF MDTTAB(LIN-0001)
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (SSNXRF OF EEWSUB(ESBACT) NOT = ZEROS
           AND SSNXRF OF EEWSUB(ESBACT) NOT = SSNXRF OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE SSNXRF OF EEWSUB(ESBACT)
                                       TO SSNXRF OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (HICNNO OF EEWSUB(ESBACT) NOT = SPACES
           AND HICNNO OF EEWSUB(ESBACT) NOT = HICNNO OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE HICNNO OF EEWSUB(ESBACT)
                                       TO HICNNO OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (PEBTFS OF EEWSUB(ESBACT) NOT = SPACES
           AND PEBTFS OF EEWSUB(ESBACT) NOT = PEBTFS OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE PEBTFS OF EEWSUB(ESBACT)
                                       TO PEBTFS OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (FAXNUM OF EEWSUB(ESBACT) NOT = SPACES
           AND FAXNUM OF EEWSUB(ESBACT) NOT = FAXNUM OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE FAXNUM OF EEWSUB(ESBACT)
                                       TO FAXNUM OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (OTHPHN OF EEWSUB(ESBACT) NOT = SPACES
           AND OTHPHN OF EEWSUB(ESBACT) NOT = OTHPHN OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE OTHPHN OF EEWSUB(ESBACT)
                                       TO OTHPHN OF MDTTAB(LIN-0001).
      *
           IF EMLIND OF EEWSUB(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMLIND OF EEWSUB(ESBACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
              IF EMLIND OF EEWSUB(ESBACT) = 'Y'
                 MOVE ELMAIL OF EEWSUB(ESBACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EMLIND OF EEWSUB(ESBACT) = 'N'
           AND EMLIND OF SUBMDT = 'N')
              MOVE SPACES              TO EMLIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (STUSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND STUSTA OF EEWSUB(ESBACT) NOT = STUSTA OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE STUSTA OF EEWSUB(ESBACT)
                                       TO STUSTA OF MDTTAB(LIN-0001).

           IF HNDIND OF EEWSUB(ESBACT) NOT = SPACES
           AND MEMSTA OF EEWSUB(ESBACT) NOT = MEMSTA OF SUBMDT
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (HNDIND OF EEWSUB(ESBACT) = 'Y'
              AND MEMSTA OF SUBMDT NOT = 'H')
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE HNDIND OF EEWSUB(ESBACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
              END-IF
              IF (BYPEDT OF EDIENR-REC = 'Y'
              AND DEMTMP = ZEROES)
              OR (HNDIND OF EEWSUB(ESBACT) = 'N'
              AND MEMSTA OF EEWSUB(DEMTMP) = 'H')
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE HNDIND OF EEWSUB(ESBACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
              END-IF.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EDUBEG OF EEWSUB(ESBACT) NOT = SPACES
           AND EDUBEG OF EEWSUB(ESBACT) NOT = EDUBEG OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EDUBEG OF EEWSUB(ESBACT)
                                       TO EDUBEG OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EDUEND OF EEWSUB(ESBACT) NOT = SPACES
           AND EDUEND OF EEWSUB(ESBACT) NOT = EDUEND OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EDUEND OF EEWSUB(ESBACT)
                                       TO EDUEND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (CQLECD OF EEWSUB(ESBACT) NOT = SPACES
           AND CQLECD OF EEWSUB(ESBACT) NOT = CQLECD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE CQLECD OF EEWSUB(ESBACT)
                                       TO CQLECD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAQ OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAQ OF EEWSUB(ESBACT) NOT = COBRAQ OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAQ OF EEWSUB(ESBACT)
                                       TO COBRAQ OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAB OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAB OF EEWSUB(ESBACT) NOT = COBRAB OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAB OF EEWSUB(ESBACT)
                                       TO COBRAB OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (COBRAE OF EEWSUB(ESBACT) NOT = SPACES
           AND COBRAE OF EEWSUB(ESBACT) NOT = COBRAE OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE COBRAE OF EEWSUB(ESBACT)
                                       TO COBRAE OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EMSTCD OF EEWSUB(ESBACT) NOT = SPACES
           AND EMSTCD OF EEWSUB(ESBACT) NOT = EMSTCD OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMSTCD OF EEWSUB(ESBACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (DETDAT OF EEWSUB(ESBACT) NOT = SPACES
           AND DETDAT OF EEWSUB(ESBACT) NOT = DETDAT OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE DETDAT OF EEWSUB(ESBACT)
                                       TO DETDAT OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MARSTA OF EEWSUB(ESBACT) NOT = SPACES
           AND MARSTA OF EEWSUB(ESBACT) NOT = MARSTA OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MARSTA OF EEWSUB(ESBACT)
                                       TO MARSTA OF MDTTAB(LIN-0001).
      *
           IF  EXTIND OF EEWSB2(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EXTIND OF EEWSB2(ESBACT)
                                       TO EXTIND OF MDTTAB(LIN-0001).
      *
           IF  RSPIND OF EEWSB2(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE RSPIND OF EEWSB2(ESBACT)
                                       TO RSPIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'Y'
           AND MMDIND OF EEWSUB(ESBACT) NOT = MMDIND OF SUBMDT)
              MOVE MMDIND OF EEWSUB(ESBACT)
                                        TO MMDIND OF MDTTAB(LIN-0001)
              MOVE 'Y'                            TO DEMCHG-FLAG
              MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MMDMAS-REC
              MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MMDMAS-REC
              MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MMDMAS-REC
              MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
              MOVE 1                    TO LINENO OF MMDMAS-REC
              MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MMDMAS-REC
              PERFORM A1000-WRITE-MMDMAS          THRU A1009-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'N'
           AND MMDIND OF EEWSUB(ESBACT) = MMDIND OF SUBMDT)
              MOVE SPACE            TO MMDIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'Y'
           AND MMDIND OF EEWSUB(ESBACT) = MMDIND OF SUBMDT)
              PERFORM A1010-MCDMAS-CHG        THRU A1019-EXIT
              IF MCDCHG-FLAG = 'Y'
                 MOVE 'Y'                     TO DEMCHG-FLAG
                 MOVE MMDIND OF EEWSUB(ESBACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MMDMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MMDMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MMDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                 MOVE 1                    TO LINENO OF MMDMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                           TO MEMBNO OF MMDMAS-REC
                 PERFORM A1000-WRITE-MMDMAS THRU A1009-EXIT.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
              GO TO B642-START.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
              GO TO B642-START.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (RSPIND OF EEWSB2(ESBACT) = 'N'
           AND RSPIND OF SUBMDT = 'N')
              MOVE SPACE            TO RSPIND OF MDTTAB(LIN-0001).
      *
           IF  ALTIND OF EEWSB2(ESBACT) NOT = SPACES
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE ALTIND OF EEWSB2(ESBACT)
                                       TO ALTIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
              GO TO B642-START.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C')
           OR (ALTIND OF EEWSB2(ESBACT) = 'N'
           AND ALTIND OF SUBMDT = 'N')
              MOVE SPACES              TO ALTIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
              GO TO B642-START.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (EXTIND OF EEWSB2(ESBACT) = 'N'
           AND EXTIND OF SUBMDT = 'N')
              MOVE SPACES              TO EXTIND OF MDTTAB(LIN-0001).
      *
       B642-START.
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND SUBACT = ZEROES)
              GO TO B642-CONT.
      *
           INITIALIZE FACMAS-REC.
           MOVE ACCTNO OF SUBMDT       TO ACCTNO OF FACMAS-KEY.
           PERFORM FACMAS-READ
           IF  MMCIND OF EEWSUB(ESBACT)     = 'Y'
           AND MMCIND OF EEWSUB(ESBACT) NOT = MMCIND OF SUBMDT
              IF MCGIND OF FACMAS-REC        = 'Y'
              OR (MCGIND OF FACMAS-REC       = ' '
              AND MCGIND OF GRPMAS-REC       = 'Y')
                MOVE MMCIND OF EEWSUB(ESBACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                       TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MDMMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MDMMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MDMMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                 MOVE 1                    TO LINENO OF MDMMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF MDMMAS-REC
                 PERFORM A1100-WRITE-MDMMAS      THRU A1109-EXIT.
      *
       B642-CONT.
           IF  MMCIND OF EEWSUB(ESBACT) = 'N'
           AND MCGIND OF FACMAS-REC     = 'Y'
              MOVE MCGIND OF FACMAS-REC TO MMCIND OF EEWSUB(ESBACT).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT)     = 'N'
           AND MMCIND OF EEWSUB(ESBACT) NOT = MMCIND OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT) = 'N'
           AND MMCIND OF EEWSUB(ESBACT) = MMCIND OF SUBMDT)
              MOVE SPACE               TO MMCIND OF MDTTAB(LIN-0001).
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMCIND OF EEWSUB(ESBACT) = 'Y'
           AND MMCIND OF EEWSUB(ESBACT) = MMCIND OF SUBMDT)
              PERFORM A1110-MCMMAS-CHG           THRU A1119-EXIT
              IF MCRCHG-FLAG = 'Y'
                 MOVE MMCIND OF EEWSUB(ESBACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                     TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHMAS-REC TO BRANCD OF MDMMAS-REC
                 MOVE BATDAT OF MBHMAS-REC TO BATDAT OF MDMMAS-REC
                 MOVE BATSEQ OF MBHMAS-REC TO BATSEQ OF MDMMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                 MOVE 1                       TO LINENO OF MDMMAS-REC
                 MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDMMAS-REC
                 PERFORM A1100-WRITE-MDMMAS      THRU A1109-EXIT.
      *
           IF EMPSTA OF EEWSUB(ESBACT) NOT =
                                        EMPSTA OF SUBMDT
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE EMPSTA OF EEWSUB(ESBACT)
                                     TO EMPSTA OF MDTTAB(LIN-0001)
           END-IF
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND DEMTMP = ZEROES)
           OR (MMDIND OF EEWSUB(ESBACT) = 'N'
           AND MMDIND OF EEWSUB(ESBACT) NOT = MMDIND OF SUBMDT)
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MMDIND OF EEWSUB(ESBACT)
                                       TO MMDIND OF MDTTAB(LIN-0001).
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF DEMMAS-CHANGE
              MOVE 1                   TO LINENO OF MDTTAB(LIN-0001)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0001)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0001)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0001)
              MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
              MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
              MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
              MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
              MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
              MOVE RELCOD OF EEWSUB(ESBACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
              MOVE RELTYP OF EEWSUB(ESBACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
              MOVE TITLCD OF EEWSUB(ESBACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
              MOVE '1'                 TO STATCD OF MDTTAB(LIN-0001)
              MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
              MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
              MOVE MHCIND OF EEWSUB(ESBACT)
                                       TO MHCIND OF MDTMAS-REC
              IF INDUPD OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE INDUPD OF EEWSUB(ESBACT)
                                       TO INDUPD OF MDTMAS-REC
              ELSE
                 MOVE 'N'              TO INDUPD OF MDTMAS-REC
              END-IF
              MOVE OMEDAT OF EEWSUB(ESBACT)
                                       TO OMEDAT OF MDTTAB(LIN-0001)
              MOVE CRDMTH OF EEWSUB(ESBACT)
                                       TO CRDMTH OF MDTTAB(LIN-0001)
              MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
              MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
              MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
              MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
              MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
              MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
              MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
              MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
              MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
              MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
              IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0001)
              ELSE
                 MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001)
              END-IF
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0001)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0001)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0001)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0001)
              END-IF
              MOVE EMPSTA OF EEWSUB(ESBACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              MOVE EMSTCD OF EEWSUB(ESBACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
              MOVE MARSTA OF EEWSUB(ESBACT)
                                       TO MARSTA OF MDTTAB(LIN-0001).
      *
           IF DEMMAS-CHANGE
           OR MEMEFF OF EEWSUB(ESBACT) NOT = EFFDAT OF SUBMDT
           OR MEMEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT
              MOVE 'Y'                           TO DEMCHG-FLAG
              MOVE MEMEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0001)
              MOVE MEMEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0001).

           IF HOLDCD OF EEWSUB(ESBACT) NOT = SPACES
              MOVE MEMBNO OF EEWSUB(ESBACT)   TO HLDCOD-MEM
              MOVE HOLDCD OF EEWSUB(ESBACT)   TO HLDCOD-HLD
              PERFORM B750-HLDCOD-CHK         THRU B759-EXIT
              IF HLDCOD-FOUND
                 GO TO B642-STEP-5.
      *
       B642-STEP-5.
           IF PRCPCP OF EEWHDR-WRK = 'N'
           OR PCPCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-6.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM B760-SUBPCP             THRU B769-EXIT
                 IF PPSTMP = 0
                 AND BYPEDT OF EDIENR-REC = 'N'
                    NEXT SENTENCE
                 ELSE
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND NOT SUBADD-MDT-EXISTS)
                 OR (PCPCOD OF EEWSUB(ESBACT) NOT = PROVNO OF SUBMDT
                 OR  PCPORG OF EEWSUB(ESBACT) NOT = PRVORG OF SUBMDT
                 OR  PCPMCP OF EEWSUB(ESBACT) NOT = PCPMCP OF SUBMDT)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                           SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    IF PCPREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE PCPREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE PCPEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE PCPEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE PCPCOD OF EEWSUB(ESBACT) TO
                                          PROVNO OF MDTTAB(LIN-0004)
                    END-IF
                       MOVE PCPORG OF EEWSUB(ESBACT) TO
                                          PRVORG OF MDTTAB(LIN-0004)
                       MOVE PCPMCP OF EEWSUB(ESBACT) TO
                                          PCPMCP OF MDTTAB(LIN-0004)
                    IF PCPOVR OF EEWSUB(ESBACT) = SPACES
                       MOVE 'N'        TO PCPOVR OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPOVR OF EEWSUB(ESBACT) TO
                                          PCPOVR OF MDTTAB(LIN-0004)
                    END-IF
                    IF PCPTRM OF EEWSUB(ESBACT) = SPACES
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                                       MOVE 'Y' TO PCPTRM-FLAG
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
                    MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
                    MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
                    MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
                    MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
                    MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
                    MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
                    MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
                    MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
                    MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
                    MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       B642-STEP-6.
           IF PRCSEC OF EEWHDR-WRK = 'N'
           OR SECCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-7.
      *****************************************************************
      * SECONDARY PRV ARE OPTIONAL SO AN ADD RECORD MAY EXIST         *
      * WITH NO SECONDARY RECORD IN MHS. SECONDARY PROVIDERS          *
      * MAY BE ADDED TO A MEMBER WITH A CHANGE RECORD ON ME1023       *
      *****************************************************************
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO B642-STEP-7.
      *
              IF SECCOD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM B770-SUBSEC             THRU B779-EXIT
              ELSE
                 GO TO B642-STEP-7.
      *
                 IF SPSTMP = ZEROES
                    GO TO B642-ADDSEC.
      *
           IF (BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS)
              GO TO B642-ADDSEC.
      *
           IF SECCOD OF EEWSUB(ESBACT) NOT = SECPRV OF SUBMDT
           OR SECORG OF EEWSUB(ESBACT) NOT = SECORG OF SUBMDT
           OR SECMCP OF EEWSUB(ESBACT) NOT = SECMCP OF SUBMDT
           OR SECEFF OF EEWSUB(ESBACT) NOT = EFFDAT OF SUBMDT
           OR SECEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT
              GO TO B642-ADDSEC.
      *
           GO TO B642-STEP-7.
       B642-ADDSEC.
           MOVE 5             TO LINENO OF MDTTAB(LIN-0005)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0005)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0005)
           MOVE '1'           TO STATCD OF MDTTAB(LIN-0005)
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0005)
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0005)
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0005)
           MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0005)
           MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0005)
           MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0005)
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0005)
           IF SECREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE SECREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT)
                                     TO FORNAM OF MDTTAB(LIN-0005)
           MOVE SECEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0005)
           MOVE SECEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0005)
           IF SECCOD OF EEWSUB(ESBACT) NOT = SPACES
               MOVE SECCOD OF EEWSUB(ESBACT) TO
                                       SECPRV OF MDTTAB(LIN-0005)
           END-IF
              MOVE SECORG OF EEWSUB(ESBACT) TO
                                          SECORG OF MDTTAB(LIN-0005)
              MOVE SECMCP OF EEWSUB(ESBACT) TO
                                          SECMCP OF MDTTAB(LIN-0005)
           IF SECOVR OF EEWSUB(ESBACT) = SPACES
              MOVE 'N'        TO SECOVR OF MDTTAB(LIN-0005)
           ELSE
           MOVE SECOVR OF EEWSUB(ESBACT) TO
                                          SECOVR OF MDTTAB(LIN-0005)
           END-IF
           IF SECTRM OF EEWSUB(ESBACT) = SPACES
              MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0005)
                    END-IF
           MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0005)
           MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0005)
           MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0005)
           MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0005)
           MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0005)
           MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0005)
           MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0005)
           MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0005)
           MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0005)
           MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0005)
           MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0005)
           MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0005)
           MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0005)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0005)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0005)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0005)
                   END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0005)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'                 TO PRTCOD OF MDTTAB(LIN-0005)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0005).
       B642-STEP-7.
           IF PRCMCS OF EEWHDR-WRK = 'N'
           OR MEDCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-8.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO B642-STEP-8.
      *
           IF  (MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND  MEDSTS OF EEWSUB(ESBACT) NOT = SPACES)
              PERFORM B780-SUBMED                THRU B789-EXIT
           ELSE
              GO TO B642-STEP-8.
      *
           IF SMDTMP = ZEROES
              GO TO B642-ADDMED.
      *
           IF BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS
              GO TO B642-ADDMED.

           IF  MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND  MEDSTS OF EEWSUB(ESBACT) NOT = SPACES
            IF MEDCTY OF EEWSUB(ESBACT) NOT = MEDCTY OF SUBMDT
            OR (MEDSTS OF EEWSUB(ESBACT) NOT = MEDSTS OF SUBMDT)
              GO TO B642-ADDMED.
      *
           GO TO B642-STEP-8.
       B642-ADDMED.
           MOVE 6                   TO LINENO OF MDTTAB(LIN-0006)
           MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0006)
           MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0006)
           MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0006)
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0006)
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0006)
           MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0006)
           MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0006)
           MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0006)
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0006)
           IF MEDREA OF EEWSUB(ESBACT) NOT = SPACES
                    MOVE MEDREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           ELSE
                    MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0006)
           MOVE MEDEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0006)
           MOVE MEDEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0006)
           MOVE MEDCTY OF EEWSUB(ESBACT) TO
                                       MEDCTY OF MDTTAB(LIN-0006)
           MOVE MEDSTS OF EEWSUB(ESBACT) TO
                                       MEDSTS OF MDTTAB(LIN-0006)
           IF MEDTRM OF EEWSUB(ESBACT) = SPACES
              MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEDTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0006)
                    END-IF
           MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0006)
           MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0006)
           MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0006)
           MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0006)
           MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0006)
           MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0006)
           MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0006)
           MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0006)
           MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0006)
           MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0006)
           MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0006)
           MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0006)
           MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0006)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0006)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0006)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0006)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0006)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0006)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0006).
       B642-STEP-8.
           IF PRCFEE OF EEWHDR-WRK = 'N'
           OR FEECHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-9.
      *
           IF CHGTYP OF EEWSUB(ESBACT) NOT = 'C'
              GO TO B642-STEP-9.
      *
           IF FEECOD OF EEWSUB(ESBACT) NOT = SPACES
              PERFORM B790-SUBFEE                THRU B799-EXIT
           ELSE
              GO TO B642-STEP-9.
      *
           IF SFETMP = ZEROES
              GO TO B642-ADDFEE.
      *
           IF BYPEDT OF EDIENR-REC = 'Y'
           AND NOT SUBADD-MDT-EXISTS
              GO TO B642-ADDFEE.

           IF FEECOD OF EEWSUB(ESBACT) NOT = FEECOD OF SUBMDT
              GO TO B642-ADDFEE.
      *
           GO TO B642-STEP-9.
       B642-ADDFEE.
           MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
           MOVE SEQNUM OF WS-WORK TO
                                   SEQNUM OF MDTTAB(LIN-0004)
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                   TO SUBSNO OF MDTTAB(LIN-0004)
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
           MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
           MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
           MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
           IF FEEREA OF EEWSUB(ESBACT) NOT = SPACES
              MOVE FEEREA OF EEWSUB(ESBACT)
                                   TO REASCD OF MDTTAB(LIN-0004)
           ELSE
              MOVE MEMREA OF EEWSUB(ESBACT)
                                   TO REASCD OF MDTTAB(LIN-0004)
           END-IF
           MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
           MOVE FEEEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
           MOVE FEEEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
           MOVE FEECOD OF EEWSUB(ESBACT)
                                       TO FEECOD OF MDTTAB(LIN-0004)
           IF FEETRM OF EEWSUB(ESBACT) NOT = SPACES
              MOVE FEETRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              MOVE 'Y'                 TO FEETRM-FLAG
           ELSE
              IF PCPTRM-NOT-USED
                MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              END-IF
           END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
           MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
           MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
           MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
           MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
           MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
           MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
           MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
           MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
           MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0004)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0004)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0004)
           END-IF
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
               MOVE 'D'                TO PRTCOD OF MDTTAB(LIN-0004)
           ELSE
               MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B642-STEP-9.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCACT OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-10.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
             IF  ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL'
                 PERFORM B800-SUBENB             THRU B809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND NOT SUBADD-MDT-EXISTS)
                 OR ACCTNO OF EEWSUB(ESBACT) NOT = ACCTNO OF SUBMDT
                    MOVE 2             TO LINENO OF MDTTAB(LIN-0002)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0002)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0002)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0002)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0002)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                    MOVE ACCTNO OF EEWSUB(ESBACT)
                                       TO ACCTNO OF MDTTAB(LIN-0002)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0002)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                    IF ENBTRM OF EEWSUB(ESBACT) = SPACES
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0002)
                    END-IF
                    IF OMEDAT OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE OMEDAT OF EEWSUB(ESBACT)
                                         TO OMEDAT OF MDTTAB(LIN-0002)
                    END-IF
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0002)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0002)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0002)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0002)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
       B642-STEP-10.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCTIR OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-11.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF TIERCD OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM B800-SUBENB             THRU B809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND NOT SUBADD-MDT-EXISTS)
                 OR TIERCD OF EEWSUB(ESBACT) NOT = TIERCD OF SUBMDT(01)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE TIRFLG OF EEWSUB(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE MEMSTA OF EEWSUB(ESBACT)
                                       TO MEMSTA OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       B642-STEP-11.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCBPK OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-11A.
      *
      ****--------------------------------------------------------****
      ****  PMHS-374  KCT  Fix                                    ****
      ****  Also capture tier code to prevent error in ME102A.    ****
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF BENPKG OF EEWSUB(ESBACT) NOT = SPACES
                 PERFORM B800-SUBENB                 THRU B809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND NOT SUBADD-MDT-EXISTS)
                 OR BENPKG OF EEWSUB(ESBACT) NOT = BENPKG OF SUBMDT
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          MOVE TIRFLG OF EEWDEP(ESBACT)
      ****                             TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE TIRFLG OF EEWSUB(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B642-STEP-11A.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWSUB(ESBACT) = 'N'
              GO TO B642-STEP-12.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF (USRFL1 OF EEWSUB(ESBACT) NOT = SPACES
              OR USRFL2 OF EEWSUB(ESBACT) NOT = SPACES
              OR USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
                 PERFORM B800-SUBENB                 THRU B809-EXIT
                 IF (BYPEDT OF EDIENR-REC = 'Y'
                 AND NOT SUBADD-MDT-EXISTS)
                 OR (USRFL1 OF EEWSUB(ESBACT) NOT = USRFL1 OF SUBMDT
                 OR USRFL2 OF EEWSUB(ESBACT) NOT = USRFL2 OF SUBMDT
                 OR USRFL3 OF EEWSUB(ESBACT) NOT = USRFL3 OF SUBMDT)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWSUB(ESBACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWSUB(ESBACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWSUB(ESBACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWSUB(ESBACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWSUB(ESBACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWSUB(ESBACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWSUB(ESBACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWSUB(ESBACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWSUB(ESBACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                       MOVE ENBTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWSUB(ESBACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWSUB(ESBACT) NOT = SPACE
                       MOVE CRDCNT OF EEWSUB(ESBACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWSUB(ESBACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWSUB(ESBACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWSUB(ESBACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWSUB(ESBACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWSUB(ESBACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWSUB(ESBACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWSUB(ESBACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWSUB(ESBACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWSUB(ESBACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWSUB(ESBACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
                    MOVE TIRFLG OF EEWDEP(ESBACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWSB2(ESBACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWSUB(ESBACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B642-STEP-12.
           IF EXTMEM OF EEWSUB(ESBACT) = SPACES
           AND EXTGRP OF EEWSUB(ESBACT) = SPACES
           AND EXTSUB OF EEWSUB(ESBACT) = SPACES
              GO TO B642-STEP-13.
      *
           MOVE 7                      TO LINENO OF MDTTAB(LIN-0007).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0007).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0007).
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0007).
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0007).
           MOVE MEMEFF OF EEWSUB(ESBACT) TO EFFDAT OF MDTTAB(LIN-0007).
           MOVE MEMEXP OF EEWSUB(ESBACT) TO EXPDAT OF MDTTAB(LIN-0007).
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0007).
           MOVE EXTMEM OF EEWSUB(ESBACT)
                                       TO EXTMEM OF MDTTAB(LIN-0007).
           MOVE EXTGRP OF EEWSUB(ESBACT)
                                       TO EXTGRP OF MDTTAB(LIN-0007).
           MOVE EXTCON OF EEWSUB(ESBACT)
                                       TO EXTCON OF MDTTAB(LIN-0007).
           MOVE EXTEFF OF EEWSUB(ESBACT)
                                       TO EXTEFF OF MDTTAB(LIN-0007).
           MOVE EXTEXP OF EEWSUB(ESBACT)
                                       TO EXTEXP OF MDTTAB(LIN-0007).
           MOVE EXTSUB OF EEWSUB(ESBACT)
                                       TO EXTSUB OF MDTTAB(LIN-0007).
           MOVE HISSEQ OF EEWSUB(ESBACT)
                                       TO HISSEQ OF MDTTAB(LIN-0007).
           MOVE CTLPLN OF EEWSUB(ESBACT)
                                       TO CTLPLN OF MDTTAB(LIN-0007).
           MOVE EXTREL OF EEWSUB(ESBACT)
                                       TO EXTREL OF MDTTAB(LIN-0007).
           MOVE PRVPLN OF EEWSUB(ESBACT)
                                       TO PRVPLN OF MDTTAB(LIN-0007).
           MOVE PRVNET OF EEWSUB(ESBACT)
                                       TO PRVNET OF MDTTAB(LIN-0007).
           MOVE PROCOD OF EEWSUB(ESBACT)
                                       TO PROCOD OF MDTTAB(LIN-0007).
           MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0007).
           MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0007).
           MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0007).
           MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0007).
           MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0007).
           MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0007).
           MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0007).
           MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0007).
           MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0007).
           MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0007).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0007)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0007)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0007)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0007)
           END-IF.

       B642-STEP-13.
           IF  SALEFF OF EEWSUB(ESBACT) = ZEROS
           AND SALEXP OF EEWSUB(ESBACT) = ZEROS
           AND SALAMT OF EEWSUB(ESBACT) = ZEROS
              GO TO B642-STEP-14.
      *
           MOVE 8                      TO LINENO OF MDTTAB(LIN-0008).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0008).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0008).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0008).
           MOVE SUBSNO OF EEWSUB(ESBACT)
                                       TO SUBSNO OF MDTTAB(LIN-0008).
           MOVE MEMBNO OF EEWSUB(ESBACT)
                                       TO MEMBNO OF MDTTAB(LIN-0008).
           MOVE RELCOD OF EEWSUB(ESBACT)
                                       TO RELCOD OF MDTTAB(LIN-0008).
           MOVE CGAOVR OF EEWSUB(ESBACT)
                                       TO CGAOVR OF MDTTAB(LIN-0008).
           MOVE CGTOVR OF EEWSUB(ESBACT)
                                       TO CGTOVR OF MDTTAB(LIN-0008).
           MOVE DALOVR OF EEWSUB(ESBACT)
                                       TO DALOVR OF MDTTAB(LIN-0008).
           MOVE SALOVR OF EEWSUB(ESBACT)
                                       TO SALOVR OF MDTTAB(LIN-0008).
           MOVE CBXOVR OF EEWSUB(ESBACT)
                                       TO CBXOVR OF MDTTAB(LIN-0008).
           MOVE CBEOVR OF EEWSUB(ESBACT)
                                       TO CBEOVR OF MDTTAB(LIN-0008).
           MOVE APCOVR OF EEWSUB(ESBACT)
                                       TO APCOVR OF MDTTAB(LIN-0008).
           MOVE SSSOVR OF EEWSUB(ESBACT)
                                       TO SSSOVR OF MDTTAB(LIN-0008).
           MOVE VRCOVR OF EEWSUB(ESBACT)
                                       TO VRCOVR OF MDTTAB(LIN-0008).
           MOVE RMTOVR OF EEWSUB(ESBACT)
                                       TO RMTOVR OF MDTTAB(LIN-0008).
           IF  SALEFF OF EEWSUB(ESBACT) = 99999999
              MOVE 9999999             TO EFFDAT OF MDTTAB(LIN-0008)
           ELSE
           IF  SALEFF OF EEWSUB(ESBACT) = ZEROS
              MOVE ZEROS               TO EFFDAT OF MDTTAB(LIN-0008)
           ELSE
              COMPUTE EFFDAT OF MDTTAB(LIN-0008) =
                  SALEFF OF EEWSUB(ESBACT) - 18000000.
           IF  SALEXP OF EEWSUB(ESBACT) = 99999999
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0008)
           ELSE
           IF  SALEXP OF EEWSUB(ESBACT) = ZEROS
              MOVE ZEROS               TO EXPDAT OF MDTTAB(LIN-0008)
           ELSE
              COMPUTE EXPDAT OF MDTTAB(LIN-0008) =
                  SALEXP OF EEWSUB(ESBACT) - 18000000.
           MOVE SALAMT OF EEWSUB(ESBACT) TO SALAMT OF MDTTAB(LIN-0008).
           MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF MDTTAB(LIN-0008).
           IF PRTCOD OF EEWSUB(ESBACT) = SPACES
              MOVE 'D'                 TO PRTCOD OF MDTTAB(LIN-0008)
           ELSE
              MOVE PRTCOD OF EEWSUB(ESBACT)
                                       TO PRTCOD OF MDTTAB(LIN-0008).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWSB2(ESBACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWSB2(ESBACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0008)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWSB2(ESBACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0008)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWSB2(ESBACT)
                                       TO EXCHNG OF MDTTAB(LIN-0008)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0008)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0008)
           END-IF.

       B642-STEP-14.
              IF ENBTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE ENBTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0002).
              IF PCPTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE PCPTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0004).
              IF SECTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE SECTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0005).
              IF MEDTRM OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE MEDTRM OF EEWSUB(ESBACT)
                                         TO TERMCD OF MDTTAB(LIN-0006).
      *
              IF ENBREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE ENBREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0002).
              IF PCPREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE PCPREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0004).
              IF SECREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE SECREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0005).
              IF MEDREA OF EEWSUB(ESBACT) NOT = SPACES
                 MOVE MEDREA OF EEWSUB(ESBACT)
                                         TO REASCD OF MDTTAB(LIN-0006).
      *
           MOVE DOCNUM OF EEWSUB(ESBACT) TO DOCNUM OF WS-WORK.
      *
           MOVE 'S'                              TO RECTYP-FLAG.
           MOVE 'N'                              TO MDT-FLAG.
           MOVE 'N'                              TO SEQ-FLAG.
           MOVE 'N'                              TO PRCSEQ-FLAG.
           MOVE 'Y'                              TO FIRST-LINE-FLAG.
           MOVE 'SUB'                            TO MEMEXT-TYP.
      *
           PERFORM A690-MDTMAS-WRITE             THRU A699-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.

           IF MDT-ADDED
              ADD 1                    TO TOTBAT OF WS-WORK
              ADD 1                    TO NUMMDT OF WS-WORK
              ADD 1                    TO BATCHG OF WS-WORK.
       B649-EXIT.
           EXIT.
      *
       B680-ME1023-DEPCHG.
      ****************************************************************
      * ME1023 change records for Dependents.                        *
      ****************************************************************
      *INITIALIZE THE MDTTAB EACH TIME THRU
           PERFORM A900-INIT-MDTTAB              THRU A909-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           MOVE SPACES                 TO DOCNUM OF WS-WORK.
      *
           IF NOT MEMADD-MDT-EXISTS              GO TO B682-ADDMEM.

           IF PRCNAM OF EEWHDR-WRK = 'N'
           OR NAMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-2.
      *
           IF LSTNAM OF EEWDEP(EDPACT) = SPACES
           AND FSTNAM OF EEWDEP(EDPACT) = SPACES
           AND MIDNAM OF EEWDEP(EDPACT) = SPACES
              GO TO B682-STEP-2.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF (LSTNAM OF EEWDEP(EDPACT) NOT = LSTNAM OF MEMMDT
           OR  FSTNAM OF EEWDEP(EDPACT) NOT = FSTNAM OF MEMMDT
           OR  MIDNAM OF EEWDEP(EDPACT) NOT = MIDNAM OF MEMMDT)
           AND CHGTYP OF EEWDEP(EDPACT) = 'C' OR SPACES
              MOVE 003                 TO LINENO OF MDTTAB(LIN-0003)
              MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0003)
              MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0003)
              MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0003)
              MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0003)
              MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0003)
              MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0003)
              MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0003)
              MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0003)
              MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0003)
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0003)
              MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0003)
              MOVE CHGEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0003)
              MOVE 9999999             TO EXPDAT OF MDTTAB(LIN-0003)
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0003)
              MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0003)
              MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0003)
              MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0003)
              MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0003)
              MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0003)
              MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0003)
              MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0003)
              MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0003)
              MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0003)
              MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0003)
              MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0003)
              MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0003)
              MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0003)
              MOVE SPACE               TO TIRFLG OF MDTTAB(LIN-0003)
      ****    IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
              IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                         OR 'MI' OR 'MS'
      ****       IF EXCHNG OF MEMMAS-REC = 'MI'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                    MOVE 'EI'          TO EXCHNG OF MDTTAB(LIN-0003)
      ****       ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                 ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                         MOVE 'ES'     TO EXCHNG OF MDTTAB(LIN-0003)
                      ELSE
      ****               MOVE EXCHNG OF MEMMAS-REC
                         MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0003)
                      END-IF
                 END-IF
                 MOVE 'Y'              TO EXCIND OF MDTTAB(LIN-0003)
                 MOVE 'R'              TO ENRSTA OF MDTTAB(LIN-0003)
              END-IF
              IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                 MOVE 'D'              TO PRTCOD OF MDTTAB(LIN-0003)
              ELSE
                 MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0003).
       B682-STEP-2.
           IF WS-DT3-TRMEFF IS NUMERIC
            IF WS-DT1-MEMEFF <= WS-DT3-TRMEFF
            AND WS-DT3-TRMEFF NOT = ZEROES
            AND (CHGTYP OF EEWDEP(EDPACT) = 'T'
            OR   CHGTYP OF EEWDEP(EDPACT) = ' ')
              IF CHGTYP OF EEWDEP(EDPACT) = ' '
                 MOVE 'T'              TO CHGTYP OF EEWDEP(EDPACT)
              END-IF
              MOVE 'Y'                           TO WS-TRMDEP.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****  Do not write EXCMDTBT if there is no detail 3 record. ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
              IF  (EFFDAT OF MEMMDT <= MEMEXP OF EEWDEP(EDPACT)
              AND EXPDAT OF MEMMDT NOT = MEMEXP OF EEWDEP(EDPACT))
              OR  WS-TRMDEP = 'Y'
                 MOVE 002              TO LINENO OF MDTTAB(LIN-0002)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0002)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0002)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0002)
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0002)
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0002)
                 MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0002)
                 MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0002)
                 MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0002)
                 MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0002)
                 MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0002)
                 MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0002)
                 MOVE MEMEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0002)
                 IF EXPDAT OF MDTTAB(LIN-0002) = ZEROES
                    MOVE WS-DT3-TRMEFF TO EXPDAT OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0002)
                 MOVE CRDCNT OF EEWDEP(EDPACT)
                                      TO CRDCNT OF MDTTAB(LIN-0002)
                 MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0002)
                 MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0002)
                 MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0002)
                 MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0002)
                 MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0002)
                 MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0002)
                 MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0002)
                 MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0002)
                 MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0002)
                 MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0002)
                 MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0002)
                 MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0002)
                 MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0002)
                 MOVE SPACE            TO TIRFLG OF MDTTAB(LIN-0002)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0002)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0002)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0002)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0002)
                 END-IF
                 MOVE EXCSUB OF EEWDEP(EDPACT)
                                       TO EXCSUB OF MDTTAB(LIN-0002)
                 MOVE EXCMEM OF EEWDEP(EDPACT)
                                       TO EXCMEM OF MDTTAB(LIN-0002)
                 IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                    MOVE 'Y'                     TO WS-TRMDEP
                    PERFORM A1520-EXCMEMBT-CHG   THRU A1529-EXIT
      ****          IF EXCMEM-FLAG = 'Y'
      ****          OR ADD-EXCMEM
                    IF   RELCOD OF EEWDP3(EDPACT) NOT = SPACES
                    AND (EXCMEM-FLAG = 'Y'
                    OR   ADD-EXCMEM)
                      MOVE 'Y'                   TO DEMCHG-FLAG
                      MOVE MEMSEQ OF MEMMAS-REC  TO WS-EXC-MEMSEQ
                      INITIALIZE EXCMDTBT-REC
                      MOVE BRANCD OF MBHMAS-REC  TO WS-EXC-BRANCD
                      MOVE BATDAT OF MBHMAS-REC  TO WS-EXC-BATDAT
                      MOVE BATSEQ OF MBHMAS-REC  TO WS-EXC-BATSEQ
                      MOVE SEQNUM OF WS-WORK     TO WS-EXC-SEQNUM
                      MOVE 2                     TO WS-EXC-LINENO
                      MOVE 1                     TO WS-EXCSEQ
                      PERFORM A1440-WRITE-EXCMDTBT THRU A1449-EXIT
                    END-IF
                 END-IF
                 IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                    MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
                 ELSE
                    MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
      *
           IF MEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-3.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO B682-STEP-3.
      *
           IF NOT MEMADD-MDT-EXISTS              GO TO B682-STEP-3.
      *
           IF (MEMEFF OF EEWDEP(EDPACT) NOT = EFFDAT OF MEMMDT
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT)
              IF (MEMEFF OF EEWDEP(EDPACT) NOT < EFFDAT OF MEMMDT
              AND MEMEFF OF EEWDEP(EDPACT) NOT > EXPDAT OF MEMMDT)
              OR (MEMEXP OF EEWDEP(EDPACT) NOT < EFFDAT OF MEMMDT
              AND MEMEXP OF EEWDEP(EDPACT) NOT > EXPDAT OF MEMMDT)
              OR (MEMEFF OF EEWDEP(EDPACT) < EFFDAT OF MEMMDT
              AND MEMEXP OF EEWDEP(EDPACT) > EXPDAT OF MEMMDT)
                 GO TO B682-ADDMEM.
      *
           IF (MEMEFF OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT)
              IF EFFDAT OF MEMMDT > MEMEXP OF EEWDEP(EDPACT)
                 INITIALIZE DAYS-AREA
                 MOVE MEMEXP OF EEWDEP(EDPACT)   TO DATFR
                 MOVE EFFDAT OF MEMMDT           TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO B682-ADDMEM.
      *
           IF (MEMEFF OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT)
              IF MEMEFF OF EEWDEP(EDPACT) > EXPDAT OF MEMMDT
                 INITIALIZE DAYS-AREA
                 MOVE EXPDAT OF MEMMDT           TO DATFR
                 MOVE MEMEFF OF EEWDEP(EDPACT)   TO DATTO
                 PERFORM 099-SCDAYS
                 IF DAYS OF DAYS-AREA = 1
                    GO TO B682-ADDMEM.
      *
           GO TO B682-STEP-3.
       B682-ADDMEM.
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Correct alignment per standards.                      ****
      ****--------------------------------------------------------****
           MOVE 2                      TO LINENO OF MDTTAB(LIN-0002).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0002).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0002).
           MOVE SEQNUM OF WS-WORK      TO SEQNUM OF MDTTAB(LIN-0002).
           MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF MDTTAB(LIN-0002).
           MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF MDTTAB(LIN-0002).
           MOVE LSTNAM OF EEWDEP(EDPACT) TO LSTNAM OF MDTTAB(LIN-0002).
           MOVE MIDNAM OF EEWDEP(EDPACT) TO MIDNAM OF MDTTAB(LIN-0002).
           MOVE FSTNAM OF EEWDEP(EDPACT) TO FSTNAM OF MDTTAB(LIN-0002).
           MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF MDTTAB(LIN-0002).
           MOVE MEMREA OF EEWDEP(EDPACT) TO REASCD OF MDTTAB(LIN-0002).
           MOVE FORNAM OF EEWDEP(EDPACT) TO FORNAM OF MDTTAB(LIN-0002).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0002).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0002).
           MOVE MEMTRM OF EEWDEP(EDPACT) TO TERMCD OF MDTTAB(LIN-0002).
           MOVE CRDCNT OF EEWDEP(EDPACT) TO CRDCNT OF MDTTAB(LIN-0002).
           MOVE USRFL2 OF EEWDEP(EDPACT) TO USRFL2 OF MDTTAB(LIN-0002).
           MOVE USRFL3 OF EEWDEP(EDPACT) TO USRFL3 OF MDTTAB(LIN-0002).
           MOVE USRFL1 OF EEWDEP(EDPACT) TO USRFL1 OF MDTTAB(LIN-0002).
           MOVE DALOVR OF EEWDEP(EDPACT) TO DALOVR OF MDTTAB(LIN-0002).
           MOVE CGAOVR OF EEWDEP(EDPACT) TO CGAOVR OF MDTTAB(LIN-0002).
           MOVE CGTOVR OF EEWDEP(EDPACT) TO CGTOVR OF MDTTAB(LIN-0002).
           MOVE SALOVR OF EEWDEP(EDPACT) TO SALOVR OF MDTTAB(LIN-0002).
           MOVE CBXOVR OF EEWDEP(EDPACT) TO CBXOVR OF MDTTAB(LIN-0002).
           MOVE CBEOVR OF EEWDEP(EDPACT) TO CBEOVR OF MDTTAB(LIN-0002).
           MOVE APCOVR OF EEWDEP(EDPACT) TO APCOVR OF MDTTAB(LIN-0002).
           MOVE SSSOVR OF EEWDEP(EDPACT) TO SSSOVR OF MDTTAB(LIN-0002).
           MOVE VRCOVR OF EEWDEP(EDPACT) TO VRCOVR OF MDTTAB(LIN-0002).
           MOVE RMTOVR OF EEWDEP(EDPACT) TO RMTOVR OF MDTTAB(LIN-0002).
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0002)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0002)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0002)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0002)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0002)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0002)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0002).
      *
       B682-STEP-3.
           PERFORM B870-DEPDEM                   THRU B879-EXIT.
           IF DEPTMP = ZERO                      GO TO B682-STEP-4.
      *
           IF PRCDEM OF EEWHDR-WRK = 'N'
           OR DEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-4.
      *
           MOVE 'N'                              TO DEMCHG-FLAG.
      *
           IF COBDAT OF EEWDEP(EDPACT)  NOT = ZEROS
              MOVE COBDAT OF EEWDEP(EDPACT)
                                       TO COBDAT OF MDTTAB(LIN-0001).
           IF PAYLOC OF EEWDEP(EDPACT)  NOT = SPACES
               MOVE PAYLOC OF EEWDEP(EDPACT)
                                       TO PAYLOC OF MDTTAB(LIN-0001).
           IF PAYNUM OF EEWDEP(EDPACT)  NOT = SPACES
               MOVE PAYNUM OF EEWDEP(EDPACT)
                                       TO PAYNUM OF MDTTAB(LIN-0001).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF  RELCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND RELCOD OF EEWDEP(EDPACT) NOT = RELCOD OF MEMMDT
                 MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF  RELTYP OF EEWDEP(EDPACT) NOT = SPACES
              AND RELTYP OF EEWDEP(EDPACT) NOT = RELTYP OF MEMMDT
                 MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
              IF SEXCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND SEXCHG OF EEWDEP(EDPACT) NOT = 'N'
              AND SEXCOD OF EEWDEP(EDPACT) NOT = SEXCOD OF MEMMDT
                 MOVE SEXCOD OF EEWDEP(EDPACT)
                                       TO SEXCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF (ADRLN1 OF EEWDEP(EDPACT) NOT = SPACES
              AND (ADRLN1 OF EEWDEP(EDPACT) NOT = ADRLN1 OF MEMMDT
              OR ADRLN2 OF EEWDEP(EDPACT) NOT = ADRLN2 OF MEMMDT))
              OR (CITYCD OF EEWDEP(EDPACT) NOT = SPACES
              AND CITYCD OF EEWDEP(EDPACT) NOT = CITYCD OF MEMMDT)
              OR (STACOD OF EEWDEP(EDPACT) NOT = SPACES
              AND STACOD OF EEWDEP(EDPACT) NOT = STACOD OF MEMMDT)
              OR (ZIPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND ZIPCOD OF EEWDEP(EDPACT) NOT = ZIPCOD OF MEMMDT)
              OR (CTRYCD OF EEWDEP(EDPACT) NOT = SPACES
              AND CTRYCD OF EEWDEP(EDPACT) NOT = CTRYCD OF MEMMDT)
              OR (AREACD OF EEWDEP(EDPACT) NOT = SPACES
              AND AREACD OF EEWDEP(EDPACT) NOT = AREACD OF MEMMDT)
              OR (LOCQLF OF EEWDEP(EDPACT) NOT = SPACES
              AND LOCQLF OF EEWDEP(EDPACT) NOT = LOCQLF OF MEMMDT)
                 MOVE ADRLN1 OF EEWDEP(EDPACT)
                                       TO ADRLN1 OF MDTTAB(LIN-0001)
                 MOVE ADRLN2 OF EEWDEP(EDPACT)
                                       TO ADRLN2 OF MDTTAB(LIN-0001)
                 MOVE CITYCD OF EEWDEP(EDPACT)
                                       TO CITYCD OF MDTTAB(LIN-0001)
                 MOVE STACOD OF EEWDEP(EDPACT)
                                       TO STACOD OF MDTTAB(LIN-0001)
                 MOVE ZIPCOD OF EEWDEP(EDPACT)
                                       TO ZIPCOD OF MDTTAB(LIN-0001)
                 MOVE CTRYCD OF EEWDEP(EDPACT)
                                       TO CTRYCD OF MDTTAB(LIN-0001)
                 MOVE AREACD OF EEWDEP(EDPACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
                 MOVE LOCQLF OF EEWDEP(EDPACT)
                                       TO LOCQLF OF MDTTAB(LIN-0001)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0001)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0001)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0001)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0001)
                 END-IF
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH1 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH1 OF EEWDEP(EDPACT) NOT = HOMPH1 OF MEMMDT
                 MOVE HOMPH1 OF EEWDEP(EDPACT)
                                       TO HOMPH1 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH2 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH2 OF EEWDEP(EDPACT) NOT = HOMPH2 OF MEMMDT

                 MOVE HOMPH2 OF EEWDEP(EDPACT)
                                       TO HOMPH2 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HOMPH3 OF EEWDEP(EDPACT) NOT = SPACES
              AND HOMPH3 OF EEWDEP(EDPACT) NOT = HOMPH3 OF MEMMDT
                 MOVE HOMPH3 OF EEWDEP(EDPACT)
                                       TO HOMPH3 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH1 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH1 OF EEWDEP(EDPACT) NOT = WRKPH1 OF MEMMDT
                 MOVE WRKPH1 OF EEWDEP(EDPACT)
                                       TO WRKPH1 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH2 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH2 OF EEWDEP(EDPACT) NOT = WRKPH2 OF MEMMDT
                 MOVE WRKPH2 OF EEWDEP(EDPACT)
                                       TO WRKPH2 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKPH3 OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKPH3 OF EEWDEP(EDPACT) NOT = WRKPH3 OF MEMMDT
                 MOVE WRKPH3 OF EEWDEP(EDPACT)
                                       TO WRKPH3 OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF WRKEXT OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKEXT OF EEWDEP(EDPACT) NOT = WRKEXT OF MEMMDT
                 MOVE WRKEXT OF EEWDEP(EDPACT)
                                       TO WRKEXT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF SOCSEC OF EEWDEP(EDPACT) NOT = SPACES
              AND SOCSEC OF EEWDEP(EDPACT) NOT = SOCSEC OF MEMMDT
                 MOVE SOCSEC OF EEWDEP(EDPACT)
                                       TO SOCSEC OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF RACECD OF EEWDEP(EDPACT) NOT = SPACES
              AND RACECD OF EEWDEP(EDPACT) NOT = RACECD OF MEMMDT
                 MOVE RACECD OF EEWDEP(EDPACT)
                                       TO RACECD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF MEMSTA OF EEWDEP(EDPACT) NOT = SPACES
              AND MEMSTA OF EEWDEP(EDPACT) NOT = MEMSTA OF MEMMDT
                 MOVE MEMSTA OF EEWDEP(EDPACT)
                                       TO MEMSTA OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF AUTEXP OF EEWDEP(EDPACT) NOT = SPACES
              AND AUTEXP OF EEWDEP(EDPACT) NOT = AUTEXP OF MEMMDT
                 MOVE AUTEXP OF EEWDEP(EDPACT)
                                       TO AUTEXP OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF ALTNUM OF EEWDEP(EDPACT) NOT = SPACES
              AND ALTNUM OF EEWDEP(EDPACT) NOT = ALTNUM OF MEMMDT

                 MOVE ALTNUM OF EEWDEP(EDPACT)
                                       TO ALTNUM OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF INTKCD OF EEWDEP(EDPACT) NOT = SPACES
              AND INTKCD OF EEWDEP(EDPACT) NOT = INTKCD OF MEMMDT
                 MOVE INTKCD OF EEWDEP(EDPACT)
                                       TO INTKCD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF BTHDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND BTHCHG OF EEWDEP(EDPACT) NOT = 'N'
              AND BTHDAT OF EEWDEP(EDPACT) NOT = BTHDAT OF MEMMDT
                 MOVE BTHDAT OF EEWDEP(EDPACT)
                                       TO BTHDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HIRDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND HIRDAT OF EEWDEP(EDPACT) NOT = HIRDAT OF MEMMDT
                 MOVE HIRDAT OF EEWDEP(EDPACT)
                                       TO HIRDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              ELSE
                 IF DEMMAS-CHANGE
                    MOVE HIRDAT OF MEMMDT
                                       TO HIRDAT OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF TYPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND TYPCOD OF EEWDEP(EDPACT) NOT = TYPCOD OF MEMMDT
                 MOVE TYPCOD OF EEWDEP(EDPACT)
                                       TO TYPCOD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF AREACD OF EEWDEP(EDPACT) NOT = SPACES
              AND AREACD OF EEWDEP(EDPACT) NOT = AREACD OF MEMMDT
                 MOVE AREACD OF EEWDEP(EDPACT)
                                       TO AREACD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF TRMDAT OF EEWDEP(EDPACT) NOT = ZEROES
              AND TRMDAT OF EEWDEP(EDPACT) NOT = TRMDAT OF MEMMDT
                 MOVE TRMDAT OF EEWDEP(EDPACT)
                                       TO TRMDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              ELSE
                 IF DEMMAS-CHANGE
                    MOVE TRMDAT OF MEMMDT
                                       TO TRMDAT OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF (CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S' OR 'N')
              AND CPAIND OF EEWDEP(EDPACT) NOT = CPAIND OF MEMMDT
                 MOVE CPAIND OF EEWDEP(EDPACT)
                                       TO CPAIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF CPDMAS-REC
                 MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF CPDMAS-REC
                 MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF CPDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                 MOVE 1                TO LINENO OF CPDMAS-REC
                 IF CPAIND OF EEWDEP(EDPACT) = 'M'
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                    PERFORM A960-WRITE-CPDMAS   THRU A969-EXIT
                 END-IF
                 IF CPAIND OF EEWDEP(EDPACT) = 'S'
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                    PERFORM A960-WRITE-CPDMAS   THRU A969-EXIT
                 END-IF
              END-IF
              IF CPAIND OF EEWDEP(EDPACT) = 'N'
              AND CPAIND OF EEWDEP(EDPACT) = CPAIND OF MEMMDT
                 MOVE SPACE            TO CPAIND OF MDTTAB(LIN-0001)
              END-IF
              IF (CPAIND OF EEWDEP(EDPACT) = 'M' OR 'S')
              AND CPAIND OF EEWDEP(EDPACT) = CPAIND OF MEMMDT
                 PERFORM A970-CPAMAS-CHG THRU A979-EXIT
                 IF CPACHG-FLAG = 'Y'
                    MOVE CPAIND OF EEWDEP(EDPACT)
                                       TO CPAIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF CPDMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF CPDMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF CPDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF CPDMAS-REC
                    MOVE 1                TO LINENO OF CPDMAS-REC
                    IF CPAIND OF EEWDEP(EDPACT) = 'M'
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A960-WRITE-CPDMAS THRU A969-EXIT
                    END-IF
                    IF CPAIND OF EEWDEP(EDPACT) = 'S'
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO CPNUMB OF CPDMAS-REC
                       PERFORM A960-WRITE-CPDMAS THRU A969-EXIT
                    END-IF
                 END-IF
              END-IF
              IF WRKLOC OF EEWDEP(EDPACT) NOT = SPACES
              AND WRKLOC OF EEWDEP(EDPACT) NOT = WRKLOC OF MEMMDT
                 MOVE WRKLOC OF EEWDEP(EDPACT)
                                       TO WRKLOC OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF SSNXRF OF EEWDEP(EDPACT) NOT = ZEROS
              AND SSNXRF OF EEWDEP(EDPACT) NOT = SSNXRF OF MEMMDT
                 MOVE SSNXRF OF EEWDEP(EDPACT)
                                       TO SSNXRF OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HICNNO OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE HICNNO OF EEWDEP(EDPACT)
                                       TO HICNNO OF MDTTAB(LIN-0001)
                 IF HICNNO OF EEWDEP(EDPACT) NOT = HICNNO OF MEMMDT
                    MOVE 'Y'                     TO DEMCHG-FLAG
                 END-IF
              END-IF
      *
              IF PEBTFS OF EEWDEP(EDPACT) NOT = SPACES
              AND PEBTFS OF EEWDEP(EDPACT) NOT = PEBTFS OF MEMMDT
                 MOVE PEBTFS OF EEWDEP(EDPACT)
                                       TO PEBTFS OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  FAXNUM OF EEWDEP(EDPACT) NOT = SPACES
              AND FAXNUM OF EEWDEP(EDPACT) NOT = FAXNUM OF MEMMDT
                 MOVE FAXNUM OF EEWDEP(EDPACT)
                                       TO FAXNUM OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  OTHPHN OF EEWDEP(EDPACT) NOT = SPACES
              AND OTHPHN OF EEWDEP(EDPACT) NOT = OTHPHN OF MEMMDT
                 MOVE OTHPHN OF EEWDEP(EDPACT)
                                       TO OTHPHN OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF EMLIND OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE EMLIND OF EEWDEP(EDPACT)
                                       TO EMLIND OF MDTTAB(LIN-0001)
                 IF EMLIND OF EEWDEP(EDPACT) = 'Y'
                    MOVE ELMAIL OF EEWDEP(EDPACT)
                                       TO ELMAIL OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF  STUSTA OF EEWDEP(EDPACT) NOT = SPACES
              AND STUSTA OF EEWDEP(EDPACT) NOT = STUSTA OF MEMMDT
                 MOVE STUSTA OF EEWDEP(EDPACT)
                                       TO STUSTA OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF HNDIND OF EEWDEP(EDPACT) NOT = SPACES
              AND MEMSTA OF EEWDEP(EDPACT) NOT = MEMSTA OF MEMMDT
                 IF HNDIND OF EEWDEP(EDPACT) = 'Y'
                 AND MEMSTA OF MEMMDT NOT = 'H'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE HNDIND OF EEWDEP(EDPACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
                 END-IF
                 IF HNDIND OF EEWDEP(EDPACT) = 'N'
                 AND MEMSTA OF MEMMDT = 'H'
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE HNDIND OF EEWDEP(EDPACT)
                                       TO HNDIND OF MDTTAB(LIN-0001)
                 END-IF
              END-IF
      *
              IF  EDUBEG OF EEWDEP(EDPACT) NOT = SPACES
              AND EDUBEG OF EEWDEP(EDPACT) NOT = EDUBEG OF MEMMDT
                 MOVE EDUBEG OF EEWDEP(EDPACT)
                                       TO EDUBEG OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  EDUEND OF EEWDEP(EDPACT) NOT = SPACES
              AND EDUEND OF EEWDEP(EDPACT) NOT = EDUEND OF MEMMDT
                 MOVE EDUEND OF EEWDEP(EDPACT)
                                       TO EDUEND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  CQLECD OF EEWDEP(EDPACT) NOT = SPACES
              AND CQLECD OF EEWDEP(EDPACT) NOT = CQLECD OF MEMMDT
                 MOVE CQLECD OF EEWDEP(EDPACT)
                                       TO CQLECD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  COBRAQ OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAQ OF EEWDEP(EDPACT) NOT = COBRAQ OF MEMMDT
                 MOVE COBRAQ OF EEWDEP(EDPACT)
                                       TO COBRAQ OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  COBRAB OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAB OF EEWDEP(EDPACT) NOT = COBRAB OF MEMMDT
                 MOVE COBRAB OF EEWDEP(EDPACT)
                                       TO COBRAB OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  COBRAE OF EEWDEP(EDPACT) NOT = SPACES
              AND COBRAE OF EEWDEP(EDPACT) NOT = COBRAE OF MEMMDT
                 MOVE COBRAE OF EEWDEP(EDPACT)
                                       TO COBRAE OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  EMSTCD OF EEWDEP(EDPACT) NOT = SPACES
              AND EMSTCD OF EEWDEP(EDPACT) NOT = EMSTCD OF MEMMDT
                 MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  DETDAT OF EEWDEP(EDPACT) NOT = SPACES
              AND DETDAT OF EEWDEP(EDPACT) NOT = DETDAT OF MEMMDT
                 MOVE DETDAT OF EEWDEP(EDPACT)
                                       TO DETDAT OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  EXTIND OF EEWDP2(EDPACT) NOT = SPACES
                 MOVE EXTIND OF EEWDP2(EDPACT)
                                       TO EXTIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  RSPIND OF EEWDP2(EDPACT) NOT = SPACES
                 MOVE RSPIND OF EEWDP2(EDPACT)
                                       TO RSPIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  ALTIND OF EEWDP2(EDPACT) NOT = SPACES
                 MOVE ALTIND OF EEWDP2(EDPACT)
                                       TO ALTIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              AND MMDIND OF EEWDEP(EDPACT) NOT = MMDIND OF MEMMDT
                 MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MMDMAS-REC
                 MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MMDMAS-REC
                 MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MMDMAS-REC
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                 MOVE 1                TO LINENO OF MMDMAS-REC
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MMDMAS-REC
                 PERFORM A1020-WRITE-MMDMAS      THRU A1029-EXIT
              END-IF
      *
              IF MMDIND OF EEWDEP(EDPACT) = 'N'
              AND MMDIND OF EEWDEP(EDPACT) = MMDIND OF MEMMDT
                 MOVE SPACE            TO MMDIND OF MDTTAB(LIN-0001)
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'Y'
              AND MMDIND OF EEWDEP(EDPACT) = MMDIND OF MEMMDT
                 PERFORM A1030-MCDMAS-CHG THRU A1039-EXIT
                 IF MCDCHG-FLAG = 'Y'
                    MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MMDMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MMDMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MMDMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF MMDMAS-REC
                    MOVE 1             TO LINENO OF MMDMAS-REC
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MMDMAS-REC
                    PERFORM A1020-WRITE-MMDMAS THRU A1029-EXIT
                 END-IF
              END-IF
              IF MMCIND OF EEWDEP(EDPACT) = 'N'
              AND MMCIND OF EEWDEP(EDPACT) = MMCIND OF MEMMDT
                 MOVE SPACE            TO MMCIND OF MDTTAB(LIN-0001)
              END-IF
              IF MMCIND OF EEWDEP(EDPACT) = 'Y'
              AND MMCIND OF EEWDEP(EDPACT) = MMCIND OF MEMMDT
                 PERFORM A1130-MCMMAS-CHG THRU A1139-EXIT
                 IF MCRCHG-FLAG = 'Y'
                    MOVE MMCIND OF EEWDEP(EDPACT)
                                       TO MMCIND OF MDTTAB(LIN-0001)
                    MOVE 'Y'                     TO DEMCHG-FLAG
                    MOVE BRANCD OF MBHKEY
                             TO BRANCD OF DOCNUM OF MDMMAS-REC
                    MOVE BATDAT OF MBHKEY
                             TO BATDAT OF DOCNUM OF MDMMAS-REC
                    MOVE BATSEQ OF MBHKEY
                             TO BATSEQ OF DOCNUM OF MDMMAS-REC
                    MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDMMAS-REC
                    MOVE 1             TO LINENO OF MDMMAS-REC
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDMMAS-REC
                    PERFORM A1120-WRITE-MDMMAS THRU A1129-EXIT
                 END-IF
              END-IF
              IF MMDIND OF EEWDEP(EDPACT) = 'N'
              AND MMDIND OF EEWDEP(EDPACT) NOT = MMDIND OF MEMMDT
                 MOVE MMDIND OF EEWDEP(EDPACT)
                                       TO MMDIND OF MDTTAB(LIN-0001)
                 MOVE 'Y'                        TO DEMCHG-FLAG
              END-IF
      *
              IF  RSPIND OF EEWDP2(EDPACT) = 'N'
              AND RSPIND OF EEWDP2(EDPACT) = RSPIND OF MEMMDT
                 MOVE SPACE            TO RSPIND OF MDTTAB(LIN-0001)
              END-IF
      *
              IF  ALTIND OF EEWDP2(EDPACT) = 'N'
              AND ALTIND OF EEWDP2(EDPACT) = ALTIND OF MEMMDT
                 MOVE SPACE            TO ALTIND OF MDTTAB(LIN-0001)
              END-IF
      *
              END-IF
      *
              IF  MEMADD-MDT-EXISTS
              AND EMPSTA OF EEWDEP(EDPACT) NOT = EMPSTA OF MEMMDT
                 MOVE 'Y'                        TO DEMCHG-FLAG
                 MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              END-IF
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
              IF DEMMAS-CHANGE
                 MOVE 001              TO LINENO OF MDTTAB(LIN-0001)
                 MOVE 'C'              TO CHGTYP OF MDTTAB(LIN-0001)
                 MOVE '3'              TO RECTYP OF MDTTAB(LIN-0001)
                 MOVE SEQNUM OF WS-WORK TO SEQNUM OF MDTTAB(LIN-0001)
                 MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
                 MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
                 MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
                 MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
                 MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
                 MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                 MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                 MOVE TITLCD OF EEWDEP(EDPACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
                 MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
                 MOVE '1'              TO STATCD OF MDTTAB(LIN-0001)
                 MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
                 MOVE EECOVR OF EEWDEP(EDPACT)
                                       TO EECOVR OF MDTTAB(LIN-0001)
                 MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
                 MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0001)
                 MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0001)
                 MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0001)
           MOVE MHCIND OF EEWDEP(EDPACT)
                                       TO MHCIND OF MDTTAB(LIN-0001)
           IF INDUPD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE INDUPD OF EEWDEP(EDPACT)
                                       TO INDUPD OF MDTTAB(LIN-0001)
           ELSE
              MOVE 'N'                 TO INDUPD OF MDTTAB(LIN-0001)
           END-IF
           MOVE OMEDAT OF EEWDEP(EDPACT)
                                       TO OMEDAT OF MDTTAB(LIN-0001)
           MOVE CRDMTH OF EEWDEP(EDPACT)
                                       TO CRDMTH OF MDTTAB(LIN-0001)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
              MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
              MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
              MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
              MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
              MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
              MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
              MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
              MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
              MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
              MOVE SPACE               TO TIRFLG OF MDTTAB(LIN-0001)
              MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
              MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
              MOVE MARSTA OF EEWDEP(EDPACT)
                                       TO MARSTA OF MDTTAB(LIN-0001)
      ****       IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
                 IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                            OR 'MI' OR 'MS'
      ****          IF EXCHNG OF MEMMAS-REC = 'MI'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                       MOVE 'EI'       TO EXCHNG OF MDTTAB(LIN-0001)
      ****          ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                    ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                            MOVE 'ES'  TO EXCHNG OF MDTTAB(LIN-0001)
                         ELSE
      ****                  MOVE EXCHNG OF MEMMAS-REC
                            MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0001)
                         END-IF
                    END-IF
                    MOVE 'Y'           TO EXCIND OF MDTTAB(LIN-0001)
                    MOVE 'R'           TO ENRSTA OF MDTTAB(LIN-0001)
                 END-IF
                 IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                    MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0001)
                 ELSE
                    MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001)
                 END-IF
              END-IF.
      *
       B682-STEP-4.
           IF PRCDEM OF EEWHDR-WRK = 'N'
           OR DEMCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-5.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF HOLDCD OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO HLDCOD-MEM
                 MOVE HOLDCD OF EEWDEP(EDPACT)   TO HLDCOD-HLD
                 PERFORM B750-HLDCOD-CHK         THRU B759-EXIT
                 IF HLDCOD-FOUND
                    GO TO B682-STEP-5
                 ELSE
                    MOVE 1             TO LINENO OF MDTTAB(LIN-0001)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0001)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0001)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0001)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0001)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0001)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0001)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0001)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0001)
                    MOVE RELCOD OF EEWDEP(EDPACT)
                                       TO RELCOD OF MDTTAB(LIN-0001)
                    MOVE RELTYP OF EEWDEP(EDPACT)
                                       TO RELTYP OF MDTTAB(LIN-0001)
                    MOVE TITLCD OF EEWDEP(EDPACT)
                                       TO TITLCD OF MDTTAB(LIN-0001)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0001)
                    MOVE HOLDCD OF EEWDEP(EDPACT)
                                       TO HOLDCD OF MDTTAB(LIN-0001)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0001)
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0001)
                    MOVE EECOVR OF EEWDEP(EDPACT)
                                       TO EECOVR OF MDTTAB(LIN-0001)
                    MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0001)
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0001)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0001)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0001)
                    MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0001)
                    MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0001)
                    MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0001)
                    MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0001)
                    MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0001)
                    MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0001)
                    MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0001)
                    MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0001)
                    MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0001)
                    MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0001)
                    MOVE SPACE         TO TIRFLG OF MDTTAB(LIN-0001)
                    MOVE EMPSTA OF EEWDEP(EDPACT)
                                       TO EMPSTA OF MDTTAB(LIN-0001)
                    MOVE EMSTCD OF EEWDEP(EDPACT)
                                       TO EMSTCD OF MDTTAB(LIN-0001)
                    MOVE MARSTA OF EEWDEP(EDPACT)
                                       TO MARSTA OF MDTTAB(LIN-0001)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****              IF EXCHNG OF MEMMAS-REC = 'MI'
                        IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                           MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0001)
      ****              ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                        ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                                MOVE 'ES'
                                        TO EXCHNG OF MDTTAB(LIN-0001)
                             ELSE
                                MOVE EXCHNG OF MEMMAS-REC
                                        TO EXCHNG OF MDTTAB(LIN-0001)
                             END-IF
                        END-IF
                        MOVE 'Y'       TO EXCIND OF MDTTAB(LIN-0001)
                        MOVE 'R'       TO ENRSTA OF MDTTAB(LIN-0001)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0001)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0001).
       B682-STEP-5.
           IF PRCPCP OF EEWHDR-WRK = 'N'
           OR PCPCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-6.
      *
           IF NOT MEMADD-MDT-EXISTS              GO TO B682-STEP-12.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
                 PERFORM B810-DEPPCP             THRU B819-EXIT
                 IF (PCPTMP = ZERO
                 AND BYPEDT OF EDIENR-REC = 'N')
                                                 GO TO B682-STEP-6
                 END-IF
                 IF PCPCOD OF EEWDEP(EDPACT) NOT = PROVNO OF MEMMDT
                 OR  PCPORG OF EEWDEP(EDPACT) NOT = PRVORG OF MEMMDT
                 OR  PCPMCP OF EEWDEP(EDPACT) NOT = PCPMCP OF MEMMDT
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    IF PCPREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE PCPREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE PCPEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE PCPEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE PCPCOD OF EEWDEP(EDPACT) TO
                                          PROVNO OF MDTTAB(LIN-0004)
                    END-IF
                       MOVE PCPORG OF EEWDEP(EDPACT) TO
                                          PRVORG OF MDTTAB(LIN-0004)
                       MOVE PCPMCP OF EEWDEP(EDPACT) TO
                                          PCPMCP OF MDTTAB(LIN-0004)
                    IF PCPOVR OF EEWDEP(EDPACT) = SPACES
                       MOVE 'N'        TO PCPOVR OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPOVR OF EEWDEP(EDPACT) TO
                                          PCPOVR OF MDTTAB(LIN-0004)
                    END-IF
                    IF PCPTRM OF EEWDEP(EDPACT) = SPACES
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PCPTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       MOVE 'Y'        TO PCPTRM-FLAG
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
                    MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
                    MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
                    MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
                    MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
                    MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
                    MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
                    MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
                    MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
                    MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
                    MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    MOVE SPACE         TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
                    MOVE PKGOVR OF EEWDEP(EDPACT)
                                       TO PKGOVR OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****              IF EXCHNG OF MEMMAS-REC = 'MI'
                        IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                           MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****              ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                        ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                                MOVE 'ES'
                                        TO EXCHNG OF MDTTAB(LIN-0004)
                             ELSE
      ****                      MOVE EXCHNG OF MEMMAS-REC
                                MOVE EXCHNG OF EEWDP2(EDPACT)
                                        TO EXCHNG OF MDTTAB(LIN-0004)
                             END-IF
                        END-IF
                        MOVE 'Y'       TO EXCIND OF MDTTAB(LIN-0004)
                        MOVE 'R'       TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
       B682-STEP-6.
           IF PRCSEC OF EEWHDR-WRK = 'N'
           OR SECCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-7.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO B682-STEP-7.
      *
           IF SECCOD OF EEWDEP(EDPACT) NOT = SPACES
              PERFORM B820-DEPSEC                THRU B829-EXIT
           ELSE
              GO TO B682-STEP-7.
      *
           IF SECTMP = ZEROES
              GO TO B682-ADDSEC.
      *
           IF SECCOD OF EEWDEP(EDPACT) NOT = SECPRV OF MEMMDT
           OR (SECORG OF EEWDEP(EDPACT) NOT = SECORG OF MEMMDT
           AND SECORG OF EEWDEP(EDPACT) NOT = SPACES)
           OR SECMCP OF EEWDEP(EDPACT) NOT = SECMCP OF MEMMDT
                                                 GO TO B682-ADDSEC.
      *
           GO TO B682-STEP-7.
      *
       B682-ADDSEC.
           MOVE 5             TO LINENO OF MDTTAB(LIN-0005)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0005)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0005)
           MOVE '1'           TO STATCD OF MDTTAB(LIN-0005)
           MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0005)
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0005)
           MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0005)
           MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0005)
           MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0005)
           MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0005)
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0005)
           IF SECREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0005)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0005)
           MOVE SECEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0005)
           MOVE SECEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0005)
           IF SECCOD OF EEWDEP(EDPACT) NOT = SPACES
              MOVE SECCOD OF EEWDEP(EDPACT) TO
                                          SECPRV OF MDTTAB(LIN-0005)
           END-IF
              MOVE SECORG OF EEWDEP(EDPACT) TO
                                          SECORG OF MDTTAB(LIN-0005)
              MOVE SECMCP OF EEWDEP(EDPACT) TO
                                          SECMCP OF MDTTAB(LIN-0005)
           IF SECOVR OF EEWDEP(EDPACT) = SPACES
              MOVE 'N'        TO SECOVR OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECOVR OF EEWDEP(EDPACT) TO
                                          SECOVR OF MDTTAB(LIN-0005)
           END-IF
           IF SECTRM OF EEWDEP(EDPACT) = SPACES
              MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           ELSE
              MOVE SECTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0005)
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0005)
           END-IF
           MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0005)
           MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0005)
           MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0005)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0005)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0005)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0005)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0005)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0005)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0005)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0005)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0005)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0005)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0005)
           MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0005 1)
           MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0005)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0005)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0005)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0005)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0005)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0005)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0005)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0005)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0005).
       B682-STEP-7.
           IF PRCMCS OF EEWHDR-WRK = 'N'
           OR MEDCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-8.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO B682-STEP-8.
      *
           IF (MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEDSTS OF EEWDEP(EDPACT) NOT = SPACES)
              PERFORM B830-DEPMED                THRU B839-EXIT
           ELSE
              GO TO B682-STEP-8.
      *
           IF MEDTMP = ZEROES
              GO TO B682-ADDMED.
      *
           IF  MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEDSTS OF EEWDEP(EDPACT) NOT = SPACES
              IF MEDCTY OF EEWDEP(EDPACT) NOT = MEDCTY OF MEMMDT
              OR (MEDSTS OF EEWDEP(EDPACT) NOT = MEDSTS OF MEMMDT)
                 GO TO B682-ADDMED.
      *
           GO TO B682-STEP-8.
      *
       B682-ADDMED.
           MOVE 6                   TO LINENO OF MDTTAB(LIN-0006)
           MOVE 'C'                 TO CHGTYP OF MDTTAB(LIN-0006)
           MOVE '3'                 TO RECTYP OF MDTTAB(LIN-0006)
           MOVE SEQNUM OF WS-WORK   TO SEQNUM OF MDTTAB(LIN-0006)
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0006)
           MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0006)
           MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0006)
           MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0006)
           MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0006)
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0006)
           IF MEDREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE MEDREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0006)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0006)
           MOVE MEDEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0006)
           MOVE MEDEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0006)
           MOVE MEDCTY OF EEWDEP(EDPACT) TO
                                       MEDCTY OF MDTTAB(LIN-0006)
           MOVE MEDSTS OF EEWDEP(EDPACT) TO
                                       MEDSTS OF MDTTAB(LIN-0006)
           IF MEDTRM OF EEWDEP(EDPACT) = SPACES
              MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           ELSE
              MOVE MEDTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0006)
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0006)
           END-IF
           MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0006)
           MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0006)
           MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0006)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0006)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0006)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0006)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0006)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0006)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0006)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0006)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0006)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0006)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0006)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0006)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0006)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0006)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0006)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0006)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0006)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'           TO PRTCOD OF MDTTAB(LIN-0006)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0006).
       B682-STEP-8.
           IF PRCFEE OF EEWHDR-WRK = 'N'
           OR FEECHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-9.
      *
           IF CHGTYP OF EEWDEP(EDPACT) NOT = 'C'
              GO TO B682-STEP-9.
      *
           IF FEECOD OF EEWDEP(EDPACT) NOT = SPACES
              PERFORM B840-DEPFEE                THRU B849-EXIT
           ELSE
              GO TO B682-STEP-9.
      *
           IF FEETMP = ZEROES
              GO TO B682-ADDFEE.
      *
           IF FEECOD OF EEWDEP(EDPACT) NOT = FEECOD OF MEMMDT
              GO TO B682-ADDFEE.
      *
           GO TO B682-STEP-9.
      *
       B682-ADDFEE.
           MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
           MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
           MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
           MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
           MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
           MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
           MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
           MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
           IF FEEREA OF EEWDEP(EDPACT) NOT = SPACES
              MOVE FEEREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
           ELSE
              MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
           END-IF
           MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
           MOVE FEEEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
           MOVE FEEEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
           MOVE FEECOD OF EEWDEP(EDPACT)
                                       TO FEECOD OF MDTTAB(LIN-0004)
           IF FEETRM OF EEWDEP(EDPACT) NOT = SPACES
              MOVE FEETRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              MOVE 'Y'                 TO FEETRM-FLAG
           ELSE
              IF PCPTRM-NOT-USED
                MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
              END-IF
           END-IF
           IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
              MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
           END-IF
           MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
           MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
           MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE SPACE                  TO TIRFLG OF MDTTAB(LIN-0004)
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0004)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0004)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0004)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0004)
           END-IF
           IF PRTCOD OF EEWDEP(EDPACT) = SPACES
              MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
           ELSE
              MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B682-STEP-9.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-11.
      *
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF (USRFL1 OF EEWDEP(EDPACT) NOT = SPACES
              OR  USRFL2 OF EEWDEP(EDPACT) NOT = SPACES
              OR  USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
                 PERFORM B850-DEPENB                 THRU B859-EXIT
                 IF ENBTMP = ZERO                    GO TO B682-STEP-12
                 END-IF
                 IF (USRFL1 OF EEWDEP(EDPACT) NOT = USRFL1 OF MEMMDT
                 OR USRFL2 OF EEWDEP(EDPACT) NOT = USRFL2 OF MEMMDT
                 OR USRFL3 OF EEWDEP(EDPACT) NOT = USRFL3 OF MEMMDT)
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE TIRFLG OF EEWDEP(EDPACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B682-STEP-11.
           IF PRCENB OF EEWHDR-WRK = 'N'
           OR PRCBPK OF EEWHDR-WRK = 'N'
           OR ENBCHG OF EEWDEP(EDPACT) = 'N'
              GO TO B682-STEP-12.

      ****--------------------------------------------------------****
      ****  PMHS-374  KCT  Fix                                    ****
      ****  Also capture tier code to prevent error in ME102A.    ****
      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
           IF CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF BENPKG OF EEWDEP(EDPACT) NOT = SPACES
                 PERFORM B850-DEPENB                 THRU B859-EXIT
                 IF ENBTMP = ZERO                    GO TO B682-STEP-12
                 END-IF
                 IF BENPKG OF EEWDEP(EDPACT) NOT = BENPKG OF MEMMDT
                    MOVE 4             TO LINENO OF MDTTAB(LIN-0004)
                    MOVE 'C'           TO CHGTYP OF MDTTAB(LIN-0004)
                    MOVE '3'           TO RECTYP OF MDTTAB(LIN-0004)
                    MOVE '1'           TO STATCD OF MDTTAB(LIN-0004)
                    MOVE SEQNUM OF WS-WORK TO
                                          SEQNUM OF MDTTAB(LIN-0004)
                    MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0004)
                    MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0004)
                    MOVE LSTNAM OF EEWDEP(EDPACT)
                                       TO LSTNAM OF MDTTAB(LIN-0004)
                    MOVE MIDNAM OF EEWDEP(EDPACT)
                                       TO MIDNAM OF MDTTAB(LIN-0004)
                    MOVE FSTNAM OF EEWDEP(EDPACT)
                                       TO FSTNAM OF MDTTAB(LIN-0004)
                    MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0004)
                    MOVE BENPKG OF EEWDEP(EDPACT)
                                       TO BENPKG OF MDTTAB(LIN-0004)
                    IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE MEMREA OF EEWDEP(EDPACT)
                                       TO REASCD OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE FORNAM OF EEWDEP(EDPACT)
                                       TO FORNAM OF MDTTAB(LIN-0004)
                    MOVE ENBEFF OF EEWDEP(EDPACT)
                                       TO EFFDAT OF MDTTAB(LIN-0004)
                    MOVE ENBEXP OF EEWDEP(EDPACT)
                                       TO EXPDAT OF MDTTAB(LIN-0004)
                    IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
                       MOVE ENBTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                    ELSE
                       IF PCPTRM-NOT-USED AND FEETRM-NOT-USED
                       MOVE MEMTRM OF EEWDEP(EDPACT)
                                       TO TERMCD OF MDTTAB(LIN-0004)
                       END-IF
                    END-IF
                    IF CRDCNT OF EEWDEP(EDPACT) NOT = SPACE
                       MOVE CRDCNT OF EEWDEP(EDPACT)
                                       TO CRDCNT OF MDTTAB(LIN-0004)
                    END-IF
                    MOVE USRFL2 OF EEWDEP(EDPACT)
                                       TO USRFL2 OF MDTTAB(LIN-0004)
                    MOVE USRFL3 OF EEWDEP(EDPACT)
                                       TO USRFL3 OF MDTTAB(LIN-0004)
                    MOVE USRFL1 OF EEWDEP(EDPACT)
                                       TO USRFL1 OF MDTTAB(LIN-0004)
           MOVE DALOVR OF EEWDEP(EDPACT)
                                       TO DALOVR OF MDTTAB(LIN-0004)
           MOVE CGAOVR OF EEWDEP(EDPACT)
                                       TO CGAOVR OF MDTTAB(LIN-0004)
           MOVE CGTOVR OF EEWDEP(EDPACT)
                                       TO CGTOVR OF MDTTAB(LIN-0004)
           MOVE SALOVR OF EEWDEP(EDPACT)
                                       TO SALOVR OF MDTTAB(LIN-0004)
           MOVE CBXOVR OF EEWDEP(EDPACT)
                                       TO CBXOVR OF MDTTAB(LIN-0004)
           MOVE CBEOVR OF EEWDEP(EDPACT)
                                       TO CBEOVR OF MDTTAB(LIN-0004)
           MOVE APCOVR OF EEWDEP(EDPACT)
                                       TO APCOVR OF MDTTAB(LIN-0004)
           MOVE SSSOVR OF EEWDEP(EDPACT)
                                       TO SSSOVR OF MDTTAB(LIN-0004)
           MOVE VRCOVR OF EEWDEP(EDPACT)
                                       TO VRCOVR OF MDTTAB(LIN-0004)
           MOVE RMTOVR OF EEWDEP(EDPACT)
                                       TO RMTOVR OF MDTTAB(LIN-0004)
           MOVE TIRFLG OF EEWDEP(EDPACT)
                                       TO TIRFLG OF MDTTAB(LIN-0004)
                    MOVE TIERCD OF EEWDEP(EDPACT)
                                       TO TIERCD OF MDTTAB(LIN-0004 1)
                    MOVE ACCTN2 OF EEWDEP(EDPACT)
                                       TO ACCTN2 OF MDTTAB(LIN-0004)
                    MOVE BILMOD OF EEWDEP(EDPACT)
                                       TO BILMOD OF MDTTAB(LIN-0004)
                    MOVE BEGMTH OF EEWDEP(EDPACT)
                                       TO BEGMTH OF MDTTAB(LIN-0004)
                    MOVE IMDBIL OF EEWDEP(EDPACT)
                                       TO IMDBIL OF MDTTAB(LIN-0004)
                    MOVE INTBIL OF EEWDEP(EDPACT)
                                       TO INTBIL OF MDTTAB(LIN-0004)
                    MOVE BILCYC OF EEWDEP(EDPACT)
                                       TO BILCYC OF MDTTAB(LIN-0004)
      ****          IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI'
      ****                                     OR 'ES'
                    IF EXCHNG OF EEWDP2(EDPACT) = 'EI' OR 'ES'
                                               OR 'MI' OR 'MS'
      ****             IF EXCHNG OF MEMMAS-REC = 'MI'
                       IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                          MOVE 'EI'    TO EXCHNG OF MDTTAB(LIN-0004)
      ****             ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
                       ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                               MOVE 'ES'
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            ELSE
      ****                     MOVE EXCHNG OF MEMMAS-REC
                               MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0004)
                            END-IF
                       END-IF
                       MOVE 'Y'        TO EXCIND OF MDTTAB(LIN-0004)
                       MOVE 'R'        TO ENRSTA OF MDTTAB(LIN-0004)
                    END-IF
                    IF PRTCOD OF EEWDEP(EDPACT) = SPACES
                       MOVE 'D'        TO PRTCOD OF MDTTAB(LIN-0004)
                    ELSE
                       MOVE PRTCOD OF EEWDEP(EDPACT)
                                       TO PRTCOD OF MDTTAB(LIN-0004).
      *
       B682-STEP-12.
           IF EXTMEM OF EEWDEP(EDPACT) = SPACES
           AND EXTGRP OF EEWDEP(EDPACT) = SPACES
           AND EXTSUB OF EEWDEP(EDPACT) = SPACES
                                                 GO TO B682-STEP-13.
      *
           MOVE 7                      TO LINENO OF MDTTAB(LIN-0007).
           MOVE '3'                    TO RECTYP OF MDTTAB(LIN-0007).
           MOVE 'C'                    TO CHGTYP OF MDTTAB(LIN-0007).
           MOVE SUBSNO OF EEWDEP(EDPACT)
                                       TO SUBSNO OF MDTTAB(LIN-0007).
           MOVE MEMBNO OF EEWDEP(EDPACT)
                                       TO MEMBNO OF MDTTAB(LIN-0007).
           MOVE MEMEFF OF EEWDEP(EDPACT) TO EFFDAT OF MDTTAB(LIN-0007).
           MOVE MEMEXP OF EEWDEP(EDPACT) TO EXPDAT OF MDTTAB(LIN-0007).
           MOVE GRPNUM OF EEWDEP(EDPACT)
                                       TO GRPNUM OF MDTTAB(LIN-0007).
           MOVE EXTMEM OF EEWDEP(EDPACT)
                                       TO EXTMEM OF MDTTAB(LIN-0007).
           MOVE EXTGRP OF EEWDEP(EDPACT)
                                       TO EXTGRP OF MDTTAB(LIN-0007).
           MOVE EXTCON OF EEWDEP(EDPACT)
                                       TO EXTCON OF MDTTAB(LIN-0007).
           MOVE EXTEFF OF EEWDEP(EDPACT)
                                       TO EXTEFF OF MDTTAB(LIN-0007).
           MOVE EXTEXP OF EEWDEP(EDPACT)
                                       TO EXTEXP OF MDTTAB(LIN-0007).
           MOVE EXTSUB OF EEWDEP(EDPACT)
                                       TO EXTSUB OF MDTTAB(LIN-0007).
           MOVE HISSEQ OF EEWDEP(EDPACT)
                                       TO HISSEQ OF MDTTAB(LIN-0007).
           MOVE CTLPLN OF EEWDEP(EDPACT)
                                       TO CTLPLN OF MDTTAB(LIN-0007).
           MOVE EXTREL OF EEWDEP(EDPACT)
                                       TO EXTREL OF MDTTAB(LIN-0007).
           MOVE PRVPLN OF EEWDEP(EDPACT)
                                       TO PRVPLN OF MDTTAB(LIN-0007).
           MOVE PRVNET OF EEWDEP(EDPACT)
                                       TO PRVNET OF MDTTAB(LIN-0007).
           MOVE PROCOD OF EEWDEP(EDPACT)
                                       TO PROCOD OF MDTTAB(LIN-0007).

      ****--------------------------------------------------------****
      ****  PMHS-362  KCT  Fix                                    ****
      ****  Check Exchange information in table instead of file.  ****
      ****--------------------------------------------------------****
      **** IF EXCHNG OF MEMMAS-REC = 'MI' OR 'MS' OR 'EI' OR 'ES'
           IF EXCHNG OF EEWDP2(EDPACT) = 'MI' OR 'MS' OR 'EI' OR 'ES'
      ****    IF EXCHNG OF MEMMAS-REC = 'MI'
              IF EXCHNG OF EEWDP2(EDPACT) = 'MI'
                 MOVE 'EI'             TO EXCHNG OF MDTTAB(LIN-0007)
      ****    ELSE IF EXCHNG OF MEMMAS-REC = 'MS'
              ELSE IF EXCHNG OF EEWDP2(EDPACT) = 'MS'
                      MOVE 'ES'        TO EXCHNG OF MDTTAB(LIN-0007)
                   ELSE
      ****            MOVE EXCHNG OF MEMMAS-REC
                      MOVE EXCHNG OF EEWDP2(EDPACT)
                                       TO EXCHNG OF MDTTAB(LIN-0007)
                   END-IF
              END-IF
              MOVE 'Y'                 TO EXCIND OF MDTTAB(LIN-0007)
              MOVE 'R'                 TO ENRSTA OF MDTTAB(LIN-0007)
           END-IF.
      *
       B682-STEP-13.
              IF ENBTRM OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE ENBTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0002).
              IF PCPTRM OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE PCPTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0004).
              IF SECTRM OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE SECTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0005).
              IF MEDTRM OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE MEDTRM OF EEWDEP(EDPACT)
                                         TO TERMCD OF MDTTAB(LIN-0006).
      *
              IF ENBREA OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE ENBREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0002).
              IF PCPREA OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE PCPREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0004).
              IF SECREA OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE SECREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0005).
              IF MEDREA OF EEWDEP(EDPACT) NOT = SPACES
                 MOVE MEDREA OF EEWDEP(EDPACT)
                                         TO REASCD OF MDTTAB(LIN-0006).
           MOVE DOCNUM OF EEWDEP(EDPACT) TO DOCNUM OF WS-WORK.
      *
           MOVE 'D'                              TO RECTYP-FLAG.
           MOVE 'N'                              TO MDT-FLAG.
           MOVE 'N'                              TO SEQ-FLAG.
           MOVE 'N'                              TO PRCSEQ-FLAG.
           MOVE 'Y'                              TO FIRST-LINE-FLAG.
           MOVE 'SUB'                            TO MEMEXT-TYP.
      *
           PERFORM A690-MDTMAS-WRITE             THRU A699-EXIT
           VARYING INDX FROM 1 BY 1              UNTIL INDX > MDTMAX.
      *
           IF MDT-ADDED
              ADD 1                    TO TOTBAT OF WS-WORK
              ADD 1                    TO NUMMDT OF WS-WORK
              ADD 1                    TO BATCHG OF WS-WORK.
       B689-EXIT.
           EXIT.
      *
       B700-RTVMBR.
      ***************************************************************
      *   CHECK FOR MEMBER IN CORE TO RECEIVE SUBSCRIBER/MEMBER
      ***************************************************************
           IF WS-DT3-CANEFF > ZERO
              GO TO B709-EXIT.
      *
           MOVE SPACES                 TO EXCSUB OF PE4SBS-REC.
           MOVE ZEROES                 TO TRNSEQ OF PE4SBS-REC
                                          SEQNUM OF PE4SBS-REC.
      *
           IF WS-DT3-EXCSUB NOT = SPACES
              MOVE WS-DT3-EXCSUB                 TO WS-EXCSUB-HOLD
           ELSE
              MOVE WS-DT3-EXCMEM                 TO WS-EXCSUB-HOLD
           END-IF.
           MOVE 'N'                              TO WS-EXCSUB-FOUND.
           PERFORM B710-RTVMBR                   THRU B719-EXIT.
           IF EXCSUB-NOT-FOUND                   GO TO B705-CHECK.
      *
           MOVE TRNSEQ OF PE4SBS-REC   TO TRNSEQ OF PEMMAS-KEY
           MOVE SEQNUM OF PE4SBS-REC   TO SEQNUM OF PEMMAS-KEY
           PERFORM PEMMAS-READ                   IF INVALID-KEY
              GO TO B709-EXIT
           END-IF.
      *
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           IF GRPNUM OF GRPMAS-REC NOT = GRPNUM OF EEWSUB(ESBACT)
              MOVE SPACES                        TO GRPMAS-REC
              MOVE GRPNUM OF EEWSUB(ESBACT)
                                       TO GRPNUM OF GRPMAS-REC
              PERFORM GRPMAS-READ                IF INVALID-KEY
                 MOVE SPACES           TO GRPNUM OF GRPMAS-REC.
      *
           IF COMPNO OF GRPMAS-REC > SPACES
              IF RECTYP OF CMPANY-REC NOT = 'A'
              OR COMPNO OF CMPANY-REC NOT = COMPNO OF GRPMAS-REC
                 MOVE SPACES                     TO CMPANY-REC
                 MOVE 'A'              TO RECTYP OF CMPANY-REC
                 MOVE COMPNO OF GRPMAS-REC
                                       TO COMPNO OF CMPANY-REC
                 PERFORM CMPANY-READ             IF INVALID-KEY
                    MOVE SPACES                  TO CMPANY-REC.
      *
      **** IF  WS-DT3-GRPNUM = GRPNUM OF PEMMAS-REC
      **** AND STATCD OF PEMMAS-REC NOT = '9'
           IF (PREUPD OF CMPANY-REC NOT = 'Y'
           OR NOT LICENSE-FOR-125573)
           AND WS-DT3-GRPNUM = GRPNUM OF PEMMAS-REC
           AND STATCD OF PEMMAS-REC NOT = '9'
              MOVE 'Y'                           TO FAMILY-FLAG
              MOVE SPACES              TO MESSAGE-INTERFACE-PARAMETERS
              MOVE 'EI09146'                     TO MI-PRIMARY-ID
                                                    MSGNUM OF ERR-LINE
              MOVE WS-DT3-MEMBNO       TO MEMBNO OF ERR-LINE
              MOVE WS-DT3-SUBSNO       TO SUBSNO OF ERR-LINE
              MOVE WS-DT3-RELCOD       TO RELCOD OF ERR-LINE
              MOVE WS-DT3-GRPNUM       TO GRPNUM OF ERR-LINE
              MOVE WS-DT3-CHGTYP       TO CHGTYP OF ERR-LINE
              MOVE 'N'                           TO SW-MEMBER-ERROR
              PERFORM X100-PRINT-ERROR           THRU X109-EXIT
                 GO TO B709-EXIT.
      *
       B705-CHECK.
           INITIALIZE REXCMEMBT OF EXCSMSBI-REC
           MOVE WS-DT3-EXCSUB          TO EXCSUB OF EXCSMSBI-REC
           MOVE WS-DT3-EXCMEM          TO EXCMEM OF EXCSMSBI-REC
           MOVE WS-DT3-GRPNUM          TO GRPNUM OF EXCSMSBI-REC
           MOVE ZEROES                 TO TRNSEQ OF EXCSMSBI-REC
           MOVE ZEROES                 TO SEQNUM OF EXCSMSBI-REC
           PERFORM EXCSMSBI-STARTGE              IF INVALID-KEY
              GO TO B709-EXIT.
      *
       B706-LOOP.
           PERFORM EXCSMSBI-READNX               IF AT-END
              GO TO B709-EXIT.
      *
           IF RELCOD OF EXCSMSBI-REC NOT = WS-DT3-RELCOD
              GO TO B706-LOOP.
      *
           IF  EXCSUB OF EXCSMSBI-REC = WS-DT3-EXCSUB
           AND EXCMEM OF EXCSMSBI-REC = WS-DT3-EXCMEM
           AND GRPNUM OF EXCSMSBI-REC = WS-DT3-GRPNUM
              IF WS-DT3-RELCOD = '1'
                 MOVE SUBSNO OF EXCSMSBI-REC
                                       TO SUBSNO OF EEWSUB(ESBACT)
                 MOVE MEMBNO OF EXCSMSBI-REC
                                       TO MEMBNO OF EEWSUB(ESBACT)
              ELSE
                 MOVE SUBSNO OF EXCSMSBI-REC
                                       TO SUBSNO OF EEWDEP(EDPACT)
                 MOVE MEMBNO OF EXCSMSBI-REC
                                       TO MEMBNO OF EEWDEP(EDPACT).
      *
       B709-EXIT.
           EXIT.
      *
       B710-RTVMBR.
      ***************************************************************
      *   Cycle through PE4SBS file to find subscriber.             *
      ***************************************************************
           MOVE SPACES                 TO EXCSUB OF PE4SBS-REC.
           MOVE ZEROES                 TO TRNSEQ OF PE4SBS-REC
                                          SEQNUM OF PE4SBS-REC.
           MOVE WS-EXCSUB-HOLD         TO EXCSUB OF PE4SBS-REC.
           PERFORM PE4SBS-STARTGE            IF NOT INVALID-KEY
              PERFORM PE4SBS-READNX          IF NOT AT-END
                 IF WS-EXCSUB-HOLD = EXCSUB OF PE4SBS-REC
                    MOVE 'Y'                 TO WS-EXCSUB-FOUND
                 END-IF
              END-IF
           END-IF.
      *
       B719-EXIT.
           EXIT.
      *
       B750-HLDCOD-CHK.
      ***************************************************************
      * Check for a hold code already attached to the member.     *
      ***************************************************************
           MOVE 'N'                              TO HLDCOD-FLAG.
           IF HOLDCD OF SUBMDT = HLDCOD-HLD
              MOVE 'Y'                           TO HLDCOD-FLAG
           END-IF.
       B759-EXIT.
           EXIT.
      *
       B760-SUBPCP.
      ***************************************************************
      * Get the current subscriber PCP from MDTMAS record.          *
      ***************************************************************
           MOVE ZEROES TO                        PPSACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF NOT SUBADD-MDT-EXISTS              GO TO B769-EXIT.
      *
           ADD 1                                 TO PPSACT.
           IF PROVNO OF SUBMDT = SPACES          GO TO B769-EXIT.
      *
           IF (EFFDAT OF SUBMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF SUBMDT NOT = EXPDAT OF SUBMDT)
                 MOVE EFFDAT OF SUBMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF SUBMDT TO ENPEXP OF WS-WORK
                 MOVE PPSACT                     TO PPSTMP.
       B769-EXIT.
           EXIT.
      *
       B770-SUBSEC.
      ***************************************************************
      * Get current subscriber's secondary provider.                *
      ***************************************************************
      *
           MOVE ZEROES TO                        SPSACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF NOT SUBADD-MDT-EXISTS              GO TO B779-EXIT.
      *
           ADD 1                                 TO SPSACT.
           IF SECPRV OF SUBMDT = SPACES          GO TO B779-EXIT.
      *
           IF (EFFDAT OF SUBMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF SUBMDT NOT = EXPDAT OF SUBMDT)
                 MOVE EFFDAT OF SUBMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF SUBMDT TO ENPEXP OF WS-WORK
                 MOVE SPSACT                        TO SPSTMP.
       B779-EXIT.
           EXIT.
      *
       B780-SUBMED.
      ****************************************************************
      * Get subscriber Medicare Info.                                *
      ****************************************************************
           MOVE ZEROES TO                        SMDACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF NOT SUBADD-MDT-EXISTS              GO TO B789-EXIT.
      *
           ADD 1                                 TO SMDACT.
           IF MEDCTY OF SUBMDT = SPACES          GO TO B789-EXIT.
      *
           IF (EFFDAT OF SUBMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF SUBMDT NOT = EXPDAT OF SUBMDT)
                 MOVE EFFDAT OF SUBMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF SUBMDT TO ENPEXP OF WS-WORK
                 MOVE SMDACT                     TO SMDTMP.
       B789-EXIT.
           EXIT.
      *
       B790-SUBFEE.
      ***************************************************************
      * Get subscriber fee schedule.                                *
      ***************************************************************
           MOVE ZEROES TO                        SFEACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
           IF NOT SUBADD-MDT-EXISTS              GO TO B799-EXIT.
      *
           ADD 1                                 TO SFEACT.
           IF FEECOD OF SUBMDT = SPACES          GO TO B799-EXIT.
      *
           IF (EFFDAT OF SUBMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF SUBMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF SUBMDT NOT = EXPDAT OF SUBMDT)
                 MOVE EFFDAT OF SUBMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF SUBMDT TO ENPEXP OF WS-WORK
                 MOVE SFEACT                     TO SFETMP.
      *
       B799-EXIT.
           EXIT.
      *
       B800-SUBENB.
      ***************************************************************
      * Get current enrollment for subscriber from MDTMAS.          *
      ***************************************************************
           MOVE ZEROES                           TO ENSACT.
           MOVE ZEROES                 TO ENBEFF OF WS-WORK
                                          ENBEXP OF WS-WORK.
           IF NOT SUBADD-MDT-EXISTS              GO TO B809-EXIT.
           ADD 1                                 TO ENSACT.
      *
           IF GRPNUM OF SUBMDT = SPACES          GO TO B809-EXIT.
      *
           IF (EFFDAT OF SUBMDT > ENBEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENBEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENBEFF OF WS-WORK
           AND EXPDAT OF SUBMDT > ENBEXP OF WS-WORK)
           OR (EFFDAT OF SUBMDT = ENBEFF OF WS-WORK
           AND EXPDAT OF SUBMDT = ENBEXP OF WS-WORK)
              IF (EFFDAT OF SUBMDT NOT = EXPDAT OF SUBMDT)
                 MOVE EFFDAT OF SUBMDT TO ENBEFF OF WS-WORK
                 MOVE EXPDAT OF SUBMDT TO ENBEXP OF WS-WORK
                 MOVE ENSACT                     TO ENSTMP.
       B809-EXIT.
           EXIT.
      *
       B810-DEPPCP.
      ****************************************************************
      * Get current PCP.                                             *
      ****************************************************************
           MOVE ZEROES TO                        PCPACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           ADD 1                                 TO PCPACT.
      *
           IF PROVNO OF MEMMDT = SPACES          GO TO B819-EXIT.
      *
           IF (EFFDAT OF MEMMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF MEMMDT NOT = EXPDAT OF MEMMDT)
                 MOVE EFFDAT OF MEMMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF MEMMDT TO ENPEXP OF WS-WORK
                 MOVE PCPACT                     TO PCPTMP.
       B819-EXIT.
           EXIT.
      *
       B820-DEPSEC.
      ****************************************************************
      * Get current secondary PCP.                                  *
      ****************************************************************
           MOVE ZEROES TO                        SECACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           ADD 1                                 TO SECACT.
      *
           IF SECPRV OF MEMMDT = SPACES          GO TO B829-EXIT.
      *
           IF (EFFDAT OF MEMMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF MEMMDT NOT = EXPDAT OF MEMMDT)
                 MOVE EFFDAT OF MEMMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF MEMMDT TO ENPEXP OF WS-WORK
                 MOVE SECACT                     TO SECTMP.
       B829-EXIT.
           EXIT.
      *
       B830-DEPMED.
      ***************************************************************
      * Get current medicare.                                       *
      ***************************************************************
           MOVE ZEROES TO                        MEDACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           ADD 1                                 TO MEDACT.
      *
           IF MEDCTY OF MEMMDT = SPACES          GO TO B839-EXIT.
      *
           IF (EFFDAT OF MEMMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF MEMMDT NOT = EXPDAT OF MEMMDT)
                 MOVE EFFDAT OF MEMMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF MEMMDT TO ENPEXP OF WS-WORK
                 MOVE MEDACT                     TO MEDTMP.
       B839-EXIT.
           EXIT.
      *
       B840-DEPFEE.
      ***************************************************************
      *  Get current fee schedule.                                 *
      ***************************************************************
           MOVE ZEROES TO                        FEEACT.
           MOVE ZEROES                           TO ENPEFF OF WS-WORK.
           MOVE ZEROES                           TO ENPEXP OF WS-WORK.
      *
           ADD 1                                 TO FEEACT.
      *
           IF FEECOD OF MEMMDT = SPACES         GO TO B849-EXIT.
      *
           IF (EFFDAT OF MEMMDT > ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENPEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENPEFF OF WS-WORK
           AND EXPDAT OF MEMMDT = ENPEXP OF WS-WORK)
              IF (EFFDAT OF MEMMDT NOT = EXPDAT OF MEMMDT)
                 MOVE EFFDAT OF MEMMDT TO ENPEFF OF WS-WORK
                 MOVE EXPDAT OF MEMMDT TO ENPEXP OF WS-WORK
                 MOVE FEEACT                     TO FEETMP.
      *
       B849-EXIT.
           EXIT.
      *
       B850-DEPENB.
      ***************************************************************
      * Get current enrollment info.
      ***************************************************************
           MOVE ZEROES                           TO ENBACT.
           MOVE ZEROES                 TO ENBEFF OF WS-WORK
                                          ENBEXP OF WS-WORK.
      *
           ADD 1                                 TO ENBACT.
      *
           IF GRPNUM OF MEMMDT = SPACES          GO TO B859-EXIT.
      *
           IF (EFFDAT OF MEMMDT > ENBEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENBEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENBEFF OF WS-WORK
           AND EXPDAT OF MEMMDT > ENBEXP OF WS-WORK)
           OR (EFFDAT OF MEMMDT = ENBEFF OF WS-WORK
           AND EXPDAT OF MEMMDT = ENBEXP OF WS-WORK)
              IF (EFFDAT OF MEMMDT NOT = EXPDAT OF MEMMDT)
                 MOVE EFFDAT OF MEMMDT TO ENBEFF OF WS-WORK
                 MOVE EXPDAT OF MEMMDT TO ENBEXP OF WS-WORK
                 MOVE ENBACT                     TO ENBTMP.
       B859-EXIT.
           EXIT.
      *
       B860-SUBDEM.
      **********************************************************
      * Get demographic info for subscriber.                   *
      **********************************************************
           MOVE ZEROES                           TO SUBACT.
      *
           ADD 1                                 TO SUBACT.
           IF MEMBNO OF SUBMDT = SPACES          GO TO B869-EXIT.
      *
           IF MEMBNO OF SUBMDT = MEMBNO OF EEWSUB(ESBACT)
           AND GRPNUM OF SUBMDT = GRPNUM OF EEWSUB(ESBACT)
              MOVE SUBACT                        TO DEMTMP
           END-IF.
       B869-EXIT.
           EXIT.
      *
       B870-DEPDEM.
      ***************************************************************
      * Dependent DEMMAS.
      ***************************************************************
           MOVE ZEROES                           TO DEPACT.
           ADD 1                                 TO DEPACT.
      *
           IF MEMBNO OF MEMMDT = MEMBNO OF EEWDEP(EDPACT)
           AND GRPNUM OF MEMMDT = GRPNUM OF EEWDEP(EDPACT)
              MOVE DEPACT                        TO DEPTMP
           END-IF.
       B879-EXIT.
           EXIT.
      *
       B880-SUBCHG-EDITS.
      ***************************************************************
      * Edit subscriber change record.                                *
      ***************************************************************
           MOVE SPACES                             TO PRV-FLAG
                                                      FEE-FLAG
                                                      ENB-FLAG.
      *
           IF PRCNAM OF EEWHDR-WRK NOT = 'N'
           AND NAMCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND NAMCHG OF EEWSUB(ESBACT) NOT = ' '
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND NAMKEY OF EEWSUB(ESBACT) NOT = SPACES
              IF CHGEFF OF EEWSUB(ESBACT) = ZEROES
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'        TO MI-PARM4
                 MOVE 'NAME CHANGE'           TO MI-PARM5
                 MOVE 'EI02443'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B889-EXIT
                END-IF
              END-IF.
      *
           IF MEMCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND (MEMEFF OF EEWSUB(ESBACT) NOT = ZEROES
           OR   MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
              IF MEMEFF OF EEWSUB(ESBACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B889-EXIT
                 END-IF
              END-IF
              IF MEMEXP OF EEWSUB(ESBACT) = ZEROES
                 IF SUBADD-MDT-EXISTS
                    MOVE EXPDAT OF SUBMDT
                                       TO MEMEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEMBER MASTER'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
           IF CHGTYP OF EEWSUB(ESBACT) = 'T'
              IF MEMEXP OF EEWSUB(ESBACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.


           IF CHGTYP OF EEWSUB(ESBACT) = 'T'
           AND SUBADD-MDT-EXISTS
              IF  EFFDAT OF SUBMDT <= MEMEXP OF EEWSUB(ESBACT)
              AND MEMEXP OF EEWSUB(ESBACT) <= EXPDAT OF SUBMDT
                 NEXT SENTENCE
              ELSE
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI02469'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO B889-EXIT.

           IF (CHGTYP OF EEWSUB(ESBACT) = 'T' OR 'C')
           AND NOT SUBADD-MDT-EXISTS
              IF BYPEDT OF EDIENR-REC = 'Y'
                 MOVE 'Y'                        TO SW-SET-ERROR
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EI02469'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                   TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCACT OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
                 IF ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL'
                    PERFORM B800-SUBENB             THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF ACCTNO OF EEWSUB(ESBACT) NOT = ACCTNO OF SUBMDT
                       PERFORM B940-ENB-DATCHK      THRU B949-EXIT
                       MOVE 'Y'                     TO ACCT-FLAG
                       MOVE ACCTNO OF EEWSUB(ESBACT) TO ACCTNO-HLD.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCTIR OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF TIERCD OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM B800-SUBENB             THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF TIERCD OF EEWSUB(ESBACT) NOT =
                                                 TIERCD OF SUBMDT(1)
                       PERFORM B940-ENB-DATCHK      THRU B949-EXIT
                       MOVE 'Y'                     TO TIER-FLAG
                       MOVE TIERCD OF EEWSUB(ESBACT) TO TIERCD-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL1 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM B800-SUBENB             THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL1 OF EEWSUB(ESBACT) NOT = USRFL1 OF SUBMDT
                       PERFORM B940-ENB-DATCHK      THRU B949-EXIT
                       MOVE USRFL1 OF EEWSUB(ESBACT) TO USRFL1-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL2 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM B800-SUBENB             THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL2 OF EEWSUB(ESBACT) NOT = USRFL2 OF SUBMDT
                       PERFORM B940-ENB-DATCHK   THRU B949-EXIT
                       MOVE USRFL2 OF EEWSUB(ESBACT) TO USRFL2-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF USRFL3 OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM B800-SUBENB          THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF NOT FAMILY-ERROR
                    AND USRFL3 OF EEWSUB(ESBACT) NOT = USRFL3 OF SUBMDT
                       PERFORM B940-ENB-DATCHK   THRU B949-EXIT
                       MOVE USRFL3 OF EEWSUB(ESBACT) TO USRFL3-HLD.

           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCBPK OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
              IF SUBADD-MDT-EXISTS
              AND CHGTYP OF EEWSUB(ESBACT) = 'C'
                 IF BENPKG OF EEWSUB(ESBACT) NOT = SPACES
                    PERFORM B800-SUBENB          THRU B809-EXIT
                    IF ENSTMP = ZEROES
                       NEXT SENTENCE
                    ELSE
                    IF BENPKG OF EEWSUB(ESBACT) NOT = BENPKG OF SUBMDT
                       PERFORM B940-ENB-DATCHK      THRU B949-EXIT.

      *
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND SUBADD-MDT-EXISTS
              PERFORM B760-SUBPCP                THRU B769-EXIT
              IF PPSTMP = ZEROES
                 GO TO B885-NEXT
              END-IF
              IF PCPEFF OF EEWSUB(ESBACT) = ZEROES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT = PROVNO OF SUBMDT
                OR PCPORG OF EEWSUB(ESBACT) NOT = PRVORG OF SUBMDT
                OR PCPMCP OF EEWSUB(ESBACT) NOT = PCPMCP OF SUBMDT)
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       PCPEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF PCPEXP OF EEWSUB(ESBACT) = ZEROES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT = PROVNO OF SUBMDT
                OR PCPORG OF EEWSUB(ESBACT) NOT = PRVORG OF SUBMDT
                OR PCPMCP OF EEWSUB(ESBACT) NOT = PCPMCP OF SUBMDT)
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       PCPEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF SUBADD-MDT-EXISTS
                    MOVE EXPDAT OF SUBMDT
                                       TO PCPEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
       B885-NEXT.
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND SUBADD-MDT-EXISTS
              PERFORM B760-SUBPCP                THRU B769-EXIT
              IF PPSTMP = ZEROES
                 GO TO B886-NEXT
              END-IF
              IF PCPCOD OF EEWSUB(ESBACT) NOT = SPACES
              AND (PCPCOD OF EEWSUB(ESBACT) NOT = PROVNO OF SUBMDT
                OR PCPORG OF EEWSUB(ESBACT) NOT = PRVORG OF SUBMDT
                OR PCPMCP OF EEWSUB(ESBACT) NOT = PCPMCP OF SUBMDT)
                 MOVE 'Y'                        TO PRV-FLAG
                 IF (PCPEXP OF EEWSUB(ESBACT) NOT =
                                       MEMEXP OF EEWSUB(ESBACT)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B889-EXIT
                    END-IF
                 ELSE
                 IF PCPEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT
                 AND MEMEXP OF EEWSUB(ESBACT) = ZEROES
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A920-ERR-SUB         THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO B889-EXIT.
      *
       B886-NEXT.
           IF   PRCSEC OF EEWHDR-WRK NOT = 'N'
           AND  SECCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND  CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND  SECCOD OF EEWSUB(ESBACT) NOT = SPACES
           AND  SUBADD-MDT-EXISTS
              PERFORM B770-SUBSEC                THRU B779-EXIT
              IF SPSTMP = ZEROES
                 IF SECEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       SECEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                  TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF SECEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                       GO TO B887-NEXT
                    END-IF
                    IF SUBADD-MDT-EXISTS
                       MOVE EXPDAT OF SUBMDT
                                       TO SECEXP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B887-NEXT
              END-IF
              IF   SECEFF OF EEWSUB(ESBACT) = ZEROES
              AND (SECCOD OF EEWSUB(ESBACT) NOT = SECPRV OF SUBMDT
                OR SECORG OF EEWSUB(ESBACT) NOT = SECORG OF SUBMDT
                OR SECMCP OF EEWSUB(ESBACT) NOT = SECMCP OF SUBMDT)
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       SECEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF   SECEXP OF EEWSUB(ESBACT) = ZEROES
              AND (SECCOD OF EEWSUB(ESBACT) NOT = SECPRV OF SUBMDT
                OR SECORG OF EEWSUB(ESBACT) NOT = SECORG OF SUBMDT
                OR SECMCP OF EEWSUB(ESBACT) NOT = SECMCP OF SUBMDT)
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       SECEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF SUBADD-MDT-EXISTS
                    MOVE EXPDAT OF SUBMDT
                                       TO SECEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
       B887-NEXT.
           IF PRCMCS OF EEWHDR-WRK NOT = 'N'
           AND MEDCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND MEDSTS OF EEWSUB(ESBACT) NOT = SPACES
           AND MEDCTY OF EEWSUB(ESBACT) NOT = SPACES
           AND SUBADD-MDT-EXISTS
              PERFORM B780-SUBMED                THRU B789-EXIT
              IF SMDTMP = ZEROES
                 IF MEDEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       MEDEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF MEDEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                       GO TO B887-FEECHK
                    END-IF
                    IF SUBADD-MDT-EXISTS
                       MOVE EXPDAT OF SUBMDT
                                       TO MEDEXP OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B887-FEECHK
              END-IF
              IF MEDEFF OF EEWSUB(ESBACT) = ZEROES
              AND (MEDSTS OF EEWSUB(ESBACT) NOT =
                                       MEDSTS OF SUBMDT
               OR MEDCTY OF EEWSUB(ESBACT) NOT =
                                      MEDCTY OF SUBMDT)
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       MEDEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF MEDEXP OF EEWSUB(ESBACT) = ZEROES
              AND (MEDSTS OF EEWSUB(ESBACT) NOT =
                                       MEDSTS OF SUBMDT
               OR MEDCTY OF EEWSUB(ESBACT) NOT =
                                      MEDCTY OF SUBMDT)
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       MEDEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF SUBADD-MDT-EXISTS
                    MOVE EXPDAT OF SUBMDT
                                       TO MEDEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
       B887-FEECHK.
           IF PRCFEE OF EEWHDR-WRK NOT = 'N'
           AND FEECHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND FEECOD OF EEWSUB(ESBACT) NOT = SPACES
           AND SUBADD-MDT-EXISTS
              PERFORM B790-SUBFEE                THRU B799-EXIT
              IF SFETMP = ZEROES
                 IF FEEEFF OF EEWSUB(ESBACT) = ZEROES
                    IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                        FEEEFF OF EEWSUB(ESBACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'FEE SCHEDULE'            TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF FEEEXP OF EEWSUB(ESBACT) = ZEROES
                    IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                       GO TO B888-NEXT
                    END-IF
                    IF SUBADD-MDT-EXISTS
                       MOVE EXPDAT OF SUBMDT
                                       TO FEEEXP OF EEWSUB(ESBACT)
                       GO TO B888-NEXT
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWSUB(ESBACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWSUB(ESBACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWSUB(ESBACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWSUB(ESBACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWSUB(ESBACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A920-ERR-SUB            THRU A929-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B889-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B888-NEXT
              END-IF
              IF FEECOD OF EEWSUB(ESBACT) NOT = FEECOD OF SUBMDT
                 MOVE 'Y'                        TO FEE-FLAG
              END-IF
              IF FEEEFF OF EEWSUB(ESBACT) = ZEROES
              AND FEECOD OF EEWSUB(ESBACT) NOT = FEECOD OF SUBMDT
                 IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                        FEEEFF OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'FEE SCHEDULE'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B889-EXIT
                    END-IF
                 END-IF
              END-IF
              IF FEEEXP OF EEWSUB(ESBACT) = ZEROES
              AND FEECOD OF EEWSUB(ESBACT) NOT = FEECOD OF SUBMDT
                 IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       FEEEXP OF EEWSUB(ESBACT)
                 ELSE
                 IF SUBADD-MDT-EXISTS
                    MOVE EXPDAT OF SUBMDT
                                       TO FEEEXP OF EEWSUB(ESBACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWSUB(ESBACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWSUB(ESBACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWSUB(ESBACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWSUB(ESBACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWSUB(ESBACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A920-ERR-SUB            THRU A929-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
       B888-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWSUB(ESBACT) NOT = 'N'
           AND CHGTYP OF EEWSUB(ESBACT) = 'C'
           AND SUBADD-MDT-EXISTS
           AND ((ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
           OR   (TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
           OR   (BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
              PERFORM B800-SUBENB                THRU B809-EXIT
              IF ENSTMP = ZEROES
                 GO TO B889-EXIT
              END-IF
              IF  (TIERCD OF EEWSUB(ESBACT) NOT =
                                    TIERCD OF SUBMDT(1)
              AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT =
                                   BENPKG OF SUBMDT
                   AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT =
                                   USRFL1 OF SUBMDT
                   AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT =
                                   USRFL2 OF SUBMDT
                   AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT =
                                   USRFL3 OF SUBMDT
                   AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
                 MOVE 'Y'                        TO ENB-FLAG
              END-IF
              IF (ENBEXP OF EEWSUB(ESBACT) NOT =
                                    MEMEXP OF EEWSUB(ESBACT)
              AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES)
              AND ((ACCTNO OF EEWSUB(ESBACT) NOT =
                                    ACCTNO OF SUBMDT
              AND ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWSUB(ESBACT) NOT =
                                    TIERCD OF SUBMDT(1)
                  AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT =
                                   USRFL1 OF SUBMDT
                  AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT =
                                   USRFL2 OF SUBMDT
                  AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT =
                                   USRFL3 OF SUBMDT
                  AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT =
                                   BENPKG OF SUBMDT
                  AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B889-EXIT
                 END-IF
              ELSE
              IF ENBEXP OF EEWSUB(ESBACT) NOT = EXPDAT OF SUBMDT
              AND MEMEXP OF EEWSUB(ESBACT) = ZEROES
              AND ((ACCTNO OF EEWSUB(ESBACT) NOT = ACCTNO OF SUBMDT
              AND ACCTNO OF EEWSUB(ESBACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWSUB(ESBACT) NOT = TIERCD OF SUBMDT(1)
              AND TIERCD OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL1 OF EEWSUB(ESBACT) NOT = USRFL1 OF SUBMDT
              AND USRFL1 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL2 OF EEWSUB(ESBACT) NOT = USRFL2 OF SUBMDT
              AND USRFL2 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (USRFL3 OF EEWSUB(ESBACT) NOT = USRFL3 OF SUBMDT
              AND USRFL3 OF EEWSUB(ESBACT) NOT = SPACES)
              OR   (BENPKG OF EEWSUB(ESBACT) NOT = BENPKG OF SUBMDT
              AND BENPKG OF EEWSUB(ESBACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO B889-EXIT.
      *
           IF FEE-CHANGE AND PCP-CHANGE
              IF FEEEFF OF EEWSUB(ESBACT) NOT =
                                       PCPEFF OF EEWSUB(ESBACT)
              OR FEEEXP OF EEWSUB(ESBACT) NOT =
                                       PCPEXP OF EEWSUB(ESBACT)
                 MOVE FEEEFF OF EEWSUB(ESBACT)
                                       TO PCPEFF OF EEWSUB(ESBACT)
                 MOVE FEEEXP OF EEWSUB(ESBACT)
                                       TO PCPEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF FEE-CHANGE AND ENB-CHANGE
              IF FEEEFF OF EEWSUB(ESBACT) NOT =
                                       ENBEFF OF EEWSUB(ESBACT)
              OR FEEEXP OF EEWSUB(ESBACT) NOT =
                                       ENBEXP OF EEWSUB(ESBACT)
                 MOVE ENBEFF OF EEWSUB(ESBACT)
                                      TO FEEEFF OF EEWSUB(ESBACT)
                 MOVE ENBEXP OF EEWSUB(ESBACT)
                                      TO FEEEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF PCP-CHANGE AND ENB-CHANGE
              IF PCPEFF OF EEWSUB(ESBACT) NOT =
                                       ENBEFF OF EEWSUB(ESBACT)
              OR PCPEXP OF EEWSUB(ESBACT) NOT =
                                       ENBEXP OF EEWSUB(ESBACT)
                 MOVE ENBEFF OF EEWSUB(ESBACT)
                                      TO PCPEFF OF EEWSUB(ESBACT)
                 MOVE ENBEXP OF EEWSUB(ESBACT)
                                      TO PCPEXP OF EEWSUB(ESBACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
       B889-EXIT.
           EXIT.
      *
       B890-DEPCHG-EDITS.
      **************************************************************
      * Edit dependent change record.                              *
      **************************************************************
           MOVE SPACES                             TO PRV-FLAG
                                                      FEE-FLAG
                                                      ENB-FLAG.

           IF PRCNAM OF EEWHDR-WRK NOT = 'N'
           AND NAMCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND NAMCHG OF EEWDEP(EDPACT) NOT = ' '
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND NAMKEY OF EEWDEP(EDPACT) NOT = SPACES
              IF CHGEFF OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'NAME CHANGE'              TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B899-EXIT
                 END-IF
              END-IF.
      *
           IF MEMCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND (MEMEFF OF EEWDEP(EDPACT) NOT = ZEROES
           OR  MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
              IF MEMEFF OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B899-EXIT
                 END-IF
              END-IF
              IF MEMEXP OF EEWDEP(EDPACT) = ZEROES
                 IF MEMADD-MDT-EXISTS
                    MOVE EXPDAT OF MEMMDT
                                       TO MEMEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEMBER MASTER'            TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF WRN-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.
      *
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
              IF MEMEXP OF EEWDEP(EDPACT) = ZEROES
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'MEMBER MASTER'            TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.
      *
           IF CHGTYP OF EEWDEP(EDPACT) = 'T'
           AND MEMADD-MDT-EXISTS
              IF  EFFDAT OF MEMMDT <= MEMEXP OF EEWDEP(EDPACT)
              AND MEMEXP OF EEWDEP(EDPACT) <= EXPDAT OF MEMMDT
                 NEXT SENTENCE
              ELSE
                 IF BYPEDT OF EDIENR-REC = 'Y'
                    MOVE 'Y'                     TO SW-SET-ERROR
                 ELSE
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EI02469'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO B899-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCACT OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMADD-MDT-EXISTS
              PERFORM B850-DEPENB                THRU B859-EXIT
              IF ENBTMP = ZEROES
                 GO TO B892-NEXT
              END-IF
              IF ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO OF MEMMDT
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
                 PERFORM B950-ENB-DATCHK   THRU B959-EXIT
              END-IF
              IF ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO OF MEMMDT
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              AND (ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO-HLD
              OR NOT SUBACCT-CHG)
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES           TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ACCOUNT'                  TO MI-PARM4
                 MOVE 'EI02470'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.

       B892-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCTIR OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMADD-MDT-EXISTS
              PERFORM B850-DEPENB                THRU B859-EXIT
              IF ENBTMP = ZEROES
                 GO TO B893-NEXT
              END-IF
              IF  TIERCD OF EEWDEP(EDPACT) NOT = SPACES
              AND TIERCD OF EEWDEP(EDPACT) NOT = TIERCD OF MEMMDT(1)
                 PERFORM B950-ENB-DATCHK   THRU B959-EXIT
              END-IF
              IF  TIERCD OF EEWDEP(EDPACT) NOT = SPACES
              AND TIERCD OF EEWDEP(EDPACT) NOT = TIERCD OF MEMMDT(1)
                 IF NOT SUB-TIRCHG
                 OR (TIERCD OF EEWDEP(EDPACT) NOT = TIERCD-HLD)
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'TIER CODE'              TO MI-PARM4
                    MOVE 'EI02470'                TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO
                                               GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO
                                               SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO
                                               RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO
                                               MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO
                                               CHGTYP OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR      THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER       THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'   GO TO B899-EXIT.
      *
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND PRCBPK OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
              IF MEMADD-MDT-EXISTS
                 IF BENPKG OF EEWDEP(EDPACT) NOT = SPACES
                    PERFORM B850-DEPENB          THRU B859-EXIT
                    IF ENBTMP = ZEROES
                       GO TO B893-NEXT
                    ELSE
                    IF BENPKG OF EEWDEP(EDPACT) NOT = BENPKG OF MEMMDT
                       PERFORM B950-ENB-DATCHK   THRU B959-EXIT.
      *
       B893-NEXT.
           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMADD-MDT-EXISTS
              PERFORM B810-DEPPCP                THRU B819-EXIT
              IF PCPTMP = ZEROES
                 GO TO B894-NEXT
              END-IF
              IF PCPEFF OF EEWDEP(EDPACT) = ZEROES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT = PROVNO OF MEMMDT
                OR PCPORG OF EEWDEP(EDPACT) NOT = PRVORG OF MEMMDT
                OR PCPMCP OF EEWDEP(EDPACT) NOT = PCPMCP OF MEMMDT)
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT)
                                       TO PCPEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF PCPEXP OF EEWDEP(EDPACT) = ZEROES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT = PROVNO OF MEMMDT
                OR PCPORG OF EEWDEP(EDPACT) NOT = PRVORG OF MEMMDT
                OR PCPMCP OF EEWDEP(EDPACT) NOT = PCPMCP OF MEMMDT)
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       PCPEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMADD-MDT-EXISTS
                    MOVE EXPDAT OF MEMMDT
                                       TO PCPEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'PRIMARY PROVIDER'         TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.

           IF PRCPCP OF EEWHDR-WRK NOT = 'N'
           AND PCPCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMADD-MDT-EXISTS
              PERFORM B810-DEPPCP                THRU B819-EXIT
              IF PCPTMP = ZEROES
                 GO TO B894-NEXT
              END-IF
              IF PCPCOD OF EEWDEP(EDPACT) NOT = SPACES
              AND (PCPCOD OF EEWDEP(EDPACT) NOT = PROVNO OF MEMMDT
                OR PCPORG OF EEWDEP(EDPACT) NOT = PRVORG OF MEMMDT
                OR PCPMCP OF EEWDEP(EDPACT) NOT = PCPMCP OF MEMMDT)
                 MOVE 'Y'                        TO PRV-FLAG
                 IF (PCPEXP OF EEWDEP(EDPACT) NOT =
                                       MEMEXP OF EEWDEP(EDPACT)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B899-EXIT
                    END-IF
                 ELSE
                 IF PCPEXP OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT
                 AND MEMEXP OF EEWDEP(EDPACT) = ZEROES
                    MOVE 'Y'                     TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'PRIMARY PROVIDER'      TO MI-PARM4
                    MOVE 'EI02468'               TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER      THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'  GO TO B899-EXIT.
      *
       B894-NEXT.
           IF   PRCSEC OF EEWHDR-WRK NOT = 'N'
           AND  SECCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND  CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND  SECCOD OF EEWDEP(EDPACT) NOT = SPACES
           AND  MEMADD-MDT-EXISTS
              PERFORM B820-DEPSEC                THRU B829-EXIT
              IF SECTMP = ZEROES
                 IF SECEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT)
                                       TO SECEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF SECEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       SECEXP OF EEWDEP(EDPACT)
                       GO TO B895-NEXT
                    END-IF
                    IF MEMADD-MDT-EXISTS
                       MOVE EXPDAT OF MEMMDT
                                       TO SECEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B895-NEXT
              END-IF
              IF   SECEFF OF EEWDEP(EDPACT) = ZEROES
              AND (SECCOD OF EEWDEP(EDPACT) NOT = SECPRV OF MEMMDT
                OR SECORG OF EEWDEP(EDPACT) NOT = SECORG OF MEMMDT
                OR SECMCP OF EEWDEP(EDPACT) NOT = SECMCP OF MEMMDT)
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       SECEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF   SECEXP OF EEWDEP(EDPACT) = ZEROES
              AND (SECCOD OF EEWDEP(EDPACT) NOT = SECPRV OF MEMMDT
                OR SECORG OF EEWDEP(EDPACT) NOT = SECORG OF MEMMDT
                OR SECMCP OF EEWDEP(EDPACT) NOT = SECMCP OF MEMMDT)
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       SECEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMADD-MDT-EXISTS
                    MOVE EXPDAT OF MEMMDT
                                       TO SECEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES         TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'SECONDARY PROVIDER'       TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID           TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.
      *
       B895-NEXT.
           IF PRCMCS OF EEWHDR-WRK NOT = 'N'
           AND MEDCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEDSTS OF EEWDEP(EDPACT) NOT = SPACES
           AND MEDCTY OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMADD-MDT-EXISTS
              PERFORM B830-DEPMED                THRU B839-EXIT
              IF MEDTMP = ZEROES
                 IF MEDEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       MEDEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES      TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF MEDEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                       GO TO B896-NEXT
                    END-IF
                    IF MEMADD-MDT-EXISTS
                       MOVE EXPDAT OF MEMMDT
                                       TO MEDEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'MEDICARE'                 TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                  TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID        TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B896-NEXT
              END-IF
              IF MEDEFF OF EEWDEP(EDPACT) = ZEROES
              AND (MEDSTS OF EEWDEP(EDPACT) NOT = MEDSTS OF MEMMDT
               OR MEDCTY OF EEWDEP(EDPACT) NOT = MEDCTY OF MEMMDT)
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       MEDEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF MEDEXP OF EEWDEP(EDPACT) = ZEROES
              AND (MEDSTS OF EEWDEP(EDPACT) NOT = MEDSTS OF MEMMDT
               OR MEDCTY OF EEWDEP(EDPACT) NOT = MEDCTY OF MEMMDT)
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       MEDEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMADD-MDT-EXISTS
                    MOVE EXPDAT OF MEMMDT
                                       TO MEDEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'MEDICARE'                 TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.
      *
       B896-NEXT.
           IF PRCFEE OF EEWHDR-WRK NOT = 'N'
           AND FEECHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND FEECOD OF EEWDEP(EDPACT) NOT = SPACES
           AND MEMADD-MDT-EXISTS
              PERFORM B840-DEPFEE                THRU B849-EXIT
              IF FEETMP = ZEROES
                 IF FEEEFF OF EEWDEP(EDPACT) = ZEROES
                    IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       FEEEFF OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID         TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 IF FEEEXP OF EEWDEP(EDPACT) = ZEROES
                    IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                    AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                       MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                       GO TO B897-NEXT
                    END-IF
                    IF MEMADD-MDT-EXISTS
                       MOVE EXPDAT OF MEMMDT
                                       TO FEEEXP OF EEWDEP(EDPACT)
                    ELSE
                       MOVE 'Y'                        TO FAMILY-FLAG
                       MOVE SPACES     TO MESSAGE-INTERFACE-PARAMETERS
                       MOVE 'EXPIRATION DATE'          TO MI-PARM4
                       MOVE 'FEE SCHEDULE'             TO MI-PARM5
                       MOVE 'EI02443'                  TO MI-PRIMARY-ID
                       MOVE GRPNUM OF EEWDEP(EDPACT)
                                                 TO GRPNUM OF ERR-LINE
                       MOVE SUBSNO OF EEWDEP(EDPACT)
                                                 TO SUBSNO OF ERR-LINE
                       MOVE RELCOD OF EEWDEP(EDPACT)
                                                 TO RELCOD OF ERR-LINE
                       MOVE MEMBNO OF EEWDEP(EDPACT)
                                                 TO MEMBNO OF ERR-LINE
                       MOVE CHGTYP OF EEWDEP(EDPACT)
                                                 TO CHGTYP OF ERR-LINE
                       MOVE MI-PRIMARY-ID         TO MSGNUM OF ERR-LINE
                       MOVE ERR-LINE                      TO LINE-E
                       PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                       PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                       IF PRCERR OF PGM-WORK = 'Y'
                          GO TO B899-EXIT
                       END-IF
                    END-IF
                 END-IF
                 GO TO B897-NEXT
              END-IF
              IF FEEEFF OF EEWDEP(EDPACT) = ZEROES
              AND FEECOD OF EEWDEP(EDPACT) NOT = FEECOD OF MEMMDT
                 MOVE 'Y'                        TO FEE-FLAG
                 IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                       FEEEFF OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B899-EXIT
                    END-IF
                 END-IF
              END-IF
              IF FEEEXP OF EEWDEP(EDPACT) = ZEROES
              AND FEECOD OF EEWDEP(EDPACT) NOT = FEECOD OF MEMMDT
                 IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
                 AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                    MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                       FEEEXP OF EEWDEP(EDPACT)
                 ELSE
                 IF MEMADD-MDT-EXISTS
                    MOVE EXPDAT OF MEMMDT
                                       TO FEEEXP OF EEWDEP(EDPACT)
                 ELSE
                    MOVE 'Y'                        TO FAMILY-FLAG
                    MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                    MOVE 'EXPIRATION DATE'          TO MI-PARM4
                    MOVE 'FEE SCHEDULE'             TO MI-PARM5
                    MOVE 'EI02443'                  TO MI-PRIMARY-ID
                    MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                    MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                    MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                    MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                    MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                    MOVE MI-PRIMARY-ID            TO MSGNUM OF ERR-LINE
                    MOVE ERR-LINE                      TO LINE-E
                    PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                    PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                    IF PRCERR OF PGM-WORK = 'Y'     GO TO B899-EXIT.
      *
       B897-NEXT.
           IF PRCENB OF EEWHDR-WRK NOT = 'N'
           AND ENBCHG OF EEWDEP(EDPACT) NOT = 'N'
           AND CHGTYP OF EEWDEP(EDPACT) = 'C'
           AND MEMADD-MDT-EXISTS
           AND ((ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
           OR   TIERCD OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL1 OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL2 OF EEWDEP(EDPACT) NOT = SPACES
           OR   USRFL3 OF EEWDEP(EDPACT) NOT = SPACES
           OR   BENPKG OF EEWDEP(EDPACT) NOT = SPACES)
              PERFORM B850-DEPENB                THRU B859-EXIT
              IF ENBTMP = ZEROES
                 GO TO B898-NEXT
              END-IF
              IF   (TIERCD OF EEWDEP(EDPACT) NOT = TIERCD OF MEMMDT(1)
              AND   TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (BENPKG OF EEWDEP(EDPACT) NOT = BENPKG OF MEMMDT
              AND  BENPKG OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL1 OF EEWDEP(EDPACT) NOT = USRFL1 OF MEMMDT
              AND  USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL2 OF EEWDEP(EDPACT) NOT = USRFL2 OF MEMMDT
              AND  USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR  (USRFL3 OF EEWDEP(EDPACT) NOT = USRFL3 OF MEMMDT
              AND  USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
                 MOVE 'Y'                        TO ENB-FLAG
              END-IF
              IF (ENBEXP OF EEWDEP(EDPACT) NOT =
                                    MEMEXP OF EEWDEP(EDPACT)
              AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES)
              AND ((ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO OF MEMMDT
              AND ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWDEP(EDPACT) NOT = TIERCD OF MEMMDT(1)
                   AND TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL1 OF EEWDEP(EDPACT) NOT = USRFL1 OF MEMMDT
                   AND USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL2 OF EEWDEP(EDPACT) NOT = USRFL2 OF MEMMDT
                   AND USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL3 OF EEWDEP(EDPACT) NOT = USRFL3 OF MEMMDT
                   AND USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (BENPKG OF EEWDEP(EDPACT) NOT = BENPKG OF MEMMDT
                   AND BENPKG OF EEWDEP(EDPACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B899-EXIT
                 END-IF
              ELSE
              IF  ENBEXP OF EEWDEP(EDPACT) NOT = EXPDAT OF MEMMDT
              AND MEMEXP OF EEWDEP(EDPACT) = ZEROES
              AND ((ACCTNO OF EEWDEP(EDPACT) NOT = ACCTNO OF MEMMDT
              AND   ACCTNO OF EEWDEP(EDPACT) NOT = SPACES AND 'INDBIL')
              OR   (TIERCD OF EEWDEP(EDPACT) NOT = TIERCD OF MEMMDT(1)
              AND   TIERCD OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL1 OF EEWDEP(EDPACT) NOT = USRFL1 OF MEMMDT
              AND   USRFL1 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL2 OF EEWDEP(EDPACT) NOT = USRFL2 OF MEMMDT
              AND   USRFL2 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (USRFL3 OF EEWDEP(EDPACT) NOT = USRFL3 OF MEMMDT
              AND   USRFL3 OF EEWDEP(EDPACT) NOT = SPACES)
              OR   (BENPKG OF EEWDEP(EDPACT) NOT = BENPKG OF MEMMDT
              AND BENPKG OF EEWDEP(EDPACT) NOT = SPACES))
                 MOVE 'Y'                     TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'ENROLLMENT BILLING'    TO MI-PARM4
                 MOVE 'EI02468'               TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF ERR-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR     THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT.
      *
       B898-NEXT.
           IF FEE-CHANGE AND PCP-CHANGE
              IF FEEEFF OF EEWDEP(EDPACT) NOT =
                                       PCPEFF OF EEWDEP(EDPACT)
              OR FEEEXP OF EEWDEP(EDPACT) NOT =
                                       PCPEXP OF EEWDEP(EDPACT)
                 MOVE FEEEFF OF EEWDEP(EDPACT)
                                       TO PCPEFF OF EEWDEP(EDPACT)
                 MOVE FEEEXP OF EEWDEP(EDPACT)
                                       TO PCPEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF FEE-CHANGE AND ENB-CHANGE
              IF FEEEFF OF EEWDEP(EDPACT) NOT =
                                       ENBEFF OF EEWDEP(EDPACT)
              OR FEEEXP OF EEWDEP(EDPACT) NOT =
                                       ENBEXP OF EEWDEP(EDPACT)
                 MOVE ENBEFF OF EEWDEP(EDPACT)
                                      TO FEEEFF OF EEWDEP(EDPACT)
                 MOVE ENBEXP OF EEWDEP(EDPACT)
                                      TO FEEEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'FEE SCHEDULE DATES'       TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
      *
           IF PCP-CHANGE AND ENB-CHANGE
              IF PCPEFF OF EEWDEP(EDPACT) NOT =
                                       ENBEFF OF EEWDEP(EDPACT)
              OR PCPEXP OF EEWDEP(EDPACT) NOT =
                                       ENBEXP OF EEWDEP(EDPACT)
                 MOVE ENBEFF OF EEWDEP(EDPACT)
                                      TO PCPEFF OF EEWDEP(EDPACT)
                 MOVE ENBEXP OF EEWDEP(EDPACT)
                                      TO PCPEXP OF EEWDEP(EDPACT)
                 MOVE SPACES          TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF WRN-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF WRN-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF WRN-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF WRN-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF WRN-LINE
                 MOVE 'EI02476'                  TO MSGNUM OF WRN-LINE
                 MOVE WRN-LINE                   TO LINE-W
                 MOVE 'PCP DATES'                TO MI-PARM4
                 MOVE 'ENROLLMENT DATES'         TO MI-PARM5
                 MOVE 'EI02476'                  TO MI-PRIMARY-ID
                 PERFORM X110-WRNING             THRU X119-EXIT.
       B899-EXIT.
           EXIT.
      *
       B940-ENB-DATCHK.
           IF ENBEFF OF EEWSUB(ESBACT) = ZEROES
              IF CHGEFF OF EEWSUB(ESBACT) NOT = ZEROES
                 MOVE CHGEFF OF EEWSUB(ESBACT) TO
                                       ENBEFF OF EEWSUB(ESBACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'      TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                       GO TO B949-EXIT
                 END-IF
              END-IF
           END-IF
           IF ENBEXP OF EEWSUB(ESBACT) = ZEROES
              IF (MEMCHG OF EEWSUB(ESBACT) = 'Y' OR SPACES)
              AND MEMEXP OF EEWSUB(ESBACT) NOT = ZEROES
                 MOVE MEMEXP OF EEWSUB(ESBACT) TO
                                       ENBEXP OF EEWSUB(ESBACT)
              ELSE
              IF SUBADD-MDT-EXISTS
                 MOVE EXPDAT OF SUBMDT TO ENBEXP OF EEWSUB(ESBACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWSUB(ESBACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWSUB(ESBACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWSUB(ESBACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWSUB(ESBACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWSUB(ESBACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A920-ERR-SUB            THRU A929-EXIT.
       B949-EXIT.
           EXIT.
      *
       B950-ENB-DATCHK.
           IF ENBEFF OF EEWDEP(EDPACT) = ZEROES
              IF CHGEFF OF EEWDEP(EDPACT) NOT = ZEROES
                 MOVE CHGEFF OF EEWDEP(EDPACT) TO
                                    ENBEFF OF EEWDEP(EDPACT)
              ELSE
                MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                 MOVE 'EFFECTIVE DATE'           TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT) TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT) TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT) TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT) TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT) TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT
                 IF PRCERR OF PGM-WORK = 'Y'
                    GO TO B959-EXIT
                 END-IF
              END-IF
           END-IF
           IF ENBEXP OF EEWDEP(EDPACT) = ZEROES
             IF (MEMCHG OF EEWDEP(EDPACT) = 'Y' OR SPACES)
              AND MEMEXP OF EEWDEP(EDPACT) NOT = ZEROES
                 MOVE MEMEXP OF EEWDEP(EDPACT) TO
                                          ENBEXP OF EEWDEP(EDPACT)
              ELSE
              IF MEMADD-MDT-EXISTS
                 MOVE EXPDAT OF MEMMDT TO ENBEXP OF EEWDEP(EDPACT)
              ELSE
                 MOVE 'Y'                        TO FAMILY-FLAG
                 MOVE SPACES        TO MESSAGE-INTERFACE-PARAMETERS
                MOVE 'EXPIRATION DATE'          TO MI-PARM4
                 MOVE 'ENROLLMENT BILLING'       TO MI-PARM5
                 MOVE 'EI02443'                  TO MI-PRIMARY-ID
                 MOVE GRPNUM OF EEWDEP(EDPACT)   TO GRPNUM OF ERR-LINE
                 MOVE SUBSNO OF EEWDEP(EDPACT)   TO SUBSNO OF ERR-LINE
                 MOVE RELCOD OF EEWDEP(EDPACT)   TO RELCOD OF ERR-LINE
                 MOVE MEMBNO OF EEWDEP(EDPACT)   TO MEMBNO OF ERR-LINE
                 MOVE CHGTYP OF EEWDEP(EDPACT)   TO CHGTYP OF ERR-LINE
                 MOVE MI-PRIMARY-ID              TO MSGNUM OF WRN-LINE
                 MOVE ERR-LINE                      TO LINE-E
                 PERFORM X100-PRINT-ERROR        THRU X109-EXIT
                 PERFORM A910-ERR-MEMBER         THRU A919-EXIT.
       B959-EXIT.
           EXIT.
      *
      ****--------------------------------------------------------****
      ****  CR141350  KCT  Fix                                    ****
      ****  Move copybook to proper source file per standards.    ****
      ****--------------------------------------------------------****
      **** COPY ED201CB OF EDCBLLESRC.
           COPY ED201CB OF QLBLSRC.
      *
      ****--------------------------------------------------------****
      ****  CR142605  SKV  Fix                                    ****
      ****--------------------------------------------------------****
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==         BY ==CMPANY==,
                        ==FILNAM-REC==     BY ==CMPANY-REC==,
                        ==FILNAM-KEY==     BY ==CMPANY-KEY==,
                        ==FILNAM-START==   BY ==CMPANY-START==,
                        ==FILNAM-STARTGE== BY ==CMPANY-STARTGE==,
                        ==FILNAM-STARTGT== BY ==CMPANY-STARTGT==,
                        ==FILNAM-READ==    BY ==CMPANY-READ==,
                        ==FILNAM-READNX==  BY ==CMPANY-READNX==,
                        ==FILNAM-STATUSR== BY ==CMPANY-STATUSR==,
                        ==FILNAM-STATUS==  BY ==CMPANY-STATUS==,
                        == 'FILNAM' ==     BY == 'CMPANYBT' ==,
                        ==FILNAM-EXITR==   BY ==CMPANY-EXITR==.
       CMPANY-INIT.
           COPY CMPANYIN OF QLBLSRC
              REPLACING ==CMPANYBT-REC==     BY ==CMPANY-REC==,
                        ==CURDAT OF MHAREA== BY ==ZEROES==,
                        ==USERID OF MHAREA== BY ==SPACES==,
                        ==TERMID OF MHAREA== BY ==SPACES==.

      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==COVMAS==,
                        ==FILNAM-START==    BY ==COVMAS-START==,
                        ==FILNAM-REC==      BY ==COVMAS-REC==,
                        ==FILNAM-KEY==      BY ==COVMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==COVMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==COVMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==COVMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==COVMAS-READ==,
                        ==FILNAM-READNX==   BY ==COVMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==COVMAS-STATUS==,
                        =='FILNAM'==        BY =='COVMAS'==,
                        ==FILNAM-EXITR==    BY ==COVMAS-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==CPAMAS==,
                        ==FILNAM-START==    BY ==CPAMAS-START==,
                        ==FILNAM-REC==      BY ==CPAMAS-REC==,
                        ==FILNAM-KEY==      BY ==CPAMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==CPAMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==CPAMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==CPAMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==CPAMAS-READ==,
                        ==FILNAM-READNX==   BY ==CPAMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==CPAMAS-STATUS==,
                        =='FILNAM'==        BY =='CPAMAS'==,
                        ==FILNAM-EXITR==    BY ==CPAMAS-EXITR==.

           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==CPDMAS==,
                        ==FILNAM-START==    BY ==CPDMAS-START==,
                        ==FILNAM-REC==      BY ==CPDMAS-REC==,
                        ==FILNAM-KEY==      BY ==CPDMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==CPDMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==CPDMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==CPDMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==CPDMAS-READ==,
                        ==FILNAM-READNX==   BY ==CPDMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==CPDMAS-STATUS==,
                        =='FILNAM'==        BY =='CPDMAS'==,
                        ==FILNAM-EXITR==    BY ==CPDMAS-EXITR==.
           COPY CPDMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==DEMMAS==,
                        ==FILNAM-START==    BY ==DEMMAS-START==,
                        ==FILNAM-REC==      BY ==DEMMAS-REC==,
                        ==FILNAM-KEY==      BY ==DEMMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==DEMMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==DEMMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==DEMMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==DEMMAS-READ==,
                        ==FILNAM-READNX==   BY ==DEMMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==DEMMAS-STATUS==,
                        =='FILNAM'==        BY =='DEMMAS'==,
                        ==FILNAM-EXITR==    BY ==DEMMAS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==DODMAS==,
                        ==FILNAM-START==    BY ==DODMAS-START==,
                        ==FILNAM-REC==      BY ==DODMAS-REC==,
                        ==FILNAM-KEY==      BY ==DODMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==DODMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==DODMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==DODMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==DODMAS-READ==,
                        ==FILNAM-READNX==   BY ==DODMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==DODMAS-STATUS==,
                        =='FILNAM'==        BY =='DODMAS'==,
                        ==FILNAM-EXITR==    BY ==DODMAS-EXITR==.
           COPY DODMASBW OF QLBLSRC.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EDIDOCBT==,
                        ==FILNAM-START==    BY ==EDIDOCBT-START==,
                        ==FILNAM-REC==      BY ==EDIDOCBT-REC==,
                        ==IF FILNAM-KEY==   BY ==IF EDIDOCBT-REC==,
                        ==FILNAM-KEY==      BY
                                    ==EXTERNALLY-DESCRIBED-KEY==,
                        ==FILNAM-STATUSR==  BY ==EDIDOCBT-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EDIDOCBT-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EDIDOCBT-STARTGT==,
                        ==FILNAM-READ==     BY ==EDIDOCBT-READ==,
                        ==FILNAM-READNX==   BY ==EDIDOCBT-READNX==,
                        ==FILNAM-STATUS==   BY ==EDIDOCBT-STATUS==,
                        =='FILNAM'==        BY =='EDIDOCBT'==,
                        ==FILNAM-EXITR==    BY ==EDIDOCBT-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EEEMAS==,
                        ==FILNAM-START==    BY ==EEEMAS-START==,
                        ==FILNAM-REC==      BY ==EEEMAS-REC==,
                        ==IF FILNAM-KEY==   BY ==IF EEEMAS-REC==,
                        ==FILNAM-KEY==      BY
                                    ==EXTERNALLY-DESCRIBED-KEY==,
                        ==FILNAM-STATUSR==  BY ==EEEMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EEEMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EEEMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==EEEMAS-READ==,
                        ==FILNAM-READNX==   BY ==EEEMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==EEEMAS-STATUS==,
                        =='FILNAM'==        BY =='EEEMAS'==,
                        ==FILNAM-EXITR==    BY ==EEEMAS-EXITR==.
           COPY EEEMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EETMAS==,
                        ==FILNAM-START==    BY ==EETMAS-START==,
                        ==FILNAM-REC==      BY ==EETMAS-REC==,
                        ==IF FILNAM-KEY==   BY ==IF EETMAS-REC==,
                        ==FILNAM-KEY==      BY
                                    ==EXTERNALLY-DESCRIBED-KEY==,
                        ==FILNAM-STATUSR==  BY ==EETMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EETMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EETMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==EETMAS-READ==,
                        ==FILNAM-READNX==   BY ==EETMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==EETMAS-STATUS==,
                        =='FILNAM'==        BY =='EETMAS'==,
                        ==FILNAM-EXITR==    BY ==EETMAS-EXITR==.
           COPY EETMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==ENBMAS==,
                        ==FILNAM-START==    BY ==ENBMAS-START==,
                        ==FILNAM-REC==      BY ==ENBMAS-REC==,
                        ==FILNAM-KEY==      BY ==ENBMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==ENBMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==ENBMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==ENBMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==ENBMAS-READ==,
                        ==FILNAM-READNX==   BY ==ENBMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==ENBMAS-STATUS==,
                        =='FILNAM'==        BY =='ENBMAS'==,
                        ==FILNAM-EXITR==    BY ==ENBMAS-EXITR==.
           COPY LOGICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==ENBMEM==,
                        ==FILNAM-START==    BY ==ENBMEM-START==,
                        ==FILNAM-REC==      BY ==ENBMEM-REC==,
                        ==FILNAM-KEY==      BY ==ENBMEM-KEY==,
                        ==FILNAM-STATUSR==  BY ==ENBMEM-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==ENBMEM-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==ENBMEM-STARTGT==,
                        ==FILNAM-READ==     BY ==ENBMEM-READ==,
                        ==FILNAM-READNX==   BY ==ENBMEM-READNX==,
                        ==FILNAM-STATUS==   BY ==ENBMEM-STATUS==,
                        =='FILNAM'==        BY =='ENBMEM'==,
                        ==FILNAM-EXITR==    BY ==ENBMEM-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==ENPMAS==,
                        ==FILNAM-START==    BY ==ENPMAS-START==,
                        ==FILNAM-REC==      BY ==ENPMAS-REC==,
                        ==FILNAM-KEY==      BY ==ENPMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==ENPMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==ENPMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==ENPMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==ENPMAS-READ==,
                        ==FILNAM-READNX==   BY ==ENPMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==ENPMAS-STATUS==,
                        =='FILNAM'==        BY =='ENPMAS'==,
                        ==FILNAM-EXITR==    BY ==ENPMAS-EXITR==.
           COPY LOGICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==ENPGRP==,
                        ==FILNAM-START==    BY ==ENPGRP-START==,
                        ==FILNAM-REC==      BY ==ENPGRP-REC==,
                        ==FILNAM-KEY==      BY ==ENPGRP-KEY==,
                        ==FILNAM-STATUSR==  BY ==ENPGRP-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==ENPGRP-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==ENPGRP-STARTGT==,
                        ==FILNAM-READ==     BY ==ENPGRP-READ==,
                        ==FILNAM-READNX==   BY ==ENPGRP-READNX==,
                        ==FILNAM-STATUS==   BY ==ENPGRP-STATUS==,
                        =='FILNAM'==        BY =='ENPGRP'==,
                        ==FILNAM-EXITR==    BY ==ENPGRP-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EXHMAS==,
                        ==FILNAM-START==    BY ==EXHMAS-START==,
                        ==FILNAM-REC==      BY ==EXHMAS-REC==,
                        ==FILNAM-KEY==      BY ==EXHMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==EXHMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EXHMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EXHMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==EXHMAS-READ==,
                        ==FILNAM-READNX==   BY ==EXHMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==EXHMAS-STATUS==,
                        =='FILNAM'==        BY =='EXHMAS'==,
                        ==FILNAM-EXITR==    BY ==EXHMAS-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EXTBENBT==,
                        ==FILNAM-START==    BY ==EXTBENBT-START==,
                        ==FILNAM-REC==      BY ==EXTBENBT-REC==,
                        ==FILNAM-KEY==      BY
                                    ==EXTERNALLY-DESCRIBED-KEY==,
                        ==IF FILNAM-KEY==   BY ==IF EXTBENBT-REC==,
                        ==FILNAM-STATUSR==  BY ==EXTBENBT-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EXTBENBT-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EXTBENBT-STARTGT==,
                        ==FILNAM-READ==     BY ==EXTBENBT-READ==,
                        ==FILNAM-READNX==   BY ==EXTBENBT-READNX==,
                        ==FILNAM-STATUS==   BY ==EXTBENBT-STATUS==,
                        =='FILNAM'==        BY =='EXTBENBT'==,
                        ==FILNAM-EXITR==    BY ==EXTBENBT-EXITR==.
      *
            COPY PHYSICALBR OF QLBLSRC
               REPLACING ==FILNAM==          BY ==EXCMDTBT==,
                         ==FILNAM-START==    BY ==EXCMDTBT-START==,
                         ==FILNAM-REC==      BY ==EXCMDTBT-REC==,
                         ==IF FILNAM-KEY==   BY ==IF EXCMDTBT-REC==,
                         ==FILNAM-KEY==      BY ==EXCMDTBT-KEY==,
                         ==FILNAM-STATUSR==  BY ==EXCMDTBT-STATUSR==,
                         ==FILNAM-STARTGE==  BY ==EXCMDTBT-STARTGE==,
                         ==FILNAM-STARTGT==  BY ==EXCMDTBT-STARTGT==,
                         ==FILNAM-READ==     BY ==EXCMDTBT-READ==,
                         ==FILNAM-READNX==   BY ==EXCMDTBT-READNX==,
                         ==FILNAM-STATUS==   BY ==EXCMDTBT-STATUS==,
                         =='FILNAM'==        BY =='EXCMDTBT'==,
                         ==FILNAM-EXITR==    BY ==EXCMDTBT-EXITR==.
      *
            COPY PHYSICALBR OF QLBLSRC
               REPLACING ==FILNAM==          BY ==EXCMEMBT==,
                         ==FILNAM-START==    BY ==EXCMEMBT-START==,
                         ==FILNAM-REC==      BY ==EXCMEMBT-REC==,
                         ==FILNAM-KEY==      BY ==EXCMEMBT-KEY==,
                         ==FILNAM-STATUSR==  BY ==EXCMEMBT-STATUSR==,
                         ==FILNAM-STARTGE==  BY ==EXCMEMBT-STARTGE==,
                         ==FILNAM-STARTGT==  BY ==EXCMEMBT-STARTGT==,
                         ==FILNAM-READ==     BY ==EXCMEMBT-READ==,
                         ==FILNAM-READNX==   BY ==EXCMEMBT-READNX==,
                         ==FILNAM-STATUS==   BY ==EXCMEMBT-STATUS==,
                         =='FILNAM'==        BY =='EXCMEMBT'==,
                         ==FILNAM-EXITR==    BY ==EXCMEMBT-EXITR==.
      *
           COPY LOGICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==EXCSMSBI==,
                        ==FILNAM-START==    BY ==EXCSMSBI-START==,
                        ==IF FILNAM-KEY==   BY ==IF EXCSMSBI-REC==,
                        ==FILNAM-REC==      BY ==EXCSMSBI-REC==,
                        ==FILNAM-KEY==
                                       BY ==EXTERNALLY-DESCRIBED-KEY==,
                        ==FILNAM-STATUSR==  BY ==EXCSMSBI-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==EXCSMSBI-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==EXCSMSBI-STARTGT==,
                        ==FILNAM-READ==     BY ==EXCSMSBI-READ==,
                        ==FILNAM-READNX==   BY ==EXCSMSBI-READNX==,
                        ==FILNAM-STATUS==   BY ==EXCSMSBI-STATUS==,
                        =='FILNAM'==        BY =='EXCSMSBI'==,
                        ==FILNAM-EXITR==    BY ==EXCSMSBI-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==GPHMAS==,
                        ==FILNAM-START==    BY ==GPHMAS-START==,
                        ==FILNAM-REC==      BY ==GPHMAS-REC==,
                        ==FILNAM-KEY==      BY ==GPHMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==GPHMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==GPHMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==GPHMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==GPHMAS-READ==,
                        ==FILNAM-READNX==   BY ==GPHMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==GPHMAS-STATUS==,
                        =='FILNAM'==        BY =='GPHMAS'==,
                        ==FILNAM-EXITR==    BY ==GPHMAS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==GRPMAS==,
                        ==FILNAM-START==    BY ==GRPMAS-START==,
                        ==FILNAM-REC==      BY ==GRPMAS-REC==,
                        ==FILNAM-KEY==      BY ==GRPMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==GRPMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==GRPMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==GRPMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==GRPMAS-READ==,
                        ==FILNAM-READNX==   BY ==GRPMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==GRPMAS-STATUS==,
                        =='FILNAM'==        BY =='GRPMAS'==,
                        ==FILNAM-EXITR==    BY ==GRPMAS-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MBHMAS==,
                        ==FILNAM-START==    BY ==MBHMAS-START==,
                        ==FILNAM-REC==      BY ==MBHMAS-REC==,
                        ==FILNAM-KEY==      BY ==MBHMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MBHMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MBHMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MBHMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MBHMAS-READ==,
                        ==FILNAM-READNX==   BY ==MBHMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MBHMAS-STATUS==,
                        =='FILNAM'==        BY =='MBHMAS'==,
                        ==FILNAM-EXITR==    BY ==MBHMAS-EXITR==.
           COPY MBHMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MCDMAS==,
                        ==FILNAM-START==    BY ==MCDMAS-START==,
                        ==FILNAM-REC==      BY ==MCDMAS-REC==,
                        ==FILNAM-KEY==      BY ==MCDMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MCDMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MCDMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MCDMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MCDMAS-READ==,
                        ==FILNAM-READNX==   BY ==MCDMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MCDMAS-STATUS==,
                        =='FILNAM'==        BY =='MCDMAS'==,
                        ==FILNAM-EXITR==    BY ==MCDMAS-EXITR==.

           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MDTMAS==,
                        ==FILNAM-START==    BY ==MDTMAS-START==,
                        ==FILNAM-REC==      BY ==MDTMAS-REC==,
                        ==FILNAM-KEY==      BY ==MDTMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MDTMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MDTMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MDTMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MDTMAS-READ==,
                        ==FILNAM-READNX==   BY ==MDTMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MDTMAS-STATUS==,
                        =='FILNAM'==        BY =='MDTMAS'==,
                        ==FILNAM-EXITR==    BY ==MDTMAS-EXITR==.
           COPY MDTMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MEEMAS==,
                        ==FILNAM-START==    BY ==MEEMAS-START==,
                        ==FILNAM-REC==      BY ==MEEMAS-REC==,
                        ==FILNAM-KEY==      BY ==MEEMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MEEMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MEEMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MEEMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MEEMAS-READ==,
                        ==FILNAM-READNX==   BY ==MEEMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MEEMAS-STATUS==,
                        =='FILNAM'==        BY =='MEEMAS'==,
                        ==FILNAM-EXITR==    BY ==MEEMAS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MEMEXDBT==,
                        ==FILNAM-START==    BY ==MEMEXDBT-START==,
                        ==FILNAM-REC==      BY ==MEMEXDBT-REC==,
                        ==FILNAM-KEY==      BY ==MEMEXDBT-KEY==,
                        ==FILNAM-STATUSR==  BY ==MEMEXDBT-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MEMEXDBT-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MEMEXDBT-STARTGT==,
                        ==FILNAM-READ==     BY ==MEMEXDBT-READ==,
                        ==FILNAM-READNX==   BY ==MEMEXDBT-READNX==,
                        ==FILNAM-STATUS==   BY ==MEMEXDBT-STATUS==,
                        =='FILNAM'==        BY =='MEMEXDBT'==,
                        ==FILNAM-EXITR==    BY ==MEMEXDBT-EXITR==.

           COPY MEMEXDBTB OF QLBLSRC.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MEMMAS==,
                        ==FILNAM-START==    BY ==MEMMAS-START==,
                        ==FILNAM-REC==      BY ==MEMMAS-REC==,
                        ==FILNAM-KEY==      BY ==MEMMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MEMMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MEMMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MEMMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MEMMAS-READ==,
                        ==FILNAM-READNX==   BY ==MEMMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MEMMAS-STATUS==,
                        =='FILNAM'==        BY =='MEMMAS'==,
                        ==FILNAM-EXITR==    BY ==MEMMAS-EXITR==.
      *
           COPY LOGICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MEMSBS==,
                        ==FILNAM-START==    BY ==MEMSBS-START==,
                        ==FILNAM-REC==      BY ==MEMSBS-REC==,
                        ==FILNAM-KEY==      BY ==MEMSBS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MEMSBS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MEMSBS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MEMSBS-STARTGT==,
                        ==FILNAM-READ==     BY ==MEMSBS-READ==,
                        ==FILNAM-READNX==   BY ==MEMSBS-READNX==,
                        ==FILNAM-STATUS==   BY ==MEMSBS-STATUS==,
                        =='FILNAM'==        BY =='MEMSBS'==,
                        ==FILNAM-EXITR==    BY ==MEMSBS-EXITR==.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MHSMAS==,
                        ==FILNAM-START==    BY ==MHSMAS-START==,
                        ==FILNAM-REC==      BY ==MHSMAS-REC==,
                        ==FILNAM-KEY==      BY ==MHSMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MHSMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MHSMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MHSMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MHSMAS-READ==,
                        ==FILNAM-READNX==   BY ==MHSMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MHSMAS-STATUS==,
                        =='FILNAM'==        BY =='MHSMAS'==,
                        ==FILNAM-EXITR==    BY ==MHSMAS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MMDMAS==,
                        ==FILNAM-START==    BY ==MMDMAS-START==,
                        ==FILNAM-REC==      BY ==MMDMAS-REC==,
                        ==FILNAM-KEY==      BY ==MMDMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MMDMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MMDMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MMDMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MMDMAS-READ==,
                        ==FILNAM-READNX==   BY ==MMDMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MMDMAS-STATUS==,
                        =='FILNAM'==        BY =='MMDMAS'==,
                        ==FILNAM-EXITR==    BY ==MMDMAS-EXITR==.
           COPY MMDMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MDMMAS==,
                        ==FILNAM-START==    BY ==MDMMAS-START==,
                        ==FILNAM-REC==      BY ==MDMMAS-REC==,
                        ==FILNAM-KEY==      BY ==MDMMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MDMMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MDMMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MDMMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MDMMAS-READ==,
                        ==FILNAM-READNX==   BY ==MDMMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MDMMAS-STATUS==,
                        =='FILNAM'==        BY =='MDMMAS'==,
                        ==FILNAM-EXITR==    BY ==MDMMAS-EXITR==.
           COPY MDMMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==MCMMAS==,
                        ==FILNAM-START==    BY ==MCMMAS-START==,
                        ==FILNAM-REC==      BY ==MCMMAS-REC==,
                        ==FILNAM-KEY==      BY ==MCMMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==MCMMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==MCMMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==MCMMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==MCMMAS-READ==,
                        ==FILNAM-READNX==   BY ==MCMMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==MCMMAS-STATUS==,
                        =='FILNAM'==        BY =='MCMMAS'==,
                        ==FILNAM-EXITR==    BY ==MCMMAS-EXITR==.
           COPY MCMMASBW OF QLBLSRC.
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==FACMAS==,
                        ==FILNAM-START==    BY ==FACMAS-START==,
                        ==FILNAM-REC==      BY ==FACMAS-REC==,
                        ==FILNAM-KEY==      BY ==FACMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==FACMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==FACMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==FACMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==FACMAS-READ==,
                        ==FILNAM-READNX==   BY ==FACMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==FACMAS-STATUS==,
                        =='FILNAM'==        BY =='FACMAS'==,
                        ==FILNAM-EXITR==    BY ==FACMAS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==PEMMAS==,
                        ==FILNAM-START==    BY ==PEMMAS-START==,
                        ==FILNAM-REC==      BY ==PEMMAS-REC==,
                        ==FILNAM-KEY==      BY ==PEMMAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==PEMMAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==PEMMAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==PEMMAS-STARTGT==,
                        ==FILNAM-READ==     BY ==PEMMAS-READ==,
                        ==FILNAM-READNX==   BY ==PEMMAS-READNX==,
                        ==FILNAM-STATUS==   BY ==PEMMAS-STATUS==,
                        =='FILNAM'==        BY =='PEMMAS'==,
                        ==FILNAM-EXITR==    BY ==PEMMAS-EXITR==.
      *
           COPY LOGICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==PE4SBS==,
                        ==FILNAM-START==    BY ==PE4SBS-START==,
                        ==IF FILNAM-KEY==   BY ==IF PE4SBS-REC==,
                        ==FILNAM-REC==      BY ==PE4SBS-REC==,
                        ==FILNAM-KEY==
                                       BY ==EXTERNALLY-DESCRIBED-KEY==,
                        ==FILNAM-STATUSR==  BY ==PE4SBS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==PE4SBS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==PE4SBS-STARTGT==,
                        ==FILNAM-READ==     BY ==PE4SBS-READ==,
                        ==FILNAM-READNX==   BY ==PE4SBS-READNX==,
                        ==FILNAM-STATUS==   BY ==PE4SBS-STATUS==,
                        =='FILNAM'==        BY =='PE4SBS'==,
                        ==FILNAM-EXITR==    BY ==PE4SBS-EXITR==.
      *
           COPY PHYSICALBR OF QLBLSRC
              REPLACING ==FILNAM==          BY ==RF3MAS==,
                        ==FILNAM-START==    BY ==RF3MAS-START==,
                        ==FILNAM-REC==      BY ==RF3MAS-REC==,
                        ==FILNAM-KEY==      BY ==RF3MAS-KEY==,
                        ==FILNAM-STATUSR==  BY ==RF3MAS-STATUSR==,
                        ==FILNAM-STARTGE==  BY ==RF3MAS-STARTGE==,
                        ==FILNAM-STARTGT==  BY ==RF3MAS-STARTGT==,
                        ==FILNAM-READ==     BY ==RF3MAS-READ==,
                        ==FILNAM-READNX==   BY ==RF3MAS-READNX==,
                        ==FILNAM-STATUS==   BY ==RF3MAS-STATUS==,
                        =='FILNAM'==        BY =='RF3MAS'==,
                        ==FILNAM-EXITR==    BY ==RF3MAS-EXITR==.

           COPY MSGCALL OF QSECCPY.                                     R323AEP1
      ****--------------------------------------------------------****
      ****  PMHS-270  KCT  Fix                                    ****
      ****  Change source file of copybook per standards.         ****
      ****--------------------------------------------------------****
      **** COPY ED201CB1 OF EDCBLLESRC.
           COPY ED201CB1 OF QLBLSRC.
